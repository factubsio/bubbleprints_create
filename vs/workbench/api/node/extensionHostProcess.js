/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/var mv=function(e,t){return mv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(i[r]=s[r])},mv(e,t)};export function __extends(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");mv(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}export var __assign=function(){return __assign=Object.assign||function(t){for(var i,s=1,r=arguments.length;s<r;s++){i=arguments[s];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},__assign.apply(this,arguments)};export function __rest(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(i[s[r]]=e[s[r]]);return i}export function __decorate(e,t,i,s){var r=arguments.length,n=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}export function __param(e,t){return function(i,s){t(i,s,e)}}export function __esDecorate(e,t,i,s,r,n){function o(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var a=s.kind,c=a==="getter"?"get":a==="setter"?"set":"value",l=!t&&e?s.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,s.name):{}),h,f=!1,p=i.length-1;p>=0;p--){var g={};for(var v in s)g[v]=v==="access"?{}:s[v];for(var v in s.access)g.access[v]=s.access[v];g.addInitializer=function(S){if(f)throw new TypeError("Cannot add initializers after decoration has completed");n.push(o(S||null))};var b=(0,i[p])(a==="accessor"?{get:u.get,set:u.set}:u[c],g);if(a==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(h=o(b.get))&&(u.get=h),(h=o(b.set))&&(u.set=h),(h=o(b.init))&&r.unshift(h)}else(h=o(b))&&(a==="field"?r.unshift(h):u[c]=h)}l&&Object.defineProperty(l,s.name,u),f=!0}export function __runInitializers(e,t,i){for(var s=arguments.length>2,r=0;r<t.length;r++)i=s?t[r].call(e,i):t[r].call(e);return s?i:void 0}export function __propKey(e){return typeof e=="symbol"?e:"".concat(e)}export function __setFunctionName(e,t,i){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}export function __metadata(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}export function __awaiter(e,t,i,s){function r(n){return n instanceof i?n:new i(function(o){o(n)})}return new(i||(i=Promise))(function(n,o){function a(u){try{l(s.next(u))}catch(h){o(h)}}function c(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?n(u.value):r(u.value).then(a,c)}l((s=s.apply(e,t||[])).next())})}export function __generator(e,t){var i={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},s,r,n,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(s=1,r&&(n=l[0]&2?r.return:l[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,l[1])).done)return n;switch(r=0,n&&(l=[l[0]&2,n.value]),l[0]){case 0:case 1:n=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(n=i.trys,!(n=n.length>0&&n[n.length-1])&&(l[0]===6||l[0]===2)){i=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){i.label=l[1];break}if(l[0]===6&&i.label<n[1]){i.label=n[1],n=l;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(l);break}n[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(u){l=[6,u],r=0}finally{s=n=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}export var __createBinding=Object.create?function(e,t,i,s){s===void 0&&(s=i);var r=Object.getOwnPropertyDescriptor(t,i);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,r)}:function(e,t,i,s){s===void 0&&(s=i),e[s]=t[i]};export function __exportStar(e,t){for(var i in e)i!=="default"&&!Object.prototype.hasOwnProperty.call(t,i)&&__createBinding(t,e,i)}export function __values(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],s=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}export function __read(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var s=i.call(e),r,n=[],o;try{for(;(t===void 0||t-- >0)&&!(r=s.next()).done;)n.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}return n}export function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}export function __spreadArrays(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var s=Array(e),r=0,t=0;t<i;t++)for(var n=arguments[t],o=0,a=n.length;o<a;o++,r++)s[r]=n[o];return s}export function __spreadArray(e,t,i){if(i||arguments.length===2)for(var s=0,r=t.length,n;s<r;s++)(n||!(s in t))&&(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}export function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}export function __asyncGenerator(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=i.apply(e,t||[]),r,n=[];return r={},a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(p){return function(g){return Promise.resolve(g).then(p,h)}}function a(p,g){s[p]&&(r[p]=function(v){return new Promise(function(b,S){n.push([p,v,b,S])>1||c(p,v)})},g&&(r[p]=g(r[p])))}function c(p,g){try{l(s[p](g))}catch(v){f(n[0][3],v)}}function l(p){p.value instanceof __await?Promise.resolve(p.value.v).then(u,h):f(n[0][2],p)}function u(p){c("next",p)}function h(p){c("throw",p)}function f(p,g){p(g),n.shift(),n.length&&c(n[0][0],n[0][1])}}export function __asyncDelegator(e){var t,i;return t={},s("next"),s("throw",function(r){throw r}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(r,n){t[r]=e[r]?function(o){return(i=!i)?{value:__await(e[r](o)),done:!1}:n?n(o):o}:n}}export function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(n){i[n]=e[n]&&function(o){return new Promise(function(a,c){o=e[n](o),r(a,c,o.done,o.value)})}}function r(n,o,a,c){Promise.resolve(c).then(function(l){n({value:l,done:a})},o)}}export function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var ML=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};export function __importStar(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return ML(t,e),t}export function __importDefault(e){return e&&e.__esModule?e:{default:e}}export function __classPrivateFieldGet(e,t,i,s){if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?s:i==="a"?s.call(e):s?s.value:t.get(e)}export function __classPrivateFieldSet(e,t,i,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,i):r?r.value=i:t.set(e,i),i}export function __classPrivateFieldIn(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}export function __addDisposableResource(e,t,i){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,r;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],i&&(r=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");r&&(s=function(){try{r.call(this)}catch(n){return Promise.reject(n)}}),e.stack.push({value:t,dispose:s,async:i})}else i&&e.stack.push({async:!0});return t}var LL=typeof SuppressedError=="function"?SuppressedError:function(e,t,i){var s=new Error(i);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};export function __disposeResources(e){function t(s){e.error=e.hasError?new LL(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}function i(){for(;e.stack.length;){var s=e.stack.pop();try{var r=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(r).then(i,function(n){return t(n),i()})}catch(n){t(n)}}if(e.hasError)throw e.error}return i()}export default{__extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__createBinding,__exportStar,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet,__classPrivateFieldIn,__addDisposableResource,__disposeResources};var RL=Object.create,vv=Object.defineProperty,OL=Object.getOwnPropertyDescriptor,Z5=Object.getOwnPropertyNames,FL=Object.getPrototypeOf,UL=Object.prototype.hasOwnProperty,jL=(e,t)=>function(){return t||(0,e[Z5(e)[0]])((t={exports:{}}).exports,t),t.exports},zL=(e,t)=>{for(var i in t)vv(e,i,{get:t[i],enumerable:!0})},HL=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Z5(t))!UL.call(e,r)&&r!==i&&vv(e,r,{get:()=>t[r],enumerable:!(s=OL(t,r))||s.enumerable});return e},Q5=(e,t,i)=>(i=e!=null?RL(FL(e)):{},HL(t||!e||!e.__esModule?vv(i,"default",{value:e,enumerable:!0}):i,e)),Y5=jL({"node_modules/minimist/index.js"(e,t){"use strict";function i(n,o){var a=n;o.slice(0,-1).forEach(function(l){a=a[l]||{}});var c=o[o.length-1];return c in a}function s(n){return typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}function r(n,o){return o==="constructor"&&typeof n[o]=="function"||o==="__proto__"}t.exports=function(n,o){o||(o={});var a={bools:{},strings:{},unknownFn:null};typeof o.unknown=="function"&&(a.unknownFn=o.unknown),typeof o.boolean=="boolean"&&o.boolean?a.allBools=!0:[].concat(o.boolean).filter(Boolean).forEach(function(z){a.bools[z]=!0});var c={};function l(z){return c[z].some(function(ue){return a.bools[ue]})}Object.keys(o.alias||{}).forEach(function(z){c[z]=[].concat(o.alias[z]),c[z].forEach(function(ue){c[ue]=[z].concat(c[z].filter(function(Le){return ue!==Le}))})}),[].concat(o.string).filter(Boolean).forEach(function(z){a.strings[z]=!0,c[z]&&[].concat(c[z]).forEach(function(ue){a.strings[ue]=!0})});var u=o.default||{},h={_:[]};function f(z,ue){return a.allBools&&/^--[^=]+$/.test(ue)||a.strings[z]||a.bools[z]||c[z]}function p(z,ue,Le){for(var ae=z,J=0;J<ue.length-1;J++){var q=ue[J];if(r(ae,q))return;ae[q]===void 0&&(ae[q]={}),(ae[q]===Object.prototype||ae[q]===Number.prototype||ae[q]===String.prototype)&&(ae[q]={}),ae[q]===Array.prototype&&(ae[q]=[]),ae=ae[q]}var G=ue[ue.length-1];r(ae,G)||((ae===Object.prototype||ae===Number.prototype||ae===String.prototype)&&(ae={}),ae===Array.prototype&&(ae=[]),ae[G]===void 0||a.bools[G]||typeof ae[G]=="boolean"?ae[G]=Le:Array.isArray(ae[G])?ae[G].push(Le):ae[G]=[ae[G],Le])}function g(z,ue,Le){if(!(Le&&a.unknownFn&&!f(z,Le)&&a.unknownFn(Le)===!1)){var ae=!a.strings[z]&&s(ue)?Number(ue):ue;p(h,z.split("."),ae),(c[z]||[]).forEach(function(J){p(h,J.split("."),ae)})}}Object.keys(a.bools).forEach(function(z){g(z,u[z]===void 0?!1:u[z])});var v=[];n.indexOf("--")!==-1&&(v=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--")));for(var b=0;b<n.length;b++){var S=n[b],E,k;if(/^--.+=/.test(S)){var j=S.match(/^--([^=]+)=([\s\S]*)$/);E=j[1];var O=j[2];a.bools[E]&&(O=O!=="false"),g(E,O,S)}else if(/^--no-.+/.test(S))E=S.match(/^--no-(.+)/)[1],g(E,!1,S);else if(/^--.+/.test(S))E=S.match(/^--(.+)/)[1],k=n[b+1],k!==void 0&&!/^(-|--)[^-]/.test(k)&&!a.bools[E]&&!a.allBools&&(!c[E]||!l(E))?(g(E,k,S),b+=1):/^(true|false)$/.test(k)?(g(E,k==="true",S),b+=1):g(E,a.strings[E]?"":!0,S);else if(/^-[^-]+/.test(S)){for(var Q=S.slice(1,-1).split(""),F=!1,B=0;B<Q.length;B++){if(k=S.slice(B+2),k==="-"){g(Q[B],k,S);continue}if(/[A-Za-z]/.test(Q[B])&&k[0]==="="){g(Q[B],k.slice(1),S),F=!0;break}if(/[A-Za-z]/.test(Q[B])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(k)){g(Q[B],k,S),F=!0;break}if(Q[B+1]&&Q[B+1].match(/\W/)){g(Q[B],S.slice(B+2),S),F=!0;break}else g(Q[B],a.strings[Q[B]]?"":!0,S)}E=S.slice(-1)[0],!F&&E!=="-"&&(n[b+1]&&!/^(-|--)[^-]/.test(n[b+1])&&!a.bools[E]&&(!c[E]||!l(E))?(g(E,n[b+1],S),b+=1):n[b+1]&&/^(true|false)$/.test(n[b+1])?(g(E,n[b+1]==="true",S),b+=1):g(E,a.strings[E]?"":!0,S))}else if((!a.unknownFn||a.unknownFn(S)!==!1)&&h._.push(a.strings._||!s(S)?S:Number(S)),o.stopEarly){h._.push.apply(h._,n.slice(b+1));break}}return Object.keys(u).forEach(function(z){i(h,z.split("."))||(p(h,z.split("."),u[z]),(c[z]||[]).forEach(function(ue){p(h,ue.split("."),u[z])}))}),o["--"]?h["--"]=v.slice():v.forEach(function(z){h._.push(z)}),h}}}),WL=Q5(Y5(),1);import*as BL from"net";var X5;function wv(e,t){const i=Object.create(null);for(const s of e){const r=t(s);let n=i[r];n||(n=i[r]=[]),n.push(s)}return i}function _L(e,t){const i=[],s=[];for(const r of e)t.has(r)||i.push(r);for(const r of t)e.has(r)||s.push(r);return{removed:i,added:s}}var Jee=class{static{X5=Symbol.toStringTag}constructor(e,t){this.b=t,this.a=new Map,this[X5]="SetWithKey";for(const i of e)this.add(i)}get size(){return this.a.size}add(e){const t=this.b(e);return this.a.set(t,e),this}delete(e){return this.a.delete(this.b(e))}has(e){return this.a.has(this.b(e))}*entries(){for(const e of this.a.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this.a.values())yield e}clear(){this.a.clear()}forEach(e,t){this.a.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}},VL=class{constructor(){this.b=[],this.a=function(e){setTimeout(()=>{throw e.stack?_s.isErrorNoTelemetry(e)?new _s(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.b.push(e),()=>{this.d(e)}}c(e){this.b.forEach(t=>{t(e)})}d(e){this.b.splice(this.b.indexOf(e),1)}setUnexpectedErrorHandler(e){this.a=e}getUnexpectedErrorHandler(){return this.a}onUnexpectedError(e){this.a(e),this.c(e)}onUnexpectedExternalError(e){this.a(e)}},iu=new VL;function bv(e){iu.setUnexpectedErrorHandler(e)}function qL(e){if(!e||typeof e!="object")return!1;const t=e;return t.code==="EPIPE"&&t.syscall?.toUpperCase()==="WRITE"}function su(e){iu.onUnexpectedError(e)}function lt(e){Mi(e)||iu.onUnexpectedError(e)}function Qd(e){Mi(e)||iu.onUnexpectedExternalError(e)}function ic(e){if(e instanceof Error){const{name:t,message:i,cause:s}=e,r=e.stacktrace||e.stack;return{$isError:!0,name:t,message:i,stack:r,noTelemetry:_s.isErrorNoTelemetry(e),cause:s?ic(s):void 0,code:e.code}}return e}function K5(e){let t;return e.noTelemetry?t=new _s:(t=new Error,t.name=e.name),t.message=e.message,t.stack=e.stack,e.code&&(t.code=e.code),e.cause&&(t.cause=K5(e.cause)),t}var Yd="Canceled";function Mi(e){return e instanceof dt?!0:e instanceof Error&&e.name===Yd&&e.message===Yd}var dt=class extends Error{constructor(){super(Yd),this.name=this.message}},yv=class Z1 extends Error{static{this.a="PendingMigrationError"}static is(t){return t instanceof Z1||t instanceof Error&&t.name===Z1.a}constructor(t){super(t),this.name=Z1.a}};function ru(){const e=new Error(Yd);return e.name=e.message,e}function $e(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}function Av(e){return e?new Error(`Illegal state: ${e}`):new Error("Illegal state")}var Lo=class extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}};function eE(e){return e?e.message?e.message:e.stack?e.stack.split(`
`)[0]:String(e):"Error"}var GL=class extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}},Sv=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}},_s=class w5 extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof w5)return t;const i=new w5;return i.message=t.message,i.stack=t.stack,i}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},qt=class GN extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,GN.prototype)}};function Ev(e,t){const i=this;let s=!1,r;return function(){if(s)return r;if(s=!0,t)try{r=e.apply(i,arguments)}finally{t()}else r=e.apply(i,arguments);return r}}function JL(e,t,i=e.length-1){const s=ZL(e,t,i);if(s!==-1)return e[s]}function ZL(e,t,i=e.length-1){for(let s=i;s>=0;s--){const r=e[s];if(t(r,s))return s}return-1}function QL(e,t,i=0,s=e.length){let r=i,n=s;for(;r<n;){const o=Math.floor((r+n)/2);t(e[o])?r=o+1:n=o}return r-1}function YL(e,t,i=0,s=e.length){let r=i,n=s;for(;r<n;){const o=Math.floor((r+n)/2);t(e[o])?n=o:r=o+1}return r}var Zee=class JN{static{this.assertInvariants=!1}constructor(t){this.e=t,this.c=0}findLastMonotonous(t){if(JN.assertInvariants){if(this.d){for(const s of this.e)if(this.d(s)&&!t(s))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this.d=t}const i=QL(this.e,t,this.c);return this.c=i+1,i===-1?void 0:this.e[i]}};function Ci(e,t,i=(s,r)=>s===r){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let s=0,r=e.length;s<r;s++)if(!i(e[s],t[s]))return!1;return!0}function XL(e,t){const i=[];let s;for(const r of e.slice(0).sort(t))!s||t(s[0],r)!==0?(s=[r],i.push(s)):s.push(r);return i}function tE(e,t,i){const s=[];function r(a,c,l){if(c===0&&l.length===0)return;const u=s[s.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=c,u.toInsert.push(...l)):s.push({start:a,deleteCount:c,toInsert:l})}let n=0,o=0;for(;;){if(n===e.length){r(n,0,t.slice(o));break}if(o===t.length){r(n,e.length-n,[]);break}const a=e[n],c=t[o],l=i(a,c);l===0?(n+=1,o+=1):l<0?(r(n,1,[]),n+=1):l>0&&(r(n,0,[c]),o+=1)}return s}function KL(e,t,i){const s=tE(e,t,i),r=[],n=[];for(const o of s)r.push(...e.slice(o.start,o.start+o.deleteCount)),n.push(...o.toInsert);return{removed:r,added:n}}function eR(e,t,i,s,r){return i===0?Promise.resolve([]):new Promise((n,o)=>{(async()=>{const a=e.length,c=e.slice(0,i).sort(t);for(let l=i,u=Math.min(i+s,a);l<a;l=u,u=Math.min(u+s,a)){if(l>i&&await new Promise(h=>setTimeout(h)),r&&r.isCancellationRequested)throw new dt;tR(e,t,c,l,u)}return c})().then(n,o)})}function tR(e,t,i,s,r){for(const n=i.length;s<r;s++){const o=e[s];if(t(o,i[n-1])<0){i.pop();const a=YL(i,c=>t(o,c)<0);i.splice(a,0,o)}}}function gt(e){return e.filter(t=>!!t)}function iR(e){let t=0;for(let i=0;i<e.length;i++)e[i]&&(e[t]=e[i],t+=1);e.length=t}function xv(e){return!Array.isArray(e)||e.length===0}function nu(e){return Array.isArray(e)&&e.length>0}function Tn(e,t=i=>i){const i=new Set;return e.filter(s=>{const r=t(s);return i.has(r)?!1:(i.add(r),!0)})}function iE(e,t){return e.push(t),()=>sR(e,t)}function sR(e,t){const i=e.indexOf(t);if(i>-1)return e.splice(i,1),t}function sE(e,t){let i;if(typeof t=="number"){let s=t;i=()=>{const r=Math.sin(s++)*179426549;return r-Math.floor(r)}}else i=Math.random;for(let s=e.length-1;s>0;s-=1){const r=Math.floor(i()*(s+1)),n=e[s];e[s]=e[r],e[r]=n}}function Xd(e,t){return Array.isArray(e)?e.map(t):t(e)}function xs(e){return Array.isArray(e)?e:[e]}var Cv;(function(e){function t(n){return n<0}e.isLessThan=t;function i(n){return n<=0}e.isLessThanOrEqual=i;function s(n){return n>0}e.isGreaterThan=s;function r(n){return n===0}e.isNeitherLessOrGreaterThan=r,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(Cv||(Cv={}));function rR(e,t){return(i,s)=>t(e(i),e(s))}var nR=(e,t)=>e-t,Qee=class Q1{static{this.empty=new Q1(t=>{})}constructor(t){this.iterate=t}forEach(t){this.iterate(i=>(t(i),!0))}toArray(){const t=[];return this.iterate(i=>(t.push(i),!0)),t}filter(t){return new Q1(i=>this.iterate(s=>t(s)?i(s):!0))}map(t){return new Q1(i=>this.iterate(s=>i(t(s))))}some(t){let i=!1;return this.iterate(s=>(i=t(s),!i)),i}findFirst(t){let i;return this.iterate(s=>t(s)?(i=s,!1):!0),i}findLast(t){let i;return this.iterate(s=>(t(s)&&(i=s),!0)),i}findLastMaxBy(t){let i,s=!0;return this.iterate(r=>((s||Cv.isGreaterThan(t(r,i)))&&(s=!1,i=r),!0)),i}},rE,nE,oE;function oR(e,t,i){let s=e.get(t);return s===void 0&&(s=i,e.set(t,s)),s}var aR=class{constructor(e,t){this.uri=e,this.value=t}};function cR(e){return Array.isArray(e)}var kt=class Fd{static{this.c=t=>t.toString()}constructor(t,i){if(this[rE]="ResourceMap",t instanceof Fd)this.d=new Map(t.d),this.e=i??Fd.c;else if(cR(t)){this.d=new Map,this.e=i??Fd.c;for(const[s,r]of t)this.set(s,r)}else this.d=new Map,this.e=t??Fd.c}set(t,i){return this.d.set(this.e(t),new aR(t,i)),this}get(t){return this.d.get(this.e(t))?.value}has(t){return this.d.has(this.e(t))}get size(){return this.d.size}clear(){this.d.clear()}delete(t){return this.d.delete(this.e(t))}forEach(t,i){typeof i<"u"&&(t=t.bind(i));for(const[s,r]of this.d)t(r.value,r.uri,this)}*values(){for(const t of this.d.values())yield t.value}*keys(){for(const t of this.d.values())yield t.uri}*entries(){for(const t of this.d.values())yield[t.uri,t.value]}*[(rE=Symbol.toStringTag,Symbol.iterator)](){for(const[,t]of this.d)yield[t.uri,t.value]}},ou=class{constructor(e,t){this[nE]="ResourceSet",!e||typeof e=="function"?this.c=new kt(e):(this.c=new kt(t),e.forEach(this.add,this))}get size(){return this.c.size}add(e){return this.c.set(e,e),this}clear(){this.c.clear()}delete(e){return this.c.delete(e)}forEach(e,t){this.c.forEach((i,s)=>e.call(t,s,s,this))}has(e){return this.c.has(e)}entries(){return this.c.entries()}keys(){return this.c.keys()}values(){return this.c.keys()}[(nE=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}},aE;(function(e){e[e.None=0]="None",e[e.AsOld=1]="AsOld",e[e.AsNew=2]="AsNew"})(aE||(aE={}));var lR=class{constructor(){this[oE]="LinkedMap",this.c=new Map,this.d=void 0,this.e=void 0,this.f=0,this.g=0}clear(){this.c.clear(),this.d=void 0,this.e=void 0,this.f=0,this.g++}isEmpty(){return!this.d&&!this.e}get size(){return this.f}get first(){return this.d?.value}get last(){return this.e?.value}has(e){return this.c.has(e)}get(e,t=0){const i=this.c.get(e);if(i)return t!==0&&this.n(i,t),i.value}set(e,t,i=0){let s=this.c.get(e);if(s)s.value=t,i!==0&&this.n(s,i);else{switch(s={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.l(s);break;case 1:this.k(s);break;case 2:this.l(s);break;default:this.l(s);break}this.c.set(e,s),this.f++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this.c.get(e);if(t)return this.c.delete(e),this.m(t),this.f--,t.value}shift(){if(!this.d&&!this.e)return;if(!this.d||!this.e)throw new Error("Invalid list");const e=this.d;return this.c.delete(e.key),this.m(e),this.f--,e.value}forEach(e,t){const i=this.g;let s=this.d;for(;s;){if(t?e.bind(t)(s.value,s.key,this):e(s.value,s.key,this),this.g!==i)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){const e=this,t=this.g;let i=this.d;const s={[Symbol.iterator](){return s},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}values(){const e=this,t=this.g;let i=this.d;const s={[Symbol.iterator](){return s},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}entries(){const e=this,t=this.g;let i=this.d;const s={[Symbol.iterator](){return s},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}[(oE=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}h(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this.d,i=this.size;for(;t&&i>e;)this.c.delete(t.key),t=t.next,i--;this.d=t,this.f=i,t&&(t.previous=void 0),this.g++}j(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this.e,i=this.size;for(;t&&i>e;)this.c.delete(t.key),t=t.previous,i--;this.e=t,this.f=i,t&&(t.next=void 0),this.g++}k(e){if(!this.d&&!this.e)this.e=e;else if(this.d)e.next=this.d,this.d.previous=e;else throw new Error("Invalid list");this.d=e,this.g++}l(e){if(!this.d&&!this.e)this.d=e;else if(this.e)e.previous=this.e,this.e.next=e;else throw new Error("Invalid list");this.e=e,this.g++}m(e){if(e===this.d&&e===this.e)this.d=void 0,this.e=void 0;else if(e===this.d){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this.d=e.next}else if(e===this.e){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this.e=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this.g++}n(e,t){if(!this.d||!this.e)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this.d)return;const i=e.next,s=e.previous;e===this.e?(s.next=void 0,this.e=s):(i.previous=s,s.next=i),e.previous=void 0,e.next=this.d,this.d.previous=e,this.d=e,this.g++}else if(t===2){if(e===this.e)return;const i=e.next,s=e.previous;e===this.d?(i.previous=void 0,this.d=i):(i.previous=s,s.next=i),e.next=void 0,e.previous=this.e,this.e.next=e,this.e=e,this.g++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}},uR=class extends lR{constructor(e,t=1){super(),this.o=e,this.p=Math.min(Math.max(0,t),1)}get limit(){return this.o}set limit(e){this.o=e,this.q()}get ratio(){return this.p}set ratio(e){this.p=Math.min(Math.max(0,e),1),this.q()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}q(){this.size>this.o&&this.r(Math.round(this.o*this.p))}},sc=class extends uR{constructor(e,t=1){super(e,t)}r(e){this.h(e)}set(e,t){return super.set(e,t),this.q(),this}},hR=class{constructor(e){if(this.c=new Map,this.d=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this.c.clear(),this.d.clear()}set(e,t){this.c.set(e,t),this.d.set(t,e)}get(e){return this.c.get(e)}getKey(e){return this.d.get(e)}delete(e){const t=this.c.get(e);return t===void 0?!1:(this.c.delete(e),this.d.delete(t),!0)}forEach(e,t){this.c.forEach((i,s)=>{e.call(t,i,s,this)})}keys(){return this.c.keys()}values(){return this.c.values()}},cE=class{constructor(){this.c=new Map}add(e,t){let i=this.c.get(e);i||(i=new Set,this.c.set(e,i)),i.add(t)}delete(e,t){const i=this.c.get(e);i&&(i.delete(t),i.size===0&&this.c.delete(e))}forEach(e,t){const i=this.c.get(e);i&&i.forEach(t)}get(e){const t=this.c.get(e);return t||new Set}};function ki(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function kv(e,t="Unreachable"){throw new Error(t)}function $v(e,t="unexpected state"){if(!e)throw typeof t=="string"?new qt(`Assertion Failed: ${t}`):t}function lE(e){if(!e()){debugger;e(),lt(new qt("Assertion Failed"))}}function Oe(e){return typeof e=="string"}function dR(e){return fR(e,Oe)}function fR(e,t){return Array.isArray(e)&&e.every(t)}function At(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}function pR(e){const t=Object.getPrototypeOf(Uint8Array);return typeof e=="object"&&e instanceof t}function Cs(e){return typeof e=="number"&&!isNaN(e)}function gR(e){return!!e&&typeof e[Symbol.iterator]=="function"}function uE(e){return e===!0||e===!1}function au(e){return typeof e>"u"}function fs(e){return!Wt(e)}function Wt(e){return au(e)||e===null}function Iv(e,t){if(!e)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function rc(e){return $v(e!=null,"Argument is `undefined` or `null`."),e}var mR=Object.prototype.hasOwnProperty;function Dv(e){if(!At(e))return!1;for(const t in e)if(mR.call(e,t))return!1;return!0}function hE(e){return typeof e=="function"}function vR(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++)dE(e[s],t[s])}function dE(e,t){if(Oe(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(hE(t)){try{if(e instanceof t)return}catch{}if(!Wt(e)&&e.constructor===t||t.length===1&&t.call(void 0,e)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Nn(e,t){for(const i in t)if(!(i in e))return!1;return!0}var Bt;(function(e){function t(F){return!!F&&typeof F=="object"&&typeof F[Symbol.iterator]=="function"}e.is=t;const i=Object.freeze([]);function s(){return i}e.empty=s;function*r(F){yield F}e.single=r;function n(F){return t(F)?F:r(F)}e.wrap=n;function o(F){return F??i}e.from=o;function*a(F){for(let B=F.length-1;B>=0;B--)yield F[B]}e.reverse=a;function c(F){return!F||F[Symbol.iterator]().next().done===!0}e.isEmpty=c;function l(F){return F[Symbol.iterator]().next().value}e.first=l;function u(F,B){let z=0;for(const ue of F)if(B(ue,z++))return!0;return!1}e.some=u;function h(F,B){let z=0;for(const ue of F)if(!B(ue,z++))return!1;return!0}e.every=h;function f(F,B){for(const z of F)if(B(z))return z}e.find=f;function*p(F,B){for(const z of F)B(z)&&(yield z)}e.filter=p;function*g(F,B){let z=0;for(const ue of F)yield B(ue,z++)}e.map=g;function*v(F,B){let z=0;for(const ue of F)yield*B(ue,z++)}e.flatMap=v;function*b(...F){for(const B of F)gR(B)?yield*B:yield B}e.concat=b;function S(F,B,z){let ue=z;for(const Le of F)ue=B(ue,Le);return ue}e.reduce=S;function E(F){let B=0;for(const z of F)B++;return B}e.length=E;function*k(F,B,z=F.length){for(B<-F.length&&(B=0),B<0&&(B+=F.length),z<0?z+=F.length:z>F.length&&(z=F.length);B<z;B++)yield F[B]}e.slice=k;function j(F,B=Number.POSITIVE_INFINITY){const z=[];if(B===0)return[z,F];const ue=F[Symbol.iterator]();for(let Le=0;Le<B;Le++){const ae=ue.next();if(ae.done)return[z,e.empty()];z.push(ae.value)}return[z,{[Symbol.iterator](){return ue}}]}e.consume=j;async function O(F){const B=[];for await(const z of F)B.push(z);return B}e.asyncToArray=O;async function Q(F){let B=[];for await(const z of F)B=B.concat(z);return B}e.asyncToArrayFlat=Q})(Bt||(Bt={}));var wR=!1,Ro=null,Yee=class ZN{constructor(){this.b=new Map}static{this.a=0}c(t){let i=this.b.get(t);return i||(i={parent:null,source:null,isSingleton:!1,value:t,idx:ZN.a++},this.b.set(t,i)),i}trackDisposable(t){const i=this.c(t);i.source||(i.source=new Error().stack)}setParent(t,i){const s=this.c(t);s.parent=i}markAsDisposed(t){this.b.delete(t)}markAsSingleton(t){this.c(t).isSingleton=!0}f(t,i){const s=i.get(t);if(s)return s;const r=t.parent?this.f(this.c(t.parent),i):t;return i.set(t,r),r}getTrackedDisposables(){const t=new Map;return[...this.b.entries()].filter(([,s])=>s.source!==null&&!this.f(s,t).isSingleton).flatMap(([s])=>s)}computeLeakingDisposables(t=10,i){let s;if(i)s=i;else{const c=new Map,l=[...this.b.values()].filter(h=>h.source!==null&&!this.f(h,c).isSingleton);if(l.length===0)return;const u=new Set(l.map(h=>h.value));if(s=l.filter(h=>!(h.parent&&u.has(h.parent))),s.length===0)throw new Error("There are cyclic diposable chains!")}if(!s)return;function r(c){function l(h,f){for(;h.length>0&&f.some(p=>typeof p=="string"?p===h[0]:h[0].match(p));)h.shift()}const u=c.source.split(`
`).map(h=>h.trim().replace("at ","")).filter(h=>h!=="");return l(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const n=new cE;for(const c of s){const l=r(c);for(let u=0;u<=l.length;u++)n.add(l.slice(0,u).join(`
`),c)}s.sort(rR(c=>c.idx,nR));let o="",a=0;for(const c of s.slice(0,t)){a++;const l=r(c),u=[];for(let h=0;h<l.length;h++){let f=l[h];f=`(shared with ${n.get(l.slice(0,h+1).join(`
`)).size}/${s.length} leaks) at ${f}`;const g=n.get(l.slice(0,h).join(`
`)),v=wv([...g].map(b=>r(b)[h]),b=>b);delete v[l[h]];for(const[b,S]of Object.entries(v))S&&u.unshift(`    - stacktraces of ${S.length} other leaks continue with ${b}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${s.length}: ${c.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return s.length>t&&(o+=`


... and ${s.length-t} more leaking disposables

`),{leaks:s,details:o}}};function bR(e){Ro=e}if(wR){const e="__is_disposable_tracked__";bR(new class{trackDisposable(t){const i=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[e]||console.log(i)},3e3)}setParent(t,i){if(t&&t!==Z.None)try{t[e]=!0}catch{}}markAsDisposed(t){if(t&&t!==Z.None)try{t[e]=!0}catch{}}markAsSingleton(t){}})}function nc(e){return Ro?.trackDisposable(e),e}function oc(e){Ro?.markAsDisposed(e)}function Oo(e,t){Ro?.setParent(e,t)}function yR(e,t){if(Ro)for(const i of e)Ro.setParent(i,t)}function Pv(e){return Ro?.markAsSingleton(e),e}function fE(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"&&e.dispose.length===0}function Zi(e){if(Bt.is(e)){const t=[];for(const i of e)if(i)try{i.dispose()}catch(s){t.push(s)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function Tv(...e){const t=te(()=>Zi(e));return yR(e,t),t}var AR=class{constructor(e){this.a=!1,this.b=e,nc(this)}dispose(){if(!this.a){if(!this.b)throw new Error("Unbound disposable context: Need to use an arrow function to preserve the value of this");this.a=!0,oc(this),this.b()}}};function te(e){return new AR(e)}var ie=class QN{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this.f=new Set,this.g=!1,nc(this)}dispose(){this.g||(oc(this),this.g=!0,this.clear())}get isDisposed(){return this.g}clear(){if(this.f.size!==0)try{Zi(this.f)}finally{this.f.clear()}}add(t){if(!t||t===Z.None)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return Oo(t,this),this.g?QN.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this.f.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this.f.delete(t),t.dispose()}}deleteAndLeak(t){t&&this.f.delete(t)&&Oo(t,null)}assertNotDisposed(){this.g&&lt(new qt("Object disposed"))}},Z=class{static{this.None=Object.freeze({dispose(){}})}constructor(){this.B=new ie,nc(this),Oo(this.B,this)}dispose(){oc(this),this.B.dispose()}D(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this.B.add(e)}},Vs=class{constructor(){this.b=!1,nc(this)}get value(){return this.b?void 0:this.a}set value(e){this.b||e===this.a||(this.a?.dispose(),e&&Oo(e,this),this.a=e)}clear(){this.value=void 0}dispose(){this.b=!0,oc(this),this.a?.dispose(),this.a=void 0}clearAndLeak(){const e=this.a;return this.a=void 0,e&&Oo(e,null),e}},Fo=class{constructor(e=new Map){this.b=!1,this.a=e,nc(this)}dispose(){oc(this),this.b=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this.a.size)try{Zi(this.a.values())}finally{this.a.clear()}}has(e){return this.a.has(e)}get size(){return this.a.size}get(e){return this.a.get(e)}set(e,t,i=!1){this.b&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this.a.get(e)?.dispose(),this.a.set(e,t),Oo(t,this)}deleteAndDispose(e){this.a.get(e)?.dispose(),this.a.delete(e)}deleteAndLeak(e){const t=this.a.get(e);return t&&Oo(t,null),this.a.delete(e),t}keys(){return this.a.keys()}values(){return this.a.values()}[Symbol.iterator](){return this.a[Symbol.iterator]()}};function SR(e,t){return e.then(i=>(t.isDisposed?i.dispose():t.add(i),i))}var ER=class extends Fo{constructor(){super(new kt)}},Ft=class Y1{static{this.Undefined=new Y1(void 0)}constructor(t){this.element=t,this.next=Y1.Undefined,this.prev=Y1.Undefined}},Mn=class{constructor(){this.a=Ft.Undefined,this.b=Ft.Undefined,this.c=0}get size(){return this.c}isEmpty(){return this.a===Ft.Undefined}clear(){let e=this.a;for(;e!==Ft.Undefined;){const t=e.next;e.prev=Ft.Undefined,e.next=Ft.Undefined,e=t}this.a=Ft.Undefined,this.b=Ft.Undefined,this.c=0}unshift(e){return this.d(e,!1)}push(e){return this.d(e,!0)}d(e,t){const i=new Ft(e);if(this.a===Ft.Undefined)this.a=i,this.b=i;else if(t){const r=this.b;this.b=i,i.prev=r,r.next=i}else{const r=this.a;this.a=i,i.next=r,r.prev=i}this.c+=1;let s=!1;return()=>{s||(s=!0,this.e(i))}}shift(){if(this.a!==Ft.Undefined){const e=this.a.element;return this.e(this.a),e}}pop(){if(this.b!==Ft.Undefined){const e=this.b.element;return this.e(this.b),e}}peek(){if(this.b!==Ft.Undefined)return this.b.element}e(e){if(e.prev!==Ft.Undefined&&e.next!==Ft.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Ft.Undefined&&e.next===Ft.Undefined?(this.a=Ft.Undefined,this.b=Ft.Undefined):e.next===Ft.Undefined?(this.b=this.b.prev,this.b.next=Ft.Undefined):e.prev===Ft.Undefined&&(this.a=this.a.next,this.a.prev=Ft.Undefined);this.c-=1}*[Symbol.iterator](){let e=this.a;for(;e!==Ft.Undefined;)yield e.element,e=e.next}},xR=globalThis.performance.now.bind(globalThis.performance),Qi=class YN{static create(t){return new YN(t)}constructor(t){this.c=t===!1?Date.now:xR,this.a=this.c(),this.b=-1}stop(){this.b=this.c()}reset(){this.a=this.c(),this.b=-1}elapsed(){return this.b!==-1?this.b-this.a:this.c()-this.a}},pE=!1,CR=!1,Ie;(function(e){e.None=()=>Z.None;function t(J){if(CR){const{onDidAddListener:q}=J,G=Nv.create();let K=0;J.onDidAddListener=()=>{++K===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),G.print()),q?.()}}}function i(J,q,G){return p(J,()=>{},0,void 0,q??!0,void 0,G)}e.defer=i;function s(J){return(q,G=null,K)=>{let se=!1,ve;return ve=J(Ne=>{if(!se)return ve?ve.dispose():se=!0,q.call(G,Ne)},null,K),se&&ve.dispose(),ve}}e.once=s;function r(J,q){return e.once(e.filter(J,q))}e.onceIf=r;function n(J,q,G){return h((K,se=null,ve)=>J(Ne=>K.call(se,q(Ne)),null,ve),G)}e.map=n;function o(J,q,G){return h((K,se=null,ve)=>J(Ne=>{q(Ne),K.call(se,Ne)},null,ve),G)}e.forEach=o;function a(J,q,G){return h((K,se=null,ve)=>J(Ne=>q(Ne)&&K.call(se,Ne),null,ve),G)}e.filter=a;function c(J){return J}e.signal=c;function l(...J){return(q,G=null,K)=>{const se=Tv(...J.map(ve=>ve(Ne=>q.call(G,Ne))));return f(se,K)}}e.any=l;function u(J,q,G,K){let se=G;return n(J,ve=>(se=q(se,ve),se),K)}e.reduce=u;function h(J,q){let G;const K={onWillAddFirstListener(){G=J(se.fire,se)},onDidRemoveLastListener(){G?.dispose()}};q||t(K);const se=new I(K);return q?.add(se),se.event}function f(J,q){return q instanceof Array?q.push(J):q&&q.add(J),J}function p(J,q,G=100,K=!1,se=!1,ve,Ne){let Me,mt,Vt,tt=0,Rt;const Si={leakWarningThreshold:ve,onWillAddFirstListener(){Me=J(As=>{tt++,mt=q(mt,As),K&&!Vt&&(ii.fire(mt),mt=void 0),Rt=()=>{const Dn=mt;mt=void 0,Vt=void 0,(!K||tt>1)&&ii.fire(Dn),tt=0},typeof G=="number"?(Vt&&clearTimeout(Vt),Vt=setTimeout(Rt,G)):Vt===void 0&&(Vt=null,queueMicrotask(Rt))})},onWillRemoveListener(){se&&tt>0&&Rt?.()},onDidRemoveLastListener(){Rt=void 0,Me.dispose()}};Ne||t(Si);const ii=new I(Si);return Ne?.add(ii),ii.event}e.debounce=p;function g(J,q=0,G,K){return e.debounce(J,(se,ve)=>se?(se.push(ve),se):[ve],q,void 0,G??!0,void 0,K)}e.accumulate=g;function v(J,q=(K,se)=>K===se,G){let K=!0,se;return a(J,ve=>{const Ne=K||!q(ve,se);return K=!1,se=ve,Ne},G)}e.latch=v;function b(J,q,G){return[e.filter(J,q,G),e.filter(J,K=>!q(K),G)]}e.split=b;function S(J,q=!1,G=[],K){let se=G.slice(),ve=J(mt=>{se?se.push(mt):Me.fire(mt)});K&&K.add(ve);const Ne=()=>{se?.forEach(mt=>Me.fire(mt)),se=null},Me=new I({onWillAddFirstListener(){ve||(ve=J(mt=>Me.fire(mt)),K&&K.add(ve))},onDidAddFirstListener(){se&&(q?setTimeout(Ne):Ne())},onDidRemoveLastListener(){ve&&ve.dispose(),ve=null}});return K&&K.add(Me),Me.event}e.buffer=S;function E(J,q){return(K,se,ve)=>{const Ne=q(new j);return J(function(Me){const mt=Ne.evaluate(Me);mt!==k&&K.call(se,mt)},void 0,ve)}}e.chain=E;const k=Symbol("HaltChainable");class j{constructor(){this.f=[]}map(q){return this.f.push(q),this}forEach(q){return this.f.push(G=>(q(G),G)),this}filter(q){return this.f.push(G=>q(G)?G:k),this}reduce(q,G){let K=G;return this.f.push(se=>(K=q(K,se),K)),this}latch(q=(G,K)=>G===K){let G=!0,K;return this.f.push(se=>{const ve=G||!q(se,K);return G=!1,K=se,ve?se:k}),this}evaluate(q){for(const G of this.f)if(q=G(q),q===k)break;return q}}function O(J,q,G=K=>K){const K=(...Me)=>Ne.fire(G(...Me)),se=()=>J.on(q,K),ve=()=>J.removeListener(q,K),Ne=new I({onWillAddFirstListener:se,onDidRemoveLastListener:ve});return Ne.event}e.fromNodeEventEmitter=O;function Q(J,q,G=K=>K){const K=(...Me)=>Ne.fire(G(...Me)),se=()=>J.addEventListener(q,K),ve=()=>J.removeEventListener(q,K),Ne=new I({onWillAddFirstListener:se,onDidRemoveLastListener:ve});return Ne.event}e.fromDOMEventEmitter=Q;function F(J,q){let G,K;const se=new Promise(ve=>{K=s(J)(ve),Mv(K,q),G=()=>{vE(K,q)}});return se.cancel=G,q&&se.finally(()=>vE(K,q)),se}e.toPromise=F;function B(J,q){return J(G=>q.fire(G))}e.forward=B;function z(J,q,G){return q(G),J(K=>q(K))}e.runAndSubscribe=z;class ue{constructor(q,G){this._observable=q,this.f=0,this.g=!1;const K={onWillAddFirstListener:()=>{q.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{q.removeObserver(this)}};G||t(K),this.emitter=new I(K),G&&G.add(this.emitter)}beginUpdate(q){this.f++}handlePossibleChange(q){}handleChange(q,G){this.g=!0}endUpdate(q){this.f--,this.f===0&&(this._observable.reportChanges(),this.g&&(this.g=!1,this.emitter.fire(this._observable.get())))}}function Le(J,q){return new ue(J,q).emitter.event}e.fromObservable=Le;function ae(J){return(q,G,K)=>{let se=0,ve=!1;const Ne={beginUpdate(){se++},endUpdate(){se--,se===0&&(J.reportChanges(),ve&&(ve=!1,q.call(G)))},handlePossibleChange(){},handleChange(){ve=!0}};J.addObserver(Ne),J.reportChanges();const Me={dispose(){J.removeObserver(Ne)}};return Mv(Me,K),Me}}e.fromObservableLight=ae})(Ie||(Ie={}));var kR=class b5{static{this.all=new Set}static{this.f=0}constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${b5.f++}`,b5.all.add(this)}start(t){this.g=new Qi,this.listenerCount=t}stop(){if(this.g){const t=this.g.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this.g=void 0}}},gE=-1,$R=class XN{static{this.f=1}constructor(t,i,s=(XN.f++).toString(16).padStart(3,"0")){this.j=t,this.threshold=i,this.name=s,this.h=0}dispose(){this.g?.clear()}check(t,i){const s=this.threshold;if(s<=0||i<s)return;this.g||(this.g=new Map);const r=this.g.get(t.value)||0;if(this.g.set(t.value,r+1),this.h-=1,this.h<=0){this.h=s*.5;const[n,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(n);const c=new IR(a,n);this.j(c)}return()=>{const n=this.g.get(t.value)||0;this.g.set(t.value,n-1)}}getMostFrequentStack(){if(!this.g)return;let t,i=0;for(const[s,r]of this.g)(!t||i<r)&&(t=[s,r],i=r);return t}},Nv=class KN{static create(){const t=new Error;return new KN(t.stack??"")}constructor(t){this.value=t}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},IR=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},DR=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},PR=0,Kd=class{constructor(e){this.value=e,this.id=PR++}},TR=2,mE=(e,t)=>{if(e instanceof Kd)t(e);else for(let i=0;i<e.length;i++){const s=e[i];s&&t(s)}},I=class{constructor(e){this.A=0,this.g=e,this.j=gE>0||this.g?.leakWarningThreshold?new $R(e?.onListenerError??lt,this.g?.leakWarningThreshold??gE):void 0,this.m=this.g?._profName?new kR(this.g._profName):void 0,this.z=this.g?.deliveryQueue}dispose(){if(!this.q){if(this.q=!0,this.z?.current===this&&this.z.reset(),this.w){if(pE){const e=this.w;queueMicrotask(()=>{mE(e,t=>t.stack?.print())})}this.w=void 0,this.A=0}this.g?.onDidRemoveLastListener?.(),this.j?.dispose()}}get event(){return this.u??=(e,t,i)=>{if(this.j&&this.A>this.j.threshold**2){const a=`[${this.j.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this.A} vs ${this.j.threshold})`;console.warn(a);const c=this.j.getMostFrequentStack()??["UNKNOWN stack",-1],l=new DR(`${a}. HINT: Stack shows most frequent listener (${c[1]}-times)`,c[0]);return(this.g?.onListenerError||lt)(l),Z.None}if(this.q)return Z.None;t&&(e=e.bind(t));const s=new Kd(e);let r,n;this.j&&this.A>=Math.ceil(this.j.threshold*.2)&&(s.stack=Nv.create(),r=this.j.check(s.stack,this.A+1)),pE&&(s.stack=n??Nv.create()),this.w?this.w instanceof Kd?(this.z??=new NR,this.w=[this.w,s]):this.w.push(s):(this.g?.onWillAddFirstListener?.(this),this.w=s,this.g?.onDidAddFirstListener?.(this)),this.g?.onDidAddListener?.(this),this.A++;const o=te(()=>{r?.(),this.B(s)});return Mv(o,i),o},this.u}B(e){if(this.g?.onWillRemoveListener?.(this),!this.w)return;if(this.A===1){this.w=void 0,this.g?.onDidRemoveLastListener?.(this),this.A=0;return}const t=this.w,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this.q),console.log("size?",this.A),console.log("arr?",JSON.stringify(this.w)),new Error("Attempted to dispose unknown listener");this.A--,t[i]=void 0;const s=this.z.current===this;if(this.A*TR<=t.length){let r=0;for(let n=0;n<t.length;n++)t[n]?t[r++]=t[n]:s&&r<this.z.end&&(this.z.end--,r<this.z.i&&this.z.i--);t.length=r}}C(e,t){if(!e)return;const i=this.g?.onListenerError||lt;if(!i){e.value(t);return}try{e.value(t)}catch(s){i(s)}}D(e){const t=e.current.w;for(;e.i<e.end;)this.C(t[e.i++],e.value);e.reset()}fire(e){if(this.z?.current&&(this.D(this.z),this.m?.stop()),this.m?.start(this.A),this.w)if(this.w instanceof Kd)this.C(this.w,e);else{const t=this.z;t.enqueue(this,e,this.w.length),this.D(t)}this.m?.stop()}hasListeners(){return this.A>0}},NR=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},cu=class extends I{async fireAsync(e,t,i){if(this.w)for(this.f||(this.f=new Mn),mE(this.w,s=>this.f.push([s.value,e]));this.f.size>0&&!t.isCancellationRequested;){const[s,r]=this.f.shift(),n=[],o={...r,token:t,waitUntil:a=>{if(Object.isFrozen(n))throw new Error("waitUntil can NOT be called asynchronous");i&&(a=i(a,s)),n.push(a)}};try{s(o)}catch(a){lt(a);continue}Object.freeze(n),await Promise.allSettled(n).then(a=>{for(const c of a)c.status==="rejected"&&lt(c.reason)})}}},lu=class extends I{get isPaused(){return this.f!==0}constructor(e){super(e),this.f=0,this.h=new Mn,this.s=e?.merge}pause(){this.f++}resume(){if(this.f!==0&&--this.f===0)if(this.s){if(this.h.size>0){const e=Array.from(this.h);this.h.clear(),super.fire(this.s(e))}}else for(;!this.f&&this.h.size!==0;)super.fire(this.h.shift())}fire(e){this.A&&(this.f!==0?this.h.push(e):super.fire(e))}},MR=class extends lu{constructor(e){super(e),this.k=e.delay??100}fire(e){this.o||(this.pause(),this.o=setTimeout(()=>{this.o=void 0,this.resume()},this.k)),super.fire(e)}},LR=class extends I{constructor(e){super(e),this.f=[],this.h=e?.merge}fire(e){this.hasListeners()&&(this.f.push(e),this.f.length===1&&queueMicrotask(()=>{this.h?super.fire(this.h(this.f)):this.f.forEach(t=>super.fire(t)),this.f=[]}))}},RR=class{constructor(){this.f=!1,this.g=Ie.None,this.h=Z.None,this.j=new I({onDidAddFirstListener:()=>{this.f=!0,this.h=this.g(this.j.fire,this.j)},onDidRemoveLastListener:()=>{this.f=!1,this.h.dispose()}}),this.event=this.j.event}set input(e){this.g=e,this.f&&(this.h.dispose(),this.h=e(this.j.fire,this.j))}dispose(){this.h.dispose(),this.j.dispose()}};function Mv(e,t){t instanceof ie?t.add(e):Array.isArray(t)&&t.push(e)}function vE(e,t){if(t instanceof ie)t.delete(e);else if(Array.isArray(t)){const i=t.indexOf(e);i!==-1&&t.splice(i,1)}e.dispose()}var wE=Object.freeze(function(e,t){const i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}),Fe;(function(e){function t(i){return i===e.None||i===e.Cancelled||i instanceof ef?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ie.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:wE})})(Fe||(Fe={}));var ef=class{constructor(){this.a=!1,this.b=null}cancel(){this.a||(this.a=!0,this.b&&(this.b.fire(void 0),this.dispose()))}get isCancellationRequested(){return this.a}get onCancellationRequested(){return this.a?wE:(this.b||(this.b=new I),this.b.event)}dispose(){this.b&&(this.b.dispose(),this.b=null)}},Qe=class{constructor(e){this.f=void 0,this.g=void 0,this.g=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this.f||(this.f=new ef),this.f}cancel(){this.f?this.f instanceof ef&&this.f.cancel():this.f=Fe.Cancelled}dispose(e=!1){e&&this.cancel(),this.g?.dispose(),this.f?this.f instanceof ef&&this.f.dispose():this.f=Fe.None}};function OR(){return globalThis._VSCODE_NLS_MESSAGES}function bE(){return globalThis._VSCODE_NLS_LANGUAGE}var FR=bE()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function tf(e,t){let i;return t.length===0?i=e:i=e.replace(/\{(\d+)\}/g,(s,r)=>{const n=r[0],o=t[n];let a=s;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),FR&&(i="\uFF3B"+i.replace(/[aouei]/g,"$&$&")+"\uFF3D"),i}function d(e,t,...i){return tf(typeof e=="number"?yE(e,t):t,i)}function yE(e,t){const i=OR()?.[e];if(typeof i!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${e} !!!`)}return i}function sf(e,t,...i){let s;typeof e=="number"?s=yE(e,t):s=t;const r=tf(s,i);return{value:r,original:t===s?r:tf(t,i)}}var Ln="en",uu=!1,hu=!1,du=!1,UR=!1,AE=!1,Lv=!1,jR=!1,Rv=!1,SE=!1,EE=!1,rf=void 0,nf=Ln,xE=Ln,zR=void 0,Jr=void 0,Zr=globalThis,Yi=void 0;typeof Zr.vscode<"u"&&typeof Zr.vscode.process<"u"?Yi=Zr.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Yi=process);var CE=typeof Yi?.versions?.electron=="string",HR=CE&&Yi?.type==="renderer";if(typeof Yi=="object"){uu=Yi.platform==="win32",hu=Yi.platform==="darwin",du=Yi.platform==="linux",UR=du&&!!Yi.env.SNAP&&!!Yi.env.SNAP_REVISION,jR=CE,SE=!!Yi.env.CI||!!Yi.env.BUILD_ARTIFACTSTAGINGDIRECTORY||!!Yi.env.GITHUB_WORKSPACE,rf=Ln,nf=Ln;const e=Yi.env.VSCODE_NLS_CONFIG;if(e)try{const t=JSON.parse(e);rf=t.userLocale,xE=t.osLocale,nf=t.resolvedLanguage||Ln,zR=t.languagePack?.translationsConfigFile}catch{}AE=!0}else typeof navigator=="object"&&!HR?(Jr=navigator.userAgent,uu=Jr.indexOf("Windows")>=0,hu=Jr.indexOf("Macintosh")>=0,Rv=(Jr.indexOf("Macintosh")>=0||Jr.indexOf("iPad")>=0||Jr.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,du=Jr.indexOf("Linux")>=0,EE=Jr?.indexOf("Mobi")>=0,Lv=!0,nf=bE()||Ln,rf=navigator.language.toLowerCase(),xE=rf):console.error("Unable to resolve platform.");var kE;(function(e){e[e.Web=0]="Web",e[e.Mac=1]="Mac",e[e.Linux=2]="Linux",e[e.Windows=3]="Windows"})(kE||(kE={}));function WR(e){switch(e){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var of=0;hu?of=1:uu?of=3:du&&(of=2);var ze=uu,Pt=hu,$t=du,$E=AE,Uo=Lv,BR=Lv&&typeof Zr.importScripts=="function",_R=BR?Zr.origin:void 0,VR=Rv,qR=EE,jo=SE,GR=of,wr=Jr,Rn=nf,IE;(function(e){function t(){return Rn}e.value=t;function i(){return Rn.length===2?Rn==="en":Rn.length>=3?Rn[0]==="e"&&Rn[1]==="n"&&Rn[2]==="-":!1}e.isDefaultVariant=i;function s(){return Rn==="en"}e.isDefault=s})(IE||(IE={}));var JR=typeof Zr.postMessage=="function"&&!Zr.importScripts,DE=(()=>{if(JR){const e=[];Zr.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork)for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n.id===i.data.vscodeScheduleAsyncWork){e.splice(s,1),n.callback();return}}});let t=0;return i=>{const s=++t;e.push({id:s,callback:i}),Zr.postMessage({vscodeScheduleAsyncWork:s},"*")}}return e=>setTimeout(e)})(),PE;(function(e){e[e.Windows=1]="Windows",e[e.Macintosh=2]="Macintosh",e[e.Linux=3]="Linux"})(PE||(PE={}));var zo=hu||Rv?2:uu?1:3,TE=!0,NE=!1;function ME(){if(!NE){NE=!0;const e=new Uint8Array(2);e[0]=1,e[1]=2,TE=new Uint16Array(e.buffer)[0]===513}return TE}var Ov=!!(wr&&wr.indexOf("Chrome")>=0),ZR=!!(wr&&wr.indexOf("Firefox")>=0),QR=!!(!Ov&&wr&&wr.indexOf("Safari")>=0),LE=!!(wr&&wr.indexOf("Edg/")>=0),Xee=!!(wr&&wr.indexOf("Android")>=0),Ho,Fv=globalThis.vscode;if(typeof Fv<"u"&&typeof Fv.process<"u"){const e=Fv.process;Ho={get platform(){return e.platform},get arch(){return e.arch},get env(){return e.env},cwd(){return e.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Ho={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Ho={get platform(){return ze?"win32":Pt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Wo=Ho.cwd,On=Ho.env,YR=Ho.platform,Kee=Ho.arch,XR=65,KR=97,e2=90,t2=122,Bo=46,di=47,Xi=92,Qr=58,i2=63,RE=class extends Error{constructor(e,t,i){let s;typeof t=="string"&&t.indexOf("not ")===0?(s="must not be",t=t.replace(/^not /,"")):s="must be";const r=e.indexOf(".")!==-1?"property":"argument";let n=`The "${e}" ${r} ${s} of type ${t}`;n+=`. Received type ${typeof i}`,super(n),this.code="ERR_INVALID_ARG_TYPE"}};function s2(e,t){if(e===null||typeof e!="object")throw new RE(t,"Object",e)}function Gt(e,t){if(typeof e!="string")throw new RE(t,"string",e)}var Ki=YR==="win32";function Ue(e){return e===di||e===Xi}function Uv(e){return e===di}function Yr(e){return e>=XR&&e<=e2||e>=KR&&e<=t2}function af(e,t,i,s){let r="",n=0,o=-1,a=0,c=0;for(let l=0;l<=e.length;++l){if(l<e.length)c=e.charCodeAt(l);else{if(s(c))break;c=di}if(s(c)){if(!(o===l-1||a===1))if(a===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==Bo||r.charCodeAt(r.length-2)!==Bo){if(r.length>2){const u=r.lastIndexOf(i);u===-1?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf(i)),o=l,a=0;continue}else if(r.length!==0){r="",n=0,o=l,a=0;continue}}t&&(r+=r.length>0?`${i}..`:"..",n=2)}else r.length>0?r+=`${i}${e.slice(o+1,l)}`:r=e.slice(o+1,l),n=l-o-1;o=l,a=0}else c===Bo&&a!==-1?++a:a=-1}return r}function r2(e){return e?`${e[0]==="."?"":"."}${e}`:""}function OE(e,t){s2(t,"pathObject");const i=t.dir||t.root,s=t.base||`${t.name||""}${r2(t.ext)}`;return i?i===t.root?`${i}${s}`:`${i}${e}${s}`:s}var Jt={resolve(...e){let t="",i="",s=!1;for(let r=e.length-1;r>=-1;r--){let n;if(r>=0){if(n=e[r],Gt(n,`paths[${r}]`),n.length===0)continue}else t.length===0?n=Wo():(n=On[`=${t}`]||Wo(),(n===void 0||n.slice(0,2).toLowerCase()!==t.toLowerCase()&&n.charCodeAt(2)===Xi)&&(n=`${t}\\`));const o=n.length;let a=0,c="",l=!1;const u=n.charCodeAt(0);if(o===1)Ue(u)&&(a=1,l=!0);else if(Ue(u))if(l=!0,Ue(n.charCodeAt(1))){let h=2,f=h;for(;h<o&&!Ue(n.charCodeAt(h));)h++;if(h<o&&h!==f){const p=n.slice(f,h);for(f=h;h<o&&Ue(n.charCodeAt(h));)h++;if(h<o&&h!==f){for(f=h;h<o&&!Ue(n.charCodeAt(h));)h++;(h===o||h!==f)&&(c=`\\\\${p}\\${n.slice(f,h)}`,a=h)}}}else a=1;else Yr(u)&&n.charCodeAt(1)===Qr&&(c=n.slice(0,2),a=2,o>2&&Ue(n.charCodeAt(2))&&(l=!0,a=3));if(c.length>0)if(t.length>0){if(c.toLowerCase()!==t.toLowerCase())continue}else t=c;if(s){if(t.length>0)break}else if(i=`${n.slice(a)}\\${i}`,s=l,l&&t.length>0)break}return i=af(i,!s,"\\",Ue),s?`${t}\\${i}`:`${t}${i}`||"."},normalize(e){Gt(e,"path");const t=e.length;if(t===0)return".";let i=0,s,r=!1;const n=e.charCodeAt(0);if(t===1)return Uv(n)?"\\":e;if(Ue(n))if(r=!0,Ue(e.charCodeAt(1))){let a=2,c=a;for(;a<t&&!Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){const l=e.slice(c,a);for(c=a;a<t&&Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&!Ue(e.charCodeAt(a));)a++;if(a===t)return`\\\\${l}\\${e.slice(c)}\\`;a!==c&&(s=`\\\\${l}\\${e.slice(c,a)}`,i=a)}}}else i=1;else Yr(n)&&e.charCodeAt(1)===Qr&&(s=e.slice(0,2),i=2,t>2&&Ue(e.charCodeAt(2))&&(r=!0,i=3));let o=i<t?af(e.slice(i),!r,"\\",Ue):"";if(o.length===0&&!r&&(o="."),o.length>0&&Ue(e.charCodeAt(t-1))&&(o+="\\"),!r&&s===void 0&&e.includes(":")){if(o.length>=2&&Yr(o.charCodeAt(0))&&o.charCodeAt(1)===Qr)return`.\\${o}`;let a=e.indexOf(":");do if(a===t-1||Ue(e.charCodeAt(a+1)))return`.\\${o}`;while((a=e.indexOf(":",a+1))!==-1)}return s===void 0?r?`\\${o}`:o:r?`${s}\\${o}`:`${s}${o}`},isAbsolute(e){Gt(e,"path");const t=e.length;if(t===0)return!1;const i=e.charCodeAt(0);return Ue(i)||t>2&&Yr(i)&&e.charCodeAt(1)===Qr&&Ue(e.charCodeAt(2))},join(...e){if(e.length===0)return".";let t,i;for(let n=0;n<e.length;++n){const o=e[n];Gt(o,"path"),o.length>0&&(t===void 0?t=i=o:t+=`\\${o}`)}if(t===void 0)return".";let s=!0,r=0;if(typeof i=="string"&&Ue(i.charCodeAt(0))){++r;const n=i.length;n>1&&Ue(i.charCodeAt(1))&&(++r,n>2&&(Ue(i.charCodeAt(2))?++r:s=!1))}if(s){for(;r<t.length&&Ue(t.charCodeAt(r));)r++;r>=2&&(t=`\\${t.slice(r)}`)}return Jt.normalize(t)},relative(e,t){if(Gt(e,"from"),Gt(t,"to"),e===t)return"";const i=Jt.resolve(e),s=Jt.resolve(t);if(i===s||(e=i.toLowerCase(),t=s.toLowerCase(),e===t))return"";if(i.length!==e.length||s.length!==t.length){const g=i.split("\\"),v=s.split("\\");g[g.length-1]===""&&g.pop(),v[v.length-1]===""&&v.pop();const b=g.length,S=v.length,E=b<S?b:S;let k;for(k=0;k<E&&g[k].toLowerCase()===v[k].toLowerCase();k++);return k===0?s:k===E?S>E?v.slice(k).join("\\"):b>E?"..\\".repeat(b-1-k)+"..":"":"..\\".repeat(b-k)+v.slice(k).join("\\")}let r=0;for(;r<e.length&&e.charCodeAt(r)===Xi;)r++;let n=e.length;for(;n-1>r&&e.charCodeAt(n-1)===Xi;)n--;const o=n-r;let a=0;for(;a<t.length&&t.charCodeAt(a)===Xi;)a++;let c=t.length;for(;c-1>a&&t.charCodeAt(c-1)===Xi;)c--;const l=c-a,u=o<l?o:l;let h=-1,f=0;for(;f<u;f++){const g=e.charCodeAt(r+f);if(g!==t.charCodeAt(a+f))break;g===Xi&&(h=f)}if(f!==u){if(h===-1)return s}else{if(l>u){if(t.charCodeAt(a+f)===Xi)return s.slice(a+f+1);if(f===2)return s.slice(a+f)}o>u&&(e.charCodeAt(r+f)===Xi?h=f:f===2&&(h=3)),h===-1&&(h=0)}let p="";for(f=r+h+1;f<=n;++f)(f===n||e.charCodeAt(f)===Xi)&&(p+=p.length===0?"..":"\\..");return a+=h,p.length>0?`${p}${s.slice(a,c)}`:(s.charCodeAt(a)===Xi&&++a,s.slice(a,c))},toNamespacedPath(e){if(typeof e!="string"||e.length===0)return e;const t=Jt.resolve(e);if(t.length<=2)return e;if(t.charCodeAt(0)===Xi){if(t.charCodeAt(1)===Xi){const i=t.charCodeAt(2);if(i!==i2&&i!==Bo)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(Yr(t.charCodeAt(0))&&t.charCodeAt(1)===Qr&&t.charCodeAt(2)===Xi)return`\\\\?\\${t}`;return t},dirname(e){Gt(e,"path");const t=e.length;if(t===0)return".";let i=-1,s=0;const r=e.charCodeAt(0);if(t===1)return Ue(r)?e:".";if(Ue(r)){if(i=s=1,Ue(e.charCodeAt(1))){let a=2,c=a;for(;a<t&&!Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&!Ue(e.charCodeAt(a));)a++;if(a===t)return e;a!==c&&(i=s=a+1)}}}}else Yr(r)&&e.charCodeAt(1)===Qr&&(i=t>2&&Ue(e.charCodeAt(2))?3:2,s=i);let n=-1,o=!0;for(let a=t-1;a>=s;--a)if(Ue(e.charCodeAt(a))){if(!o){n=a;break}}else o=!1;if(n===-1){if(i===-1)return".";n=i}return e.slice(0,n)},basename(e,t){t!==void 0&&Gt(t,"suffix"),Gt(e,"path");let i=0,s=-1,r=!0,n;if(e.length>=2&&Yr(e.charCodeAt(0))&&e.charCodeAt(1)===Qr&&(i=2),t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=i;--n){const c=e.charCodeAt(n);if(Ue(c)){if(!r){i=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return i===s?s=a:s===-1&&(s=e.length),e.slice(i,s)}for(n=e.length-1;n>=i;--n)if(Ue(e.charCodeAt(n))){if(!r){i=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":e.slice(i,s)},extname(e){Gt(e,"path");let t=0,i=-1,s=0,r=-1,n=!0,o=0;e.length>=2&&e.charCodeAt(1)===Qr&&Yr(e.charCodeAt(0))&&(t=s=2);for(let a=e.length-1;a>=t;--a){const c=e.charCodeAt(a);if(Ue(c)){if(!n){s=a+1;break}continue}r===-1&&(n=!1,r=a+1),c===Bo?i===-1?i=a:o!==1&&(o=1):i!==-1&&(o=-1)}return i===-1||r===-1||o===0||o===1&&i===r-1&&i===s+1?"":e.slice(i,r)},format:OE.bind(null,"\\"),parse(e){Gt(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.length;let s=0,r=e.charCodeAt(0);if(i===1)return Ue(r)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(Ue(r)){if(s=1,Ue(e.charCodeAt(1))){let h=2,f=h;for(;h<i&&!Ue(e.charCodeAt(h));)h++;if(h<i&&h!==f){for(f=h;h<i&&Ue(e.charCodeAt(h));)h++;if(h<i&&h!==f){for(f=h;h<i&&!Ue(e.charCodeAt(h));)h++;h===i?s=h:h!==f&&(s=h+1)}}}}else if(Yr(r)&&e.charCodeAt(1)===Qr){if(i<=2)return t.root=t.dir=e,t;if(s=2,Ue(e.charCodeAt(2))){if(i===3)return t.root=t.dir=e,t;s=3}}s>0&&(t.root=e.slice(0,s));let n=-1,o=s,a=-1,c=!0,l=e.length-1,u=0;for(;l>=s;--l){if(r=e.charCodeAt(l),Ue(r)){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),r===Bo?n===-1?n=l:u!==1&&(u=1):n!==-1&&(u=-1)}return a!==-1&&(n===-1||u===0||u===1&&n===a-1&&n===o+1?t.base=t.name=e.slice(o,a):(t.name=e.slice(o,n),t.base=e.slice(o,a),t.ext=e.slice(n,a))),o>0&&o!==s?t.dir=e.slice(0,o-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},n2=(()=>{if(Ki){const e=/\\/g;return()=>{const t=Wo().replace(e,"/");return t.slice(t.indexOf("/"))}}return()=>Wo()})(),Be={resolve(...e){let t="",i=!1;for(let s=e.length-1;s>=0&&!i;s--){const r=e[s];Gt(r,`paths[${s}]`),r.length!==0&&(t=`${r}/${t}`,i=r.charCodeAt(0)===di)}if(!i){const s=n2();t=`${s}/${t}`,i=s.charCodeAt(0)===di}return t=af(t,!i,"/",Uv),i?`/${t}`:t.length>0?t:"."},normalize(e){if(Gt(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===di,i=e.charCodeAt(e.length-1)===di;return e=af(e,!t,"/",Uv),e.length===0?t?"/":i?"./":".":(i&&(e+="/"),t?`/${e}`:e)},isAbsolute(e){return Gt(e,"path"),e.length>0&&e.charCodeAt(0)===di},join(...e){if(e.length===0)return".";const t=[];for(let i=0;i<e.length;++i){const s=e[i];Gt(s,"path"),s.length>0&&t.push(s)}return t.length===0?".":Be.normalize(t.join("/"))},relative(e,t){if(Gt(e,"from"),Gt(t,"to"),e===t||(e=Be.resolve(e),t=Be.resolve(t),e===t))return"";const i=1,s=e.length,r=s-i,n=1,o=t.length-n,a=r<o?r:o;let c=-1,l=0;for(;l<a;l++){const h=e.charCodeAt(i+l);if(h!==t.charCodeAt(n+l))break;h===di&&(c=l)}if(l===a)if(o>a){if(t.charCodeAt(n+l)===di)return t.slice(n+l+1);if(l===0)return t.slice(n+l)}else r>a&&(e.charCodeAt(i+l)===di?c=l:l===0&&(c=0));let u="";for(l=i+c+1;l<=s;++l)(l===s||e.charCodeAt(l)===di)&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(n+c)}`},toNamespacedPath(e){return e},dirname(e){if(Gt(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===di;let i=-1,s=!0;for(let r=e.length-1;r>=1;--r)if(e.charCodeAt(r)===di){if(!s){i=r;break}}else s=!1;return i===-1?t?"/":".":t&&i===1?"//":e.slice(0,i)},basename(e,t){t!==void 0&&Gt(t,"suffix"),Gt(e,"path");let i=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const c=e.charCodeAt(n);if(c===di){if(!r){i=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return i===s?s=a:s===-1&&(s=e.length),e.slice(i,s)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===di){if(!r){i=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":e.slice(i,s)},extname(e){Gt(e,"path");let t=-1,i=0,s=-1,r=!0,n=0;for(let o=e.length-1;o>=0;--o){const a=e[o];if(a==="/"){if(!r){i=o+1;break}continue}s===-1&&(r=!1,s=o+1),a==="."?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===i+1?"":e.slice(t,s)},format:OE.bind(null,"/"),parse(e){Gt(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.charCodeAt(0)===di;let s;i?(t.root="/",s=1):s=0;let r=-1,n=0,o=-1,a=!0,c=e.length-1,l=0;for(;c>=s;--c){const u=e.charCodeAt(c);if(u===di){if(!a){n=c+1;break}continue}o===-1&&(a=!1,o=c+1),u===Bo?r===-1?r=c:l!==1&&(l=1):r!==-1&&(l=-1)}if(o!==-1){const u=n===0&&i?1:n;r===-1||l===0||l===1&&r===o-1&&r===n+1?t.base=t.name=e.slice(u,o):(t.name=e.slice(u,r),t.base=e.slice(u,o),t.ext=e.slice(r,o))}return n>0?t.dir=e.slice(0,n-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Be.win32=Jt.win32=Jt,Be.posix=Jt.posix=Be;var Xr=Ki?Jt.normalize:Be.normalize,ks=Ki?Jt.isAbsolute:Be.isAbsolute,_e=Ki?Jt.join:Be.join,o2=Ki?Jt.resolve:Be.resolve,ac=Ki?Jt.relative:Be.relative,$i=Ki?Jt.dirname:Be.dirname,vt=Ki?Jt.basename:Be.basename,cf=Ki?Jt.extname:Be.extname,ete=Ki?Jt.format:Be.format,tte=Ki?Jt.parse:Be.parse,ite=Ki?Jt.toNamespacedPath:Be.toNamespacedPath,St=Ki?Jt.sep:Be.sep,FE=Ki?Jt.delimiter:Be.delimiter;function a2(e){return e}var c2=class{constructor(e,t){this.a=void 0,this.b=void 0,typeof e=="function"?(this.c=e,this.d=a2):(this.c=t,this.d=e.getCacheKey)}get(e){const t=this.d(e);return this.b!==t&&(this.b=t,this.a=this.c(e)),this.a}},Fn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Completed=2]="Completed"})(Fn||(Fn={}));var Tt=class{constructor(e){this.d=e,this.a=Fn.Uninitialized}get hasValue(){return this.a===Fn.Completed}get value(){if(this.a===Fn.Uninitialized){this.a=Fn.Running;try{this.b=this.d()}catch(e){this.c=e}finally{this.a=Fn.Completed}}else if(this.a===Fn.Running)throw new Error("Cannot read the value of a lazy that is being initialized");if(this.c)throw this.c;return this.b}get rawValue(){return this.b}};function fu(e){return!e||typeof e!="string"?!0:e.trim().length===0}var l2=/{([^}]+)}/g;function UE(e,t){return Object.keys(t).length===0?e:e.replace(l2,(i,s)=>t[s]??i)}function Un(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function u2(e,t){let i=0,s=e.indexOf(t);for(;s!==-1;)i++,s=e.indexOf(t,s+t.length);return i}function h2(e,t){if(!e||!t)return e;const i=t.length;let s=0;if(i===1){const r=t.charCodeAt(0);for(;s<e.length&&e.charCodeAt(s)===r;)s++}else for(;e.startsWith(t,s);)s+=i;return e.substring(s)}function jn(e,t){if(!e||!t)return e;const i=t.length,s=e.length;if(i===1){let n=s;const o=t.charCodeAt(0);for(;n>0&&e.charCodeAt(n-1)===o;)n--;return e.substring(0,n)}let r=s;for(;r>0&&e.endsWith(t,r);)r-=i;return e.substring(0,r)}function jE(e,t,i={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=Un(e)),i.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e=e+"\\b"));let s="";return i.global&&(s+="g"),i.matchCase||(s+="i"),i.multiline&&(s+="m"),i.unicode&&(s+="u"),new RegExp(e,s)}function zE(e){return e.source==="^"||e.source==="^$"||e.source==="$"||e.source==="^\\s*$"?!1:!!(e.exec("")&&e.lastIndex===0)}function HE(e){return e.split(/\r\n|\r|\n/)}function jv(e){for(let t=0,i=e.length;t<i;t++){const s=e.charCodeAt(t);if(s!==32&&s!==9)return t}return-1}function d2(e,t=e.length-1){for(let i=t;i>=0;i--){const s=e.charCodeAt(i);if(s!==32&&s!==9)return i}return-1}function _o(e,t){return e<t?-1:e>t?1:0}function zv(e,t,i=0,s=e.length,r=0,n=t.length){for(;i<s&&r<n;i++,r++){const c=e.charCodeAt(i),l=t.charCodeAt(r);if(c<l)return-1;if(c>l)return 1}const o=s-i,a=n-r;return o<a?-1:o>a?1:0}function Hv(e,t){return cc(e,t,0,e.length,0,t.length)}function cc(e,t,i=0,s=e.length,r=0,n=t.length){for(;i<s&&r<n;i++,r++){let c=e.charCodeAt(i),l=t.charCodeAt(r);if(c===l)continue;if(c>=128||l>=128)return zv(e.toLowerCase(),t.toLowerCase(),i,s,r,n);WE(c)&&(c-=32),WE(l)&&(l-=32);const u=c-l;if(u!==0)return u}const o=s-i,a=n-r;return o<a?-1:o>a?1:0}function WE(e){return e>=97&&e<=122}function BE(e){return e>=65&&e<=90}function $s(e,t){return e.length===t.length&&cc(e,t)===0}function lf(e,t){const i=t.length;return i<=e.length&&cc(e,t,0,i)===0}function f2(e,t){const i=e.length,s=i-t.length;return s>=0&&cc(e,t,s,i)===0}function p2(e,t){const i=Math.min(e.length,t.length);let s;for(s=0;s<i;s++)if(e.charCodeAt(s)!==t.charCodeAt(s))return s;return i}function uf(e){return 55296<=e&&e<=56319}function hf(e){return 56320<=e&&e<=57343}function Wv(e,t){return(e-55296<<10)+(t-56320)+65536}function _E(e,t,i){const s=e.charCodeAt(i);if(uf(s)&&i+1<t){const r=e.charCodeAt(i+1);if(hf(r))return Wv(s,r)}return s}function g2(e,t){const i=e.charCodeAt(t-1);if(hf(i)&&t>1){const s=e.charCodeAt(t-2);if(uf(s))return Wv(s,i)}return i}var m2=class{get offset(){return this.e}constructor(e,t=0){this.c=e,this.d=e.length,this.e=t}setOffset(e){this.e=e}prevCodePoint(){const e=g2(this.c,this.e);return this.e-=e>=65536?2:1,e}nextCodePoint(){const e=_E(this.c,this.d,this.e);return this.e+=e>=65536?2:1,e}eol(){return this.e>=this.d}},v2=class{get offset(){return this.c.offset}constructor(e,t=0){this.c=new m2(e,t)}nextGraphemeLength(){const e=YE.getInstance(),t=this.c,i=t.offset;let s=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const r=t.offset,n=e.getGraphemeBreakType(t.nextCodePoint());if(ZE(s,n)){t.setOffset(r);break}s=n}return t.offset-i}prevGraphemeLength(){const e=YE.getInstance(),t=this.c,i=t.offset;let s=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const r=t.offset,n=e.getGraphemeBreakType(t.prevCodePoint());if(ZE(n,s)){t.setOffset(r);break}s=n}return i-t.offset}eol(){return this.c.eol()}};function VE(e,t){return new v2(e,t).nextGraphemeLength()}var Bv=void 0;function w2(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function qE(e){return Bv||(Bv=w2()),Bv.test(e)}var b2=/^[\t\n\r\x20-\x7E]*$/;function y2(e){return b2.test(e)}var A2=/[\u2028\u2029]/;function GE(e){return A2.test(e)}var S2=/(?:\x1b\[|\x9b)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/,E2=/(?:\x1b\]|\x9d).*?(?:\x1b\\|\x07|\x9c)/,x2=/\x1b(?:[ #%\(\)\*\+\-\.\/]?[a-zA-Z0-9\|}~@])/,ste=new RegExp("(?:"+[S2.source,E2.source,x2.source].join("|")+")","g"),C2="\uFEFF";function k2(e){return!!(e&&e.length>0&&e.charCodeAt(0)===65279)}function $2(e,t){if(!e||!t||e.length<t.length)return!1;const i=t.length,s=e.toLowerCase();let r=0,n=-1;for(;r<i;){const o=s.indexOf(t[r],n+1);if(o<0)return!1;n=o,r++}return!0}function JE(e,t=!1){return e?(t&&(e=e.replace(/\\./g,"")),e.toLowerCase()!==e):!1}function I2(e){return e.charAt(0).toUpperCase()+e.slice(1)}function D2(e,t=1){if(t===0)return"";let i=-1;do i=e.indexOf(`
`,i+1),t--;while(t>0&&i>=0);return i===-1?e:(e[i-1]==="\r"&&i--,e.substr(0,i))}function ZE(e,t){return e===0?t!==5&&t!==7:e===2&&t===3?!1:e===4||e===2||e===3||t===4||t===2||t===3?!0:!(e===8&&(t===8||t===9||t===11||t===12)||(e===11||e===9)&&(t===9||t===10)||(e===12||e===10)&&t===10||t===5||t===13||t===7||e===1||e===13&&t===14||e===6&&t===6)}var QE;(function(e){e[e.Other=0]="Other",e[e.Prepend=1]="Prepend",e[e.CR=2]="CR",e[e.LF=3]="LF",e[e.Control=4]="Control",e[e.Extend=5]="Extend",e[e.Regional_Indicator=6]="Regional_Indicator",e[e.SpacingMark=7]="SpacingMark",e[e.L=8]="L",e[e.V=9]="V",e[e.T=10]="T",e[e.LV=11]="LV",e[e.LVT=12]="LVT",e[e.ZWJ=13]="ZWJ",e[e.Extended_Pictographic=14]="Extended_Pictographic"})(QE||(QE={}));var YE=class Ud{static{this.c=null}static getInstance(){return Ud.c||(Ud.c=new Ud),Ud.c}constructor(){this.d=P2()}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;const i=this.d,s=i.length/3;let r=1;for(;r<=s;)if(t<i[3*r])r=2*r;else if(t>i[3*r+1])r=2*r+1;else return i[3*r+2];return 0}};function P2(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var XE;(function(e){e[e.zwj=8205]="zwj",e[e.emojiVariantSelector=65039]="emojiVariantSelector",e[e.enclosingKeyCap=8419]="enclosingKeyCap",e[e.space=32]="space"})(XE||(XE={}));var rte=class jd{static{this.c=new Tt(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}'))}static{this.d=new c2(t=>{const i=t.split(",");function s(h){const f=new Map;for(let p=0;p<h.length;p+=2)f.set(h[p],h[p+1]);return f}function r(h,f){const p=new Map(h);for(const[g,v]of f)p.set(g,v);return p}function n(h,f){if(!h)return f;const p=new Map;for(const[g,v]of h)f.has(g)&&p.set(g,v);return p}const o=this.c.value;let a=i.filter(h=>!h.startsWith("_")&&Object.hasOwn(o,h));a.length===0&&(a=["_default"]);let c;for(const h of a){const f=s(o[h]);c=n(c,f)}const l=s(o._common),u=r(l,c);return new jd(u)})}static getInstance(t){return jd.d.get(Array.from(t).join(","))}static{this.e=new Tt(()=>Object.keys(jd.c.value).filter(t=>!t.startsWith("_")))}static getLocales(){return jd.e.value}constructor(t){this.f=t}isAmbiguous(t){return this.f.has(t)}containsAmbiguousCharacter(t){for(let i=0;i<t.length;i++){const s=t.codePointAt(i);if(typeof s=="number"&&this.isAmbiguous(s))return!0}return!1}getPrimaryConfusable(t){return this.f.get(t)}getConfusableCodePoints(){return new Set(this.f.keys())}},nte=class zd{static c(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static{this.d=void 0}static e(){return this.d||(this.d=new Set([...Object.values(zd.c())].flat())),this.d}static isInvisibleCharacter(t){return zd.e().has(t)}static containsInvisibleCharacter(t){for(let i=0;i<t.length;i++){const s=t.codePointAt(i);if(typeof s=="number"&&(zd.isInvisibleCharacter(s)||s===32))return!0}return!1}static get codePoints(){return zd.e()}};function zn(e){return e===47||e===92}function KE(e){return e.replace(/[\\/]/g,Be.sep)}function T2(e){return e.indexOf("/")===-1&&(e=KE(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function _v(e,t=Be.sep){if(!e)return"";const i=e.length,s=e.charCodeAt(0);if(zn(s)){if(zn(e.charCodeAt(1))&&!zn(e.charCodeAt(2))){let n=3;const o=n;for(;n<i&&!zn(e.charCodeAt(n));n++);if(o!==n&&!zn(e.charCodeAt(n+1))){for(n+=1;n<i;n++)if(zn(e.charCodeAt(n)))return e.slice(0,n+1).replace(/[\\/]/g,t)}}return t}else if(ex(s)&&e.charCodeAt(1)===58)return zn(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let r=e.indexOf("://");if(r!==-1){for(r+=3;r<i;r++)if(zn(e.charCodeAt(r)))return e.slice(0,r+1)}return""}var N2=/[\\/:\*\?"<>\|]/g,M2=/[/]/g,L2=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function R2(e,t=ze){const i=t?N2:M2;return!(!e||e.length===0||/^\s+$/.test(e)||(i.lastIndex=0,i.test(e))||t&&L2.test(e)||e==="."||e===".."||t&&e[e.length-1]==="."||t&&e.length!==e.trim().length||e.length>255)}function df(e,t,i){const s=e===t;return!i||s?s:!e||!t?!1:$s(e,t)}function Vo(e,t,i,s=St){if(e===t)return!0;if(!e||!t||t.length>e.length)return!1;if(i){if(!lf(e,t))return!1;if(t.length===e.length)return!0;let n=t.length;return t.charAt(t.length-1)===s&&n--,e.charAt(n)===s}return t.charAt(t.length-1)!==s&&(t+=s),e.indexOf(t)===0}function ex(e){return e>=65&&e<=90||e>=97&&e<=122}function O2(e){return ze?(e=jn(e,St),e.endsWith(":")&&(e+=St)):(e=jn(e,St),e||(e=St)),e}function tx(e){const t=Xr(e);return ze?e.length>3?!1:Vv(t)&&(e.length===2||t.charCodeAt(2)===92):t===Be.sep}function Vv(e,t=ze){return t?ex(e.charCodeAt(0))&&e.charCodeAt(1)===58:!1}function ix(e,t=ze){return Vv(e,t)?e[0]:void 0}var F2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",U2="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function j2(e,t,i=8){let s="";for(let n=0;n<i;n++){let o;n===0&&ze&&!t&&(i===3||i===4)?o=U2:o=F2,s+=o.charAt(Math.floor(Math.random()*o.length))}let r;return t?r=`${t}-${s}`:r=s,e?_e(e,r):r}var z2=/^\w[\w\d+.-]*$/,H2=/^\//,W2=/^\/\//;function B2(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!z2.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path){if(e.authority){if(!H2.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(W2.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function _2(e,t){return!e&&!t?"file":e}function V2(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==qs&&(t=qs+t):t=qs;break}return t}var Et="",qs="/",q2=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,y=class X1{static isUri(t){return t instanceof X1?!0:!t||typeof t!="object"?!1:typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function"}constructor(t,i,s,r,n,o=!1){typeof t=="object"?(this.scheme=t.scheme||Et,this.authority=t.authority||Et,this.path=t.path||Et,this.query=t.query||Et,this.fragment=t.fragment||Et):(this.scheme=_2(t,o),this.authority=i||Et,this.path=V2(this.scheme,s||Et),this.query=r||Et,this.fragment=n||Et,B2(this,o))}get fsPath(){return pf(this,!1)}with(t){if(!t)return this;let{scheme:i,authority:s,path:r,query:n,fragment:o}=t;return i===void 0?i=this.scheme:i===null&&(i=Et),s===void 0?s=this.authority:s===null&&(s=Et),r===void 0?r=this.path:r===null&&(r=Et),n===void 0?n=this.query:n===null&&(n=Et),o===void 0?o=this.fragment:o===null&&(o=Et),i===this.scheme&&s===this.authority&&r===this.path&&n===this.query&&o===this.fragment?this:new lc(i,s,r,n,o)}static parse(t,i=!1){const s=q2.exec(t);return s?new lc(s[2]||Et,gf(s[4]||Et),gf(s[5]||Et),gf(s[7]||Et),gf(s[9]||Et),i):new lc(Et,Et,Et,Et,Et)}static file(t){let i=Et;if(ze&&(t=t.replace(/\\/g,qs)),t[0]===qs&&t[1]===qs){const s=t.indexOf(qs,2);s===-1?(i=t.substring(2),t=qs):(i=t.substring(2,s),t=t.substring(s)||qs)}return new lc("file",i,t,Et,Et)}static from(t,i){return new lc(t.scheme,t.authority,t.path,t.query,t.fragment,i)}static joinPath(t,...i){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let s;return ze&&t.scheme==="file"?s=X1.file(Jt.join(pf(t,!0),...i)).path:s=Be.join(t.path,...i),t.with({path:s})}toString(t=!1){return qv(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof X1)return t;{const i=new lc(t);return i._formatted=t.external??null,i._fsPath=t._sep===sx?t.fsPath??null:null,i}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function ff(e){return!e||typeof e!="object"?!1:typeof e.scheme=="string"&&(typeof e.authority=="string"||typeof e.authority>"u")&&(typeof e.path=="string"||typeof e.path>"u")&&(typeof e.query=="string"||typeof e.query>"u")&&(typeof e.fragment=="string"||typeof e.fragment>"u")}var sx=ze?1:void 0,lc=class extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=pf(this,!1)),this._fsPath}toString(e=!1){return e?qv(this,!0):(this._formatted||(this._formatted=qv(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=sx),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},rx={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function nx(e,t,i){let s,r=-1;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||t&&o===47||i&&o===91||i&&o===93||i&&o===58)r!==-1&&(s+=encodeURIComponent(e.substring(r,n)),r=-1),s!==void 0&&(s+=e.charAt(n));else{s===void 0&&(s=e.substr(0,n));const a=rx[o];a!==void 0?(r!==-1&&(s+=encodeURIComponent(e.substring(r,n)),r=-1),s+=a):r===-1&&(r=n)}}return r!==-1&&(s+=encodeURIComponent(e.substring(r))),s!==void 0?s:e}function G2(e){let t;for(let i=0;i<e.length;i++){const s=e.charCodeAt(i);s===35||s===63?(t===void 0&&(t=e.substr(0,i)),t+=rx[s]):t!==void 0&&(t+=e[i])}return t!==void 0?t:e}function pf(e,t){let i;return e.authority&&e.path.length>1&&e.scheme==="file"?i=`//${e.authority}${e.path}`:e.path.charCodeAt(0)===47&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&e.path.charCodeAt(2)===58?t?i=e.path.substr(1):i=e.path[1].toLowerCase()+e.path.substr(2):i=e.path,ze&&(i=i.replace(/\//g,"\\")),i}function qv(e,t){const i=t?G2:nx;let s="",{scheme:r,authority:n,path:o,query:a,fragment:c}=e;if(r&&(s+=r,s+=":"),(n||r==="file")&&(s+=qs,s+=qs),n){let l=n.indexOf("@");if(l!==-1){const u=n.substr(0,l);n=n.substr(l+1),l=u.lastIndexOf(":"),l===-1?s+=i(u,!1,!1):(s+=i(u.substr(0,l),!1,!1),s+=":",s+=i(u.substr(l+1),!1,!0)),s+="@"}n=n.toLowerCase(),l=n.lastIndexOf(":"),l===-1?s+=i(n,!1,!0):(s+=i(n.substr(0,l),!1,!0),s+=n.substr(l))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const l=o.charCodeAt(1);l>=65&&l<=90&&(o=`/${String.fromCharCode(l+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const l=o.charCodeAt(0);l>=65&&l<=90&&(o=`${String.fromCharCode(l+32)}:${o.substr(2)}`)}s+=i(o,!0,!1)}return a&&(s+="?",s+=i(a,!1,!1)),c&&(s+="#",s+=t?c:nx(c,!1,!1)),s}function ox(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+ox(e.substr(3)):e}}var ax=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function gf(e){return e.match(ax)?e.replace(ax,t=>ox(t)):e}var V;(function(e){e.inMemory="inmemory",e.vscode="vscode",e.internal="private",e.walkThrough="walkThrough",e.walkThroughSnippet="walkThroughSnippet",e.http="http",e.https="https",e.file="file",e.mailto="mailto",e.untitled="untitled",e.data="data",e.command="command",e.vscodeRemote="vscode-remote",e.vscodeRemoteResource="vscode-remote-resource",e.vscodeManagedRemoteResource="vscode-managed-remote-resource",e.vscodeUserData="vscode-userdata",e.vscodeCustomEditor="vscode-custom-editor",e.vscodeNotebookCell="vscode-notebook-cell",e.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",e.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",e.vscodeNotebookCellOutput="vscode-notebook-cell-output",e.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",e.vscodeNotebookMetadata="vscode-notebook-metadata",e.vscodeInteractiveInput="vscode-interactive-input",e.vscodeSettings="vscode-settings",e.vscodeWorkspaceTrust="vscode-workspace-trust",e.vscodeTerminal="vscode-terminal",e.vscodeChatCodeBlock="vscode-chat-code-block",e.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",e.vscodeChatEditor="vscode-chat-editor",e.vscodeChatInput="chatSessionInput",e.vscodeLocalChatSession="vscode-chat-session",e.webviewPanel="webview-panel",e.vscodeWebview="vscode-webview",e.extension="extension",e.vscodeFileResource="vscode-file",e.tmp="tmp",e.vsls="vsls",e.vscodeSourceControl="vscode-scm",e.commentsInput="comment",e.codeSetting="code-setting",e.outputChannel="output",e.accessibleView="accessible-view",e.chatEditingSnapshotScheme="chat-editing-snapshot-text-model",e.chatEditingModel="chat-editing-text-model",e.copilotPr="copilot-pr"})(V||(V={}));function Gv(e,t){return y.isUri(e)?$s(e.scheme,t):lf(e,t+":")}function J2(e,...t){return t.some(i=>Gv(e,i))}var Z2="tkn",Q2=class{constructor(){this.a=Object.create(null),this.b=Object.create(null),this.c=Object.create(null),this.d="http",this.e=null,this.f="/"}setPreferredWebSchema(e){this.d=e}setDelegate(e){this.e=e}setServerRootPath(e,t){this.f=Be.join(t??"/",Y2(e))}getServerRootPath(){return this.f}get g(){return Be.join(this.f,V.vscodeRemoteResource)}set(e,t,i){this.a[e]=t,this.b[e]=i}setConnectionToken(e,t){this.c[e]=t}getPreferredWebSchema(){return this.d}rewrite(e){if(this.e)try{return this.e(e)}catch(o){return lt(o),e}const t=e.authority;let i=this.a[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const s=this.b[t],r=this.c[t];let n=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(n+=`&${Z2}=${encodeURIComponent(r)}`),y.from({scheme:Uo?this.d:V.vscodeRemoteResource,authority:`${i}:${s}`,path:this.g,query:n})}},cx=new Q2;function Y2(e){return`${e.quality??"oss"}-${e.commit??"dev"}`}var X2="vs/../../node_modules",K2="vs/../../node_modules.asar",lx="vscode-app",eO=class K1{static{this.a=lx}asBrowserUri(t){const i=this.b(t);return this.uriToBrowserUri(i)}uriToBrowserUri(t){return t.scheme===V.vscodeRemote?cx.rewrite(t):t.scheme===V.file&&($E||_R===`${V.vscodeFileResource}://${K1.a}`)?t.with({scheme:V.vscodeFileResource,authority:t.authority||K1.a,query:null,fragment:null}):t}asFileUri(t){const i=this.b(t);return this.uriToFileUri(i)}uriToFileUri(t){return t.scheme===V.vscodeFileResource?t.with({scheme:V.file,authority:t.authority!==K1.a?t.authority:null,query:null,fragment:null}):t}b(t){if(y.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return y.joinPath(y.parse(i,!0),t);const s=_e(i,t);return y.file(s)}throw new Error("Cannot determine URI for module id!")}},mf=new eO,ote=Object.freeze({"Cache-Control":"no-cache, no-store"}),ate=Object.freeze({"Document-Policy":"include-js-call-stacks-in-crash-reports"}),ux;(function(e){const t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);e.CoopAndCoep=Object.freeze(t.get("3"));const i="vscode-coi";function s(n){let o;typeof n=="string"?o=new URL(n).searchParams:n instanceof URL?o=n.searchParams:y.isUri(n)&&(o=new URL(n.toString(!0)).searchParams);const a=o?.get(i);if(a)return t.get(a)}e.getHeadersFromQuery=s;function r(n,o,a){if(!globalThis.crossOriginIsolated)return;const c=o&&a?"3":a?"2":"1";n instanceof URLSearchParams?n.set(i,c):n[i]=c}e.addSearchParam=r})(ux||(ux={}));function Gs(e){return pf(e,!0)}var uc=class{constructor(e){this.a=e}compare(e,t,i=!1){return e===t?0:_o(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this.a(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this.a(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===V.file)return Vo(Gs(e),Gs(t),this.a(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(fx(e.authority,t.authority))return Vo(e.path,t.path,this.a(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return Li(e)||e.authority}basename(e){return Be.basename(e.path)}extname(e){return Be.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===V.file?t=y.file($i(Gs(e))).path:(t=Be.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===V.file?t=y.file(Xr(Gs(e))).path:t=Be.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!fx(e.authority,t.authority))return;if(e.scheme===V.file){const r=ac(Gs(e),Gs(t));return ze?KE(r):r}let i=e.path||"/";const s=t.path||"/";if(this.a(e)){let r=0;for(const n=Math.min(i.length,s.length);r<n&&!(i.charCodeAt(r)!==s.charCodeAt(r)&&i.charAt(r).toLowerCase()!==s.charAt(r).toLowerCase());r++);i=s.substr(0,r)+i.substr(r)}return Be.relative(i,s)}resolvePath(e,t){if(e.scheme===V.file){const i=y.file(o2(Gs(e),t));return e.with({authority:i.authority,path:i.path})}return t=T2(t),e.with({path:Be.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&$s(e,t)}hasTrailingPathSeparator(e,t=St){if(e.scheme===V.file){const i=Gs(e);return i.length>_v(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=St){return px(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=St){let i=!1;if(e.scheme===V.file){const s=Gs(e);i=s!==void 0&&s.length===_v(s).length&&s[s.length-1]===t}else{t="/";const s=e.path;i=s.length===1&&s.charCodeAt(s.length-1)===47}return!i&&!px(e,t)?e.with({path:e.path+"/"}):e}},Ke=new uc(()=>!1),Jv=new uc(e=>e.scheme===V.file?!$t:!0),tO=new uc(e=>!0),hc=Ke.isEqual.bind(Ke),cte=Ke.isEqualOrParent.bind(Ke),lte=Ke.getComparisonKey.bind(Ke),Zv=Ke.basenameOrAuthority.bind(Ke),Li=Ke.basename.bind(Ke),hx=Ke.extname.bind(Ke),dc=Ke.dirname.bind(Ke),It=Ke.joinPath.bind(Ke),ute=Ke.normalizePath.bind(Ke),dx=Ke.relativePath.bind(Ke),hte=Ke.resolvePath.bind(Ke),iO=Ke.isAbsolutePath.bind(Ke),fx=Ke.isEqualAuthority.bind(Ke),px=Ke.hasTrailingPathSeparator.bind(Ke),dte=Ke.removeTrailingPathSeparator.bind(Ke),fte=Ke.addTrailingPathSeparator.bind(Ke),gx;(function(e){e.META_DATA_LABEL="label",e.META_DATA_DESCRIPTION="description",e.META_DATA_SIZE="size",e.META_DATA_MIME="mime";function t(i){const s=new Map;i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,c]=o.split(":");a&&c&&s.set(a,c)});const n=i.path.substring(0,i.path.indexOf(";"));return n&&s.set(e.META_DATA_MIME,n),s}e.parseMetaData=t})(gx||(gx={}));var sO=Symbol("MicrotaskDelay");function Hn(e){return!!e&&typeof e.then=="function"}function Kr(e){const t=new Qe,i=e(t.token);let s=!1;const r=new Promise((n,o)=>{const a=t.token.onCancellationRequested(()=>{s=!0,a.dispose(),o(new dt)});Promise.resolve(i).then(c=>{a.dispose(),t.dispose(),s?fE(c)&&c.dispose():n(c)},c=>{a.dispose(),t.dispose(),o(c)})});return new class{cancel(){t.cancel(),t.dispose()}then(n,o){return r.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return r.finally(n)}}}function rO(e,t,i){return new Promise((s,r)=>{const n=t.onCancellationRequested(()=>{n.dispose(),s(i)});e.then(s,r).finally(()=>n.dispose())})}function vf(e,t){return new Promise((i,s)=>{const r=t.onCancellationRequested(()=>{r.dispose(),s(new dt)});e.then(i,s).finally(()=>r.dispose())})}function fi(e){return new Promise((t,i)=>{const s=e();Hn(s)?s.then(t,i):t(s)})}function mx(){let e,t;return{promise:new Promise((s,r)=>{e=s,t=r}),resolve:e,reject:t}}var nO=class{constructor(){this.a=null,this.b=null,this.d=null,this.f=new Qe}queue(e){if(this.f.token.isCancellationRequested)return Promise.reject(new Error("Throttler is disposed"));if(this.a){if(this.d=e,!this.b){const t=()=>{if(this.b=null,this.f.token.isCancellationRequested)return;const i=this.queue(this.d);return this.d=null,i};this.b=new Promise(i=>{this.a.then(t,t).then(i)})}return new Promise((t,i)=>{this.b.then(t,i)})}return this.a=e(this.f.token),new Promise((t,i)=>{this.a.then(s=>{this.a=null,t(s)},s=>{this.a=null,i(s)})})}dispose(){this.f.cancel()}},oO=class{constructor(){this.a=Promise.resolve(null)}queue(e){return this.a=this.a.then(()=>e(),()=>e())}},vx=class{constructor(){this.a=new Map}queue(e,t){const s=(this.a.get(e)??Promise.resolve()).catch(()=>{}).then(t).finally(()=>{this.a.get(e)===s&&this.a.delete(e)});return this.a.set(e,s),s}peek(e){return this.a.get(e)||void 0}keys(){return this.a.keys()}},aO=(e,t)=>{let i=!0;const s=setTimeout(()=>{i=!1,t()},e);return{isTriggered:()=>i,dispose:()=>{clearTimeout(s),i=!1}}},cO=e=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,e())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},wx=class{constructor(e){this.defaultDelay=e,this.a=null,this.b=null,this.d=null,this.f=null,this.g=null}trigger(e,t=this.defaultDelay){this.g=e,this.h(),this.b||(this.b=new Promise((s,r)=>{this.d=s,this.f=r}).then(()=>{if(this.b=null,this.d=null,this.g){const s=this.g;return this.g=null,s()}}));const i=()=>{this.a=null,this.d?.(null)};return this.a=t===sO?cO(i):aO(t,i),this.b}isTriggered(){return!!this.a?.isTriggered()}cancel(){this.h(),this.b&&(this.f?.(new dt),this.b=null)}h(){this.a?.dispose(),this.a=null}dispose(){this.cancel()}},pu=class{constructor(e){this.a=new wx(e),this.b=new nO}trigger(e,t){return this.a.trigger(()=>this.b.queue(e),t)}isTriggered(){return this.a.isTriggered()}cancel(){this.a.cancel()}dispose(){this.a.dispose(),this.b.dispose()}},ps=class{constructor(){this.a=!1,this.b=new Promise((e,t)=>{this.d=e})}isOpen(){return this.a}open(){this.a=!0,this.d(!0)}wait(){return this.b}};function ri(e,t){return t?new Promise((i,s)=>{const r=setTimeout(()=>{n.dispose(),i()},e),n=t.onCancellationRequested(()=>{clearTimeout(r),n.dispose(),s(new dt)})}):Kr(i=>ri(e,i))}function Qv(e,t=0,i){const s=setTimeout(()=>{e(),i&&r.dispose()},t),r=te(()=>{clearTimeout(s),i?.delete(r)});return i?.add(r),r}function lO(e,t=s=>!!s,i=null){if(e.length===0)return Promise.resolve(i);let s=e.length;const r=()=>{s=-1;for(const n of e)n.cancel?.()};return new Promise((n,o)=>{for(const a of e)a.then(c=>{--s>=0&&t(c)?(r(),n(c)):s===0&&n(i)}).catch(c=>{--s>=0&&(r(),o(c))})})}var uO=class{constructor(e){this.a=0,this.b=!1,this.f=e,this.g=[],this.d=0,this.h=new I}whenIdle(){return this.size>0?Ie.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this.h.event}get size(){return this.a}queue(e){if(this.b)throw new Error("Object has been disposed");return this.a++,new Promise((t,i)=>{this.g.push({factory:e,c:t,e:i}),this.j()})}j(){for(;this.g.length&&this.d<this.f;){const e=this.g.shift();this.d++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.k(),()=>this.k())}}k(){this.b||(this.d--,--this.a===0&&this.h.fire(),this.g.length>0&&this.j())}clear(){if(this.b)throw new Error("Object has been disposed");this.g.length=0,this.a=this.d}dispose(){this.b=!0,this.g.length=0,this.a=0,this.h.dispose()}},hO=class extends uO{constructor(){super(1)}},bx=class{constructor(){this.a=new Map,this.b=new Set,this.d=void 0,this.f=0}async whenDrained(){if(this.g())return;const e=new Ri;return this.b.add(e),e.p}g(){for(const[,e]of this.a)if(e.size>0)return!1;return!0}queueSize(e,t=Ke){const i=t.getComparisonKey(e);return this.a.get(i)?.size??0}queueFor(e,t,i=Ke){const s=i.getComparisonKey(e);let r=this.a.get(s);if(!r){r=new hO;const n=this.f++,o=Ie.once(r.onDrained)(()=>{r?.dispose(),this.a.delete(s),this.h(),this.d?.deleteAndDispose(n),this.d?.size===0&&(this.d.dispose(),this.d=void 0)});this.d||(this.d=new Fo),this.d.set(n,o),this.a.set(s,r)}return r.queue(t)}h(){this.g()&&this.j()}j(){for(const e of this.b)e.complete();this.b.clear()}dispose(){for(const[,e]of this.a)e.dispose();this.a.clear(),this.j(),this.d?.dispose()}},yx=class{constructor(e,t){this.b=!1,this.a=void 0,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this.b=!0}cancel(){this.a!==void 0&&(clearTimeout(this.a),this.a=void 0)}cancelAndSet(e,t){if(this.b)throw new qt("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this.a=setTimeout(()=>{this.a=void 0,e()},t)}setIfNotSet(e,t){if(this.b)throw new qt("Calling 'setIfNotSet' on a disposed TimeoutTimer");this.a===void 0&&(this.a=setTimeout(()=>{this.a=void 0,e()},t))}},Ax=class{constructor(){this.g=void 0,this.j=!1}cancel(){this.g?.dispose(),this.g=void 0}cancelAndSet(e,t,i=globalThis){if(this.j)throw new qt("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const s=i.setInterval(()=>{e()},t);this.g=te(()=>{i.clearInterval(s),this.g=void 0})}dispose(){this.cancel(),this.j=!0}},br=class{constructor(e,t){this.b=void 0,this.a=e,this.d=t,this.f=this.g.bind(this)}dispose(){this.cancel(),this.a=null}cancel(){this.isScheduled()&&(clearTimeout(this.b),this.b=void 0)}schedule(e=this.d){this.cancel(),this.b=setTimeout(this.f,e)}get delay(){return this.d}set delay(e){this.d=e}isScheduled(){return this.b!==void 0}flush(){this.isScheduled()&&(this.cancel(),this.h())}g(){this.b=void 0,this.a&&this.h()}h(){this.a?.()}},Sx=class{constructor(e,t){t%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${t}ms is not a multiple of 1000ms.`),this.a=e,this.b=t,this.d=0,this.f=void 0,this.g=this.h.bind(this)}dispose(){this.cancel(),this.a=null}cancel(){this.isScheduled()&&(clearInterval(this.f),this.f=void 0)}schedule(e=this.b){e%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${e}ms is not a multiple of 1000ms.`),this.cancel(),this.d=Math.ceil(e/1e3),this.f=setInterval(this.g,1e3)}isScheduled(){return this.f!==void 0}h(){this.d--,!(this.d>0)&&(clearInterval(this.f),this.f=void 0,this.a?.())}},dO=class extends br{constructor(e,t){super(e,t),this.j=[]}work(e){this.j.push(e),this.isScheduled()||this.schedule()}h(){const e=this.j;this.j=[],this.a?.(e)}dispose(){this.j=[],super.dispose()}},Ex=class extends Z{constructor(e,t){super(),this.h=e,this.j=t,this.a=[],this.b=this.D(new Vs),this.f=!1,this.g=0}get pending(){return this.a.length}work(e){if(this.f)return!1;if(typeof this.h.maxBufferedWork=="number"){if(this.b.value){if(this.pending+e.length>this.h.maxBufferedWork)return!1}else if(this.pending+e.length-this.h.maxWorkChunkSize>this.h.maxBufferedWork)return!1}for(const i of e)this.a.push(i);const t=Date.now()-this.g;return!this.b.value&&(!this.h.waitThrottleDelayBetweenWorkUnits||t>=this.h.throttleDelay)?this.m():!this.b.value&&this.h.waitThrottleDelayBetweenWorkUnits&&this.q(Math.max(this.h.throttleDelay-t,0)),!0}m(){this.g=Date.now(),this.j(this.a.splice(0,this.h.maxWorkChunkSize)),this.a.length>0&&this.q()}q(e=this.h.throttleDelay){this.b.value=new br(()=>{this.b.clear(),this.m()},e),this.b.value.schedule()}dispose(){super.dispose(),this.a.length=0,this.f=!0}},xx,wf;(function(){const e=globalThis;typeof e.requestIdleCallback!="function"||typeof e.cancelIdleCallback!="function"?wf=(t,i,s)=>{DE(()=>{if(r)return;const n=Date.now()+15;i(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let r=!1;return{dispose(){r||(r=!0)}}}:wf=(t,i,s)=>{const r=t.requestIdleCallback(i,typeof s=="number"?{timeout:s}:void 0);let n=!1;return{dispose(){n||(n=!0,t.cancelIdleCallback(r))}}},xx=(t,i)=>wf(globalThis,t,i)})();var fO=class{constructor(e,t){this.l=!1,this.g=()=>{try{this.m=t()}catch(i){this.o=i}finally{this.l=!0}},this.j=wf(e,()=>this.g())}dispose(){this.j.dispose()}get value(){if(this.l||(this.j.dispose(),this.g()),this.o)throw this.o;return this.m}get isInitialized(){return this.l}},pO=class extends fO{constructor(e){super(globalThis,e)}};async function gO(e,t,i){let s;for(let r=0;r<i;r++)try{return await e()}catch(n){s=n,await ri(t)}throw s}var Cx;(function(e){e[e.Resolved=0]="Resolved",e[e.Rejected=1]="Rejected"})(Cx||(Cx={}));var Ri=class eM{static fromPromise(t){const i=new eM;return i.settleWith(t),i}get isRejected(){return this.d?.outcome===1}get isResolved(){return this.d?.outcome===0}get isSettled(){return!!this.d}get value(){return this.d?.outcome===0?this.d?.value:void 0}constructor(){this.p=new Promise((t,i)=>{this.a=t,this.b=i})}complete(t){return this.isSettled?Promise.resolve():new Promise(i=>{this.a(t),this.d={outcome:0,value:t},i()})}error(t){return this.isSettled?Promise.resolve():new Promise(i=>{this.b(t),this.d={outcome:1,value:t},i()})}settleWith(t){return t.then(i=>this.complete(i),i=>this.error(i))}cancel(){return this.error(new dt)}},Wn;(function(e){async function t(s){let r;const n=await Promise.all(s.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return n}e.settled=t;function i(s){return new Promise(async(r,n)=>{try{await s(r,n)}catch(o){n(o)}})}e.withAsyncBody=i})(Wn||(Wn={}));var kx;(function(e){e[e.Initial=0]="Initial",e[e.DoneOK=1]="DoneOK",e[e.DoneError=2]="DoneError"})(kx||(kx={}));var Yv=class ys{static fromArray(t){return new ys(i=>{i.emitMany(t)})}static fromPromise(t){return new ys(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new ys(async i=>{await Promise.all(t.map(async s=>i.emitOne(await s)))})}static merge(t){return new ys(async i=>{await Promise.all(t.map(async s=>{for await(const r of s)i.emitOne(r)}))})}static{this.EMPTY=ys.fromArray([])}constructor(t,i){this.a=0,this.b=[],this.d=null,this.f=i,this.g=new I,queueMicrotask(async()=>{const s={emitOne:r=>this.h(r),emitMany:r=>this.j(r),reject:r=>this.l(r)};try{await Promise.resolve(t(s)),this.k()}catch(r){this.l(r)}finally{s.emitOne=void 0,s.emitMany=void 0,s.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this.a===2)throw this.d;if(t<this.b.length)return{done:!1,value:this.b[t++]};if(this.a===1)return{done:!0,value:void 0};await Ie.toPromise(this.g.event)}while(!0)},return:async()=>(this.f?.(),{done:!0,value:void 0})}}static map(t,i){return new ys(async s=>{for await(const r of t)s.emitOne(i(r))})}map(t){return ys.map(this,t)}static filter(t,i){return new ys(async s=>{for await(const r of t)i(r)&&s.emitOne(r)})}filter(t){return ys.filter(this,t)}static coalesce(t){return ys.filter(t,i=>!!i)}coalesce(){return ys.coalesce(this)}static async toPromise(t){const i=[];for await(const s of t)i.push(s);return i}toPromise(){return ys.toPromise(this)}h(t){this.a===0&&(this.b.push(t),this.g.fire())}j(t){this.a===0&&(this.b=this.b.concat(t),this.g.fire())}k(){this.a===0&&(this.a=1,this.g.fire())}l(t){this.a===0&&(this.a=2,this.d=t,this.g.fire())}},mO=class{constructor(e){this.a=new Ri,this.b=new Yv(s=>{if(t){s.reject(t);return}return i&&s.emitMany(i),this.d=r=>s.reject(r),this.f=r=>s.emitOne(r),this.g=r=>s.emitMany(r),this.a.p},e);let t,i;this.d=s=>{t||(t=s)},this.f=s=>{i||(i=[]),i.push(s)},this.g=s=>{i?s.forEach(r=>i.push(r)):i=s.slice()}}get asyncIterable(){return this.b}resolve(){this.a.complete()}reject(e){this.d(e),this.a.complete()}emitOne(e){this.f(e)}emitMany(e){this.g(e)}},vO=class{constructor(){this.a=[],this.b=[]}get hasFinalValue(){return!!this.d}produce(e){if(this.f(),this.a.length>0){const t=this.a.shift();this.g(t,e)}else this.b.push(e)}produceFinal(e){this.f(),this.d=e;for(const t of this.a)this.g(t,e);this.a.length=0}f(){if(this.d)throw new qt("ProducerConsumer: cannot produce after final value has been set")}g(e,t){t.ok?e.complete(t.value):e.error(t.error)}consume(){if(this.b.length>0||this.d){const e=this.b.length>0?this.b.shift():this.d;return e.ok?Promise.resolve(e.value):Promise.reject(e.error)}else{const e=new Ri;return this.a.push(e),e.p}}},$x=class cs{constructor(t,i){this.b=i,this.a=new vO,this.g={next:()=>this.a.consume(),return:()=>(this.b?.(),Promise.resolve({done:!0,value:void 0})),throw:async s=>(this.f(s),{done:!0,value:void 0})},queueMicrotask(async()=>{const s=t({emitOne:r=>this.a.produce({ok:!0,value:{done:!1,value:r}}),emitMany:r=>{for(const n of r)this.a.produce({ok:!0,value:{done:!1,value:n}})},reject:r=>this.f(r)});if(!this.a.hasFinalValue)try{await s,this.d()}catch(r){this.f(r)}})}static fromArray(t){return new cs(i=>{i.emitMany(t)})}static fromPromise(t){return new cs(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new cs(async i=>{await Promise.all(t.map(async s=>i.emitOne(await s)))})}static merge(t){return new cs(async i=>{await Promise.all(t.map(async s=>{for await(const r of s)i.emitOne(r)}))})}static{this.EMPTY=cs.fromArray([])}static map(t,i){return new cs(async s=>{for await(const r of t)s.emitOne(i(r))})}static tee(t){let i,s;const r=new Ri,n=async()=>{if(!(!i||!s))try{for await(const c of t)i.emitOne(c),s.emitOne(c)}catch(c){i.reject(c),s.reject(c)}finally{r.complete()}},o=new cs(async c=>(i=c,n(),r.p)),a=new cs(async c=>(s=c,n(),r.p));return[o,a]}map(t){return cs.map(this,t)}static coalesce(t){return cs.filter(t,i=>!!i)}coalesce(){return cs.coalesce(this)}static filter(t,i){return new cs(async s=>{for await(const r of t)i(r)&&s.emitOne(r)})}filter(t){return cs.filter(this,t)}d(){this.a.hasFinalValue||this.a.produceFinal({ok:!0,value:{done:!0,value:void 0}})}f(t){this.a.hasFinalValue||this.a.produceFinal({ok:!1,error:t})}[Symbol.asyncIterator](){return this.g}},pte=Symbol("AsyncReaderEndOfStream");function bf(e,t){return new wO(e,t)}var wO=class{constructor(e,t){this.e=e,this.f=t,this.a={flowing:!1,ended:!1,destroyed:!1},this.b={data:[],error:[]},this.c={data:[],error:[],end:[]},this.d=[]}pause(){this.a.destroyed||(this.a.flowing=!1)}resume(){this.a.destroyed||this.a.flowing||(this.a.flowing=!0,this.j(),this.k(),this.l())}write(e){if(!this.a.destroyed){if(this.a.flowing)this.g(e);else if(this.b.data.push(e),typeof this.f?.highWaterMark=="number"&&this.b.data.length>this.f.highWaterMark)return new Promise(t=>this.d.push(t))}}error(e){this.a.destroyed||(this.a.flowing?this.h(e):this.b.error.push(e))}end(e){this.a.destroyed||(typeof e<"u"&&this.write(e),this.a.flowing?(this.i(),this.destroy()):this.a.ended=!0)}g(e){this.c.data.slice(0).forEach(t=>t(e))}h(e){this.c.error.length===0?lt(e):this.c.error.slice(0).forEach(t=>t(e))}i(){this.c.end.slice(0).forEach(e=>e())}on(e,t){if(!this.a.destroyed)switch(e){case"data":this.c.data.push(t),this.resume();break;case"end":this.c.end.push(t),this.a.flowing&&this.l()&&this.destroy();break;case"error":this.c.error.push(t),this.a.flowing&&this.k();break}}removeListener(e,t){if(this.a.destroyed)return;let i;switch(e){case"data":i=this.c.data;break;case"end":i=this.c.end;break;case"error":i=this.c.error;break}if(i){const s=i.indexOf(t);s>=0&&i.splice(s,1)}}j(){if(this.b.data.length===0)return;if(typeof this.e=="function"){const t=this.e(this.b.data);this.g(t)}else for(const t of this.b.data)this.g(t);this.b.data.length=0;const e=[...this.d];this.d.length=0,e.forEach(t=>t())}k(){if(this.c.error.length>0){for(const e of this.b.error)this.h(e);this.b.error.length=0}}l(){return this.a.ended?(this.i(),this.c.end.length>0):!1}destroy(){this.a.destroyed||(this.a.destroyed=!0,this.a.ended=!0,this.b.data.length=0,this.b.error.length=0,this.c.data.length=0,this.c.error.length=0,this.c.end.length=0,this.d.length=0)}};function bO(e,t){const i=[];let s;for(;(s=e.read())!==null;)i.push(s);return t(i)}function Ix(e,t){return new Promise((i,s)=>{const r=[];Xv(e,{onData:n=>{t&&r.push(n)},onError:n=>{t?s(n):i(void 0)},onEnd:()=>{i(t?t(r):void 0)}})})}function Xv(e,t,i){e.on("error",s=>{i?.isCancellationRequested||t.onError(s)}),e.on("end",()=>{i?.isCancellationRequested||t.onEnd()}),e.on("data",s=>{i?.isCancellationRequested||t.onData(s)})}function yO(e,t){const i=bf(t);return i.end(e),i}function AO(e,t,i){const s=bf(i);return Xv(e,{onData:r=>s.write(t.data(r)),onError:r=>s.error(t.error?t.error(r):r),onEnd:()=>s.end()}),s}var gu=typeof Buffer<"u",SO=new Tt(()=>new Uint8Array(256)),Kv,e0,W=class js{static alloc(t){return gu?new js(Buffer.allocUnsafe(t)):new js(new Uint8Array(t))}static wrap(t){return gu&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new js(t)}static fromString(t,i){return!(i?.dontUseNodeBuffer||!1)&&gu?new js(Buffer.from(t)):(Kv||(Kv=new TextEncoder),new js(Kv.encode(t)))}static fromByteArray(t){const i=js.alloc(t.length);for(let s=0,r=t.length;s<r;s++)i.buffer[s]=t[s];return i}static concat(t,i){if(typeof i>"u"){i=0;for(let n=0,o=t.length;n<o;n++)i+=t[n].byteLength}const s=js.alloc(i);let r=0;for(let n=0,o=t.length;n<o;n++){const a=t[n];s.set(a,r),r+=a.byteLength}return s}static isNativeBuffer(t){return gu&&Buffer.isBuffer(t)}constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){const t=js.alloc(this.byteLength);return t.set(this),t}toString(){return gu?this.buffer.toString():(e0||(e0=new TextDecoder(void 0,{ignoreBOM:!0})),e0.decode(this.buffer))}slice(t,i){return new js(this.buffer.subarray(t,i))}set(t,i){if(t instanceof js)this.buffer.set(t.buffer,i);else if(t instanceof Uint8Array)this.buffer.set(t,i);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),i);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return yf(this.buffer,t)}writeUInt32BE(t,i){Af(this.buffer,t,i)}readUInt32LE(t){return CO(this.buffer,t)}writeUInt32LE(t,i){kO(this.buffer,t,i)}readUInt8(t){return $O(this.buffer,t)}writeUInt8(t,i){IO(this.buffer,t,i)}indexOf(t,i=0){return Dx(this.buffer,t instanceof js?t.buffer:t,i)}equals(t){return this===t?!0:this.byteLength!==t.byteLength?!1:this.buffer.every((i,s)=>i===t.buffer[s])}};function Dx(e,t,i=0){const s=t.byteLength,r=e.byteLength;if(s===0)return 0;if(s===1)return e.indexOf(t[0]);if(s>r-i)return-1;const n=SO.value;n.fill(t.length);for(let l=0;l<t.length;l++)n[t[l]]=t.length-l-1;let o=i+t.length-1,a=o,c=-1;for(;o<r;)if(e[o]===t[a]){if(a===0){c=o;break}o--,a--}else o+=Math.max(t.length-a,n[e[o]]),a=t.length-1;return c}function EO(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function xO(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255}function yf(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function Af(e,t,i){e[i+3]=t,t=t>>>8,e[i+2]=t,t=t>>>8,e[i+1]=t,t=t>>>8,e[i]=t}function CO(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0|e[t+2]<<16>>>0|e[t+3]<<24>>>0}function kO(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255,t=t>>>8,e[i+2]=t&255,t=t>>>8,e[i+3]=t&255}function $O(e,t){return e[t]}function IO(e,t,i){e[i]=t}function DO(e){return bO(e,t=>W.concat(t))}function Px(e){return Ix(e,t=>W.concat(t))}function PO(e){return yO(e,t=>W.concat(t))}function TO(e){return AO(e,{data:t=>typeof t=="string"?W.fromString(t):W.wrap(t)},t=>W.concat(t))}function qo(e){let t=0,i=0,s=0;const r=new Uint8Array(Math.floor(e.length/4*3)),n=a=>{switch(i){case 3:r[s++]=t|a,i=0;break;case 2:r[s++]=t|a>>>2,t=a<<6,i=3;break;case 1:r[s++]=t|a>>>4,t=a<<4,i=2;break;default:t=a<<2,i=1}};for(let a=0;a<e.length;a++){const c=e.charCodeAt(a);if(c>=65&&c<=90)n(c-65);else if(c>=97&&c<=122)n(c-97+26);else if(c>=48&&c<=57)n(c-48+52);else if(c===43||c===45)n(62);else if(c===47||c===95)n(63);else{if(c===61)break;throw new SyntaxError(`Unexpected base64 character ${e[a]}`)}}const o=s;for(;i>0;)n(0);return W.wrap(r).slice(0,o)}var NO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",MO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function fc({buffer:e},t=!0,i=!1){const s=i?MO:NO;let r="";const n=e.byteLength%3;let o=0;for(;o<e.byteLength-n;o+=3){const a=e[o+0],c=e[o+1],l=e[o+2];r+=s[a>>>2],r+=s[(a<<4|c>>>4)&63],r+=s[(c<<2|l>>>6)&63],r+=s[l&63]}if(n===1){const a=e[o+0];r+=s[a>>>2],r+=s[a<<4&63],t&&(r+="==")}else if(n===2){const a=e[o+0],c=e[o+1];r+=s[a>>>2],r+=s[(a<<4|c>>>4)&63],r+=s[c<<2&63],t&&(r+="=")}return r}var Tx="0123456789abcdef";function t0({buffer:e}){let t="";for(let i=0;i<e.length;i++){const s=e[i];t+=Tx[s>>>4],t+=Tx[s&15]}return t}function LO(e){if(e.length%2!==0)throw new SyntaxError("Hex string must have an even length");const t=new Uint8Array(e.length>>1);for(let i=0;i<e.length;)t[i>>1]=Nx(e,i++)<<4|Nx(e,i++);return W.wrap(t)}function Nx(e,t){const i=e.charCodeAt(t);if(i>=48&&i<=57)return i-48;if(i>=97&&i<=102)return i-87;if(i>=65&&i<=70)return i-55;throw new SyntaxError(`Invalid hex character at position ${t}`)}function i0(e){const t=[];typeof e=="number"&&t.push("code/timeOrigin",e);function i(r,n){t.push(r,n?.startTime??Date.now())}function s(){const r=[];for(let n=0;n<t.length;n+=2)r.push({name:t[n],startTime:t[n+1]});return r}return{mark:i,getMarks:s}}function RO(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?i0():{mark(e,t){performance.mark(e,t)},getMarks(){let e=performance.timeOrigin;typeof e!="number"&&(e=(performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart)??0);const t=[{name:"code/timeOrigin",startTime:Math.round(e)}];for(const i of performance.getEntriesByType("mark"))t.push({name:i.name,startTime:Math.round(e+i.startTime)});return t}};if(typeof process=="object"){const e=performance?.timeOrigin;return i0(e)}else return console.trace("perf-util loaded in UNKNOWN environment"),i0()}function OO(e){return e.MonacoPerformanceMarks||(e.MonacoPerformanceMarks=RO()),e.MonacoPerformanceMarks}var Mx=OO(globalThis),Ut=Mx.mark,FO=Mx.getMarks,Sf={};zL(Sf,{Promises:()=>nt,RimRafMode:()=>Go,SymlinkSupport:()=>Oi,configureFlushOnWrite:()=>o0,realcase:()=>a0,realpathSync:()=>Wx,whenDeleted:()=>qO,writeFileSync:()=>QO});import*as He from"fs";import{tmpdir as UO}from"os";import{promisify as mu}from"util";var jO=new sc(1e4);function Ef(e){return Lx(e,"NFC",jO)}var zO=new sc(1e4);function s0(e){return Lx(e,"NFD",zO)}var HO=/[^\u0000-\u0080]/;function Lx(e,t,i){if(!e)return e;const s=i.get(e);if(s)return s;let r;return HO.test(e)?r=e.normalize(t):r=e,i.set(e,r),r}var vte=function(){const e=new sc(1e4),t=/[\u0300-\u036f]/g;return function(i){const s=e.get(i);if(s)return s;const r=s0(i).replace(t,""),n=(r.length===i.length?r:i).toLowerCase();return e.set(i,n),n}}(),Go;(function(e){e[e.UNLINK=0]="UNLINK",e[e.MOVE=1]="MOVE"})(Go||(Go={}));async function Rx(e,t=Go.UNLINK,i){if(tx(e))throw new Error("rimraf - will refuse to recursively delete root");return t===Go.UNLINK?r0(e):WO(e,i)}async function WO(e,t=j2(UO())){try{try{await He.promises.rename(e,t)}catch(i){return i.code==="ENOENT"?void 0:r0(e)}r0(t).catch(()=>{})}catch(i){if(i.code!=="ENOENT")throw i}}async function r0(e){return He.promises.rm(e,{recursive:!0,force:!0,maxRetries:3})}async function xf(e,t){try{return await Ox(e,t)}catch(i){if(i.code==="ENOENT"&&ze&&tx(e))try{return await Ox(`${e}.`,t)}catch{}throw i}}async function Ox(e,t){return _O(await(t?BO(e):He.promises.readdir(e)))}async function BO(e){try{return await He.promises.readdir(e,{withFileTypes:!0})}catch(s){console.warn("[node.js fs] readdir with filetypes failed with error: ",s)}const t=[],i=await xf(e);for(const s of i){let r=!1,n=!1,o=!1;try{const a=await He.promises.lstat(_e(e,s));r=a.isFile(),n=a.isDirectory(),o=a.isSymbolicLink()}catch(a){console.warn("[node.js fs] unexpected error from lstat after readdir: ",a)}t.push({name:s,isFile:()=>r,isDirectory:()=>n,isSymbolicLink:()=>o})}return t}function _O(e){return e.map(t=>typeof t=="string"?Pt?Ef(t):t:(t.name=Pt?Ef(t.name):t.name,t))}async function VO(e){const t=await xf(e),i=[];for(const s of t)await Oi.existsDirectory(_e(e,s))&&i.push(s);return i}function qO(e,t=1e3){return new Promise(i=>{let s=!1;const r=setInterval(()=>{s||(s=!0,He.access(e,n=>{s=!1,n&&(clearInterval(r),i(void 0))}))},t)})}var Oi;(function(e){async function t(r){let n;try{if(n=await He.promises.lstat(r),!n.isSymbolicLink())return{stat:n}}catch{}try{return{stat:await He.promises.stat(r),symbolicLink:n?.isSymbolicLink()?{dangling:!1}:void 0}}catch(o){if(o.code==="ENOENT"&&n)return{stat:n,symbolicLink:{dangling:!0}};if(ze&&o.code==="EACCES")try{return{stat:await He.promises.stat(await He.promises.readlink(r)),symbolicLink:{dangling:!1}}}catch(a){if(a.code==="ENOENT"&&n)return{stat:n,symbolicLink:{dangling:!0}};throw a}throw o}}e.stat=t;async function i(r){try{const{stat:n,symbolicLink:o}=await e.stat(r);return n.isFile()&&o?.dangling!==!0}catch{}return!1}e.existsFile=i;async function s(r){try{const{stat:n,symbolicLink:o}=await e.stat(r);return n.isDirectory()&&o?.dangling!==!0}catch{}return!1}e.existsDirectory=s})(Oi||(Oi={}));var GO=new bx;function JO(e,t,i){return GO.queueFor(y.file(e),()=>{const s=Fx(i);return new Promise((r,n)=>ZO(e,t,s,o=>o?n(o):r()))},Jv)}var n0=!0;function o0(e){n0=e}function ZO(e,t,i,s){if(!n0)return He.writeFile(e,t,{mode:i.mode,flag:i.flag},s);He.open(e,i.flag,i.mode,(r,n)=>{if(r)return s(r);He.writeFile(n,t,o=>{if(o)return He.close(n,()=>s(o));He.fdatasync(n,a=>(a&&(console.warn("[node.js fs] fdatasync is now disabled for this session because it failed: ",a),o0(!1)),He.close(n,c=>s(c))))})})}function QO(e,t,i){const s=Fx(i);if(!n0)return He.writeFileSync(e,t,{mode:s.mode,flag:s.flag});const r=He.openSync(e,s.flag,s.mode);try{He.writeFileSync(r,t);try{He.fdatasyncSync(r)}catch(n){console.warn("[node.js fs] fdatasyncSync is now disabled for this session because it failed: ",n),o0(!1)}}finally{He.closeSync(r)}}function Fx(e){return e?{mode:typeof e.mode=="number"?e.mode:438,flag:typeof e.flag=="string"?e.flag:"w"}:{mode:438,flag:"w"}}async function YO(e,t,i=6e4){if(e!==t)try{ze&&typeof i=="number"?await Ux(e,t,Date.now(),i):await He.promises.rename(e,t)}catch(s){if(e.toLowerCase()!==t.toLowerCase()&&s.code==="EXDEV"||e.endsWith("."))await jx(e,t,{preserveSymlinks:!1}),await Rx(e,Go.MOVE);else throw s}}async function Ux(e,t,i,s,r=0){try{return await He.promises.rename(e,t)}catch(n){if(n.code!=="EACCES"&&n.code!=="EPERM"&&n.code!=="EBUSY")throw n;if(Date.now()-i>=s)throw console.error(`[node.js fs] rename failed after ${r} retries with error: ${n}`),n;if(r===0){let o=!1;try{const{stat:a}=await Oi.stat(t);a.isFile()||(o=!0)}catch{}if(o)throw n}return await ri(Math.min(100,r*10)),Ux(e,t,i,s,r+1)}}async function jx(e,t,i){return Hx(e,t,{root:{source:e,target:t},options:i,handledSourcePaths:new Set})}var zx=511;async function Hx(e,t,i){if(i.handledSourcePaths.has(e))return;i.handledSourcePaths.add(e);const{stat:s,symbolicLink:r}=await Oi.stat(e);if(r){if(i.options.preserveSymlinks)try{return await eF(e,t,i)}catch{}if(r.dangling)return}return s.isDirectory()?XO(e,t,s.mode&zx,i):KO(e,t,s.mode&zx)}async function XO(e,t,i,s){await He.promises.mkdir(t,{recursive:!0,mode:i});const r=await xf(e);for(const n of r)await Hx(_e(e,n),_e(t,n),s)}async function KO(e,t,i){await He.promises.copyFile(e,t),await He.promises.chmod(t,i)}async function eF(e,t,i){let s=await He.promises.readlink(e);Vo(s,i.root.source,!$t)&&(s=_e(i.root.target,s.substr(i.root.source.length+1))),await He.promises.symlink(s,t)}async function a0(e,t){if($t)return e;const i=$i(e);if(e===i)return e;const s=(vt(e)||e).toLowerCase();try{if(t?.isCancellationRequested)return null;const n=(await nt.readdir(i)).filter(o=>o.toLowerCase()===s);if(n.length===1){const o=await a0(i,t);if(o)return _e(o,n[0])}else if(n.length>1){const o=n.indexOf(s);if(o>=0){const a=await a0(i,t);if(a)return _e(a,n[o])}}}catch{}return null}async function tF(e){try{return await mu(He.realpath)(e)}catch{const t=Bx(e);return await He.promises.access(t,He.constants.R_OK),t}}function Wx(e){try{return He.realpathSync(e)}catch{const t=Bx(e);return He.accessSync(t,He.constants.R_OK),t}}function Bx(e){return jn(Xr(e),St)}var nt=new class{get read(){return(e,t,i,s,r)=>new Promise((n,o)=>{He.read(e,t,i,s,r,(a,c,l)=>a?o(a):n({bytesRead:c,buffer:l}))})}get write(){return(e,t,i,s,r)=>new Promise((n,o)=>{He.write(e,t,i,s,r,(a,c,l)=>a?o(a):n({bytesWritten:c,buffer:l}))})}get fdatasync(){return mu(He.fdatasync)}get open(){return mu(He.open)}get close(){return mu(He.close)}get ftruncate(){return mu(He.ftruncate)}async exists(e){try{return await He.promises.access(e),!0}catch{return!1}}get readdir(){return xf}get readDirsInDir(){return VO}get writeFile(){return JO}get rm(){return Rx}get rename(){return YO}get copy(){return jx}get realpath(){return tF}};function _x(e){return(t,i,s)=>{let r=null,n=null;if(typeof s.value=="function"?(r="value",n=s.value):typeof s.get=="function"&&(r="get",n=s.get),!n||typeof i=="symbol")throw new Error("not supported");s[r]=e(n,i)}}function Vx(e,t,i){let s=null,r=null;if(typeof i.value=="function"?(s="value",r=i.value,r.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof i.get=="function"&&(s="get",r=i.get),!r)throw new Error("not supported");const n=`$memoize$${t}`;i[s]=function(...o){return this.hasOwnProperty(n)||Object.defineProperty(this,n,{configurable:!1,enumerable:!1,writable:!1,value:r.apply(this,o)}),this[n]}}function Cf(e,t,i){return _x((s,r)=>{const n=`$debounce$${r}`,o=`$debounce$result$${r}`;return function(...a){this[o]||(this[o]=i?i():void 0),clearTimeout(this[n]),t&&(this[o]=t(this[o],...a),a=[this[o]]),this[n]=setTimeout(()=>{s.apply(this,a),this[o]=i?i():void 0},e)}})}function iF(e,t,i){return _x((s,r)=>{const n=`$throttle$timer$${r}`,o=`$throttle$result$${r}`,a=`$throttle$lastRun$${r}`,c=`$throttle$pending$${r}`;return function(...l){if(this[o]||(this[o]=i?i():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),t&&(this[o]=t(this[o],...l)),this[c])return;const u=this[a]+e;u<=Date.now()?(this[a]=Date.now(),s.apply(this,[this[o]]),this[o]=i?i():void 0):(this[c]=!0,this[n]=setTimeout(()=>{this[c]=!1,this[a]=Date.now(),s.apply(this,[this[o]]),this[o]=i?i():void 0},u-Date.now()))}})}function sF(e){return JSON.stringify(e,rF)}function qx(e){let t=JSON.parse(e);return t=Zt(t),t}function rF(e,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:t.flags}:t}function Zt(e,t=0){if(!e||t>200)return e;if(typeof e=="object"){switch(e.$mid){case 1:return y.revive(e);case 2:return new RegExp(e.source,e.flags);case 17:return new Date(e.source)}if(e instanceof W||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let i=0;i<e.length;++i)e[i]=Zt(e[i],t+1);else for(const i in e)Object.hasOwnProperty.call(e,i)&&(e[i]=Zt(e[i],t+1))}return e}var Gx;(function(e){e[e.Promise=100]="Promise",e[e.PromiseCancel=101]="PromiseCancel",e[e.EventListen=102]="EventListen",e[e.EventDispose=103]="EventDispose"})(Gx||(Gx={}));function Jx(e){switch(e){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}var Zx;(function(e){e[e.Initialize=200]="Initialize",e[e.PromiseSuccess=201]="PromiseSuccess",e[e.PromiseError=202]="PromiseError",e[e.PromiseErrorObj=203]="PromiseErrorObj",e[e.EventFire=204]="EventFire"})(Zx||(Zx={}));function Qx(e){switch(e){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}var Jo;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Idle=1]="Idle"})(Jo||(Jo={}));function pc(e){let t=0;for(let i=0;;i+=7){const s=e.read(1);if(t|=(s.buffer[0]&127)<<i,!(s.buffer[0]&128))return t}}var nF=Bn(0);function gc(e,t){if(t===0){e.write(nF);return}let i=0;for(let r=t;r!==0;r=r>>>7)i++;const s=W.alloc(i);for(let r=0;t!==0;r++)s.buffer[r]=t&127,t=t>>>7,t>0&&(s.buffer[r]|=128);e.write(s)}var oF=class{constructor(e){this.b=e,this.a=0}read(e){const t=this.b.slice(this.a,this.a+e);return this.a+=t.byteLength,t}},aF=class{constructor(){this.a=[]}get buffer(){return W.concat(this.a)}write(e){this.a.push(e)}},Ii;(function(e){e[e.Undefined=0]="Undefined",e[e.String=1]="String",e[e.Buffer=2]="Buffer",e[e.VSBuffer=3]="VSBuffer",e[e.Array=4]="Array",e[e.Object=5]="Object",e[e.Int=6]="Int"})(Ii||(Ii={}));function Bn(e){const t=W.alloc(1);return t.writeUInt8(e,0),t}var Zo={Undefined:Bn(Ii.Undefined),String:Bn(Ii.String),Buffer:Bn(Ii.Buffer),VSBuffer:Bn(Ii.VSBuffer),Array:Bn(Ii.Array),Object:Bn(Ii.Object),Uint:Bn(Ii.Int)};function c0(e,t){if(typeof t>"u")e.write(Zo.Undefined);else if(typeof t=="string"){const i=W.fromString(t);e.write(Zo.String),gc(e,i.byteLength),e.write(i)}else if(W.isNativeBuffer(t)){const i=W.wrap(t);e.write(Zo.Buffer),gc(e,i.byteLength),e.write(i)}else if(t instanceof W)e.write(Zo.VSBuffer),gc(e,t.byteLength),e.write(t);else if(Array.isArray(t)){e.write(Zo.Array),gc(e,t.length);for(const i of t)c0(e,i)}else if(typeof t=="number"&&(t|0)===t)e.write(Zo.Uint),gc(e,t);else{const i=W.fromString(JSON.stringify(t));e.write(Zo.Object),gc(e,i.byteLength),e.write(i)}}function l0(e){switch(e.read(1).readUInt8(0)){case Ii.Undefined:return;case Ii.String:return e.read(pc(e)).toString();case Ii.Buffer:return e.read(pc(e)).buffer;case Ii.VSBuffer:return e.read(pc(e));case Ii.Array:{const i=pc(e),s=[];for(let r=0;r<i;r++)s.push(l0(e));return s}case Ii.Object:return JSON.parse(e.read(pc(e)).toString());case Ii.Int:return pc(e)}}var Yx;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(Yx||(Yx={}));var Xx=class{constructor(e,t=null){this.l=e,this.a=!1,this.b=Jo.Uninitialized,this.d=new Set,this.f=new Map,this.g=0,this.k=new I,this.onDidInitialize=this.k.event,this.h=this.l.onMessage(i=>this.s(i)),this.j=t}getChannel(e){const t=this;return{call(i,s,r){return t.a?Promise.reject(new dt):t.m(e,i,s,r)},listen(i,s){return t.a?Ie.None:t.o(e,i,s)}}}m(e,t,i,s=Fe.None){const r=this.g++,o={id:r,type:100,channelName:e,name:t,arg:i};if(s.isCancellationRequested)return Promise.reject(new dt);let a,c;return new Promise((u,h)=>{if(s.isCancellationRequested)return h(new dt);const f=()=>{const v=b=>{switch(b.type){case 201:this.f.delete(r),u(b.data);break;case 202:{this.f.delete(r);const S=new Error(b.data.message);S.stack=Array.isArray(b.data.stack)?b.data.stack.join(`
`):b.data.stack,S.name=b.data.name,h(S);break}case 203:this.f.delete(r),h(b.data);break}};this.f.set(r,v),this.p(o)};let p=null;this.b===Jo.Idle?f():(p=Kr(v=>this.u()),p.then(()=>{p=null,f()}));const g=()=>{p?(p.cancel(),p=null):this.p({id:r,type:101}),h(new dt)};a=s.onCancellationRequested(g),c={dispose:Ev(()=>{g(),a.dispose()})},this.d.add(c)}).finally(()=>{a?.dispose(),this.d.delete(c)})}o(e,t,i){const s=this.g++,n={id:s,type:102,channelName:e,name:t,arg:i};let o=null;const a=new I({onWillAddFirstListener:()=>{const l=()=>{this.d.add(a),this.p(n)};this.b===Jo.Idle?l():(o=Kr(u=>this.u()),o.then(()=>{o=null,l()}))},onDidRemoveLastListener:()=>{o?(o.cancel(),o=null):(this.d.delete(a),this.p({id:s,type:103})),this.f.delete(s)}}),c=l=>a.fire(l.data);return this.f.set(s,c),a.event}p(e){switch(e.type){case 100:case 102:{const t=this.q([e.type,e.id,e.channelName,e.name],e.arg);this.j?.logOutgoing(t,e.id,0,`${Jx(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{const t=this.q([e.type,e.id]);this.j?.logOutgoing(t,e.id,0,Jx(e.type));return}}}q(e,t=void 0){const i=new aF;return c0(i,e),c0(i,t),this.r(i.buffer)}r(e){try{return this.l.send(e),e.byteLength}catch{return 0}}s(e){const t=new oF(e),i=l0(t),s=l0(t),r=i[0];switch(r){case 200:return this.j?.logIncoming(e.byteLength,0,0,Qx(r)),this.t({type:i[0]});case 201:case 202:case 204:case 203:return this.j?.logIncoming(e.byteLength,i[1],0,Qx(r),s),this.t({type:i[0],id:i[1],data:s})}}t(e){if(e.type===200){this.b=Jo.Idle,this.k.fire();return}this.f.get(e.id)?.(e)}get onDidInitializePromise(){return Ie.toPromise(this.onDidInitialize)}u(){return this.b===Jo.Idle?Promise.resolve():this.onDidInitializePromise}dispose(){this.a=!0,this.h&&(this.h.dispose(),this.h=null),Zi(this.d.values()),this.d.clear()}};__decorate([Vx],Xx.prototype,"onDidInitializePromise",null);function cF(e){let t=!1;return{call(i,s,r){return t?e.call(i,s,r):ri(0).then(()=>t=!0).then(()=>e.call(i,s,r))},listen(i,s){if(t)return e.listen(i,s);const r=new RR;return ri(0).then(()=>t=!0).then(()=>r.input=e.listen(i,s)),r.event}}}var u0;(function(e){function t(n,o,a){const c=n,l=a?.disableMarshalling,u=new Map;for(const h in c)s(h)&&u.set(h,Ie.buffer(c[h],!0,void 0,o));return new class{listen(h,f,p){const g=u.get(f);if(g)return g;const v=c[f];if(typeof v=="function"){if(r(f))return v.call(c,p);if(s(f))return u.set(f,Ie.buffer(c[f],!0,void 0,o)),u.get(f)}throw new _s(`Event not found: ${f}`)}call(h,f,p){const g=c[f];if(typeof g=="function"){if(!l&&Array.isArray(p))for(let b=0;b<p.length;b++)p[b]=Zt(p[b]);let v=g.apply(c,p);return v instanceof Promise||(v=Promise.resolve(v)),v}throw new _s(`Method not found: ${f}`)}}}e.fromService=t;function i(n,o){const a=o?.disableMarshalling;return new Proxy({},{get(c,l){if(typeof l=="string")return o?.properties?.has(l)?o.properties.get(l):r(l)?function(u){return n.listen(l,u)}:s(l)?n.listen(l):async function(...u){let h;o&&!Wt(o.context)?h=[o.context,...u]:h=u;const f=await n.call(l,h);return a?f:Zt(f)};throw new _s(`Property not found: ${String(l)}`)}})}e.toService=i;function s(n){return n[0]==="o"&&n[1]==="n"&&BE(n.charCodeAt(2))}function r(n){return/^onDynamic/.test(n)&&BE(n.charCodeAt(9))}})(u0||(u0={}));var Kx;(function(e){e.Created="created",e.Read="read",e.Write="write",e.Open="open",e.Error="error",e.Close="close",e.BrowserWebSocketBlobReceived="browserWebSocketBlobReceived",e.NodeEndReceived="nodeEndReceived",e.NodeEndSent="nodeEndSent",e.NodeDrainBegin="nodeDrainBegin",e.NodeDrainEnd="nodeDrainEnd",e.zlibInflateError="zlibInflateError",e.zlibInflateData="zlibInflateData",e.zlibInflateInitialWrite="zlibInflateInitialWrite",e.zlibInflateInitialFlushFired="zlibInflateInitialFlushFired",e.zlibInflateWrite="zlibInflateWrite",e.zlibInflateFlushFired="zlibInflateFlushFired",e.zlibDeflateError="zlibDeflateError",e.zlibDeflateData="zlibDeflateData",e.zlibDeflateWrite="zlibDeflateWrite",e.zlibDeflateFlushFired="zlibDeflateFlushFired",e.WebSocketNodeSocketWrite="webSocketNodeSocketWrite",e.WebSocketNodeSocketPeekedHeader="webSocketNodeSocketPeekedHeader",e.WebSocketNodeSocketReadHeader="webSocketNodeSocketReadHeader",e.WebSocketNodeSocketReadData="webSocketNodeSocketReadData",e.WebSocketNodeSocketUnmaskedData="webSocketNodeSocketUnmaskedData",e.WebSocketNodeSocketDrainBegin="webSocketNodeSocketDrainBegin",e.WebSocketNodeSocketDrainEnd="webSocketNodeSocketDrainEnd",e.ProtocolHeaderRead="protocolHeaderRead",e.ProtocolMessageRead="protocolMessageRead",e.ProtocolHeaderWrite="protocolHeaderWrite",e.ProtocolMessageWrite="protocolMessageWrite",e.ProtocolWrite="protocolWrite"})(Kx||(Kx={}));var kf;(function(e){e.enableDiagnostics=!1,e.records=[];const t=new WeakMap;let i=0;function s(n,o){if(!t.has(n)){const a=String(++i);t.set(n,a)}return t.get(n)}function r(n,o,a,c){if(!e.enableDiagnostics)return;const l=s(n,o);if(c instanceof W||c instanceof Uint8Array||c instanceof ArrayBuffer||ArrayBuffer.isView(c)){const u=W.alloc(c.byteLength);u.set(c),e.records.push({timestamp:Date.now(),id:l,label:o,type:a,buff:u})}else e.records.push({timestamp:Date.now(),id:l,label:o,type:a,data:c})}e.traceSocketEvent=r})(kf||(kf={}));var eC;(function(e){e[e.NodeSocketCloseEvent=0]="NodeSocketCloseEvent",e[e.WebSocketCloseEvent=1]="WebSocketCloseEvent"})(eC||(eC={}));var h0=null;function _n(){return h0||(h0=W.alloc(0)),h0}var tC=class{get byteLength(){return this.b}constructor(){this.a=[],this.b=0}acceptChunk(e){this.a.push(e),this.b+=e.byteLength}read(e){return this.c(e,!0)}peek(e){return this.c(e,!1)}c(e,t){if(e===0)return _n();if(e>this.b)throw new Error("Cannot read so many bytes!");if(this.a[0].byteLength===e){const n=this.a[0];return t&&(this.a.shift(),this.b-=e),n}if(this.a[0].byteLength>e){const n=this.a[0].slice(0,e);return t&&(this.a[0]=this.a[0].slice(e),this.b-=e),n}const i=W.alloc(e);let s=0,r=0;for(;e>0;){const n=this.a[r];if(n.byteLength>e){const o=n.slice(0,e);i.set(o,s),s+=e,t&&(this.a[r]=n.slice(e),this.b-=e),e-=e}else i.set(n,s),s+=n.byteLength,t?(this.a.shift(),this.b-=n.byteLength):r++,e-=n.byteLength}return i}},iC;(function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.Control=2]="Control",e[e.Ack=3]="Ack",e[e.Disconnect=5]="Disconnect",e[e.ReplayRequest=6]="ReplayRequest",e[e.Pause=7]="Pause",e[e.Resume=8]="Resume",e[e.KeepAlive=9]="KeepAlive"})(iC||(iC={}));function sC(e){switch(e){case 0:return"None";case 1:return"Regular";case 2:return"Control";case 3:return"Ack";case 5:return"Disconnect";case 6:return"ReplayRequest";case 7:return"PauseWriting";case 8:return"ResumeWriting";case 9:return"KeepAlive"}}var rC;(function(e){e[e.HeaderLength=13]="HeaderLength",e[e.AcknowledgeTime=2e3]="AcknowledgeTime",e[e.TimeoutTime=2e4]="TimeoutTime",e[e.ReconnectionGraceTime=108e5]="ReconnectionGraceTime",e[e.ReconnectionShortGraceTime=3e5]="ReconnectionShortGraceTime",e[e.KeepAliveSendTime=5e3]="KeepAliveSendTime"})(rC||(rC={}));var yr=class{constructor(e,t,i,s){this.type=e,this.id=t,this.ack=i,this.data=s,this.writtenTime=0}get size(){return this.data.byteLength}},nC=class extends Z{constructor(e){super(),this.f=this.D(new I),this.onMessage=this.f.event,this.g={readHead:!0,readLen:13,messageType:0,id:0,ack:0},this.a=e,this.b=!1,this.c=new tC,this.D(this.a.onData(t=>this.acceptChunk(t))),this.lastReadTime=Date.now()}acceptChunk(e){if(!(!e||e.byteLength===0))for(this.lastReadTime=Date.now(),this.c.acceptChunk(e);this.c.byteLength>=this.g.readLen;){const t=this.c.read(this.g.readLen);if(this.g.readHead)this.g.readHead=!1,this.g.readLen=t.readUInt32BE(9),this.g.messageType=t.readUInt8(0),this.g.id=t.readUInt32BE(1),this.g.ack=t.readUInt32BE(5),this.a.traceSocketEvent("protocolHeaderRead",{messageType:sC(this.g.messageType),id:this.g.id,ack:this.g.ack,messageSize:this.g.readLen});else{const i=this.g.messageType,s=this.g.id,r=this.g.ack;if(this.g.readHead=!0,this.g.readLen=13,this.g.messageType=0,this.g.id=0,this.g.ack=0,this.a.traceSocketEvent("protocolMessageRead",t),this.f.fire(new yr(i,s,r,t)),this.b)break}}}readEntireBuffer(){return this.c.read(this.c.byteLength)}dispose(){this.b=!0,super.dispose()}},oC=class{constructor(e){this.k=null,this.a=!1,this.b=!1,this.c=e,this.d=[],this.f=0,this.lastWriteTime=0}dispose(){try{this.flush()}catch{}this.a=!0}drain(){return this.flush(),this.c.drain()}flush(){this.m()}pause(){this.b=!0}resume(){this.b=!1,this.l()}write(e){if(this.a)return;e.writtenTime=Date.now(),this.lastWriteTime=Date.now();const t=W.alloc(13);t.writeUInt8(e.type,0),t.writeUInt32BE(e.id,1),t.writeUInt32BE(e.ack,5),t.writeUInt32BE(e.data.byteLength,9),this.c.traceSocketEvent("protocolHeaderWrite",{messageType:sC(e.type),id:e.id,ack:e.ack,messageSize:e.data.byteLength}),this.c.traceSocketEvent("protocolMessageWrite",e.data),this.j(t,e.data)}g(e,t){const i=this.f===0;return this.d.push(e,t),this.f+=e.byteLength+t.byteLength,i}h(){const e=W.concat(this.d,this.f);return this.d.length=0,this.f=0,e}j(e,t){this.g(e,t)&&this.l()}l(){this.k||(this.k=setTimeout(()=>{this.k=null,this.m()}))}m(){if(this.f===0||this.b)return;const e=this.h();this.c.traceSocketEvent("protocolWrite",{byteLength:e.byteLength}),this.c.write(e)}},Qo=class{constructor(){this.b=!1,this.c=!1,this.d=[],this.a=new I({onWillAddFirstListener:()=>{this.b=!0,queueMicrotask(()=>this.f())},onDidRemoveLastListener:()=>{this.b=!1}}),this.event=this.a.event}f(){if(!this.c){for(this.c=!0;this.b&&this.d.length>0;)this.a.fire(this.d.shift());this.c=!1}}fire(e){this.b?this.d.length>0?this.d.push(e):this.a.fire(e):this.d.push(e)}flushBuffer(){this.d=[]}},lF=class{constructor(e){this.data=e,this.next=null}},uF=class{constructor(){this.a=null,this.b=null}length(){let e=0,t=this.a;for(;t;)t=t.next,e++;return e}peek(){return this.a?this.a.data:null}toArray(){const e=[];let t=0,i=this.a;for(;i;)e[t++]=i.data,i=i.next;return e}pop(){if(this.a){if(this.a===this.b){this.a=null,this.b=null;return}this.a=this.a.next}}push(e){const t=new lF(e);if(!this.a){this.a=t,this.b=t;return}this.b.next=t,this.b=t}},hF=class Br{static{this.a=10}static{this.b=null}static getInstance(){return Br.b||(Br.b=new Br),Br.b}constructor(){this.c=[];const t=Date.now();for(let i=0;i<Br.a;i++)this.c[i]=t-1e3*i;setInterval(()=>{for(let i=Br.a;i>=1;i--)this.c[i]=this.c[i-1];this.c[0]=Date.now()},1e3)}d(){const t=Date.now(),i=(1+Br.a)*1e3;let s=0;for(let r=0;r<Br.a;r++)t-this.c[r]<=i&&s++;return 1-s/Br.a}hasHighLoad(){return this.d()>=.5}},d0=class{get unacknowledgedCount(){return this.d-this.f}constructor(e){this.v=new Qo,this.onControlMessage=this.v.event,this.w=new Qo,this.onMessage=this.w.event,this.x=new Qo,this.onDidDispose=this.x.event,this.y=new Qo,this.onSocketClose=this.y.event,this.z=new Qo,this.onSocketTimeout=this.z.event,this.t=e.loadEstimator??hF.getInstance(),this.u=e.sendKeepAlive??!0,this.a=!1,this.c=new uF,this.d=0,this.f=0,this.g=null,this.h=0,this.j=0,this.k=0,this.l=null,this.n=0,this.o=Date.now(),this.s=new ie,this.p=e.socket,this.q=this.s.add(new oC(this.p)),this.r=this.s.add(new nC(this.p)),this.s.add(this.r.onMessage(t=>this.A(t))),this.s.add(this.p.onClose(t=>this.y.fire(t))),e.initialChunk&&this.r.acceptChunk(e.initialChunk),this.u?this.m=setInterval(()=>{this.E()},5e3):this.m=null}dispose(){this.g&&(clearTimeout(this.g),this.g=null),this.l&&(clearTimeout(this.l),this.l=null),this.m&&(clearInterval(this.m),this.m=null),this.s.dispose()}drain(){return this.q.drain()}sendDisconnect(){if(!this.b){this.b=!0;const e=new yr(5,0,0,_n());this.q.write(e),this.q.flush()}}sendPause(){const e=new yr(7,0,0,_n());this.q.write(e)}sendResume(){const e=new yr(8,0,0,_n());this.q.write(e)}pauseSocketWriting(){this.q.pause()}getSocket(){return this.p}getMillisSinceLastIncomingData(){return Date.now()-this.r.lastReadTime}beginAcceptReconnection(e,t){this.a=!0,this.s.dispose(),this.s=new ie,this.v.flushBuffer(),this.y.flushBuffer(),this.z.flushBuffer(),this.p.dispose(),this.n=0,this.o=Date.now(),this.p=e,this.q=this.s.add(new oC(this.p)),this.r=this.s.add(new nC(this.p)),this.s.add(this.r.onMessage(i=>this.A(i))),this.s.add(this.p.onClose(i=>this.y.fire(i))),this.r.acceptChunk(t)}endAcceptReconnection(){this.a=!1,this.j=this.h;const e=new yr(3,0,this.j,_n());this.q.write(e);const t=this.c.toArray();for(let i=0,s=t.length;i<s;i++)this.q.write(t[i]);this.C()}acceptDisconnect(){this.x.fire()}A(e){if(e.ack>this.f){this.f=e.ack;do{const t=this.c.peek();if(t&&t.id<=e.ack)this.c.pop();else break}while(!0)}switch(e.type){case 0:break;case 1:{if(e.id>this.h)if(e.id!==this.h+1){const t=Date.now();t-this.n>1e4&&(this.n=t,this.q.write(new yr(6,0,0,_n())))}else this.h=e.id,this.k=Date.now(),this.B(),this.w.fire(e.data);break}case 2:{this.v.fire(e.data);break}case 3:break;case 5:{this.x.fire();break}case 6:{const t=this.c.toArray();for(let i=0,s=t.length;i<s;i++)this.q.write(t[i]);this.C();break}case 7:{this.q.pause();break}case 8:{this.q.resume();break}case 9:break}}readEntireBuffer(){return this.r.readEntireBuffer()}flush(){this.q.flush()}send(e){const t=++this.d;this.j=this.h;const i=new yr(1,t,this.j,e);this.c.push(i),this.a||(this.q.write(i),this.C())}sendControl(e){const t=new yr(2,0,0,e);this.q.write(t)}B(){if(this.h<=this.j||this.l)return;const e=Date.now()-this.k;if(e>=2e3){this.D();return}this.l=setTimeout(()=>{this.l=null,this.B()},2e3-e+5)}C(){if(this.d<=this.f||this.g||this.a)return;const e=this.c.peek(),t=Date.now()-e.writtenTime,i=Date.now()-this.r.lastReadTime,s=Date.now()-this.o;if(t>=2e4&&i>=2e4&&s>=2e4&&!this.t.hasHighLoad()){this.o=Date.now(),this.z.fire({unacknowledgedMsgCount:this.c.length(),timeSinceOldestUnacknowledgedMsg:t,timeSinceLastReceivedSomeData:i});return}const r=Math.max(2e4-t,2e4-i,2e4-s,500);this.g=setTimeout(()=>{this.g=null,this.C()},r)}D(){if(this.h<=this.j)return;this.j=this.h;const e=new yr(3,0,this.j,_n());this.q.write(e)}E(){this.j=this.h;const e=new yr(9,0,this.j,_n());this.q.write(e)}};import"crypto";import"net";import{tmpdir as dF}from"os";import{createDeflateRaw as fF,createInflateRaw as pF}from"zlib";var Nt=function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let s=0,r="";return r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r}}(),gF=3e4,vu=class{traceSocketEvent(e,t){kf.traceSocketEvent(this.socket,this.debugLabel,e,t)}constructor(e,t=""){this.d=!0,this.debugLabel=t,this.socket=e,this.traceSocketEvent("created",{type:"NodeSocket"}),this.a=s=>{if(this.traceSocketEvent("error",{code:s?.code,message:s?.message}),s){if(s.code==="EPIPE")return;lt(s)}},this.socket.on("error",this.a);let i;this.b=s=>{this.traceSocketEvent("close",{hadError:s}),this.d=!1,i&&clearTimeout(i)},this.socket.on("close",this.b),this.c=()=>{this.traceSocketEvent("nodeEndReceived"),this.d=!1,i=setTimeout(()=>e.destroy(),gF)},this.socket.on("end",this.c)}dispose(){this.socket.off("error",this.a),this.socket.off("close",this.b),this.socket.off("end",this.c),this.socket.destroy()}onData(e){const t=i=>{this.traceSocketEvent("read",i),e(W.wrap(i))};return this.socket.on("data",t),{dispose:()=>this.socket.off("data",t)}}onClose(e){const t=i=>{e({type:0,hadError:i,error:void 0})};return this.socket.on("close",t),{dispose:()=>this.socket.off("close",t)}}onEnd(e){const t=()=>{e()};return this.socket.on("end",t),{dispose:()=>this.socket.off("end",t)}}write(e){if(!(this.socket.destroyed||!this.d))try{this.traceSocketEvent("write",e),this.socket.write(e.buffer,t=>{if(t){if(t.code==="EPIPE")return;lt(t)}})}catch(t){if(t.code==="EPIPE")return;lt(t)}}end(){this.traceSocketEvent("nodeEndSent"),this.socket.end()}drain(){return this.traceSocketEvent("nodeDrainBegin"),new Promise((e,t)=>{if(this.socket.bufferSize===0){this.traceSocketEvent("nodeDrainEnd"),e();return}const i=()=>{this.socket.off("close",i),this.socket.off("end",i),this.socket.off("error",i),this.socket.off("timeout",i),this.socket.off("drain",i),this.traceSocketEvent("nodeDrainEnd"),e()};this.socket.on("close",i),this.socket.on("end",i),this.socket.on("error",i),this.socket.on("timeout",i),this.socket.on("drain",i)})}},aC;(function(e){e[e.MinHeaderByteSize=2]="MinHeaderByteSize",e[e.MaxWebSocketMessageLength=262144]="MaxWebSocketMessageLength"})(aC||(aC={}));var cC;(function(e){e[e.PeekHeader=1]="PeekHeader",e[e.ReadHeader=2]="ReadHeader",e[e.ReadBody=3]="ReadBody",e[e.Fin=4]="Fin"})(cC||(cC={}));var mF=class extends Z{get permessageDeflate(){return this.a.permessageDeflate}get recordedInflateBytes(){return this.a.recordedInflateBytes}traceSocketEvent(e,t){this.socket.traceSocketEvent(e,t)}constructor(e,t,i,s,r=!0){super(),this.c=this.D(new I),this.f=this.D(new I),this.h=!1,this.j={state:1,readLen:2,fin:0,compressed:!1,firstFrameOfMessage:!0,mask:0,opcode:0},this.socket=e,this.g=r?262144:1/0,this.traceSocketEvent("created",{type:"WebSocketNodeSocket",permessageDeflate:t,inflateBytesLength:i?.byteLength||0,recordInflateBytes:s}),this.a=this.D(new vF(this,t,i,s,this.c,(n,o)=>this.m(n,o))),this.D(this.a.onError(n=>{console.error(n),lt(n),this.f.fire({type:0,hadError:!0,error:n})})),this.b=new tC,this.D(this.socket.onData(n=>this.n(n))),this.D(this.socket.onClose(async n=>{this.a.isProcessingReadQueue()&&await Ie.toPromise(this.a.onDidFinishProcessingReadQueue),this.f.fire(n)}))}dispose(){this.a.isProcessingWriteQueue()?this.D(this.a.onDidFinishProcessingWriteQueue(()=>{this.dispose()})):(this.socket.dispose(),super.dispose())}onData(e){return this.c.event(e)}onClose(e){return this.f.event(e)}onEnd(e){return this.socket.onEnd(e)}write(e){let t=0;for(;t<e.byteLength;)this.a.writeMessage(e.slice(t,Math.min(t+this.g,e.byteLength)),{compressed:!0,opcode:2}),t+=this.g}m(e,{compressed:t,opcode:i}){if(this.h)return;this.traceSocketEvent("webSocketNodeSocketWrite",e);let s=2;e.byteLength<126?s+=0:e.byteLength<2**16?s+=2:s+=8;const r=W.alloc(s),n=t?64:0,o=i&15;if(r.writeUInt8(128|n|o,0),e.byteLength<126)r.writeUInt8(e.byteLength,1);else if(e.byteLength<2**16){r.writeUInt8(126,1);let a=1;r.writeUInt8(e.byteLength>>>8&255,++a),r.writeUInt8(e.byteLength>>>0&255,++a)}else{r.writeUInt8(127,1);let a=1;r.writeUInt8(0,++a),r.writeUInt8(0,++a),r.writeUInt8(0,++a),r.writeUInt8(0,++a),r.writeUInt8(e.byteLength>>>24&255,++a),r.writeUInt8(e.byteLength>>>16&255,++a),r.writeUInt8(e.byteLength>>>8&255,++a),r.writeUInt8(e.byteLength>>>0&255,++a)}this.socket.write(W.concat([r,e]))}end(){this.h=!0,this.socket.end()}n(e){if(e.byteLength!==0){for(this.b.acceptChunk(e);this.b.byteLength>=this.j.readLen;)if(this.j.state===1){const t=this.b.peek(this.j.readLen),i=t.readUInt8(0),s=(i&128)>>>7,r=(i&64)>>>6,n=i&15,o=t.readUInt8(1),a=(o&128)>>>7,c=o&127;this.j.state=2,this.j.readLen=2+(a?4:0)+(c===126?2:0)+(c===127?8:0),this.j.fin=s,this.j.firstFrameOfMessage&&(this.j.compressed=!!r),this.j.firstFrameOfMessage=!!s,this.j.mask=0,this.j.opcode=n,this.traceSocketEvent("webSocketNodeSocketPeekedHeader",{headerSize:this.j.readLen,compressed:this.j.compressed,fin:this.j.fin,opcode:this.j.opcode})}else if(this.j.state===2){const t=this.b.read(this.j.readLen),i=t.readUInt8(1),s=(i&128)>>>7;let r=i&127,n=1;r===126?r=t.readUInt8(++n)*2**8+t.readUInt8(++n):r===127&&(r=t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*2**24+t.readUInt8(++n)*2**16+t.readUInt8(++n)*2**8+t.readUInt8(++n));let o=0;s&&(o=t.readUInt8(++n)*2**24+t.readUInt8(++n)*2**16+t.readUInt8(++n)*2**8+t.readUInt8(++n)),this.j.state=3,this.j.readLen=r,this.j.mask=o,this.traceSocketEvent("webSocketNodeSocketPeekedHeader",{bodySize:this.j.readLen,compressed:this.j.compressed,fin:this.j.fin,mask:this.j.mask,opcode:this.j.opcode})}else if(this.j.state===3){const t=this.b.read(this.j.readLen);this.traceSocketEvent("webSocketNodeSocketReadData",t),yF(t,this.j.mask),this.traceSocketEvent("webSocketNodeSocketUnmaskedData",t),this.j.state=1,this.j.readLen=2,this.j.mask=0,this.j.opcode<=2?this.a.acceptFrame(t,this.j.compressed,!!this.j.fin):this.j.opcode===9&&this.a.writeMessage(t,{compressed:!1,opcode:10})}}}async drain(){this.traceSocketEvent("webSocketNodeSocketDrainBegin"),this.a.isProcessingWriteQueue()&&await Ie.toPromise(this.a.onDidFinishProcessingWriteQueue),await this.socket.drain(),this.traceSocketEvent("webSocketNodeSocketDrainEnd")}},vF=class extends Z{get permessageDeflate(){return!!(this.b&&this.c)}get recordedInflateBytes(){return this.b?this.b.recordedInflateBytes:W.alloc(0)}constructor(e,t,i,s,r,n){super(),this.m=e,this.n=r,this.q=n,this.a=this.D(new I),this.onError=this.a.event,this.f=[],this.g=[],this.h=this.D(new I),this.onDidFinishProcessingReadQueue=this.h.event,this.j=this.D(new I),this.onDidFinishProcessingWriteQueue=this.j.event,this.r=!1,this.u=!1,t?(this.b=this.D(new wF(this.m,s,i,{windowBits:15})),this.c=this.D(new bF(this.m,{windowBits:15})),this.D(this.b.onError(o=>this.a.fire(o))),this.D(this.c.onError(o=>this.a.fire(o)))):(this.b=null,this.c=null)}writeMessage(e,t){this.f.push({data:e,options:t}),this.s()}async s(){if(!this.r){for(this.r=!0;this.f.length>0;){const{data:e,options:t}=this.f.shift();if(this.c&&t.compressed){const i=await this.t(this.c,e);this.q(i,t)}else this.q(e,{...t,compressed:!1})}this.r=!1,this.j.fire()}}isProcessingWriteQueue(){return this.r}t(e,t){return new Promise((i,s)=>{e.write(t),e.flush(r=>i(r))})}acceptFrame(e,t,i){this.g.push({data:e,isCompressed:t,isLastFrameOfMessage:i}),this.w()}async w(){if(!this.u){for(this.u=!0;this.g.length>0;){const e=this.g.shift();if(this.b&&e.isCompressed){const t=await this.y(this.b,e.data,e.isLastFrameOfMessage);this.n.fire(t)}else this.n.fire(e.data)}this.u=!1,this.h.fire()}}isProcessingReadQueue(){return this.u}y(e,t,i){return new Promise((s,r)=>{e.write(t),i&&e.write(W.fromByteArray([0,0,255,255])),e.flush(n=>s(n))})}},wF=class extends Z{get recordedInflateBytes(){return this.h?W.concat(this.c):W.alloc(0)}constructor(e,t,i,s){super(),this.g=e,this.h=t,this.a=this.D(new I),this.onError=this.a.event,this.c=[],this.f=[],this.b=pF(s),this.b.on("error",r=>{this.g.traceSocketEvent("zlibInflateError",{message:r?.message,code:r?.code}),this.a.fire(r)}),this.b.on("data",r=>{this.g.traceSocketEvent("zlibInflateData",r),this.f.push(W.wrap(r))}),i&&(this.g.traceSocketEvent("zlibInflateInitialWrite",i.buffer),this.b.write(i.buffer),this.b.flush(()=>{this.g.traceSocketEvent("zlibInflateInitialFlushFired"),this.f.length=0}))}write(e){this.h&&this.c.push(e.clone()),this.g.traceSocketEvent("zlibInflateWrite",e),this.b.write(e.buffer)}flush(e){this.b.flush(()=>{this.g.traceSocketEvent("zlibInflateFlushFired");const t=W.concat(this.f);this.f.length=0,e(t)})}},bF=class extends Z{constructor(e,t){super(),this.f=e,this.a=this.D(new I),this.onError=this.a.event,this.c=[],this.b=fF({windowBits:15}),this.b.on("error",i=>{this.f.traceSocketEvent("zlibDeflateError",{message:i?.message,code:i?.code}),this.a.fire(i)}),this.b.on("data",i=>{this.f.traceSocketEvent("zlibDeflateData",i),this.c.push(W.wrap(i))})}write(e){this.f.traceSocketEvent("zlibDeflateWrite",e.buffer),this.b.write(e.buffer)}flush(e){this.b.flush(2,()=>{this.f.traceSocketEvent("zlibDeflateFlushFired");let t=W.concat(this.c);this.c.length=0,t=t.slice(0,t.byteLength-4),e(t)})}};function yF(e,t){if(t===0)return;const i=e.byteLength>>>2;for(let c=0;c<i;c++){const l=e.readUInt32BE(c*4);e.writeUInt32BE(l^t,c*4)}const s=i*4,r=e.byteLength-s,n=t>>>24&255,o=t>>>16&255,a=t>>>8&255;r>=1&&e.writeUInt8(e.readUInt8(s)^n,s),r>=2&&e.writeUInt8(e.readUInt8(s+1)^o,s+1),r>=3&&e.writeUInt8(e.readUInt8(s+2)^a,s+2)}var lC=process.env.XDG_RUNTIME_DIR,AF={2:107,1:103};function SF(){const e=Nt();if(process.platform==="win32")return`\\\\.\\pipe\\vscode-ipc-${e}-sock`;const t=process.platform!=="darwin"&&lC?lC:dF(),i=_e(t,`vscode-ipc-${e}.sock`);return EF(i),i}function EF(e){const t=AF[GR];typeof t=="number"&&e.length>=t&&console.warn(`WARNING: IPC handle "${e}" is longer than ${t} chars, try a shorter --user-data-dir`)}function ot(e){if(!e||typeof e!="object"||e instanceof RegExp)return e;const t=Array.isArray(e)?[]:{};return Object.entries(e).forEach(([i,s])=>{t[i]=s&&typeof s=="object"?ot(s):s}),t}function f0(e){if(!e||typeof e!="object")return e;const t=[e];for(;t.length>0;){const i=t.shift();Object.freeze(i);for(const s in i)if(uC.call(i,s)){const r=i[s];typeof r=="object"&&!Object.isFrozen(r)&&!pR(r)&&t.push(r)}}return e}var uC=Object.prototype.hasOwnProperty;function mc(e,t){return p0(e,t,new Set)}function p0(e,t,i){if(Wt(e))return e;const s=t(e);if(typeof s<"u")return s;if(Array.isArray(e)){const r=[];for(const n of e)r.push(p0(n,t,i));return r}if(At(e)){if(i.has(e))throw new Error("Cannot clone recursive data-structure");i.add(e);const r={};for(const n in e)uC.call(e,n)&&(r[n]=p0(e[n],t,i));return i.delete(e),r}return e}function en(e,t,i=!0){return At(e)?(At(t)&&Object.keys(t).forEach(s=>{s in e?i&&(At(e[s])&&At(t[s])?en(e[s],t[s],i):e[s]=t[s]):e[s]=t[s]}),e):t}function Fi(e,t){if(e===t)return!0;if(e==null||t===null||t===void 0||typeof e!=typeof t||typeof e!="object"||Array.isArray(e)!==Array.isArray(t))return!1;let i,s;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!Fi(e[i],t[i]))return!1}else{const r=[];for(s in e)r.push(s);r.sort();const n=[];for(s in t)n.push(s);if(n.sort(),!Fi(r,n))return!1;for(i=0;i<r.length;i++)if(!Fi(e[r[i]],t[r[i]]))return!1}return!0}function xF(e){const t=new Set;return JSON.stringify(e,(i,s)=>{if(At(s)||Array.isArray(s)){if(t.has(s))return"[Circular]";t.add(s)}return typeof s=="bigint"?`[BigInt ${s.toString()}]`:s})}function hC(e,t){const i=t.toLowerCase(),s=Object.keys(e).find(r=>r.toLowerCase()===i);return s?e[s]:e[t]}function dC(e,t){const i=Object.create(null);for(const[s,r]of Object.entries(e))t(s,r)&&(i[s]=r);return i}var CF=new class{constructor(){this.a=0,this.b=new I,this.onDidChangeZoomLevel=this.b.event}getZoomLevel(){return this.a}setZoomLevel(e){e=Math.min(Math.max(-5,e),20),this.a!==e&&(this.a=e,this.b.fire(this.a))}},kF=Pt?1.5:1.35,g0=8,$F=class y5{static _create(t,i,s,r,n,o,a,c,l){o===0?o=kF*s:o<g0&&(o=o*s),o=Math.round(o),o<g0&&(o=g0);const u=1+(l?0:CF.getZoomLevel()*.1);return s*=u,o*=u,n===pC&&(i==="normal"||i==="bold"?n=fC:(n=`'wght' ${parseInt(i,10)}`,i="normal")),new y5({pixelRatio:c,fontFamily:t,fontWeight:i,fontSize:s,fontFeatureSettings:r,fontVariationSettings:n,lineHeight:o,letterSpacing:a})}constructor(t){this._bareFontInfoBrand=void 0,this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=t.lineHeight|0,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const t=Ar.fontFamily,i=y5.a(this.fontFamily);return t&&this.fontFamily!==t?`${i}, ${t}`:i}static a(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}},IF=2,DF=class extends $F{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=IF,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}},fC="normal",pC="translate",PF="Consolas, 'Courier New', monospace",TF="Menlo, Monaco, 'Courier New', monospace",NF="'Droid Sans Mono', monospace",Ar={fontFamily:Pt?TF:ze?PF:NF,fontWeight:"normal",fontSize:Pt?12:14,lineHeight:0,letterSpacing:0},gC={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},mC="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function MF(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const i of mC)e.indexOf(i)>=0||(t+="\\"+i);return t+="\\s]+)",new RegExp(t,"g")}var LF=MF();function vC(e){let t=LF;if(e&&e instanceof RegExp)if(e.global)t=e;else{let i="g";e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),t=new RegExp(e.source,i)}return t.lastIndex=0,t}var wC=new Mn;wC.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function bC(e,t,i,s,r){if(t=vC(t),r||(r=Bt.first(wC)),i.length>r.maxLen){let l=e-r.maxLen/2;return l<0?l=0:s+=l,i=i.substring(l,e+r.maxLen/2),bC(e,t,i,s,r)}const n=Date.now(),o=e-1-s;let a=-1,c=null;for(let l=1;!(Date.now()-n>=r.timeBudget);l++){const u=o-r.windowSize*l;t.lastIndex=Math.max(0,u);const h=RF(t,i,o,a);if(!h&&c||(c=h,u<=0))break;a=u}if(c){const l={word:c[0],startColumn:s+1+c.index,endColumn:s+1+c.index+c[0].length};return t.lastIndex=0,l}return null}function RF(e,t,i,s){let r;for(;r=e.exec(t);){const n=r.index||0;if(n<=i&&e.lastIndex>=i)return r;if(s>0&&n>s)return null}return null}var yC;(function(e){e[e.None=0]="None",e[e.Keep=1]="Keep",e[e.Brackets=2]="Brackets",e[e.Advanced=3]="Advanced",e[e.Full=4]="Full"})(yC||(yC={}));var OF=8,FF=class{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},at=class{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return If(e,t)}compute(e,t,i){return i}},$f=class{constructor(e,t){this.newValue=e,this.didChange=t}};function If(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return new $f(t,e!==t);if(Array.isArray(e)||Array.isArray(t)){const s=Array.isArray(e)&&Array.isArray(t)&&Ci(e,t);return new $f(t,!s)}let i=!1;for(const s in t)if(t.hasOwnProperty(s)){const r=If(e[s],t[s]);r.didChange&&(e[s]=r.newValue,i=!0)}return new $f(e,i)}var Vn=class{constructor(e,t){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=t}applyUpdate(e,t){return If(e,t)}validate(e){return this.defaultValue}},vc=class{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return If(e,t)}compute(e,t,i){return i}};function ee(e,t){return typeof e>"u"?t:e==="false"?!1:!!e}var fe=class extends vc{constructor(e,t,i,s=void 0){typeof s<"u"&&(s.type="boolean",s.default=i),super(e,t,i,s)}validate(e){return ee(e,this.defaultValue)}};function UF(e,t,i,s){if(typeof e=="string"&&(e=parseInt(e,10)),typeof e!="number"||isNaN(e))return t;let r=e;return r=Math.max(i,r),r=Math.min(s,r),r|0}var We=class tM extends vc{static clampedInt(t,i,s,r){return UF(t,i,s,r)}constructor(t,i,s,r,n,o=void 0){typeof o<"u"&&(o.type="integer",o.default=s,o.minimum=r,o.maximum=n),super(t,i,s,o),this.minimum=r,this.maximum=n}validate(t){return tM.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}},Is=class iM extends vc{static clamp(t,i,s){return t<i?i:t>s?s:t}static float(t,i){return typeof t=="string"&&(t=parseFloat(t)),typeof t!="number"||isNaN(t)?i:t}constructor(t,i,s,r,n,o,a){typeof n<"u"&&(n.type="number",n.default=s,n.minimum=o,n.maximum=a),super(t,i,s,n),this.validationFn=r,this.minimum=o,this.maximum=a}validate(t){return this.validationFn(iM.float(t,this.defaultValue))}},Di=class sM extends vc{static string(t,i){return typeof t!="string"?i:t}constructor(t,i,s,r=void 0){typeof r<"u"&&(r.type="string",r.default=s),super(t,i,s,r)}validate(t){return sM.string(t,this.defaultValue)}};function st(e,t,i,s){return typeof e!="string"?t:s&&e in s?s[e]:i.indexOf(e)===-1?t:e}var ct=class extends vc{constructor(e,t,i,s,r=void 0){typeof r<"u"&&(r.type="string",r.enum=s.slice(0),r.default=i),super(e,t,i,r),this.c=s}validate(e){return st(e,this.defaultValue,this.c)}},wu=class extends at{constructor(e,t,i,s,r,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=r,o.default=s),super(e,t,i,o),this.c=r,this.d=n}validate(e){return typeof e!="string"?this.defaultValue:this.c.indexOf(e)===-1?this.defaultValue:this.d(e)}};function jF(e){switch(e){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var zF=class extends at{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[d(316,null),d(317,null),d(318,null)],default:"auto",tags:["accessibility"],description:d(319,null)})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}},HF=class extends at{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(29,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:d(320,null)},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:d(321,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:ee(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ee(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}},AC;(function(e){e[e.Hidden=0]="Hidden",e[e.Blink=1]="Blink",e[e.Smooth=2]="Smooth",e[e.Phase=3]="Phase",e[e.Expand=4]="Expand",e[e.Solid=5]="Solid"})(AC||(AC={}));function WF(e){switch(e){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var Ds;(function(e){e[e.Line=1]="Line",e[e.Block=2]="Block",e[e.Underline=3]="Underline",e[e.LineThin=4]="LineThin",e[e.BlockOutline=5]="BlockOutline",e[e.UnderlineThin=6]="UnderlineThin"})(Ds||(Ds={}));function SC(e){switch(e){case"line":return Ds.Line;case"block":return Ds.Block;case"underline":return Ds.Underline;case"line-thin":return Ds.LineThin;case"block-outline":return Ds.BlockOutline;case"underline-thin":return Ds.UnderlineThin}}var BF=class extends Vn{constructor(){super(162,"")}compute(e,t,i){const s=["monaco-editor"];return t.get(48)&&s.push(t.get(48)),e.extraEditorClassName&&s.push(e.extraEditorClassName),t.get(82)==="default"?s.push("mouse-default"):t.get(82)==="copy"&&s.push("mouse-copy"),t.get(127)&&s.push("showUnused"),t.get(157)&&s.push("showDeprecated"),s.join(" ")}},_F=class extends fe{constructor(){super(45,"emptySelectionClipboard",!0,{description:d(322,null)})}compute(e,t,i){return i&&e.emptySelectionClipboard}},VF=class extends at{constructor(){const e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(50,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:d(323,null)},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[d(324,null),d(325,null),d(326,null)],description:d(327,null)},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[d(328,null),d(329,null),d(330,null)],description:d(331,null)},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:d(332,null),included:Pt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:d(333,null)},"editor.find.loop":{type:"boolean",default:e.loop,description:d(334,null)},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[d(335,null),d(336,null)],description:d(337,null)},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[d(338,null),d(339,null)],description:d(340,null)},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:d(341,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:ee(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:ee(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":st(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":st(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ee(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ee(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ee(t.loop,this.defaultValue.loop),history:st(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:st(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}},qF=class _l extends at{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(60,"fontLigatures",_l.OFF,{anyOf:[{type:"boolean",description:d(342,null)},{type:"string",description:d(343,null)}],description:d(344,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?_l.OFF:t==="true"?_l.ON:t:t?_l.ON:_l.OFF}},GF=class Vl extends at{static{this.OFF=fC}static{this.TRANSLATE=pC}constructor(){super(63,"fontVariations",Vl.OFF,{anyOf:[{type:"boolean",description:d(345,null)},{type:"string",description:d(346,null)}],description:d(347,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"?Vl.OFF:t==="true"?Vl.TRANSLATE:t:t?Vl.TRANSLATE:Vl.OFF}compute(t,i,s){return t.fontInfo.fontVariationSettings}},JF=class extends Vn{constructor(){super(59,new DF({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:!1,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:!1,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},!1))}compute(e,t,i){return e.fontInfo}},ZF=class extends Vn{constructor(){super(161,Ds.Line)}compute(e,t,i){return e.inputMode==="overtype"?t.get(92):t.get(34)}},QF=class extends Vn{constructor(){super(170,!1)}compute(e,t){return e.editContextSupported&&t.get(44)}},YF=class extends Vn{constructor(){super(172,!1)}compute(e,t){return e.accessibilitySupport===2?t.get(7):t.get(6)}},XF=class extends vc{constructor(){super(61,"fontSize",Ar.fontSize,{type:"number",minimum:6,maximum:100,default:Ar.fontSize,description:d(348,null)})}validate(e){const t=Is.float(e,this.defaultValue);return t===0?Ar.fontSize:Is.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}},KF=class ql extends at{static{this.c=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.d=1}static{this.e=1e3}constructor(){super(62,"fontWeight",Ar.fontWeight,{anyOf:[{type:"number",minimum:ql.d,maximum:ql.e,errorMessage:d(349,null)},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:ql.c}],default:Ar.fontWeight,description:d(350,null)})}validate(t){return t==="normal"||t==="bold"?t:String(We.clampedInt(t,Ar.fontWeight,ql.d,ql.e))}},eU=class extends at{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[d(351,null),d(352,null),d(353,null)]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(67,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:d(354,null)},"editor.gotoLocation.multipleDefinitions":{description:d(355,null),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:d(356,null),...t},"editor.gotoLocation.multipleDeclarations":{description:d(357,null),...t},"editor.gotoLocation.multipleImplementations":{description:d(358,null),...t},"editor.gotoLocation.multipleReferences":{description:d(359,null),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:d(360,null)},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:d(361,null)},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:d(362,null)},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:d(363,null)},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:d(364,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:st(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:st(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:st(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:st(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:st(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:st(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:st(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Di.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Di.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Di.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Di.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Di.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Di.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},tU=class extends at{constructor(){const e={enabled:"on",delay:300,hidingDelay:300,sticky:!0,above:!0};super(69,"hover",e,{"editor.hover.enabled":{type:"string",enum:["on","off","onKeyboardModifier"],default:e.enabled,markdownEnumDescriptions:[d(365,null),d(366,null),d(367,null,Pt?"Command":"Control")],description:d(368,null)},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:d(369,null)},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:d(370,null)},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:d(371,null)},"editor.hover.above":{type:"boolean",default:e.above,description:d(372,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:st(t.enabled,this.defaultValue.enabled,["on","off","onKeyboardModifier"]),delay:We.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:ee(t.sticky,this.defaultValue.sticky),hidingDelay:We.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ee(t.above,this.defaultValue.above)}}},EC;(function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Blocks=2]="Blocks"})(EC||(EC={}));var iU=class ev extends Vn{constructor(){super(165,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(t,i,s){return ev.computeLayout(i,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){const i=t.height/t.lineHeight,s=Math.floor(t.paddingTop/t.lineHeight);let r=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(r=Math.max(r,i-1));const n=(s+t.viewLineCount+r)/(t.pixelRatio*t.height),o=Math.floor(t.viewLineCount/n);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:s,extraLinesBeyondLastLine:r,desiredRatio:n,minimapLineCount:o}}static c(t,i){const s=t.outerWidth,r=t.outerHeight,n=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(n*r),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:r};const o=i.stableMinimapLayoutInput,a=o&&t.outerHeight===o.outerHeight&&t.lineHeight===o.lineHeight&&t.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&t.pixelRatio===o.pixelRatio&&t.scrollBeyondLastLine===o.scrollBeyondLastLine&&t.paddingTop===o.paddingTop&&t.paddingBottom===o.paddingBottom&&t.minimap.enabled===o.minimap.enabled&&t.minimap.side===o.minimap.side&&t.minimap.size===o.minimap.size&&t.minimap.showSlider===o.minimap.showSlider&&t.minimap.renderCharacters===o.minimap.renderCharacters&&t.minimap.maxColumn===o.minimap.maxColumn&&t.minimap.scale===o.minimap.scale&&t.verticalScrollbarWidth===o.verticalScrollbarWidth&&t.isViewportWrapping===o.isViewportWrapping,c=t.lineHeight,l=t.typicalHalfwidthCharacterWidth,u=t.scrollBeyondLastLine,h=t.minimap.renderCharacters;let f=n>=2?Math.round(t.minimap.scale*2):t.minimap.scale;const p=t.minimap.maxColumn,g=t.minimap.size,v=t.minimap.side,b=t.verticalScrollbarWidth,S=t.viewLineCount,E=t.remainingWidth,k=t.isViewportWrapping,j=h?2:3;let O=Math.floor(n*r);const Q=O/n;let F=!1,B=!1,z=j*f,ue=f/n,Le=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:ve,extraLinesBeforeFirstLine:Ne,extraLinesBeyondLastLine:Me,desiredRatio:mt,minimapLineCount:Vt}=ev.computeContainedMinimapLineCount({viewLineCount:S,scrollBeyondLastLine:u,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:r,lineHeight:c,pixelRatio:n});if(S/Vt>1)F=!0,B=!0,f=1,z=1,ue=f/n;else{let Rt=!1,Si=f+1;if(g==="fit"){const ii=Math.ceil((Ne+S+Me)*z);k&&a&&E<=i.stableFitRemainingWidth?(Rt=!0,Si=i.stableFitMaxMinimapScale):Rt=ii>O}if(g==="fill"||Rt){F=!0;const ii=f;z=Math.min(c*n,Math.max(1,Math.floor(1/mt))),k&&a&&E<=i.stableFitRemainingWidth&&(Si=i.stableFitMaxMinimapScale),f=Math.min(Si,Math.max(1,Math.floor(z/j))),f>ii&&(Le=Math.min(2,f/ii)),ue=f/n/Le,O=Math.ceil(Math.max(ve,Ne+S+Me)*z),k?(i.stableMinimapLayoutInput=t,i.stableFitRemainingWidth=E,i.stableFitMaxMinimapScale=f):(i.stableMinimapLayoutInput=null,i.stableFitRemainingWidth=0)}}}const ae=Math.floor(p*ue),J=Math.min(ae,Math.max(0,Math.floor((E-b-2)*ue/(l+ue)))+OF);let q=Math.floor(n*J);const G=q/n;q=Math.floor(q*Le);const K=h?1:2,se=v==="left"?0:s-J-b;return{renderMinimap:K,minimapLeft:se,minimapWidth:J,minimapHeightIsEditorHeight:F,minimapIsSampling:B,minimapScale:f,minimapLineHeight:z,minimapCanvasInnerWidth:q,minimapCanvasInnerHeight:O,minimapCanvasOuterWidth:G,minimapCanvasOuterHeight:Q}}static computeLayout(t,i){const s=i.outerWidth|0,r=i.outerHeight|0,n=i.lineHeight|0,o=i.lineNumbersDigitCount|0,a=i.typicalHalfwidthCharacterWidth,c=i.maxDigitWidth,l=i.pixelRatio,u=i.viewLineCount,h=t.get(154),f=h==="inherit"?t.get(153):h,p=f==="inherit"?t.get(149):f,g=t.get(152),v=i.isDominatedByLongLines,b=t.get(66),S=t.get(76).renderType!==0,E=t.get(77),k=t.get(119),j=t.get(96),O=t.get(81),Q=t.get(117),F=Q.verticalScrollbarSize,B=Q.verticalHasArrows,z=Q.arrowSize,ue=Q.horizontalScrollbarSize,Le=t.get(52),ae=t.get(126)!=="never";let J=t.get(74);Le&&ae&&(J+=16);let q=0;if(S){const Dn=Math.max(o,E);q=Math.round(Dn*c)}let G=0;b&&(G=n*i.glyphMarginDecorationLaneCount);let K=0,se=K+G,ve=se+q,Ne=ve+J;const Me=s-G-q-J;let mt=!1,Vt=!1,tt=-1;t.get(2)===2&&f==="inherit"&&v?(mt=!0,Vt=!0):p==="on"||p==="bounded"?Vt=!0:p==="wordWrapColumn"&&(tt=g);const Rt=ev.c({outerWidth:s,outerHeight:r,lineHeight:n,typicalHalfwidthCharacterWidth:a,pixelRatio:l,scrollBeyondLastLine:k,paddingTop:j.top,paddingBottom:j.bottom,minimap:O,verticalScrollbarWidth:F,viewLineCount:u,remainingWidth:Me,isViewportWrapping:Vt},i.memory||new FF);Rt.renderMinimap!==0&&Rt.minimapLeft===0&&(K+=Rt.minimapWidth,se+=Rt.minimapWidth,ve+=Rt.minimapWidth,Ne+=Rt.minimapWidth);const Si=Me-Rt.minimapWidth,ii=Math.max(1,Math.floor((Si-F-2)/a)),As=B?z:0;return Vt&&(tt=Math.max(1,ii),p==="bounded"&&(tt=Math.min(tt,g))),{width:s,height:r,glyphMarginLeft:K,glyphMarginWidth:G,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:se,lineNumbersWidth:q,decorationsLeft:ve,decorationsWidth:J,contentLeft:Ne,contentWidth:Si,minimap:Rt,viewportColumn:ii,isWordWrapMinified:mt,isViewportWrapping:Vt,wrappingColumn:tt,verticalScrollbarWidth:F,horizontalScrollbarHeight:ue,overviewRuler:{top:As,width:F,height:r-2*As,right:0}}}},sU=class extends at{constructor(){super(156,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[d(373,null),d(374,null)],type:"string",enum:["simple","advanced"],default:"simple",description:d(375,null)}})}validate(e){return st(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}},tn;(function(e){e.Off="off",e.OnCode="onCode",e.On="on"})(tn||(tn={}));var rU=class extends at{constructor(){const e={enabled:tn.OnCode};super(73,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[tn.Off,tn.OnCode,tn.On],default:e.enabled,enumDescriptions:[d(376,null),d(377,null),d(378,null)],description:d(379,null)}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:st(e.enabled,this.defaultValue.enabled,[tn.Off,tn.OnCode,tn.On])}}},nU=class extends at{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(131,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:d(380,null)},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:d(381,null)},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:d(382,null)},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:d(383,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),maxLineCount:We.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:st(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ee(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},oU=class extends at{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(159,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:d(384,null),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[d(385,null),d(386,null,Pt?"Ctrl+Option":"Ctrl+Alt"),d(387,null,Pt?"Ctrl+Option":"Ctrl+Alt"),d(388,null)]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:d(389,null,"`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:d(390,null,"`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:d(391,null)},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:d(392,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:st(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:We.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Di.string(t.fontFamily,this.defaultValue.fontFamily),padding:ee(t.padding,this.defaultValue.padding),maximumLength:We.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},aU=class extends at{constructor(){super(74,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):We.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?We.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},cU=class extends Is{constructor(){super(75,"lineHeight",Ar.lineHeight,e=>Is.clamp(e,0,150),{markdownDescription:d(393,null)},0,150)}compute(e,t,i){return e.fontInfo.lineHeight}},lU=class extends at{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(81,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:d(394,null)},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[d(395,null),d(396,null),d(397,null)],default:e.autohide,description:d(398,null)},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[d(399,null),d(400,null),d(401,null)],default:e.size,description:d(402,null)},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:d(403,null)},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:d(404,null)},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:d(405,null)},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:d(406,null)},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:d(407,null)},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:d(408,null)},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:d(409,null)},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:d(410,null)},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:d(411,null)},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:d(412,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const s=t.markSectionHeaderRegex;if(typeof s=="string")try{new RegExp(s,"d"),i=s}catch{}return{enabled:ee(t.enabled,this.defaultValue.enabled),autohide:st(t.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:st(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:st(t.side,this.defaultValue.side,["right","left"]),showSlider:st(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ee(t.renderCharacters,this.defaultValue.renderCharacters),scale:We.clampedInt(t.scale,1,1,3),maxColumn:We.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ee(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ee(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:Is.clamp(Is.float(t.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:Is.clamp(Is.float(t.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}};function uU(e){return e==="ctrlCmd"?Pt?"metaKey":"ctrlKey":"altKey"}var hU=class extends at{constructor(){super(96,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:d(413,null)},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:d(414,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:We.clampedInt(t.top,0,0,1e3),bottom:We.clampedInt(t.bottom,0,0,1e3)}}},dU=class extends at{constructor(){const e={enabled:!0,cycle:!0};super(98,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:d(415,null)},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:d(416,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),cycle:ee(t.cycle,this.defaultValue.cycle)}}},fU=class extends Vn{constructor(){super(163,1)}compute(e,t,i){return e.pixelRatio}},pU=class extends at{constructor(){super(100,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},gU=class extends at{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[d(417,null),d(418,null),d(419,null)]}];super(102,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:d(420,null)},comments:{anyOf:t,default:e.comments,description:d(421,null)},other:{anyOf:t,default:e.other,description:d(422,null)}},default:e,markdownDescription:d(423,null,"`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:s}=e,r=["on","inline","off"];let n,o,a;return typeof t=="boolean"?n=t?"on":"off":n=st(t,this.defaultValue.other,r),typeof i=="boolean"?o=i?"on":"off":o=st(i,this.defaultValue.comments,r),typeof s=="boolean"?a=s?"on":"off":a=st(s,this.defaultValue.strings,r),{other:n,comments:o,strings:a}}},xC;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval",e[e.Custom=4]="Custom"})(xC||(xC={}));var mU=class extends at{constructor(){super(76,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[d(424,null),d(425,null),d(426,null),d(427,null)],default:"on",description:d(428,null)})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}},vU=class extends at{constructor(){const e=[],t={type:"number",description:d(429,null)};super(116,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:d(430,null),format:"color-hex"}}}]},default:e,description:d(431,null)})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:We.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const s=i;t.push({column:We.clampedInt(s.column,0,0,1e4),color:s.color})}return t.sort((i,s)=>i.column-s.column),t}return this.defaultValue}},wU=class extends at{constructor(){super(105,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function CC(e,t){if(typeof e!="string")return t;switch(e){case"hidden":return 2;case"visible":return 3;default:return 1}}var bU=class extends at{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(117,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[d(432,null),d(433,null),d(434,null)],default:"auto",description:d(435,null)},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[d(436,null),d(437,null),d(438,null)],default:"auto",description:d(439,null)},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:d(440,null)},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:d(441,null)},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:d(442,null)},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:d(443,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=We.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),s=We.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:We.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:CC(t.vertical,this.defaultValue.vertical),horizontal:CC(t.horizontal,this.defaultValue.horizontal),useShadows:ee(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:ee(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ee(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ee(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ee(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:We.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:s,verticalSliderSize:We.clampedInt(t.verticalSliderSize,s,0,1e3),scrollByPage:ee(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ee(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},Js="inUntrustedWorkspace",Yo={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},yU=class extends at{constructor(){const e={nonBasicASCII:Js,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Js,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(142,"unicodeHighlight",e,{[Yo.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Js],default:e.nonBasicASCII,description:d(444,null)},[Yo.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:d(445,null)},[Yo.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:d(446,null)},[Yo.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Js],default:e.includeComments,description:d(447,null)},[Yo.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Js],default:e.includeStrings,description:d(448,null)},[Yo.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:d(449,null),additionalProperties:{type:"boolean"}},[Yo.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:d(450,null)}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(Fi(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(Fi(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const s=super.applyUpdate(e,t);return i?new $f(s.newValue,!0):s}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:wc(t.nonBasicASCII,Js,[!0,!1,Js]),invisibleCharacters:ee(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ee(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:wc(t.includeComments,Js,[!0,!1,Js]),includeStrings:wc(t.includeStrings,Js,[!0,!1,Js]),allowedCharacters:this.c(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.c(t.allowedLocales,this.defaultValue.allowedLocales)}}c(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[s,r]of Object.entries(e))r===!0&&(i[s]=!0);return i}},AU=class extends at{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,minShowDelay:0,suppressInSnippetMode:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always",showLongDistanceHint:!0},triggerCommandOnProviderChange:!1,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:!0}};super(71,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:d(451,null)},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[d(452,null),d(453,null),d(454,null)],description:d(455,null)},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:d(456,null)},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:d(457,null)},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:d(458,null)},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:d(459,null)},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:d(460,null),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:d(461,null),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:d(462,null),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:d(463,null),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:d(464,null)},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:d(465,null),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showLongDistanceHint":{type:"boolean",default:e.edits.showLongDistanceHint,description:d(466,null),tags:["nextEditSuggestions","experimental"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:d(467,null),enum:["auto","never"],enumDescriptions:[d(468,null),d(469,null)],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:d(470,null),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),mode:st(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:st(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ee(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ee(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Di.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:ee(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:We.clampedInt(t.minShowDelay,0,0,1e4),suppressInSnippetMode:ee(t.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this.c(t.edits),triggerCommandOnProviderChange:ee(t.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this.d(t.experimental)}}c(e){if(!e||typeof e!="object")return this.defaultValue.edits;const t=e;return{enabled:ee(t.enabled,this.defaultValue.edits.enabled),showCollapsed:ee(t.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:st(t.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),showLongDistanceHint:ee(t.showLongDistanceHint,this.defaultValue.edits.showLongDistanceHint),renderSideBySide:st(t.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}d(e){if(!e||typeof e!="object")return this.defaultValue.experimental;const t=e;return{suppressInlineSuggestions:Di.string(t.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:st(t.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:ee(t.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}},SU=class extends at{constructor(){const e={enabled:gC.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:gC.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(21,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(471,null,"`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:d(472,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ee(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},EU=class extends at{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(22,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[d(473,null),d(474,null),d(475,null)],default:e.bracketPairs,description:d(476,null)},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[d(477,null),d(478,null),d(479,null)],default:e.bracketPairsHorizontal,description:d(480,null)},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:d(481,null)},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:d(482,null)},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[d(483,null),d(484,null),d(485,null)],default:e.highlightActiveIndentation,description:d(486,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:wc(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:wc(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ee(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ee(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:wc(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function wc(e,t,i){const s=i.indexOf(e);return s===-1?t:i[s]}var xU=class extends at{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(134,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[d(487,null),d(488,null)],default:e.insertMode,description:d(489,null)},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:d(490,null)},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:d(491,null)},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:d(492,null)},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[d(493,null),d(494,null),d(495,null),d(496,null)],default:e.selectionMode,markdownDescription:d(497,null,"`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:d(498,null)},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:d(499,null)},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:d(500,null)},"editor.suggest.preview":{type:"boolean",default:e.preview,description:d(501,null)},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:d(502,null)},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:d(503,null)},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:d(504,null)},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:d(505,null)},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:d(506,null)},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:d(507,null)},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:d(508,null)},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:d(509,null)},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:d(510,null)},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:d(511,null)},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:d(512,null)},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:d(513,null)},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:d(514,null)},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:d(515,null)},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:d(516,null)},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:d(517,null)},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:d(518,null)},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:d(519,null)},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:d(520,null)},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:d(521,null)},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:d(522,null)},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:d(523,null)},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:d(524,null)},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:d(525,null)},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:d(526,null)},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:d(527,null)},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:d(528,null)},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:d(529,null)},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:d(530,null)},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:d(531,null)},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:d(532,null)},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:d(533,null)},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:d(534,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:st(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ee(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ee(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ee(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ee(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:st(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ee(t.showIcons,this.defaultValue.showIcons),showStatusBar:ee(t.showStatusBar,this.defaultValue.showStatusBar),preview:ee(t.preview,this.defaultValue.preview),previewMode:st(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ee(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ee(t.showMethods,this.defaultValue.showMethods),showFunctions:ee(t.showFunctions,this.defaultValue.showFunctions),showConstructors:ee(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:ee(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ee(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ee(t.showFields,this.defaultValue.showFields),showVariables:ee(t.showVariables,this.defaultValue.showVariables),showClasses:ee(t.showClasses,this.defaultValue.showClasses),showStructs:ee(t.showStructs,this.defaultValue.showStructs),showInterfaces:ee(t.showInterfaces,this.defaultValue.showInterfaces),showModules:ee(t.showModules,this.defaultValue.showModules),showProperties:ee(t.showProperties,this.defaultValue.showProperties),showEvents:ee(t.showEvents,this.defaultValue.showEvents),showOperators:ee(t.showOperators,this.defaultValue.showOperators),showUnits:ee(t.showUnits,this.defaultValue.showUnits),showValues:ee(t.showValues,this.defaultValue.showValues),showConstants:ee(t.showConstants,this.defaultValue.showConstants),showEnums:ee(t.showEnums,this.defaultValue.showEnums),showEnumMembers:ee(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ee(t.showKeywords,this.defaultValue.showKeywords),showWords:ee(t.showWords,this.defaultValue.showWords),showColors:ee(t.showColors,this.defaultValue.showColors),showFiles:ee(t.showFiles,this.defaultValue.showFiles),showReferences:ee(t.showReferences,this.defaultValue.showReferences),showFolders:ee(t.showFolders,this.defaultValue.showFolders),showTypeParameters:ee(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ee(t.showSnippets,this.defaultValue.showSnippets),showUsers:ee(t.showUsers,this.defaultValue.showUsers),showIssues:ee(t.showIssues,this.defaultValue.showIssues)}}},CU=class extends at{constructor(){super(129,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:d(535,null),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:d(536,null),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:ee(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ee(e.selectSubwords,this.defaultValue.selectSubwords)}}},kU=class extends at{constructor(){const e=[];super(147,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:d(537,null),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}},kC;(function(e){e[e.None=0]="None",e[e.Same=1]="Same",e[e.Indent=2]="Indent",e[e.DeepIndent=3]="DeepIndent"})(kC||(kC={}));var $U=class extends at{constructor(){super(155,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[d(538,null),d(539,null),d(540,null),d(541,null)],description:d(542,null),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}},IU=class extends Vn{constructor(){super(166,{isDominatedByLongLines:!1,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1})}compute(e,t,i){const s=t.get(165);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}},DU=class extends at{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(43,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(543,null)},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:d(544,null),enum:["afterDrop","never"],enumDescriptions:[d(545,null),d(546,null)],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),showDropSelector:st(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},PU=class extends at{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(97,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(547,null)},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:d(548,null),enum:["afterPaste","never"],enumDescriptions:[d(549,null),d(550,null)],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),showPasteSelector:st(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},TU=[];function N(e){return TU[e.id]=e,e}var $C;(function(e){e[e.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",e[e.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",e[e.accessibilitySupport=2]="accessibilitySupport",e[e.accessibilityPageSize=3]="accessibilityPageSize",e[e.allowOverflow=4]="allowOverflow",e[e.allowVariableLineHeights=5]="allowVariableLineHeights",e[e.allowVariableFonts=6]="allowVariableFonts",e[e.allowVariableFontsInAccessibilityMode=7]="allowVariableFontsInAccessibilityMode",e[e.ariaLabel=8]="ariaLabel",e[e.ariaRequired=9]="ariaRequired",e[e.autoClosingBrackets=10]="autoClosingBrackets",e[e.autoClosingComments=11]="autoClosingComments",e[e.screenReaderAnnounceInlineSuggestion=12]="screenReaderAnnounceInlineSuggestion",e[e.autoClosingDelete=13]="autoClosingDelete",e[e.autoClosingOvertype=14]="autoClosingOvertype",e[e.autoClosingQuotes=15]="autoClosingQuotes",e[e.autoIndent=16]="autoIndent",e[e.autoIndentOnPaste=17]="autoIndentOnPaste",e[e.autoIndentOnPasteWithinString=18]="autoIndentOnPasteWithinString",e[e.automaticLayout=19]="automaticLayout",e[e.autoSurround=20]="autoSurround",e[e.bracketPairColorization=21]="bracketPairColorization",e[e.guides=22]="guides",e[e.codeLens=23]="codeLens",e[e.codeLensFontFamily=24]="codeLensFontFamily",e[e.codeLensFontSize=25]="codeLensFontSize",e[e.colorDecorators=26]="colorDecorators",e[e.colorDecoratorsLimit=27]="colorDecoratorsLimit",e[e.columnSelection=28]="columnSelection",e[e.comments=29]="comments",e[e.contextmenu=30]="contextmenu",e[e.copyWithSyntaxHighlighting=31]="copyWithSyntaxHighlighting",e[e.cursorBlinking=32]="cursorBlinking",e[e.cursorSmoothCaretAnimation=33]="cursorSmoothCaretAnimation",e[e.cursorStyle=34]="cursorStyle",e[e.cursorSurroundingLines=35]="cursorSurroundingLines",e[e.cursorSurroundingLinesStyle=36]="cursorSurroundingLinesStyle",e[e.cursorWidth=37]="cursorWidth",e[e.cursorHeight=38]="cursorHeight",e[e.disableLayerHinting=39]="disableLayerHinting",e[e.disableMonospaceOptimizations=40]="disableMonospaceOptimizations",e[e.domReadOnly=41]="domReadOnly",e[e.dragAndDrop=42]="dragAndDrop",e[e.dropIntoEditor=43]="dropIntoEditor",e[e.editContext=44]="editContext",e[e.emptySelectionClipboard=45]="emptySelectionClipboard",e[e.experimentalGpuAcceleration=46]="experimentalGpuAcceleration",e[e.experimentalWhitespaceRendering=47]="experimentalWhitespaceRendering",e[e.extraEditorClassName=48]="extraEditorClassName",e[e.fastScrollSensitivity=49]="fastScrollSensitivity",e[e.find=50]="find",e[e.fixedOverflowWidgets=51]="fixedOverflowWidgets",e[e.folding=52]="folding",e[e.foldingStrategy=53]="foldingStrategy",e[e.foldingHighlight=54]="foldingHighlight",e[e.foldingImportsByDefault=55]="foldingImportsByDefault",e[e.foldingMaximumRegions=56]="foldingMaximumRegions",e[e.unfoldOnClickAfterEndOfLine=57]="unfoldOnClickAfterEndOfLine",e[e.fontFamily=58]="fontFamily",e[e.fontInfo=59]="fontInfo",e[e.fontLigatures=60]="fontLigatures",e[e.fontSize=61]="fontSize",e[e.fontWeight=62]="fontWeight",e[e.fontVariations=63]="fontVariations",e[e.formatOnPaste=64]="formatOnPaste",e[e.formatOnType=65]="formatOnType",e[e.glyphMargin=66]="glyphMargin",e[e.gotoLocation=67]="gotoLocation",e[e.hideCursorInOverviewRuler=68]="hideCursorInOverviewRuler",e[e.hover=69]="hover",e[e.inDiffEditor=70]="inDiffEditor",e[e.inlineSuggest=71]="inlineSuggest",e[e.letterSpacing=72]="letterSpacing",e[e.lightbulb=73]="lightbulb",e[e.lineDecorationsWidth=74]="lineDecorationsWidth",e[e.lineHeight=75]="lineHeight",e[e.lineNumbers=76]="lineNumbers",e[e.lineNumbersMinChars=77]="lineNumbersMinChars",e[e.linkedEditing=78]="linkedEditing",e[e.links=79]="links",e[e.matchBrackets=80]="matchBrackets",e[e.minimap=81]="minimap",e[e.mouseStyle=82]="mouseStyle",e[e.mouseWheelScrollSensitivity=83]="mouseWheelScrollSensitivity",e[e.mouseWheelZoom=84]="mouseWheelZoom",e[e.multiCursorMergeOverlapping=85]="multiCursorMergeOverlapping",e[e.multiCursorModifier=86]="multiCursorModifier",e[e.mouseMiddleClickAction=87]="mouseMiddleClickAction",e[e.multiCursorPaste=88]="multiCursorPaste",e[e.multiCursorLimit=89]="multiCursorLimit",e[e.occurrencesHighlight=90]="occurrencesHighlight",e[e.occurrencesHighlightDelay=91]="occurrencesHighlightDelay",e[e.overtypeCursorStyle=92]="overtypeCursorStyle",e[e.overtypeOnPaste=93]="overtypeOnPaste",e[e.overviewRulerBorder=94]="overviewRulerBorder",e[e.overviewRulerLanes=95]="overviewRulerLanes",e[e.padding=96]="padding",e[e.pasteAs=97]="pasteAs",e[e.parameterHints=98]="parameterHints",e[e.peekWidgetDefaultFocus=99]="peekWidgetDefaultFocus",e[e.placeholder=100]="placeholder",e[e.definitionLinkOpensInPeek=101]="definitionLinkOpensInPeek",e[e.quickSuggestions=102]="quickSuggestions",e[e.quickSuggestionsDelay=103]="quickSuggestionsDelay",e[e.readOnly=104]="readOnly",e[e.readOnlyMessage=105]="readOnlyMessage",e[e.renameOnType=106]="renameOnType",e[e.renderRichScreenReaderContent=107]="renderRichScreenReaderContent",e[e.renderControlCharacters=108]="renderControlCharacters",e[e.renderFinalNewline=109]="renderFinalNewline",e[e.renderLineHighlight=110]="renderLineHighlight",e[e.renderLineHighlightOnlyWhenFocus=111]="renderLineHighlightOnlyWhenFocus",e[e.renderValidationDecorations=112]="renderValidationDecorations",e[e.renderWhitespace=113]="renderWhitespace",e[e.revealHorizontalRightPadding=114]="revealHorizontalRightPadding",e[e.roundedSelection=115]="roundedSelection",e[e.rulers=116]="rulers",e[e.scrollbar=117]="scrollbar",e[e.scrollBeyondLastColumn=118]="scrollBeyondLastColumn",e[e.scrollBeyondLastLine=119]="scrollBeyondLastLine",e[e.scrollPredominantAxis=120]="scrollPredominantAxis",e[e.selectionClipboard=121]="selectionClipboard",e[e.selectionHighlight=122]="selectionHighlight",e[e.selectionHighlightMaxLength=123]="selectionHighlightMaxLength",e[e.selectionHighlightMultiline=124]="selectionHighlightMultiline",e[e.selectOnLineNumbers=125]="selectOnLineNumbers",e[e.showFoldingControls=126]="showFoldingControls",e[e.showUnused=127]="showUnused",e[e.snippetSuggestions=128]="snippetSuggestions",e[e.smartSelect=129]="smartSelect",e[e.smoothScrolling=130]="smoothScrolling",e[e.stickyScroll=131]="stickyScroll",e[e.stickyTabStops=132]="stickyTabStops",e[e.stopRenderingLineAfter=133]="stopRenderingLineAfter",e[e.suggest=134]="suggest",e[e.suggestFontSize=135]="suggestFontSize",e[e.suggestLineHeight=136]="suggestLineHeight",e[e.suggestOnTriggerCharacters=137]="suggestOnTriggerCharacters",e[e.suggestSelection=138]="suggestSelection",e[e.tabCompletion=139]="tabCompletion",e[e.tabIndex=140]="tabIndex",e[e.trimWhitespaceOnDelete=141]="trimWhitespaceOnDelete",e[e.unicodeHighlighting=142]="unicodeHighlighting",e[e.unusualLineTerminators=143]="unusualLineTerminators",e[e.useShadowDOM=144]="useShadowDOM",e[e.useTabStops=145]="useTabStops",e[e.wordBreak=146]="wordBreak",e[e.wordSegmenterLocales=147]="wordSegmenterLocales",e[e.wordSeparators=148]="wordSeparators",e[e.wordWrap=149]="wordWrap",e[e.wordWrapBreakAfterCharacters=150]="wordWrapBreakAfterCharacters",e[e.wordWrapBreakBeforeCharacters=151]="wordWrapBreakBeforeCharacters",e[e.wordWrapColumn=152]="wordWrapColumn",e[e.wordWrapOverride1=153]="wordWrapOverride1",e[e.wordWrapOverride2=154]="wordWrapOverride2",e[e.wrappingIndent=155]="wrappingIndent",e[e.wrappingStrategy=156]="wrappingStrategy",e[e.showDeprecated=157]="showDeprecated",e[e.inertialScroll=158]="inertialScroll",e[e.inlayHints=159]="inlayHints",e[e.wrapOnEscapedLineFeeds=160]="wrapOnEscapedLineFeeds",e[e.effectiveCursorStyle=161]="effectiveCursorStyle",e[e.editorClassName=162]="editorClassName",e[e.pixelRatio=163]="pixelRatio",e[e.tabFocusMode=164]="tabFocusMode",e[e.layoutInfo=165]="layoutInfo",e[e.wrappingInfo=166]="wrappingInfo",e[e.defaultColorDecorators=167]="defaultColorDecorators",e[e.colorDecoratorsActivatedOn=168]="colorDecoratorsActivatedOn",e[e.inlineCompletionsAccessibilityVerbose=169]="inlineCompletionsAccessibilityVerbose",e[e.effectiveEditContext=170]="effectiveEditContext",e[e.scrollOnMiddleClick=171]="scrollOnMiddleClick",e[e.effectiveAllowVariableFonts=172]="effectiveAllowVariableFonts"})($C||($C={}));var Cte={acceptSuggestionOnCommitCharacter:N(new fe(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:d(551,null)})),acceptSuggestionOnEnter:N(new ct(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",d(552,null),""],markdownDescription:d(553,null)})),accessibilitySupport:N(new zF),accessibilityPageSize:N(new We(3,"accessibilityPageSize",500,1,1073741824,{description:d(554,null),tags:["accessibility"]})),allowOverflow:N(new fe(4,"allowOverflow",!0)),allowVariableLineHeights:N(new fe(5,"allowVariableLineHeights",!0,{description:d(555,null)})),allowVariableFonts:N(new fe(6,"allowVariableFonts",!0,{description:d(556,null)})),allowVariableFontsInAccessibilityMode:N(new fe(7,"allowVariableFontsInAccessibilityMode",!1,{description:d(557,null),tags:["accessibility"]})),ariaLabel:N(new Di(8,"ariaLabel",d(558,null))),ariaRequired:N(new fe(9,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:N(new fe(12,"screenReaderAnnounceInlineSuggestion",!0,{description:d(559,null),tags:["accessibility"]})),autoClosingBrackets:N(new ct(10,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(560,null),d(561,null),""],description:d(562,null)})),autoClosingComments:N(new ct(11,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(563,null),d(564,null),""],description:d(565,null)})),autoClosingDelete:N(new ct(13,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",d(566,null),""],description:d(567,null)})),autoClosingOvertype:N(new ct(14,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",d(568,null),""],description:d(569,null)})),autoClosingQuotes:N(new ct(15,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(570,null),d(571,null),""],description:d(572,null)})),autoIndent:N(new wu(16,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],jF,{enumDescriptions:[d(573,null),d(574,null),d(575,null),d(576,null),d(577,null)],description:d(578,null)})),autoIndentOnPaste:N(new fe(17,"autoIndentOnPaste",!1,{description:d(579,null)})),autoIndentOnPasteWithinString:N(new fe(18,"autoIndentOnPasteWithinString",!0,{description:d(580,null)})),automaticLayout:N(new fe(19,"automaticLayout",!1)),autoSurround:N(new ct(20,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[d(581,null),d(582,null),d(583,null),""],description:d(584,null)})),bracketPairColorization:N(new SU),bracketPairGuides:N(new EU),stickyTabStops:N(new fe(132,"stickyTabStops",!1,{description:d(585,null)})),codeLens:N(new fe(23,"codeLens",!0,{description:d(586,null)})),codeLensFontFamily:N(new Di(24,"codeLensFontFamily","",{description:d(587,null)})),codeLensFontSize:N(new We(25,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:d(588,null)})),colorDecorators:N(new fe(26,"colorDecorators",!0,{description:d(589,null)})),colorDecoratorActivatedOn:N(new ct(168,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[d(590,null),d(591,null),d(592,null)],description:d(593,null)})),colorDecoratorsLimit:N(new We(27,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:d(594,null)})),columnSelection:N(new fe(28,"columnSelection",!1,{description:d(595,null)})),comments:N(new HF),contextmenu:N(new fe(30,"contextmenu",!0)),copyWithSyntaxHighlighting:N(new fe(31,"copyWithSyntaxHighlighting",!0,{description:d(596,null)})),cursorBlinking:N(new wu(32,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],WF,{description:d(597,null)})),cursorSmoothCaretAnimation:N(new ct(33,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[d(598,null),d(599,null),d(600,null)],description:d(601,null)})),cursorStyle:N(new wu(34,"cursorStyle",Ds.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],SC,{description:d(602,null)})),overtypeCursorStyle:N(new wu(92,"overtypeCursorStyle",Ds.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],SC,{description:d(603,null)})),cursorSurroundingLines:N(new We(35,"cursorSurroundingLines",0,0,1073741824,{description:d(604,null)})),cursorSurroundingLinesStyle:N(new ct(36,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[d(605,null),d(606,null)],markdownDescription:d(607,null)})),cursorWidth:N(new We(37,"cursorWidth",0,0,1073741824,{markdownDescription:d(608,null)})),cursorHeight:N(new We(38,"cursorHeight",0,0,1073741824,{markdownDescription:d(609,null)})),disableLayerHinting:N(new fe(39,"disableLayerHinting",!1)),disableMonospaceOptimizations:N(new fe(40,"disableMonospaceOptimizations",!1)),domReadOnly:N(new fe(41,"domReadOnly",!1)),dragAndDrop:N(new fe(42,"dragAndDrop",!0,{description:d(610,null)})),emptySelectionClipboard:N(new _F),dropIntoEditor:N(new DU),editContext:N(new fe(44,"editContext",!0,{description:d(611,null),included:Ov||LE||$E})),renderRichScreenReaderContent:N(new fe(107,"renderRichScreenReaderContent",!1,{markdownDescription:d(612,null)})),stickyScroll:N(new nU),experimentalGpuAcceleration:N(new ct(46,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[d(613,null),d(614,null)],description:d(615,null)})),experimentalWhitespaceRendering:N(new ct(47,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[d(616,null),d(617,null),d(618,null)],description:d(619,null)})),extraEditorClassName:N(new Di(48,"extraEditorClassName","")),fastScrollSensitivity:N(new Is(49,"fastScrollSensitivity",5,e=>e<=0?5:e,{markdownDescription:d(620,null)})),find:N(new VF),fixedOverflowWidgets:N(new fe(51,"fixedOverflowWidgets",!1)),folding:N(new fe(52,"folding",!0,{description:d(621,null)})),foldingStrategy:N(new ct(53,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[d(622,null),d(623,null)],description:d(624,null)})),foldingHighlight:N(new fe(54,"foldingHighlight",!0,{description:d(625,null)})),foldingImportsByDefault:N(new fe(55,"foldingImportsByDefault",!1,{description:d(626,null)})),foldingMaximumRegions:N(new We(56,"foldingMaximumRegions",5e3,10,65e3,{description:d(627,null)})),unfoldOnClickAfterEndOfLine:N(new fe(57,"unfoldOnClickAfterEndOfLine",!1,{description:d(628,null)})),fontFamily:N(new Di(58,"fontFamily",Ar.fontFamily,{description:d(629,null)})),fontInfo:N(new JF),fontLigatures2:N(new qF),fontSize:N(new XF),fontWeight:N(new KF),fontVariations:N(new GF),formatOnPaste:N(new fe(64,"formatOnPaste",!1,{description:d(630,null)})),formatOnType:N(new fe(65,"formatOnType",!1,{description:d(631,null)})),glyphMargin:N(new fe(66,"glyphMargin",!0,{description:d(632,null)})),gotoLocation:N(new eU),hideCursorInOverviewRuler:N(new fe(68,"hideCursorInOverviewRuler",!1,{description:d(633,null)})),hover:N(new tU),inDiffEditor:N(new fe(70,"inDiffEditor",!1)),inertialScroll:N(new fe(158,"inertialScroll",!1,{description:d(634,null)})),letterSpacing:N(new Is(72,"letterSpacing",Ar.letterSpacing,e=>Is.clamp(e,-5,20),{description:d(635,null)})),lightbulb:N(new rU),lineDecorationsWidth:N(new aU),lineHeight:N(new cU),lineNumbers:N(new mU),lineNumbersMinChars:N(new We(77,"lineNumbersMinChars",5,1,300)),linkedEditing:N(new fe(78,"linkedEditing",!1,{description:d(636,null)})),links:N(new fe(79,"links",!0,{description:d(637,null)})),matchBrackets:N(new ct(80,"matchBrackets","always",["always","near","never"],{description:d(638,null)})),minimap:N(new lU),mouseStyle:N(new ct(82,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:N(new Is(83,"mouseWheelScrollSensitivity",1,e=>e===0?1:e,{markdownDescription:d(639,null)})),mouseWheelZoom:N(new fe(84,"mouseWheelZoom",!1,{markdownDescription:d(Pt?640:641,null)})),multiCursorMergeOverlapping:N(new fe(85,"multiCursorMergeOverlapping",!0,{description:d(642,null)})),multiCursorModifier:N(new wu(86,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],uU,{markdownEnumDescriptions:[d(643,null),d(644,null)],markdownDescription:d(645,null)})),mouseMiddleClickAction:N(new ct(87,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:d(646,null)})),multiCursorPaste:N(new ct(88,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[d(647,null),d(648,null)],markdownDescription:d(649,null)})),multiCursorLimit:N(new We(89,"multiCursorLimit",1e4,1,1e5,{markdownDescription:d(650,null)})),occurrencesHighlight:N(new ct(90,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[d(651,null),d(652,null),d(653,null)],markdownDescription:d(654,null)})),occurrencesHighlightDelay:N(new We(91,"occurrencesHighlightDelay",0,0,2e3,{description:d(655,null),tags:["preview"]})),overtypeOnPaste:N(new fe(93,"overtypeOnPaste",!0,{description:d(656,null)})),overviewRulerBorder:N(new fe(94,"overviewRulerBorder",!0,{description:d(657,null)})),overviewRulerLanes:N(new We(95,"overviewRulerLanes",3,0,3)),padding:N(new hU),pasteAs:N(new PU),parameterHints:N(new dU),peekWidgetDefaultFocus:N(new ct(99,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[d(658,null),d(659,null)],description:d(660,null)})),placeholder:N(new pU),definitionLinkOpensInPeek:N(new fe(101,"definitionLinkOpensInPeek",!1,{description:d(661,null)})),quickSuggestions:N(new gU),quickSuggestionsDelay:N(new We(103,"quickSuggestionsDelay",10,0,1073741824,{description:d(662,null),experiment:{mode:"auto"}})),readOnly:N(new fe(104,"readOnly",!1)),readOnlyMessage:N(new wU),renameOnType:N(new fe(106,"renameOnType",!1,{description:d(663,null),markdownDeprecationMessage:d(664,null)})),renderControlCharacters:N(new fe(108,"renderControlCharacters",!0,{description:d(665,null),restricted:!0})),renderFinalNewline:N(new ct(109,"renderFinalNewline",$t?"dimmed":"on",["off","on","dimmed"],{description:d(666,null)})),renderLineHighlight:N(new ct(110,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",d(667,null)],description:d(668,null)})),renderLineHighlightOnlyWhenFocus:N(new fe(111,"renderLineHighlightOnlyWhenFocus",!1,{description:d(669,null)})),renderValidationDecorations:N(new ct(112,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:N(new ct(113,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",d(670,null),d(671,null),d(672,null),""],description:d(673,null)})),revealHorizontalRightPadding:N(new We(114,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:N(new fe(115,"roundedSelection",!0,{description:d(674,null)})),rulers:N(new vU),scrollbar:N(new bU),scrollBeyondLastColumn:N(new We(118,"scrollBeyondLastColumn",4,0,1073741824,{description:d(675,null)})),scrollBeyondLastLine:N(new fe(119,"scrollBeyondLastLine",!0,{description:d(676,null)})),scrollOnMiddleClick:N(new fe(171,"scrollOnMiddleClick",!1,{description:d(677,null)})),scrollPredominantAxis:N(new fe(120,"scrollPredominantAxis",!0,{description:d(678,null)})),selectionClipboard:N(new fe(121,"selectionClipboard",!0,{description:d(679,null),included:$t})),selectionHighlight:N(new fe(122,"selectionHighlight",!0,{description:d(680,null)})),selectionHighlightMaxLength:N(new We(123,"selectionHighlightMaxLength",200,0,1073741824,{description:d(681,null)})),selectionHighlightMultiline:N(new fe(124,"selectionHighlightMultiline",!1,{description:d(682,null)})),selectOnLineNumbers:N(new fe(125,"selectOnLineNumbers",!0)),showFoldingControls:N(new ct(126,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[d(683,null),d(684,null),d(685,null)],description:d(686,null)})),showUnused:N(new fe(127,"showUnused",!0,{description:d(687,null)})),showDeprecated:N(new fe(157,"showDeprecated",!0,{description:d(688,null)})),inlayHints:N(new oU),snippetSuggestions:N(new ct(128,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[d(689,null),d(690,null),d(691,null),d(692,null)],description:d(693,null)})),smartSelect:N(new CU),smoothScrolling:N(new fe(130,"smoothScrolling",!1,{description:d(694,null)})),stopRenderingLineAfter:N(new We(133,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:N(new xU),inlineSuggest:N(new AU),inlineCompletionsAccessibilityVerbose:N(new fe(169,"inlineCompletionsAccessibilityVerbose",!1,{description:d(695,null)})),suggestFontSize:N(new We(135,"suggestFontSize",0,0,1e3,{markdownDescription:d(696,null,"`0`","`#editor.fontSize#`")})),suggestLineHeight:N(new We(136,"suggestLineHeight",0,0,1e3,{markdownDescription:d(697,null,"`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:N(new fe(137,"suggestOnTriggerCharacters",!0,{description:d(698,null)})),suggestSelection:N(new ct(138,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[d(699,null),d(700,null),d(701,null)],description:d(702,null)})),tabCompletion:N(new ct(139,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[d(703,null),d(704,null),d(705,null)],description:d(706,null)})),tabIndex:N(new We(140,"tabIndex",0,-1,1073741824)),trimWhitespaceOnDelete:N(new fe(141,"trimWhitespaceOnDelete",!1,{description:d(707,null)})),unicodeHighlight:N(new yU),unusualLineTerminators:N(new ct(143,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[d(708,null),d(709,null),d(710,null)],description:d(711,null)})),useShadowDOM:N(new fe(144,"useShadowDOM",!0)),useTabStops:N(new fe(145,"useTabStops",!0,{description:d(712,null)})),wordBreak:N(new ct(146,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[d(713,null),d(714,null)],description:d(715,null)})),wordSegmenterLocales:N(new kU),wordSeparators:N(new Di(148,"wordSeparators",mC,{description:d(716,null)})),wordWrap:N(new ct(149,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[d(717,null),d(718,null),d(719,null),d(720,null)],description:d(721,null)})),wordWrapBreakAfterCharacters:N(new Di(150,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:N(new Di(151,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:N(new We(152,"wordWrapColumn",80,1,1073741824,{markdownDescription:d(722,null)})),wordWrapOverride1:N(new ct(153,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:N(new ct(154,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:N(new fe(160,"wrapOnEscapedLineFeeds",!1,{markdownDescription:d(723,null)})),effectiveCursorStyle:N(new ZF),editorClassName:N(new BF),defaultColorDecorators:N(new ct(167,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[d(724,null),d(725,null),d(726,null)],description:d(727,null)})),pixelRatio:N(new fU),tabFocusMode:N(new fe(164,"tabFocusMode",!1,{markdownDescription:d(728,null)})),layoutInfo:N(new iU),wrappingInfo:N(new IU),wrappingIndent:N(new $U),wrappingStrategy:N(new sU),effectiveEditContextEnabled:N(new QF),effectiveAllowVariableFonts:N(new YF)},es,m0=globalThis.vscode;if(typeof m0<"u"&&typeof m0.context<"u"){const e=m0.context.configuration();if(e)es=e.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(es=globalThis._VSCODE_PRODUCT_JSON,On.VSCODE_DEV&&Object.assign(es,{nameShort:`${es.nameShort} Dev`,nameLong:`${es.nameLong} Dev`,dataFolderName:`${es.dataFolderName}-dev`,serverDataFolderName:es.serverDataFolderName?`${es.serverDataFolderName}-dev`:void 0}),!es.version){const e=globalThis._VSCODE_PACKAGE_JSON;Object.assign(es,{version:e.version})}}else es={nameShort:"Code - OSS",nameLong:"Code - OSS",applicationName:"code-oss",dataFolderName:".vscode-oss",win32MutexName:"vscodeoss",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverGreeting:[],serverLicense:[],serverLicensePrompt:"",serverApplicationName:"code-server-oss",serverDataFolderName:".vscode-server-oss",tunnelApplicationName:"code-tunnel-oss",win32DirName:"Microsoft Code OSS",win32NameVersion:"Microsoft Code OSS",win32RegValueName:"CodeOSS",win32x64AppId:"{{D77B7E06-80BA-4137-BCF4-654B95CCEBC5}",win32arm64AppId:"{{D1ACE434-89C5-48D1-88D3-E2991DF85475}",win32x64UserAppId:"{{CC6B787D-37A0-49E8-AE24-8559A032BE0C}",win32arm64UserAppId:"{{3AEBF0C8-F733-4AD4-BADE-FDB816D53D7B}",win32AppUserModelId:"Microsoft.CodeOSS",win32ShellNameShort:"C&ode - OSS",win32TunnelServiceMutex:"vscodeoss-tunnelservice",win32TunnelMutex:"vscodeoss-tunnel",darwinBundleIdentifier:"com.visualstudio.code.oss",darwinProfileUUID:"47827DD9-4734-49A0-AF80-7E19B11495CC",darwinProfilePayloadUUID:"CF808BE7-53F3-46C6-A7E2-7EDB98A5E959",linuxIconName:"code-oss",licenseFileName:"LICENSE.txt",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",nodejsRepository:"https://nodejs.org",urlProtocol:"code-oss",webviewContentExternalBaseUrlTemplate:"https://{{uuid}}.vscode-cdn.net/insider/ef65ac1ba57f57f2a3961bfe94aa20481caca4c6/out/vs/workbench/contrib/webview/browser/pre/",builtInExtensions:[{name:"ms-vscode.js-debug-companion",version:"1.1.3",sha256:"7380a890787452f14b2db7835dfa94de538caf358ebc263f9d46dd68ac52de93",repo:"https://github.com/microsoft/vscode-js-debug-companion",metadata:{id:"99cb0b7f-7354-4278-b8da-6cc79972169d",publisherId:{publisherId:"5f5636e7-69ed-4afe-b5d6-8d231fb3d3ee",publisherName:"ms-vscode",displayName:"Microsoft",flags:"verified"},publisherDisplayName:"Microsoft"}},{name:"ms-vscode.js-debug",version:"1.105.0",sha256:"0c45b90342e8aafd4ff2963b4006de64208ca58c2fd01fea7a710fe61dcfd12a",repo:"https://github.com/microsoft/vscode-js-debug",metadata:{id:"25629058-ddac-4e17-abba-74678e126c5d",publisherId:{publisherId:"5f5636e7-69ed-4afe-b5d6-8d231fb3d3ee",publisherName:"ms-vscode",displayName:"Microsoft",flags:"verified"},publisherDisplayName:"Microsoft"}},{name:"ms-vscode.vscode-js-profile-table",version:"1.0.10",sha256:"7361748ddf9fd09d8a2ed1f2a2d7376a2cf9aae708692820b799708385c38e08",repo:"https://github.com/microsoft/vscode-js-profile-visualizer",metadata:{id:"7e52b41b-71ad-457b-ab7e-0620f1fc4feb",publisherId:{publisherId:"5f5636e7-69ed-4afe-b5d6-8d231fb3d3ee",publisherName:"ms-vscode",displayName:"Microsoft",flags:"verified"},publisherDisplayName:"Microsoft"}}],defaultChatAgent:{extensionId:"GitHub.copilot",chatExtensionId:"GitHub.copilot-chat",documentationUrl:"https://aka.ms/github-copilot-overview",termsStatementUrl:"https://aka.ms/github-copilot-terms-statement",privacyStatementUrl:"https://aka.ms/github-copilot-privacy-statement",skusDocumentationUrl:"https://aka.ms/github-copilot-plans",publicCodeMatchesUrl:"https://aka.ms/github-copilot-match-public-code",manageSettingsUrl:"https://aka.ms/github-copilot-settings",managePlanUrl:"https://aka.ms/github-copilot-manage-plan",manageOverageUrl:"https://aka.ms/github-copilot-manage-overage",upgradePlanUrl:"https://aka.ms/github-copilot-upgrade-plan",signUpUrl:"https://aka.ms/github-sign-up",provider:{default:{id:"github",name:"GitHub"},enterprise:{id:"github-enterprise",name:"GHE.com"},google:{id:"google",name:"Google"},apple:{id:"apple",name:"Apple"}},providerUriSetting:"github-enterprise.uri",providerScopes:[["read:user","user:email","repo","workflow"],["user:email"],["read:user"]],entitlementUrl:"https://api.github.com/copilot_internal/user",entitlementSignupLimitedUrl:"https://api.github.com/copilot_internal/subscribe_limited_user",chatQuotaExceededContext:"github.copilot.chat.quotaExceeded",completionsQuotaExceededContext:"github.copilot.completions.quotaExceeded",walkthroughCommand:"github.copilot.open.walkthrough",completionsMenuCommand:"github.copilot.toggleStatusMenu",completionsRefreshTokenCommand:"github.copilot.signIn",chatRefreshTokenCommand:"github.copilot.refreshToken",generateCommitMessageCommand:"github.copilot.git.generateCommitMessage",resolveMergeConflictsCommand:"github.copilot.git.resolveMergeConflicts",completionsAdvancedSetting:"github.copilot.advanced",completionsEnablementSetting:"github.copilot.enable",nextEditSuggestionsSetting:"github.copilot.nextEditSuggestions.enabled"},trustedExtensionAuthAccess:{github:["GitHub.copilot-chat"],"github-enterprise":["GitHub.copilot-chat"]},version:"1.108.0",commit:"2064368b65eca34492249241745ca3b9d4b7bc5d",date:"2025-12-31T14:47:27.055Z"},Object.keys(es).length===0&&Object.assign(es,{version:"1.104.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var yi=es,IC=class rM{static{this.count=0}constructor(t){this._proxyIdentifierBrand=void 0,this.sid=t,this.nid=++rM.count}},DC=[];function M(e){const t=new IC(e);return DC[t.nid]=t,t}function Df(e){return DC[e].sid}var pi=class{constructor(e){this.value=e}},PC;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(PC||(PC={}));var TC;(function(e){e[e.UnknownInput=0]="UnknownInput",e[e.TextInput=1]="TextInput",e[e.TextDiffInput=2]="TextDiffInput",e[e.TextMergeInput=3]="TextMergeInput",e[e.NotebookInput=4]="NotebookInput",e[e.NotebookDiffInput=5]="NotebookDiffInput",e[e.CustomEditorInput=6]="CustomEditorInput",e[e.WebviewEditorInput=7]="WebviewEditorInput",e[e.TerminalEditorInput=8]="TerminalEditorInput",e[e.InteractiveEditorInput=9]="InteractiveEditorInput",e[e.ChatEditorInput=10]="ChatEditorInput",e[e.MultiDiffEditorInput=11]="MultiDiffEditorInput"})(TC||(TC={}));var NC;(function(e){e[e.TAB_OPEN=0]="TAB_OPEN",e[e.TAB_CLOSE=1]="TAB_CLOSE",e[e.TAB_UPDATE=2]="TAB_UPDATE",e[e.TAB_MOVE=3]="TAB_MOVE"})(NC||(NC={}));var MC;(function(e){e[e.Editable=0]="Editable",e[e.SupportsHotExit=1]="SupportsHotExit"})(MC||(MC={}));var LC;(function(e){e[e.Int8Array=1]="Int8Array",e[e.Uint8Array=2]="Uint8Array",e[e.Uint8ClampedArray=3]="Uint8ClampedArray",e[e.Int16Array=4]="Int16Array",e[e.Uint16Array=5]="Uint16Array",e[e.Int32Array=6]="Int32Array",e[e.Uint32Array=7]="Uint32Array",e[e.Float32Array=8]="Float32Array",e[e.Float64Array=9]="Float64Array",e[e.BigInt64Array=10]="BigInt64Array",e[e.BigUint64Array=11]="BigUint64Array"})(LC||(LC={}));var RC;(function(e){e[e.Text=1]="Text",e[e.Error=2]="Error",e[e.Rich=3]="Rich"})(RC||(RC={}));var OC;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(OC||(OC={}));var v0;(function(e){e[e.None=0]="None",e[e.Process=1]="Process",e[e.Output=2]="Output",e[e.Hybrid=3]="Hybrid"})(v0||(v0={}));var kte=class nM{static{this.a=0}static mixin(t){return t._id=nM.a++,t}},FC;(function(e){e.label="a",e.kind="b",e.detail="c",e.documentation="d",e.sortText="e",e.filterText="f",e.preselect="g",e.insertText="h",e.insertTextRules="i",e.range="j",e.commitCharacters="k",e.additionalTextEdits="l",e.kindModifier="m",e.commandIdent="n",e.commandId="o",e.commandArguments="p"})(FC||(FC={}));var UC;(function(e){e.defaultRanges="a",e.completions="b",e.isIncomplete="c",e.duration="d"})(UC||(UC={}));var jC;(function(e){e[e.Workspace=0]="Workspace",e[e.TextDocument=1]="TextDocument"})(jC||(jC={}));var Y={MainThreadAuthentication:M("MainThreadAuthentication"),MainThreadBulkEdits:M("MainThreadBulkEdits"),MainThreadLanguageModels:M("MainThreadLanguageModels"),MainThreadEmbeddings:M("MainThreadEmbeddings"),MainThreadChatAgents2:M("MainThreadChatAgents2"),MainThreadCodeMapper:M("MainThreadCodeMapper"),MainThreadLanguageModelTools:M("MainThreadChatSkills"),MainThreadClipboard:M("MainThreadClipboard"),MainThreadCommands:M("MainThreadCommands"),MainThreadComments:M("MainThreadComments"),MainThreadConfiguration:M("MainThreadConfiguration"),MainThreadConsole:M("MainThreadConsole"),MainThreadDebugService:M("MainThreadDebugService"),MainThreadDecorations:M("MainThreadDecorations"),MainThreadDiagnostics:M("MainThreadDiagnostics"),MainThreadDialogs:M("MainThreadDiaglogs"),MainThreadDocuments:M("MainThreadDocuments"),MainThreadDocumentContentProviders:M("MainThreadDocumentContentProviders"),MainThreadTextEditors:M("MainThreadTextEditors"),MainThreadEditorInsets:M("MainThreadEditorInsets"),MainThreadEditorTabs:M("MainThreadEditorTabs"),MainThreadErrors:M("MainThreadErrors"),MainThreadTreeViews:M("MainThreadTreeViews"),MainThreadDownloadService:M("MainThreadDownloadService"),MainThreadLanguageFeatures:M("MainThreadLanguageFeatures"),MainThreadLanguages:M("MainThreadLanguages"),MainThreadLogger:M("MainThreadLogger"),MainThreadMessageService:M("MainThreadMessageService"),MainThreadOutputService:M("MainThreadOutputService"),MainThreadProgress:M("MainThreadProgress"),MainThreadQuickDiff:M("MainThreadQuickDiff"),MainThreadQuickOpen:M("MainThreadQuickOpen"),MainThreadStatusBar:M("MainThreadStatusBar"),MainThreadSecretState:M("MainThreadSecretState"),MainThreadStorage:M("MainThreadStorage"),MainThreadSpeech:M("MainThreadSpeechProvider"),MainThreadTelemetry:M("MainThreadTelemetry"),MainThreadTerminalService:M("MainThreadTerminalService"),MainThreadTerminalShellIntegration:M("MainThreadTerminalShellIntegration"),MainThreadWebviews:M("MainThreadWebviews"),MainThreadWebviewPanels:M("MainThreadWebviewPanels"),MainThreadWebviewViews:M("MainThreadWebviewViews"),MainThreadCustomEditors:M("MainThreadCustomEditors"),MainThreadUrls:M("MainThreadUrls"),MainThreadUriOpeners:M("MainThreadUriOpeners"),MainThreadProfileContentHandlers:M("MainThreadProfileContentHandlers"),MainThreadWorkspace:M("MainThreadWorkspace"),MainThreadFileSystem:M("MainThreadFileSystem"),MainThreadFileSystemEventService:M("MainThreadFileSystemEventService"),MainThreadExtensionService:M("MainThreadExtensionService"),MainThreadSCM:M("MainThreadSCM"),MainThreadSearch:M("MainThreadSearch"),MainThreadShare:M("MainThreadShare"),MainThreadTask:M("MainThreadTask"),MainThreadWindow:M("MainThreadWindow"),MainThreadLabelService:M("MainThreadLabelService"),MainThreadNotebook:M("MainThreadNotebook"),MainThreadNotebookDocuments:M("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:M("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:M("MainThreadNotebookKernels"),MainThreadNotebookRenderers:M("MainThreadNotebookRenderers"),MainThreadInteractive:M("MainThreadInteractive"),MainThreadTheming:M("MainThreadTheming"),MainThreadTunnelService:M("MainThreadTunnelService"),MainThreadManagedSockets:M("MainThreadManagedSockets"),MainThreadTimeline:M("MainThreadTimeline"),MainThreadTesting:M("MainThreadTesting"),MainThreadLocalization:M("MainThreadLocalizationShape"),MainThreadMcp:M("MainThreadMcpShape"),MainThreadAiRelatedInformation:M("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:M("MainThreadAiEmbeddingVector"),MainThreadChatStatus:M("MainThreadChatStatus"),MainThreadAiSettingsSearch:M("MainThreadAiSettingsSearch"),MainThreadDataChannels:M("MainThreadDataChannels"),MainThreadChatSessions:M("MainThreadChatSessions"),MainThreadChatOutputRenderer:M("MainThreadChatOutputRenderer"),MainThreadChatContext:M("MainThreadChatContext")},ne={ExtHostCodeMapper:M("ExtHostCodeMapper"),ExtHostCommands:M("ExtHostCommands"),ExtHostConfiguration:M("ExtHostConfiguration"),ExtHostDiagnostics:M("ExtHostDiagnostics"),ExtHostDebugService:M("ExtHostDebugService"),ExtHostDecorations:M("ExtHostDecorations"),ExtHostDocumentsAndEditors:M("ExtHostDocumentsAndEditors"),ExtHostDocuments:M("ExtHostDocuments"),ExtHostDocumentContentProviders:M("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:M("ExtHostDocumentSaveParticipant"),ExtHostEditors:M("ExtHostEditors"),ExtHostTreeViews:M("ExtHostTreeViews"),ExtHostFileSystem:M("ExtHostFileSystem"),ExtHostFileSystemInfo:M("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:M("ExtHostFileSystemEventService"),ExtHostLanguages:M("ExtHostLanguages"),ExtHostLanguageFeatures:M("ExtHostLanguageFeatures"),ExtHostQuickOpen:M("ExtHostQuickOpen"),ExtHostQuickDiff:M("ExtHostQuickDiff"),ExtHostStatusBar:M("ExtHostStatusBar"),ExtHostShare:M("ExtHostShare"),ExtHostExtensionService:M("ExtHostExtensionService"),ExtHostLogLevelServiceShape:M("ExtHostLogLevelServiceShape"),ExtHostTerminalService:M("ExtHostTerminalService"),ExtHostTerminalShellIntegration:M("ExtHostTerminalShellIntegration"),ExtHostSCM:M("ExtHostSCM"),ExtHostSearch:M("ExtHostSearch"),ExtHostTask:M("ExtHostTask"),ExtHostWorkspace:M("ExtHostWorkspace"),ExtHostWindow:M("ExtHostWindow"),ExtHostWebviews:M("ExtHostWebviews"),ExtHostWebviewPanels:M("ExtHostWebviewPanels"),ExtHostCustomEditors:M("ExtHostCustomEditors"),ExtHostWebviewViews:M("ExtHostWebviewViews"),ExtHostEditorInsets:M("ExtHostEditorInsets"),ExtHostEditorTabs:M("ExtHostEditorTabs"),ExtHostProgress:M("ExtHostProgress"),ExtHostComments:M("ExtHostComments"),ExtHostSecretState:M("ExtHostSecretState"),ExtHostStorage:M("ExtHostStorage"),ExtHostUrls:M("ExtHostUrls"),ExtHostUriOpeners:M("ExtHostUriOpeners"),ExtHostChatOutputRenderer:M("ExtHostChatOutputRenderer"),ExtHostProfileContentHandlers:M("ExtHostProfileContentHandlers"),ExtHostOutputService:M("ExtHostOutputService"),ExtHostLabelService:M("ExtHostLabelService"),ExtHostNotebook:M("ExtHostNotebook"),ExtHostNotebookDocuments:M("ExtHostNotebookDocuments"),ExtHostNotebookEditors:M("ExtHostNotebookEditors"),ExtHostNotebookKernels:M("ExtHostNotebookKernels"),ExtHostNotebookRenderers:M("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:M("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:M("ExtHostInteractive"),ExtHostChatAgents2:M("ExtHostChatAgents"),ExtHostLanguageModelTools:M("ExtHostChatSkills"),ExtHostChatProvider:M("ExtHostChatProvider"),ExtHostChatContext:M("ExtHostChatContext"),ExtHostSpeech:M("ExtHostSpeech"),ExtHostEmbeddings:M("ExtHostEmbeddings"),ExtHostAiRelatedInformation:M("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:M("ExtHostAiEmbeddingVector"),ExtHostAiSettingsSearch:M("ExtHostAiSettingsSearch"),ExtHostTheming:M("ExtHostTheming"),ExtHostTunnelService:M("ExtHostTunnelService"),ExtHostManagedSockets:M("ExtHostManagedSockets"),ExtHostAuthentication:M("ExtHostAuthentication"),ExtHostTimeline:M("ExtHostTimeline"),ExtHostTesting:M("ExtHostTesting"),ExtHostTelemetry:M("ExtHostTelemetry"),ExtHostLocalization:M("ExtHostLocalization"),ExtHostMcp:M("ExtHostMcp"),ExtHostDataChannels:M("ExtHostDataChannels"),ExtHostChatSessions:M("ExtHostChatSessions")};function zC(e){return e.toJSON()}var NU=class{constructor(e){this.a=e}transformIncoming(e){const t=this.a.transformIncoming(e);return t===e?e:zC(y.from(t))}transformOutgoing(e){const t=this.a.transformOutgoing(e);return t===e?e:zC(y.from(t))}transformOutgoingURI(e){const t=this.a.transformOutgoing(e);return t===e?e:y.from(t)}transformOutgoingScheme(e){return this.a.transformOutgoingScheme(e)}},$te=new class{transformIncoming(e){return e}transformOutgoing(e){return e}transformOutgoingURI(e){return e}transformOutgoingScheme(e){return e}};function HC(e,t,i,s){if(!e||s>200)return null;if(typeof e=="object"){if(e.$mid===1)return i?y.revive(t.transformIncoming(e)):t.transformIncoming(e);if(e instanceof W)return null;for(const r in e)if(Object.hasOwnProperty.call(e,r)){const n=HC(e[r],t,i,s+1);n!==null&&(e[r]=n)}}return null}function bu(e,t){const i=HC(e,t,!1,0);return i===null?e:i}var WC=class{constructor(){this.a=null,this.b=null,this.d=null,this.f=!1,this.g=null,this.h=!1,this.i=null}get[Symbol.toStringTag](){return this.toString()}j(){return this.a||(this.a=new Promise((e,t)=>{this.b=e,this.d=t,this.f&&this.b(this.g),this.h&&this.d(this.i)})),this.a}resolveOk(e){this.f||this.h||(this.f=!0,this.g=e,this.a&&this.b(e))}resolveErr(e){this.f||this.h||(this.h=!0,this.i=e,this.a?this.d(e):lt(e))}then(e,t){return this.j().then(e,t)}catch(e){return this.j().then(void 0,e)}finally(e){return this.j().finally(e)}},MU=class extends WC{constructor(){super(),this.h=!0,this.i=new dt}},BC;function w0(e,t){try{return JSON.stringify(e,t)}catch{return"null"}}var b0="$$ref$$",LU={[b0]:-1};function _C(e,t=null,i=!1){const s=[];return{jsonString:(i?w0:JSON.stringify)(e,(n,o)=>{if(typeof o>"u")return LU;if(typeof o=="object"){if(o instanceof W){const a=s.push(o)-1;return{[b0]:a}}if(t)return t(n,o)}return o}),referencedBuffers:s}}function VC(e,t,i){return JSON.parse(e,(s,r)=>{if(r){const n=r[b0];if(typeof n=="number")return t[n];if(i&&r.$mid===1)return i.transformIncoming(r)}return r})}function qC(e,t){return JSON.stringify(e,t)}function RU(e){return e?(t,i)=>i&&i.$mid===1?e.transformOutgoing(i):i:null}var GC;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(GC||(GC={}));var JC;(function(e){e[e.Responsive=0]="Responsive",e[e.Unresponsive=1]="Unresponsive"})(JC||(JC={}));var OU=()=>{},FU=Symbol.for("rpcProtocol"),UU=Symbol.for("rpcProxy"),jU=class A5 extends Z{static{BC=FU}static{this.a=3*1e3}constructor(t,i=null,s=null){super(),this[BC]=!0,this.b=this.D(new I),this.onDidChangeResponsiveState=this.b.event,this.c=t,this.f=i,this.g=s,this.h=RU(this.g),this.j=!1,this.m=[],this.q=[];for(let r=0,n=IC.count;r<n;r++)this.m[r]=null,this.q[r]=null;this.s=0,this.t=Object.create(null),this.u={},this.w=0,this.y=0,this.z=0,this.C=this.D(new br(()=>this.H(),1e3)),this.D(this.c.onMessage(r=>this.L(r)))}dispose(){this.j=!0,Object.keys(this.u).forEach(t=>{const i=this.u[t];delete this.u[t],i.resolveErr(ru())}),super.dispose()}drain(){return typeof this.c.drain=="function"?this.c.drain():Promise.resolve()}F(t){this.y===0&&(this.z=Date.now()+A5.a),this.y++,this.C.isScheduled()||this.C.schedule()}G(t){this.z=Date.now()+A5.a,this.y--,this.y===0&&this.C.cancel(),this.I(0)}H(){this.y!==0&&(Date.now()>this.z?this.I(1):this.C.schedule())}I(t){this.w!==t&&(this.w=t,this.b.fire(this.w))}get responsiveState(){return this.w}transformIncomingURIs(t){return this.g?bu(t,this.g):t}getProxy(t){const{nid:i,sid:s}=t;return this.q[i]||(this.q[i]=this.J(i,s)),this.q[i]}J(t,i){const s={get:(r,n)=>(typeof n=="string"&&!r[n]&&n.charCodeAt(0)===36&&(r[n]=(...o)=>this.U(t,n,o)),n===UU?i:r[n])};return new Proxy(Object.create(null),s)}set(t,i){return this.m[t.nid]=i,i}assertRegistered(t){for(let i=0,s=t.length;i<s;i++){const r=t[i];if(!this.m[r.nid])throw new Error(`Missing proxy instance ${r.sid}`)}}L(t){if(this.j)return;const i=t.byteLength,s=_t.read(t,0),r=s.readUInt8(),n=s.readUInt32();switch(r){case 1:case 2:{let{rpcId:o,method:a,args:c}=Ps.deserializeRequestJSONArgs(s);this.g&&(c=bu(c,this.g)),this.M(i,n,o,a,c,r===2);break}case 3:case 4:{let{rpcId:o,method:a,args:c}=Ps.deserializeRequestMixedArgs(s);this.g&&(c=bu(c,this.g)),this.M(i,n,o,a,c,r===4);break}case 5:{this.f?.logIncoming(i,n,0,"ack"),this.G(n);break}case 6:{this.N(i,n);break}case 7:{this.O(i,n,void 0);break}case 9:{let o=Ps.deserializeReplyOKJSON(s);this.g&&(o=bu(o,this.g)),this.O(i,n,o);break}case 10:{const o=Ps.deserializeReplyOKJSONWithBuffers(s,this.g);this.O(i,n,o);break}case 8:{const o=Ps.deserializeReplyOKVSBuffer(s);this.O(i,n,o);break}case 11:{let o=Ps.deserializeReplyErrError(s);this.g&&(o=bu(o,this.g)),this.P(i,n,o);break}case 12:{this.P(i,n,void 0);break}default:console.error("received unexpected message"),console.error(t)}}M(t,i,s,r,n,o){this.f?.logIncoming(t,i,1,`receiveRequest ${Df(s)}.${r}(`,n);const a=String(i);let c,l;if(o){const h=new Qe;n.push(h.token),c=this.Q(s,r,n),l=()=>h.cancel()}else c=this.Q(s,r,n),l=OU;this.t[a]=l;const u=Ps.serializeAcknowledged(i);this.f?.logOutgoing(u.byteLength,i,1,"ack"),this.c.send(u),c.then(h=>{delete this.t[a];const f=Ps.serializeReplyOK(i,h,this.h);this.f?.logOutgoing(f.byteLength,i,1,"reply:",h),this.c.send(f)},h=>{delete this.t[a];const f=Ps.serializeReplyErr(i,h);this.f?.logOutgoing(f.byteLength,i,1,"replyErr:",h),this.c.send(f)})}N(t,i){this.f?.logIncoming(t,i,1,"receiveCancel");const s=String(i);this.t[s]?.()}O(t,i,s){this.f?.logIncoming(t,i,0,"receiveReply:",s);const r=String(i);if(!this.u.hasOwnProperty(r))return;const n=this.u[r];delete this.u[r],n.resolveOk(s)}P(t,i,s){this.f?.logIncoming(t,i,0,"receiveReplyErr:",s);const r=String(i);if(!this.u.hasOwnProperty(r))return;const n=this.u[r];delete this.u[r];let o;s&&(s.$isError?(o=new Error,o.name=s.name,o.message=s.message,o.stack=s.stack):o=s),n.resolveErr(o)}Q(t,i,s){try{return Promise.resolve(this.S(t,i,s))}catch(r){return Promise.reject(r)}}S(t,i,s){const r=this.m[t];if(!r)throw new Error("Unknown actor "+Df(t));const n=r[i];if(typeof n!="function")throw new Error("Unknown method "+i+" on actor "+Df(t));return n.apply(r,s)}U(t,i,s){if(this.j)return new MU;let r=null;if(s.length>0&&Fe.isCancellationToken(s[s.length-1])&&(r=s.pop()),r&&r.isCancellationRequested)return Promise.reject(ru());const n=Ps.serializeRequestArguments(s,this.h),o=++this.s,a=String(o),c=new WC,l=new ie;r&&l.add(r.onCancellationRequested(()=>{const h=Ps.serializeCancel(o);this.f?.logOutgoing(h.byteLength,o,0,"cancel"),this.c.send(h)})),this.u[a]=new zU(c,l),this.F(o);const u=Ps.serializeRequest(o,t,i,n,!!r);return this.f?.logOutgoing(u.byteLength,o,0,`request: ${Df(t)}.${i}(`,s),this.c.send(u),c}},zU=class{constructor(e,t){this.a=e,this.b=t}resolveOk(e){this.a.resolveOk(e),this.b.dispose()}resolveErr(e){this.a.resolveErr(e),this.b.dispose()}},_t=class S5{static alloc(t,i,s){const r=new S5(W.alloc(s+1+4),0);return r.writeUInt8(t),r.writeUInt32(i),r}static read(t,i){return new S5(t,i)}get buffer(){return this.a}constructor(t,i){this.a=t,this.b=i}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(t){this.a.writeUInt8(t,this.b),this.b+=1}readUInt8(){const t=this.a.readUInt8(this.b);return this.b+=1,t}writeUInt32(t){this.a.writeUInt32BE(t,this.b),this.b+=4}readUInt32(){const t=this.a.readUInt32BE(this.b);return this.b+=4,t}static sizeShortString(t){return 1+t.byteLength}writeShortString(t){this.a.writeUInt8(t.byteLength,this.b),this.b+=1,this.a.set(t,this.b),this.b+=t.byteLength}readShortString(){const t=this.a.readUInt8(this.b);this.b+=1;const s=this.a.slice(this.b,this.b+t).toString();return this.b+=t,s}static sizeLongString(t){return 4+t.byteLength}writeLongString(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}readLongString(){const t=this.a.readUInt32BE(this.b);this.b+=4;const s=this.a.slice(this.b,this.b+t).toString();return this.b+=t,s}writeBuffer(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}static sizeVSBuffer(t){return 4+t.byteLength}writeVSBuffer(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}readVSBuffer(){const t=this.a.readUInt32BE(this.b);this.b+=4;const i=this.a.slice(this.b,this.b+t);return this.b+=t,i}static sizeMixedArray(t){let i=0;i+=1;for(let s=0,r=t.length;s<r;s++){const n=t[s];switch(i+=1,n.type){case 1:i+=this.sizeLongString(n.value);break;case 2:i+=this.sizeVSBuffer(n.value);break;case 3:i+=this.sizeUInt32,i+=this.sizeLongString(n.value);for(let o=0;o<n.buffers.length;++o)i+=this.sizeVSBuffer(n.buffers[o]);break;case 4:break}}return i}writeMixedArray(t){this.a.writeUInt8(t.length,this.b),this.b+=1;for(let i=0,s=t.length;i<s;i++){const r=t[i];switch(r.type){case 1:this.writeUInt8(1),this.writeLongString(r.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(r.value);break;case 3:this.writeUInt8(3),this.writeUInt32(r.buffers.length),this.writeLongString(r.value);for(let n=0;n<r.buffers.length;++n)this.writeBuffer(r.buffers[n]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const t=this.a.readUInt8(this.b);this.b+=1;const i=new Array(t);for(let s=0;s<t;s++)switch(this.readUInt8()){case 1:i[s]=this.readLongString();break;case 2:i[s]=this.readVSBuffer();break;case 3:{const n=this.readUInt32(),o=this.readLongString(),a=[];for(let c=0;c<n;++c)a.push(this.readVSBuffer());i[s]=new pi(VC(o,a,null));break}case 4:i[s]=void 0;break}return i}},ZC;(function(e){e[e.Simple=0]="Simple",e[e.Mixed=1]="Mixed"})(ZC||(ZC={}));var Ps=class{static a(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof W||e[t]instanceof pi||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this.a(e)){const i=[];for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n instanceof W)i[s]={type:2,value:n};else if(typeof n>"u")i[s]={type:4};else if(n instanceof pi){const{jsonString:o,referencedBuffers:a}=_C(n.value,t);i[s]={type:3,value:W.fromString(o),buffers:a}}else i[s]={type:1,value:W.fromString(qC(n,t))}}return{type:1,args:i}}return{type:0,args:qC(e,t)}}static serializeRequest(e,t,i,s,r){switch(s.type){case 0:return this.b(e,t,i,s.args,r);case 1:return this.c(e,t,i,s.args,r)}}static b(e,t,i,s,r){const n=W.fromString(i),o=W.fromString(s);let a=0;a+=_t.sizeUInt8(),a+=_t.sizeShortString(n),a+=_t.sizeLongString(o);const c=_t.alloc(r?2:1,e,a);return c.writeUInt8(t),c.writeShortString(n),c.writeLongString(o),c.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),s=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(s)}}static c(e,t,i,s,r){const n=W.fromString(i);let o=0;o+=_t.sizeUInt8(),o+=_t.sizeShortString(n),o+=_t.sizeMixedArray(s);const a=_t.alloc(r?4:3,e,o);return a.writeUInt8(t),a.writeShortString(n),a.writeMixedArray(s),a.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),s=e.readMixedArray(),r=new Array(s.length);for(let n=0,o=s.length;n<o;n++){const a=s[n];typeof a=="string"?r[n]=JSON.parse(a):r[n]=a}return{rpcId:t,method:i,args:r}}static serializeAcknowledged(e){return _t.alloc(5,e,0).buffer}static serializeCancel(e){return _t.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this.d(e);if(t instanceof W)return this.e(e,t);if(t instanceof pi){const{jsonString:s,referencedBuffers:r}=_C(t.value,i,!0);return this.g(e,s,r)}else return this.f(e,w0(t,i))}static d(e){return _t.alloc(7,e,0).buffer}static e(e,t){let i=0;i+=_t.sizeVSBuffer(t);const s=_t.alloc(8,e,i);return s.writeVSBuffer(t),s.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static f(e,t){const i=W.fromString(t);let s=0;s+=_t.sizeLongString(i);const r=_t.alloc(9,e,s);return r.writeLongString(i),r.buffer}static g(e,t,i){const s=W.fromString(t);let r=0;r+=_t.sizeUInt32,r+=_t.sizeLongString(s);for(const o of i)r+=_t.sizeVSBuffer(o);const n=_t.alloc(10,e,r);n.writeUInt32(i.length),n.writeLongString(s);for(const o of i)n.writeBuffer(o);return n.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),s=e.readLongString(),r=[];for(let n=0;n<i;++n)r.push(e.readVSBuffer());return new pi(VC(s,r,t))}static serializeReplyErr(e,t){const i=t?w0(ic(t),null):void 0;if(typeof i!="string")return this.h(e);const s=W.fromString(i);let r=0;r+=_t.sizeLongString(s);const n=_t.alloc(11,e,r);return n.writeLongString(s),n.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static h(e){return _t.alloc(12,e,0).buffer}},QC;(function(e){e[e.RequestJSONArgs=1]="RequestJSONArgs",e[e.RequestJSONArgsWithCancellation=2]="RequestJSONArgsWithCancellation",e[e.RequestMixedArgs=3]="RequestMixedArgs",e[e.RequestMixedArgsWithCancellation=4]="RequestMixedArgsWithCancellation",e[e.Acknowledged=5]="Acknowledged",e[e.Cancel=6]="Cancel",e[e.ReplyOKEmpty=7]="ReplyOKEmpty",e[e.ReplyOKVSBuffer=8]="ReplyOKVSBuffer",e[e.ReplyOKJSON=9]="ReplyOKJSON",e[e.ReplyOKJSONWithBuffers=10]="ReplyOKJSONWithBuffers",e[e.ReplyErrError=11]="ReplyErrError",e[e.ReplyErrEmpty=12]="ReplyErrEmpty"})(QC||(QC={}));var YC;(function(e){e[e.String=1]="String",e[e.VSBuffer=2]="VSBuffer",e[e.SerializedObjectWithBuffers=3]="SerializedObjectWithBuffers",e[e.Undefined=4]="Undefined"})(YC||(YC={}));var Zs;(function(e){e.serviceIds=new Map,e.DI_TARGET="$di$target",e.DI_DEPENDENCIES="$di$dependencies";function t(i){return i[e.DI_DEPENDENCIES]||[]}e.getServiceDependencies=t})(Zs||(Zs={}));var Xo=H("instantiationService");function HU(e,t,i){t[Zs.DI_TARGET]===t?t[Zs.DI_DEPENDENCIES].push({id:e,index:i}):(t[Zs.DI_DEPENDENCIES]=[{id:e,index:i}],t[Zs.DI_TARGET]=t)}function H(e){if(Zs.serviceIds.has(e))return Zs.serviceIds.get(e);const t=function(i,s,r){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");HU(t,i,r)};return t.toString=()=>e,Zs.serviceIds.set(e,t),t}function Ite(e){return e}function y0(e){if(!e)return;const t=e.indexOf("+");return t<0?e:e.substr(0,t)}var XC=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"],KC;(function(e){e[e.System=0]="System",e[e.User=1]="User"})(KC||(KC={}));var ek;(function(e){e.WIN32_X64="win32-x64",e.WIN32_ARM64="win32-arm64",e.LINUX_X64="linux-x64",e.LINUX_ARM64="linux-arm64",e.LINUX_ARMHF="linux-armhf",e.ALPINE_X64="alpine-x64",e.ALPINE_ARM64="alpine-arm64",e.DARWIN_X64="darwin-x64",e.DARWIN_ARM64="darwin-arm64",e.WEB="web",e.UNIVERSAL="universal",e.UNKNOWN="unknown",e.UNDEFINED="undefined"})(ek||(ek={}));var Ye=class{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,s=typeof t=="string"?t:t.value;return $s(i,s)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}},Ko=class{get size(){return this.c.size}constructor(e){if(this.c=new Set,e)for(const t of e)this.add(t)}add(e){this.c.add(Ye.toKey(e))}delete(e){return this.c.delete(Ye.toKey(e))}has(e){return this.c.has(Ye.toKey(e))}},qn=class{constructor(){this.c=new Map}clear(){this.c.clear()}delete(e){this.c.delete(Ye.toKey(e))}get(e){return this.c.get(Ye.toKey(e))}has(e){return this.c.has(Ye.toKey(e))}set(e,t){this.c.set(Ye.toKey(e),t)}values(){return this.c.values()}forEach(e){this.c.forEach(e)}[Symbol.iterator](){return this.c[Symbol.iterator]()}},tk=class extends Error{constructor(e,t,i){super(`Error in extension ${Ye.toKey(e)}: ${i??t.message}`,{cause:t}),this.name="ExtensionError",this.extension=e}},Dte=H("IBuiltinExtensionsScannerService");function A0(e,t){return t&&(e.stack||e.stacktrace)?d(110,null,sk(e),ik(e.stack)||ik(e.stacktrace)):sk(e)}function ik(e){return Array.isArray(e)?e.join(`
`):e}function sk(e){return e.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${e.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof e.code=="string"&&typeof e.errno=="number"&&typeof e.syscall=="string"?d(111,null,e.message):e.message||d(112,null)}function Sr(e=null,t=!1){if(!e)return d(113,null);if(Array.isArray(e)){const i=gt(e),s=Sr(i[0],t);return i.length>1?d(114,null,s,i.length):s}if(Oe(e))return e;if(e.detail){const i=e.detail;if(i.error)return A0(i.error,t);if(i.exception)return A0(i.exception,t)}return e.stack?A0(e,t):e.message?e.message:d(115,null)}function sn(e){return S0(e,0)}function S0(e,t){switch(typeof e){case"object":return e===null?rn(349,t):Array.isArray(e)?BU(e,t):_U(e,t);case"string":return E0(e,t);case"boolean":return WU(e,t);case"number":return rn(e,t);case"undefined":return rn(937,t);default:return rn(617,t)}}function rn(e,t){return(t<<5)-t+e|0}function WU(e,t){return rn(e?433:863,t)}function E0(e,t){t=rn(149417,t);for(let i=0,s=e.length;i<s;i++)t=rn(e.charCodeAt(i),t);return t}function BU(e,t){return t=rn(104579,t),e.reduce((i,s)=>S0(s,i),t)}function _U(e,t){return t=rn(181387,t),Object.keys(e).sort().reduce((i,s)=>(i=E0(s,i),S0(e[s],i)),t)}var rk;(function(e){e[e.BLOCK_SIZE=64]="BLOCK_SIZE",e[e.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"})(rk||(rk={}));function x0(e,t,i=32){const s=i-t,r=~((1<<s)-1);return(e<<t|(r&e)>>>s)>>>0}function yu(e,t=32){return e instanceof ArrayBuffer?t0(W.wrap(new Uint8Array(e))):(e>>>0).toString(16).padStart(t/4,"0")}var Pte=class oM{static{this.g=new DataView(new ArrayBuffer(320))}constructor(){this.h=1732584193,this.l=4023233417,this.m=2562383102,this.n=271733878,this.o=3285377520,this.p=new Uint8Array(67),this.q=new DataView(this.p.buffer),this.r=0,this.t=0,this.u=0,this.v=!1}update(t){const i=t.length;if(i===0)return;const s=this.p;let r=this.r,n=this.u,o,a;for(n!==0?(o=n,a=-1,n=0):(o=t.charCodeAt(0),a=0);;){let c=o;if(uf(o))if(a+1<i){const l=t.charCodeAt(a+1);hf(l)?(a++,c=Wv(o,l)):c=65533}else{n=o;break}else hf(o)&&(c=65533);if(r=this.w(s,r,c),a++,a<i)o=t.charCodeAt(a);else break}this.r=r,this.u=n}w(t,i,s){return s<128?t[i++]=s:s<2048?(t[i++]=192|(s&1984)>>>6,t[i++]=128|(s&63)>>>0):s<65536?(t[i++]=224|(s&61440)>>>12,t[i++]=128|(s&4032)>>>6,t[i++]=128|(s&63)>>>0):(t[i++]=240|(s&1835008)>>>18,t[i++]=128|(s&258048)>>>12,t[i++]=128|(s&4032)>>>6,t[i++]=128|(s&63)>>>0),i>=64&&(this.y(),i-=64,this.t+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),i}digest(){return this.v||(this.v=!0,this.u&&(this.u=0,this.r=this.w(this.p,this.r,65533)),this.t+=this.r,this.x()),yu(this.h)+yu(this.l)+yu(this.m)+yu(this.n)+yu(this.o)}x(){this.p[this.r++]=128,this.p.subarray(this.r).fill(0),this.r>56&&(this.y(),this.p.fill(0));const t=8*this.t;this.q.setUint32(56,Math.floor(t/4294967296),!1),this.q.setUint32(60,t%4294967296,!1),this.y()}y(){const t=oM.g,i=this.q;for(let h=0;h<64;h+=4)t.setUint32(h,i.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)t.setUint32(h,x0(t.getUint32(h-12,!1)^t.getUint32(h-32,!1)^t.getUint32(h-56,!1)^t.getUint32(h-64,!1),1),!1);let s=this.h,r=this.l,n=this.m,o=this.n,a=this.o,c,l,u;for(let h=0;h<80;h++)h<20?(c=r&n|~r&o,l=1518500249):h<40?(c=r^n^o,l=1859775393):h<60?(c=r&n|r&o|n&o,l=2400959708):(c=r^n^o,l=3395469782),u=x0(s,5)+c+a+l+t.getUint32(h*4,!1)&4294967295,a=o,o=n,n=x0(r,30),r=s,s=u;this.h=this.h+s&4294967295,this.l=this.l+r&4294967295,this.m=this.m+n&4294967295,this.n=this.n+o&4294967295,this.o=this.o+a&4294967295}},nk;(function(e){e[e.LParen=0]="LParen",e[e.RParen=1]="RParen",e[e.Neg=2]="Neg",e[e.Eq=3]="Eq",e[e.NotEq=4]="NotEq",e[e.Lt=5]="Lt",e[e.LtEq=6]="LtEq",e[e.Gt=7]="Gt",e[e.GtEq=8]="GtEq",e[e.RegexOp=9]="RegexOp",e[e.RegexStr=10]="RegexStr",e[e.True=11]="True",e[e.False=12]="False",e[e.In=13]="In",e[e.Not=14]="Not",e[e.And=15]="And",e[e.Or=16]="Or",e[e.Str=17]="Str",e[e.QuotedStr=18]="QuotedStr",e[e.Error=19]="Error",e[e.EOF=20]="EOF"})(nk||(nk={}));function C0(...e){switch(e.length){case 1:return d(1874,null,e[0]);case 2:return d(1875,null,e[0],e[1]);case 3:return d(1876,null,e[0],e[1],e[2]);default:return}}var VU=d(1877,null),qU=d(1878,null),Au=class E5{constructor(){this.c="",this.d=0,this.e=0,this.f=[],this.g=[],this.m=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw Av(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static{this.a=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)))}static{this.b=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this.g}reset(t){return this.c=t,this.d=0,this.e=0,this.f=[],this.g=[],this}scan(){for(;!this.r();)switch(this.d=this.e,this.i()){case 40:this.k(0);break;case 41:this.k(1);break;case 33:if(this.h(61)){const i=this.h(61);this.f.push({type:4,offset:this.d,isTripleEq:i})}else this.k(2);break;case 39:this.o();break;case 47:this.q();break;case 61:if(this.h(61)){const i=this.h(61);this.f.push({type:3,offset:this.d,isTripleEq:i})}else this.h(126)?this.k(9):this.l(C0("==","=~"));break;case 60:this.k(this.h(61)?6:5);break;case 62:this.k(this.h(61)?8:7);break;case 38:this.h(38)?this.k(15):this.l(C0("&&"));break;case 124:this.h(124)?this.k(16):this.l(C0("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this.n()}return this.d=this.e,this.k(20),Array.from(this.f)}h(t){return this.r()||this.c.charCodeAt(this.e)!==t?!1:(this.e++,!0)}i(){return this.c.charCodeAt(this.e++)}j(){return this.r()?0:this.c.charCodeAt(this.e)}k(t){this.f.push({type:t,offset:this.d})}l(t){const i=this.d,s=this.c.substring(this.d,this.e),r={type:19,offset:this.d,lexeme:s};this.g.push({offset:i,lexeme:s,additionalInfo:t}),this.f.push(r)}n(){this.m.lastIndex=this.d;const t=this.m.exec(this.c);if(t){this.e=this.d+t[0].length;const i=this.c.substring(this.d,this.e),s=E5.b.get(i);s?this.k(s):this.f.push({type:17,lexeme:i,offset:this.d})}}o(){for(;this.j()!==39&&!this.r();)this.i();if(this.r()){this.l(VU);return}this.i(),this.f.push({type:18,lexeme:this.c.substring(this.d+1,this.e-1),offset:this.d+1})}q(){let t=this.e,i=!1,s=!1;for(;;){if(t>=this.c.length){this.e=t,this.l(qU);return}const n=this.c.charCodeAt(t);if(i)i=!1;else if(n===47&&!s){t++;break}else n===91?s=!0:n===92?i=!0:n===93&&(s=!1);t++}for(;t<this.c.length&&E5.a.has(this.c.charCodeAt(t));)t++;this.e=t;const r=this.c.substring(this.d,this.e);this.f.push({type:10,lexeme:r,offset:this.d})}r(){return this.e>=this.c.length}},li=new Map;li.set("false",!1),li.set("true",!0),li.set("isMac",Pt),li.set("isLinux",$t),li.set("isWindows",ze),li.set("isWeb",Uo),li.set("isMacNative",Pt&&!Uo),li.set("isEdge",LE),li.set("isFirefox",ZR),li.set("isChrome",Ov),li.set("isSafari",QR);var GU=Object.prototype.hasOwnProperty,ok;(function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.Defined=2]="Defined",e[e.Not=3]="Not",e[e.Equals=4]="Equals",e[e.NotEquals=5]="NotEquals",e[e.And=6]="And",e[e.Regex=7]="Regex",e[e.NotRegex=8]="NotRegex",e[e.Or=9]="Or",e[e.In=10]="In",e[e.NotIn=11]="NotIn",e[e.Greater=12]="Greater",e[e.GreaterEquals=13]="GreaterEquals",e[e.Smaller=14]="Smaller",e[e.SmallerEquals=15]="SmallerEquals"})(ok||(ok={}));var JU={regexParsingWithErrorRecovery:!0},ZU=d(1854,null),QU=d(1855,null),YU=d(1856,null),ak=d(1857,null),XU=d(1858,null),KU=d(1859,null),ej=d(1860,null),tj=d(1861,null),ck=class Hd{static{this.c=new Error}get lexingErrors(){return this.d.errors}get parsingErrors(){return this.h}constructor(t=JU){this.k=t,this.d=new Au,this.f=[],this.g=0,this.h=[],this.v=/g|y/g}parse(t){if(t===""){this.h.push({message:ZU,offset:0,lexeme:"",additionalInfo:QU});return}this.f=this.d.reset(t).scan(),this.g=0,this.h=[];try{const i=this.l();if(!this.E()){const s=this.D(),r=s.type===17?KU:void 0;throw this.h.push({message:XU,offset:s.offset,lexeme:Au.getLexeme(s),additionalInfo:r}),Hd.c}return i}catch(i){if(i!==Hd.c)throw i;return}}l(){return this.m()}m(){const t=[this.o()];for(;this.y(16);){const i=this.o();t.push(i)}return t.length===1?t[0]:Mt.or(...t)}o(){const t=[this.s()];for(;this.y(15);){const i=this.s();t.push(i)}return t.length===1?t[0]:Mt.and(...t)}s(){if(this.y(2)){const t=this.D();switch(t.type){case 11:return this.z(),Ui.INSTANCE;case 12:return this.z(),ts.INSTANCE;case 0:{this.z();const i=this.l();return this.A(1,ak),i?.negate()}case 17:return this.z(),xu.create(t.lexeme);default:throw this.B("KEY | true | false | '(' expression ')'",t)}}return this.t()}t(){const t=this.D();switch(t.type){case 11:return this.z(),Mt.true();case 12:return this.z(),Mt.false();case 0:{this.z();const i=this.l();return this.A(1,ak),i}case 17:{const i=t.lexeme;if(this.z(),this.y(9)){const r=this.D();if(!this.k.regexParsingWithErrorRecovery){if(this.z(),r.type!==10)throw this.B("REGEX",r);const n=r.lexeme,o=n.lastIndexOf("/"),a=o===n.length-1?void 0:this.w(n.substring(o+1));let c;try{c=new RegExp(n.substring(1,o),a)}catch{throw this.B("REGEX",r)}return T0.create(i,c)}switch(r.type){case 10:case 19:{const n=[r.lexeme];this.z();let o=this.D(),a=0;for(let f=0;f<r.lexeme.length;f++)r.lexeme.charCodeAt(f)===40?a++:r.lexeme.charCodeAt(f)===41&&a--;for(;!this.E()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?a++:r.lexeme.charCodeAt(f)===41&&a--}if(a<0)break;n.push(Au.getLexeme(o)),this.z(),o=this.D()}const c=n.join(""),l=c.lastIndexOf("/"),u=l===c.length-1?void 0:this.w(c.substring(l+1));let h;try{h=new RegExp(c.substring(1,l),u)}catch{throw this.B("REGEX",r)}return Mt.regex(i,h)}case 18:{const n=r.lexeme;this.z();let o=null;if(!fu(n)){const a=n.indexOf("/"),c=n.lastIndexOf("/");if(a!==c&&a>=0){const l=n.slice(a+1,c),u=n[c+1]==="i"?"i":"";try{o=new RegExp(l,u)}catch{throw this.B("REGEX",r)}}}if(o===null)throw this.B("REGEX",r);return T0.create(i,o)}default:throw this.B("REGEX",this.D())}}if(this.y(14)){this.A(13,YU);const r=this.u();return Mt.notIn(i,r)}switch(this.D().type){case 3:{this.z();const r=this.u();if(this.x().type===18)return Mt.equals(i,r);switch(r){case"true":return Mt.has(i);case"false":return Mt.not(i);default:return Mt.equals(i,r)}}case 4:{this.z();const r=this.u();if(this.x().type===18)return Mt.notEquals(i,r);switch(r){case"true":return Mt.not(i);case"false":return Mt.has(i);default:return Mt.notEquals(i,r)}}case 5:return this.z(),D0.create(i,this.u());case 6:return this.z(),P0.create(i,this.u());case 7:return this.z(),Tf.create(i,this.u());case 8:return this.z(),I0.create(i,this.u());case 13:return this.z(),Mt.in(i,this.u());default:return Mt.has(i)}}case 20:throw this.h.push({message:ej,offset:t.offset,lexeme:"",additionalInfo:tj}),Hd.c;default:throw this.B(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this.D())}}u(){const t=this.D();switch(t.type){case 17:case 18:return this.z(),t.lexeme;case 11:return this.z(),"true";case 12:return this.z(),"false";case 13:return this.z(),"in";default:return""}}w(t){return t.replaceAll(this.v,"")}x(){return this.f[this.g-1]}y(t){return this.C(t)?(this.z(),!0):!1}z(){return this.E()||this.g++,this.x()}A(t,i){if(this.C(t))return this.z();throw this.B(i,this.D())}B(t,i,s){const r=d(1862,null,t,Au.getLexeme(i)),n=i.offset,o=Au.getLexeme(i);return this.h.push({message:r,offset:n,lexeme:o,additionalInfo:s}),Hd.c}C(t){return this.D().type===t}D(){return this.f[this.g]}E(){return this.D().type===20}},Mt=class{static false(){return Ui.INSTANCE}static true(){return ts.INSTANCE}static has(e){return Eu.create(e)}static equals(e,t){return k0.create(e,t)}static notEquals(e,t){return $0.create(e,t)}static regex(e,t){return T0.create(e,t)}static in(e,t){return lk.create(e,t)}static notIn(e,t){return uk.create(e,t)}static not(e){return xu.create(e)}static and(...e){return dk.create(e,null,!0)}static or(...e){return N0.create(e,null,!0)}static greater(e,t){return Tf.create(e,t)}static greaterEquals(e,t){return I0.create(e,t)}static smaller(e,t){return D0.create(e,t)}static smallerEquals(e,t){return P0.create(e,t)}static{this.c=new ck({regexParsingWithErrorRecovery:!1})}static deserialize(e){return e==null?void 0:this.c.parse(e)}};function ij(e){const t=new ck({regexParsingWithErrorRecovery:!1});return e.map(i=>(t.parse(i),t.lexingErrors.length>0?t.lexingErrors.map(s=>({errorMessage:s.additionalInfo?d(1863,null,s.additionalInfo):d(1864,null),offset:s.offset,length:s.lexeme.length})):t.parsingErrors.length>0?t.parsingErrors.map(s=>({errorMessage:s.additionalInfo?`${s.message}. ${s.additionalInfo}`:s.message,offset:s.offset,length:s.lexeme.length})):[]))}function Su(e,t){return e.cmp(t)}var Ui=class aM{static{this.INSTANCE=new aM}constructor(){this.type=0}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return ts.INSTANCE}},ts=class cM{static{this.INSTANCE=new cM}constructor(){this.type=1}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return Ui.INSTANCE}},Eu=class lM{static create(t,i=null){const s=li.get(t);return typeof s=="boolean"?s?ts.INSTANCE:Ui.INSTANCE:new lM(t,i)}constructor(t,i){this.key=t,this.c=i,this.type=2}cmp(t){return t.type!==this.type?this.type-t.type:fk(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){const t=li.get(this.key);return typeof t=="boolean"?t?ts.INSTANCE:Ui.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.c||(this.c=xu.create(this.key,this)),this.c}},k0=class uM{static create(t,i,s=null){if(typeof i=="boolean")return i?Eu.create(t,s):xu.create(t,s);const r=li.get(t);return typeof r=="boolean"?i===(r?"true":"false")?ts.INSTANCE:Ui.INSTANCE:new uM(t,i,s)}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=4}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){const t=li.get(this.c);if(typeof t=="boolean"){const i=t?"true":"false";return this.d===i?ts.INSTANCE:Ui.INSTANCE}return this}evaluate(t){return t.getValue(this.c)==this.d}serialize(){return`${this.c} == '${this.d}'`}keys(){return[this.c]}map(t){return t.mapEquals(this.c,this.d)}negate(){return this.f||(this.f=$0.create(this.c,this.d,this)),this.f}},lk=class hM{static create(t,i){return new hM(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=10,this.c=null}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.d,this.f,t.d,t.f)}equals(t){return t.type===this.type?this.d===t.d&&this.f===t.f:!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.f),s=t.getValue(this.d);return Array.isArray(i)?i.includes(s):typeof s=="string"&&typeof i=="object"&&i!==null?GU.call(i,s):!1}serialize(){return`${this.d} in '${this.f}'`}keys(){return[this.d,this.f]}map(t){return t.mapIn(this.d,this.f)}negate(){return this.c||(this.c=uk.create(this.d,this.f)),this.c}},uk=class dM{static create(t,i){return new dM(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=11,this.c=lk.create(t,i)}cmp(t){return t.type!==this.type?this.type-t.type:this.c.cmp(t.c)}equals(t){return t.type===this.type?this.c.equals(t.c):!1}substituteConstants(){return this}evaluate(t){return!this.c.evaluate(t)}serialize(){return`${this.d} not in '${this.f}'`}keys(){return this.c.keys()}map(t){return t.mapNotIn(this.d,this.f)}negate(){return this.c}},$0=class fM{static create(t,i,s=null){if(typeof i=="boolean")return i?xu.create(t,s):Eu.create(t,s);const r=li.get(t);return typeof r=="boolean"?i===(r?"true":"false")?Ui.INSTANCE:ts.INSTANCE:new fM(t,i,s)}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=5}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){const t=li.get(this.c);if(typeof t=="boolean"){const i=t?"true":"false";return this.d===i?Ui.INSTANCE:ts.INSTANCE}return this}evaluate(t){return t.getValue(this.c)!=this.d}serialize(){return`${this.c} != '${this.d}'`}keys(){return[this.c]}map(t){return t.mapNotEquals(this.c,this.d)}negate(){return this.f||(this.f=k0.create(this.c,this.d,this)),this.f}},xu=class pM{static create(t,i=null){const s=li.get(t);return typeof s=="boolean"?s?Ui.INSTANCE:ts.INSTANCE:new pM(t,i)}constructor(t,i){this.c=t,this.d=i,this.type=3}cmp(t){return t.type!==this.type?this.type-t.type:fk(this.c,t.c)}equals(t){return t.type===this.type?this.c===t.c:!1}substituteConstants(){const t=li.get(this.c);return typeof t=="boolean"?t?Ui.INSTANCE:ts.INSTANCE:this}evaluate(t){return!t.getValue(this.c)}serialize(){return`!${this.c}`}keys(){return[this.c]}map(t){return t.mapNot(this.c)}negate(){return this.d||(this.d=Eu.create(this.c,this)),this.d}};function Pf(e,t){if(typeof e=="string"){const i=parseFloat(e);isNaN(i)||(e=i)}return typeof e=="string"||typeof e=="number"?t(e):Ui.INSTANCE}var Tf=class gM{static create(t,i,s=null){return Pf(i,r=>new gM(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=12}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))>this.d}serialize(){return`${this.c} > ${this.d}`}keys(){return[this.c]}map(t){return t.mapGreater(this.c,this.d)}negate(){return this.f||(this.f=P0.create(this.c,this.d,this)),this.f}},I0=class mM{static create(t,i,s=null){return Pf(i,r=>new mM(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=13}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))>=this.d}serialize(){return`${this.c} >= ${this.d}`}keys(){return[this.c]}map(t){return t.mapGreaterEquals(this.c,this.d)}negate(){return this.f||(this.f=D0.create(this.c,this.d,this)),this.f}},D0=class vM{static create(t,i,s=null){return Pf(i,r=>new vM(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=14}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))<this.d}serialize(){return`${this.c} < ${this.d}`}keys(){return[this.c]}map(t){return t.mapSmaller(this.c,this.d)}negate(){return this.f||(this.f=I0.create(this.c,this.d,this)),this.f}},P0=class wM{static create(t,i,s=null){return Pf(i,r=>new wM(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=15}cmp(t){return t.type!==this.type?this.type-t.type:ea(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))<=this.d}serialize(){return`${this.c} <= ${this.d}`}keys(){return[this.c]}map(t){return t.mapSmallerEquals(this.c,this.d)}negate(){return this.f||(this.f=Tf.create(this.c,this.d,this)),this.f}},T0=class bM{static create(t,i){return new bM(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=7,this.c=null}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.d<t.d)return-1;if(this.d>t.d)return 1;const i=this.f?this.f.source:"",s=t.f?t.f.source:"";return i<s?-1:i>s?1:0}equals(t){if(t.type===this.type){const i=this.f?this.f.source:"",s=t.f?t.f.source:"";return this.d===t.d&&i===s}return!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.d);return this.f?this.f.test(i):!1}serialize(){const t=this.f?`/${this.f.source}/${this.f.flags}`:"/invalid/";return`${this.d} =~ ${t}`}keys(){return[this.d]}map(t){return t.mapRegex(this.d,this.f)}negate(){return this.c||(this.c=sj.create(this)),this.c}},sj=class x5{static create(t){return new x5(t)}constructor(t){this.c=t,this.type=8}cmp(t){return t.type!==this.type?this.type-t.type:this.c.cmp(t.c)}equals(t){return t.type===this.type?this.c.equals(t.c):!1}substituteConstants(){return this}evaluate(t){return!this.c.evaluate(t)}serialize(){return`!(${this.c.serialize()})`}keys(){return this.c.keys()}map(t){return new x5(this.c.map(t))}negate(){return this.c}};function hk(e){let t=null;for(let i=0,s=e.length;i<s;i++){const r=e[i].substituteConstants();if(e[i]!==r&&t===null){t=[];for(let n=0;n<i;n++)t[n]=e[n]}t!==null&&(t[i]=r)}return t===null?e:t}var dk=class Gl{static create(t,i,s){return Gl.d(t,i,s)}constructor(t,i){this.expr=t,this.c=i,this.type=6}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,s=this.expr.length;i<s;i++){const r=Su(this.expr[i],t.expr[i]);if(r!==0)return r}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,s=this.expr.length;i<s;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=hk(this.expr);return t===this.expr?this:Gl.create(t,this.c,!1)}evaluate(t){for(let i=0,s=this.expr.length;i<s;i++)if(!this.expr[i].evaluate(t))return!1;return!0}static d(t,i,s){const r=[];let n=!1;for(const o of t)if(o){if(o.type===1){n=!0;continue}if(o.type===0)return Ui.INSTANCE;if(o.type===6){r.push(...o.expr);continue}r.push(o)}if(r.length===0&&n)return ts.INSTANCE;if(r.length!==0){if(r.length===1)return r[0];r.sort(Su);for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];for(;r.length>1;){const o=r[r.length-1];if(o.type!==9)break;r.pop();const a=r.pop(),c=r.length===0,l=N0.create(o.expr.map(u=>Gl.create([u,a],null,s)),null,c);l&&(r.push(l),r.sort(Su))}if(r.length===1)return r[0];if(s){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return Ui.INSTANCE;if(r.length===1)return r[0]}return new Gl(r,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Gl(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.c){const t=[];for(const i of this.expr)t.push(i.negate());this.c=N0.create(t,this,!0)}return this.c}},N0=class Za{static create(t,i,s){return Za.d(t,i,s)}constructor(t,i){this.expr=t,this.c=i,this.type=9}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,s=this.expr.length;i<s;i++){const r=Su(this.expr[i],t.expr[i]);if(r!==0)return r}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,s=this.expr.length;i<s;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=hk(this.expr);return t===this.expr?this:Za.create(t,this.c,!1)}evaluate(t){for(let i=0,s=this.expr.length;i<s;i++)if(this.expr[i].evaluate(t))return!0;return!1}static d(t,i,s){let r=[],n=!1;if(t){for(let o=0,a=t.length;o<a;o++){const c=t[o];if(c){if(c.type===0){n=!0;continue}if(c.type===1)return ts.INSTANCE;if(c.type===9){r=r.concat(c.expr);continue}r.push(c)}}if(r.length===0&&n)return Ui.INSTANCE;r.sort(Su)}if(r.length!==0){if(r.length===1)return r[0];for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];if(s){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return ts.INSTANCE;if(r.length===1)return r[0]}return new Za(r,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Za(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.c){const t=[];for(const i of this.expr)t.push(i.negate());for(;t.length>1;){const i=t.shift(),s=t.shift(),r=[];for(const n of pk(i))for(const o of pk(s))r.push(dk.create([n,o],null,!1));t.unshift(Za.create(r,null,!1))}this.c=Za.create(t,this,!0)}return this.c}},C=class tv extends Eu{static{this.d=[]}static all(){return tv.d.values()}constructor(t,i,s){super(t,null),this.f=i,typeof s=="object"?tv.d.push({...s,key:t}):s!==!0&&tv.d.push({key:t,description:s,type:i!=null?typeof i:void 0})}bindTo(t){return t.createKey(this.key,this.f)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return k0.create(this.key,t)}notEqualsTo(t){return $0.create(this.key,t)}greater(t){return Tf.create(this.key,t)}},Gn=H("contextKeyService");function fk(e,t){return e<t?-1:e>t?1:0}function ea(e,t,i,s){return e<i?-1:e>i?1:t<s?-1:t>s?1:0}function pk(e){return e.type===9?e.expr:[e]}var Se=H("logService"),Jn=H("loggerService"),X;(function(e){e[e.Off=0]="Off",e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error"})(X||(X={}));var rj=X.Info;function M0(e,t){return e!==X.Off&&e<=t}function nj(e,t,i){switch(t){case X.Trace:e.trace(i);break;case X.Debug:e.debug(i);break;case X.Info:e.info(i);break;case X.Warning:e.warn(i);break;case X.Error:e.error(i);break;case X.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function bc(e,t=!1){let i="";for(let s=0;s<e.length;s++){let r=e[s];if(r instanceof Error&&(r=Sr(r,t)),typeof r=="object")try{r=JSON.stringify(r)}catch{}i+=(s>0?" ":"")+r}return i}var gk=class extends Z{constructor(){super(...arguments),this.b=rj,this.c=this.D(new I)}get onDidChangeLogLevel(){return this.c.event}setLevel(e){this.b!==e&&(this.b=e,this.c.fire(this.b))}getLevel(){return this.b}f(e){return M0(this.b,e)}g(e){return this.B.isDisposed?!1:this.f(e)}},L0=class extends gk{constructor(e){super(),this.h=e}f(e){return this.h||super.f(e)}trace(e,...t){this.g(X.Trace)&&this.m(X.Trace,bc([e,...t],!0))}debug(e,...t){this.g(X.Debug)&&this.m(X.Debug,bc([e,...t]))}info(e,...t){this.g(X.Info)&&this.m(X.Info,bc([e,...t]))}warn(e,...t){this.g(X.Warning)&&this.m(X.Warning,bc([e,...t]))}error(e,...t){if(this.g(X.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.m(X.Error,bc(i))}else this.m(X.Error,bc([e,...t]))}flush(){}},oj=class extends gk{constructor(e){super(),this.h=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.h)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.h)i.trace(e,...t)}debug(e,...t){for(const i of this.h)i.debug(e,...t)}info(e,...t){for(const i of this.h)i.info(e,...t)}warn(e,...t){for(const i of this.h)i.warn(e,...t)}error(e,...t){for(const i of this.h)i.error(e,...t)}flush(){for(const e of this.h)e.flush()}dispose(){for(const e of this.h)e.dispose();super.dispose()}},aj=class extends Z{constructor(e,t,i){if(super(),this.j=e,this.m=t,this.b=new kt,this.f=this.D(new I),this.onDidChangeLoggers=this.f.event,this.g=this.D(new I),this.onDidChangeLogLevel=this.g.event,this.h=this.D(new I),this.onDidChangeVisibility=this.h.event,i)for(const s of i)this.b.set(s.resource,{logger:void 0,info:s})}n(e){return Oe(e)?[...this.b.values()].find(t=>t.info.id===e):this.b.get(e)}getLogger(e){return this.n(e)?.logger}createLogger(e,t){const i=this.q(e),s=Oe(e)?e:t?.id??sn(i.toString()).toString(16);let r=this.b.get(i)?.logger;const n=t?.logLevel==="always"?X.Trace:t?.logLevel;r||(r=this.s(i,n??this.getLogLevel(i)??this.j,{...t,id:s}));const o={logger:r,info:{resource:i,id:s,logLevel:n,name:t?.name,hidden:t?.hidden,group:t?.group,extensionId:t?.extensionId,when:t?.when}};return this.registerLogger(o.info),this.b.set(i,o),r}q(e){return Oe(e)?It(this.m,`${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`):e}setLogLevel(e,t){if(y.isUri(e)){const i=e,s=t,r=this.b.get(i);r&&s!==r.info.logLevel&&(r.info.logLevel=s===this.j?void 0:s,r.logger?.setLevel(s),this.b.set(r.info.resource,r),this.g.fire([i,s]))}else{this.j=e;for(const[i,s]of this.b.entries())this.b.get(i)?.info.logLevel===void 0&&s.logger?.setLevel(this.j);this.g.fire(this.j)}}setVisibility(e,t){const i=this.n(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this.b.set(i.info.resource,i),this.h.fire([i.info.resource,t]))}getLogLevel(e){let t;return e&&(t=this.b.get(e)?.info.logLevel),t??this.j}registerLogger(e){const t=this.b.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this.b.set(e.resource,{info:e,logger:void 0}),this.f.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this.q(e),i=this.b.get(t);i&&(i.logger&&i.logger.dispose(),this.b.delete(t),this.f.fire({added:[],removed:[i.info]}))}*getRegisteredLoggers(){for(const e of this.b.values())yield e.info}getRegisteredLogger(e){return this.b.get(e)?.info}dispose(){this.b.forEach(e=>e.logger?.dispose()),this.b.clear(),super.dispose()}};function cj(e){switch(e){case X.Trace:return"trace";case X.Debug:return"debug";case X.Info:return"info";case X.Warning:return"warn";case X.Error:return"error";case X.Off:return"off"}}var Tte=new C("logLevel",cj(X.Info)),Er=class{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}},mk=[],vk;(function(e){e[e.Eager=0]="Eager",e[e.Delayed=1]="Delayed"})(vk||(vk={}));function De(e,t,i){t instanceof Er||(t=new Er(t,[],!!i)),mk.push([e,t])}function lj(){return mk}var R0=class{constructor(...e){this.a=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this.a.get(e);return this.a.set(e,t),i}has(e){return this.a.has(e)}get(e){return this.a.get(e)}},jt=H("IExtHostInitDataService"),uj=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}},wk=class{constructor(e){this.b=e,this.a=new Map}roots(){const e=[];for(const t of this.a.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),s=this.lookupOrInsertNode(t);i.outgoing.set(s.key,s),s.incoming.set(i.key,i)}removeNode(e){const t=this.b(e);this.a.delete(t);for(const i of this.a.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this.b(e);let i=this.a.get(t);return i||(i=new uj(t,e),this.a.set(t,i)),i}lookup(e){return this.a.get(this.b(e))}isEmpty(){return this.a.size===0}toString(){const e=[];for(const[t,i]of this.a)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this.a){const i=new Set([e]),s=this.c(t,i);if(s)return s}}c(e,t){for(const[i,s]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this.c(s,t);if(r)return r;t.delete(i)}}},hj=!1,bk=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},dj=class C5{constructor(t=new R0,i=!1,s,r=hj){this.i=t,this.j=i,this.k=s,this.l=r,this.f=!1,this.g=new Set,this.h=new Set,this.t=new Set,this.i.set(Xo,this),this._globalGraph=r?s?._globalGraph??new wk(n=>n):void 0}dispose(){if(!this.f){this.f=!0,Zi(this.h),this.h.clear();for(const t of this.g)fE(t)&&t.dispose();this.g.clear()}}m(){if(this.f)throw new Error("InstantiationService has been disposed")}createChild(t,i){this.m();const s=this,r=new class extends C5{dispose(){s.h.delete(r),super.dispose()}}(t,this.j,this,this.l);return this.h.add(r),i?.add(r),r}invokeFunction(t,...i){this.m();const s=O0.traceInvocation(this.l,t);let r=!1;try{return t({get:o=>{if(r)throw Av("service accessor is only valid during the invocation of its target method");const a=this.s(o,s);return a||this.y(`[invokeFunction] unknown service '${o}'`,!1),a}},...i)}finally{r=!0,s.stop()}}createInstance(t,...i){this.m();let s,r;return t instanceof Er?(s=O0.traceCreation(this.l,t.ctor),r=this.o(t.ctor,t.staticArguments.concat(i),s)):(s=O0.traceCreation(this.l,t),r=this.o(t,i,s)),s.stop(),r}o(t,i=[],s){const r=Zs.getServiceDependencies(t).sort((a,c)=>a.index-c.index),n=[];for(const a of r){const c=this.s(a.id,s);c||this.y(`[createInstance] ${t.name} depends on UNKNOWN service ${a.id}.`,!1),n.push(c)}const o=r.length>0?r[0].index:i.length;if(i.length!==o){console.trace(`[createInstance] First service dependency of ${t.name} at position ${o+1} conflicts with ${i.length} static arguments`);const a=o-i.length;a>0?i=i.concat(new Array(a)):i=i.slice(0,o)}return Reflect.construct(t,i.concat(n))}q(t,i){if(this.i.get(t)instanceof Er)this.i.set(t,i);else if(this.k)this.k.q(t,i);else throw new Error("illegalState - setting UNKNOWN service instance")}r(t){const i=this.i.get(t);return!i&&this.k?this.k.r(t):i}s(t,i){this._globalGraph&&this.c&&this._globalGraph.insertEdge(this.c,String(t));const s=this.r(t);return s instanceof Er?this.u(t,s,i.branch(t,!0)):(i.branch(t,!1),s)}u(t,i,s){if(this.t.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this.t.add(t);try{return this.v(t,i,s)}finally{this.t.delete(t)}}v(t,i,s){const r=new wk(c=>c.id.toString());let n=0;const o=[{id:t,desc:i,_trace:s}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),r.lookupOrInsertNode(c),n++>1e3)throw new bk(r);for(const l of Zs.getServiceDependencies(c.desc.ctor)){const u=this.r(l.id);if(u||this.y(`[createInstance] ${t} depends on ${l.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(c.id),String(l.id)),u instanceof Er){const h={id:l.id,desc:u,_trace:c._trace.branch(l.id,!0)};r.insertEdge(c,h),o.push(h)}}}}for(;;){const c=r.roots();if(c.length===0){if(!r.isEmpty())throw new bk(r);break}for(const{data:l}of c){if(this.r(l.id)instanceof Er){const h=this.w(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this.q(l.id,h)}r.removeNode(l)}}return this.r(t)}w(t,i,s=[],r,n){if(this.i.get(t)instanceof Er)return this.x(t,i,s,r,n,this.g);if(this.k)return this.k.w(t,i,s,r,n);throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}x(t,i,s=[],r,n,o){if(r){const a=new C5(void 0,this.j,this,this.l);a.c=String(t);const c=new Map,l=new pO(()=>{const u=a.o(i,s,n);for(const[h,f]of c){const p=u[h];if(typeof p=="function")for(const g of f)g.disposable=p.apply(u,g.listener)}return c.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,h){if(!l.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let g=c.get(h);return g||(g=new Mn,c.set(h,g)),(b,S,E)=>{if(l.isInitialized)return l.value[h](b,S,E);{const k={listener:[b,S,E],disposable:void 0},j=g.push(k);return te(()=>{j(),k.disposable?.dispose()})}}}if(h in u)return u[h];const f=l.value;let p=f[h];return typeof p!="function"||(p=p.bind(f),u[h]=p),p},set(u,h,f){return l.value[h]=f,!0},getPrototypeOf(u){return i.prototype}})}else{const a=this.o(i,s,n);return o.add(a),a}}y(t,i){if(i&&console.warn(t),this.j)throw new Error(t)}},yk;(function(e){e[e.None=0]="None",e[e.Creation=1]="Creation",e[e.Invocation=2]="Invocation",e[e.Branch=3]="Branch"})(yk||(yk={}));var O0=class _r{static{this.all=new Set}static{this.c=new class extends _r{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(t,i){return t?new _r(2,i.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):_r.c}static traceCreation(t,i){return t?new _r(1,i.name):_r.c}static{this.f=0}constructor(t,i){this.type=t,this.name=i,this.g=Date.now(),this.h=[]}branch(t,i){const s=new _r(3,t.toString());return this.h.push([t,i,s]),s}stop(){const t=Date.now()-this.g;_r.f+=t;let i=!1;function s(n,o){const a=[],c=new Array(n+1).join("	");for(const[l,u,h]of o.h)if(u&&h){i=!0,a.push(`${c}CREATES -> ${l}`);const f=s(n+1,h);f&&a.push(f)}else a.push(`${c}uses -> ${l}`);return a.join(`
`)}const r=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${s(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${_r.f.toFixed(2)}ms)`];(t>2||i)&&_r.all.add(r.join(`
`))}},ke=H("IExtHostRpcService"),fj=class{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}},Cu=H("IURITransformerService"),pj=class{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}},gj=class{constructor(){this.b="",this.c=0}reset(e){return this.b=e,this.c=0,this}next(){return this.c+=1,this}hasNext(){return this.c<this.b.length-1}cmp(e){const t=e.charCodeAt(0),i=this.b.charCodeAt(this.c);return t-i}value(){return this.b[this.c]}},mj=class{constructor(e=!0){this.e=e}reset(e){return this.b=e,this.c=0,this.d=0,this.next()}hasNext(){return this.d<this.b.length}next(){this.c=this.d;let e=!0;for(;this.d<this.b.length;this.d++)if(this.b.charCodeAt(this.d)===46)if(e)this.c++;else break;else e=!1;return this}cmp(e){return this.e?zv(e,this.b,0,e.length,this.c,this.d):cc(e,this.b,0,e.length,this.c,this.d)}value(){return this.b.substring(this.c,this.d)}},Ak=class{constructor(e=!0,t=!0){this.f=e,this.g=t}reset(e){this.d=0,this.e=0,this.b=e,this.c=e.length;for(let t=e.length-1;t>=0;t--,this.c--){const i=this.b.charCodeAt(t);if(!(i===47||this.f&&i===92))break}return this.next()}hasNext(){return this.e<this.c}next(){this.d=this.e;let e=!0;for(;this.e<this.c;this.e++){const t=this.b.charCodeAt(this.e);if(t===47||this.f&&t===92)if(e)this.d++;else break;else e=!1}return this}cmp(e){return this.g?zv(e,this.b,0,e.length,this.d,this.e):cc(e,this.b,0,e.length,this.d,this.e)}value(){return this.b.substring(this.d,this.e)}},Sk;(function(e){e[e.Scheme=1]="Scheme",e[e.Authority=2]="Authority",e[e.Path=3]="Path",e[e.Query=4]="Query",e[e.Fragment=5]="Fragment"})(Sk||(Sk={}));var Ek=class{constructor(e,t){this.f=e,this.g=t,this.d=[],this.e=0}reset(e){return this.c=e,this.d=[],this.c.scheme&&this.d.push(1),this.c.authority&&this.d.push(2),this.c.path&&(this.b=new Ak(!1,!this.f(e)),this.b.reset(e.path),this.b.value()&&this.d.push(3)),this.g(e)||(this.c.query&&this.d.push(4),this.c.fragment&&this.d.push(5)),this.e=0,this}next(){return this.d[this.e]===3&&this.b.hasNext()?this.b.next():this.e+=1,this}hasNext(){return this.d[this.e]===3&&this.b.hasNext()||this.e<this.d.length-1}cmp(e){if(this.d[this.e]===1)return Hv(e,this.c.scheme);if(this.d[this.e]===2)return Hv(e,this.c.authority);if(this.d[this.e]===3)return this.b.cmp(e);if(this.d[this.e]===4)return _o(e,this.c.query);if(this.d[this.e]===5)return _o(e,this.c.fragment);throw new Error}value(){if(this.d[this.e]===1)return this.c.scheme;if(this.d[this.e]===2)return this.c.authority;if(this.d[this.e]===3)return this.b.value();if(this.d[this.e]===4)return this.c.query;if(this.d[this.e]===5)return this.c.fragment;throw new Error}},ta=class k5{static{this.Val=Symbol("undefined_placeholder")}static wrap(t){return t===void 0?k5.Val:t}static unwrap(t){return t===k5.Val?void 0:t}},Nf=class{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}},xk;(function(e){e[e.Left=-1]="Left",e[e.Mid=0]="Mid",e[e.Right=1]="Right"})(xk||(xk={}));var Zn=class Wd{static forUris(t=()=>!1,i=()=>!1){return new Wd(new Ek(t,i))}static forPaths(t=!1){return new Wd(new Ak(void 0,!t))}static forStrings(){return new Wd(new gj)}static forConfigKeys(){return new Wd(new mj)}constructor(t){this.b=t}clear(){this.c=void 0}fill(t,i){if(i){const s=i.slice(0);sE(s);for(const r of s)this.set(r,t)}else{const s=t.slice(0);sE(s);for(const r of s)this.set(r[0],r[1])}}set(t,i){const s=this.b.reset(t);let r;this.c||(this.c=new Nf,this.c.segment=s.value());const n=[];for(r=this.c;;){const a=s.cmp(r.segment);if(a>0)r.left||(r.left=new Nf,r.left.segment=s.value()),n.push([-1,r]),r=r.left;else if(a<0)r.right||(r.right=new Nf,r.right.segment=s.value()),n.push([1,r]),r=r.right;else if(s.hasNext())s.next(),r.mid||(r.mid=new Nf,r.mid.segment=s.value()),n.push([0,r]),r=r.mid;else break}const o=ta.unwrap(r.value);r.value=ta.wrap(i),r.key=t;for(let a=n.length-1;a>=0;a--){const c=n[a][1];c.updateHeight();const l=c.balanceFactor();if(l<-1||l>1){const u=n[a][0],h=n[a+1][0];if(u===1&&h===1)n[a][1]=c.rotateLeft();else if(u===-1&&h===-1)n[a][1]=c.rotateRight();else if(u===1&&h===-1)c.right=n[a+1][1]=n[a+1][1].rotateRight(),n[a][1]=c.rotateLeft();else if(u===-1&&h===1)c.left=n[a+1][1]=n[a+1][1].rotateLeft(),n[a][1]=c.rotateRight();else throw new Error;if(a>0)switch(n[a-1][0]){case-1:n[a-1][1].left=n[a][1];break;case 1:n[a-1][1].right=n[a][1];break;case 0:n[a-1][1].mid=n[a][1];break}else this.c=n[0][1]}}return o}get(t){return ta.unwrap(this.d(t)?.value)}d(t){const i=this.b.reset(t);let s=this.c;for(;s;){const r=i.cmp(s.segment);if(r>0)s=s.left;else if(r<0)s=s.right;else if(i.hasNext())i.next(),s=s.mid;else break}return s}has(t){const i=this.d(t);return!(i?.value===void 0&&i?.mid===void 0)}delete(t){return this.e(t,!1)}deleteSuperstr(t){return this.e(t,!0)}e(t,i){const s=this.b.reset(t),r=[];let n=this.c;for(;n;){const o=s.cmp(n.segment);if(o>0)r.push([-1,n]),n=n.left;else if(o<0)r.push([1,n]),n=n.right;else if(s.hasNext())s.next(),r.push([0,n]),n=n.mid;else break}if(n){if(i?(n.left=void 0,n.mid=void 0,n.right=void 0,n.height=1):(n.key=void 0,n.value=void 0),!n.mid&&!n.value)if(n.left&&n.right){const o=[[1,n]],a=this.f(n.right,o);if(a.key){n.key=a.key,n.value=a.value,n.segment=a.segment;const c=a.right;if(o.length>1){const[u,h]=o[o.length-1];switch(u){case-1:h.left=c;break;case 0:$v(!1);case 1:$v(!1)}}else n.right=c;const l=this.g(o);if(r.length>0){const[u,h]=r[r.length-1];switch(u){case-1:h.left=l;break;case 0:h.mid=l;break;case 1:h.right=l;break}}else this.c=l}}else{const o=n.left??n.right;if(r.length>0){const[a,c]=r[r.length-1];switch(a){case-1:c.left=o;break;case 0:c.mid=o;break;case 1:c.right=o;break}}else this.c=o}this.c=this.g(r)??this.c}}f(t,i){for(;t.left;)i.push([-1,t]),t=t.left;return t}g(t){for(let i=t.length-1;i>=0;i--){const s=t[i][1];s.updateHeight();const r=s.balanceFactor();if(r>1?(s.right.balanceFactor()>=0||(s.right=s.right.rotateRight()),t[i][1]=s.rotateLeft()):r<-1&&(s.left.balanceFactor()<=0||(s.left=s.left.rotateLeft()),t[i][1]=s.rotateRight()),i>0)switch(t[i-1][0]){case-1:t[i-1][1].left=t[i][1];break;case 1:t[i-1][1].right=t[i][1];break;case 0:t[i-1][1].mid=t[i][1];break}else return t[0][1]}}findSubstr(t){const i=this.b.reset(t);let s=this.c,r;for(;s;){const n=i.cmp(s.segment);if(n>0)s=s.left;else if(n<0)s=s.right;else if(i.hasNext())i.next(),r=ta.unwrap(s.value)||r,s=s.mid;else break}return s&&ta.unwrap(s.value)||r}findSuperstr(t){return this.h(t,!1)}h(t,i){const s=this.b.reset(t);let r=this.c;for(;r;){const n=s.cmp(r.segment);if(n>0)r=r.left;else if(n<0)r=r.right;else if(s.hasNext())s.next(),r=r.mid;else return r.mid?this.j(r.mid):i?ta.unwrap(r.value):void 0}}hasElementOrSubtree(t){return this.h(t,!0)!==void 0}forEach(t){for(const[i,s]of this)t(s,i)}*[Symbol.iterator](){yield*this.j(this.c)}j(t){const i=[];return this.l(t,i),i[Symbol.iterator]()}l(t,i){t&&(t.left&&this.l(t.left,i),t.value!==void 0&&i.push([t.key,ta.unwrap(t.value)]),t.mid&&this.l(t.mid,i),t.right&&this.l(t.right,i))}_isBalanced(){const t=i=>{if(!i)return!0;const s=i.balanceFactor();return s<-1||s>1?!1:t(i.left)&&t(i.right)};return t(this.c)}};function vj(e,t,i){return Math.min(Math.max(e,t),i)}var wj=class{constructor(){this.a=0}getNext(){return this.a++}},bj=class{constructor(){this.a=1,this.b=0}update(e){return this.b=this.b+(e-this.b)/this.a,this.a+=1,this.b}get value(){return this.b}},ku;(function(e){e[e.Ignore=0]="Ignore",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(ku||(ku={})),function(e){const t="error",i="warning",s="warn",r="info",n="ignore";function o(c){return c?$s(t,c)?e.Error:$s(i,c)||$s(s,c)?e.Warning:$s(r,c)?e.Info:e.Ignore:e.Ignore}e.fromValue=o;function a(c){switch(c){case e.Error:return t;case e.Warning:return i;case e.Info:return r;default:return n}}e.toString=a}(ku||(ku={}));var Lt=ku,yj=Lt,Nte=H("notificationService"),Ck;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.SILENT=2]="SILENT",e[e.URGENT=3]="URGENT"})(Ck||(Ck={}));var kk;(function(e){e[e.WORKSPACE=0]="WORKSPACE",e[e.PROFILE=1]="PROFILE",e[e.APPLICATION=2]="APPLICATION"})(kk||(kk={}));var $k;(function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR"})($k||($k={}));var $u=H("contextService");function Aj(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.uri)}function Sj(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.configPath)}var Ik;(function(e){e[e.EMPTY=1]="EMPTY",e[e.FOLDER=2]="FOLDER",e[e.WORKSPACE=3]="WORKSPACE"})(Ik||(Ik={}));var Ej=class{get folders(){return this.g}set folders(e){this.g=e,this.n()}constructor(e,t,i,s,r){this.h=e,this.j=i,this.k=s,this.l=r,this.c=Zn.forUris(this.l,()=>!0),this.folders=t}update(e){this.h=e.id,this.k=e.configuration,this.j=e.transient,this.l=e.l,this.folders=e.folders}get id(){return this.h}get transient(){return this.j}get configuration(){return this.k}set configuration(e){this.k=e}getFolder(e){return e&&this.c.findSubstr(e)||null}n(){this.c=Zn.forUris(this.l,()=>!0);for(const e of this.folders)this.c.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}},F0=class{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return It(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}};function U0(e){return new F0({uri:e,index:0,name:Zv(e)},{uri:e.toString()})}var Dk="code-workspace",xj=`.${Dk}`,Mte=[{name:d(2776,null),extensions:[Dk]}];function Cj(e){return(typeof e=="string"?cf(e):hx(e))===xj}var kj=class{constructor(){this.a=new Set(Object.keys(V)),this.b=new Map,this.extUri=new uc(e=>{const t=this.b.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this.b.delete(e.scheme):this.b.set(e.scheme,t)}isFreeScheme(e){return!this.b.has(e)&&!this.a.has(e)}getCapabilities(e){return this.b.get(e)}},yc=H("IExtHostFileSystemInfo"),j0=Object.freeze({create:e=>Tn(e.map(t=>t.toString())).join(`\r
`),split:e=>e.split(`\r
`),parse:e=>j0.split(e).filter(t=>!t.startsWith("#"))}),Lte=new Uint32Array(10),Pk;(function(e){e[e.InitialConsonant=4352]="InitialConsonant",e[e.Vowel=4449]="Vowel",e[e.FinalConsonant=4520]="FinalConsonant",e[e.CompatibilityJamo=12593]="CompatibilityJamo"})(Pk||(Pk={}));var Tk;(function(e){e[e.NUL=0]="NUL",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z"})(Tk||(Tk={}));var Nk;(function(e){e[e.fa=24934]="fa",e[e.fg=26470]="fg",e[e.fq=29030]="fq",e[e.fr=29286]="fr",e[e.ft=29798]="ft",e[e.fv=30310]="fv",e[e.fx=30822]="fx",e[e.hk=27496]="hk",e[e.hl=27752]="hl",e[e.ho=28520]="ho",e[e.ml=27757]="ml",e[e.nj=27246]="nj",e[e.nl=27758]="nl",e[e.np=28782]="np",e[e.qt=29809]="qt",e[e.rt=29810]="rt",e[e.sg=26483]="sg",e[e.sw=30579]="sw"})(Nk||(Nk={}));var Rte=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Ote=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),Fte=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Ute=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function Mk(...e){return function(t,i){for(let s=0,r=e.length;s<r;s++){const n=e[s](t,i);if(n)return n}return null}}var jte=Lk.bind(void 0,!1),z0=Lk.bind(void 0,!0);function Lk(e,t,i){if(!i||i.length<t.length)return null;let s;return e?s=lf(i,t):s=i.indexOf(t)===0,s?t.length>0?[{start:0,end:t.length}]:[]:null}function $j(e,t){if(e.length>t.length)return null;const i=t.toLowerCase().indexOf(e.toLowerCase());return i===-1?null:[{start:i,end:i+e.length}]}function Ij(e,t){return e.length>t.length?null:H0(e.toLowerCase(),t.toLowerCase(),0,0)}function H0(e,t,i,s){if(i===e.length)return[];if(s===t.length)return null;if(e[i]===t[s]){let r=null;return(r=H0(e,t,i+1,s+1))?Ok({start:s,end:s+1},r):null}return H0(e,t,i,s+1)}function W0(e){return 97<=e&&e<=122}function Iu(e){return 65<=e&&e<=90}function B0(e){return 48<=e&&e<=57}function Dj(e){return e===32||e===9||e===10||e===13}var Pj=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(e=>Pj.add(e.charCodeAt(0)));function Rk(e){return W0(e)||Iu(e)||B0(e)}function Ok(e,t){return t.length===0?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function Fk(e,t){for(let i=t;i<e.length;i++){const s=e.charCodeAt(i);if(Iu(s)||B0(s)||i>0&&!Rk(e.charCodeAt(i-1)))return i}return e.length}function _0(e,t,i,s){if(i===e.length)return[];if(s===t.length)return null;if(e[i]!==t[s].toLowerCase())return null;{let r=null,n=s+1;for(r=_0(e,t,i+1,s+1);!r&&(n=Fk(t,n))<t.length;)r=_0(e,t,i+1,n),n++;return r===null?null:Ok({start:s,end:s+1},r)}}function Tj(e){let t=0,i=0,s=0,r=0,n=0;for(let u=0;u<e.length;u++)n=e.charCodeAt(u),Iu(n)&&t++,W0(n)&&i++,Rk(n)&&s++,B0(n)&&r++;const o=t/e.length,a=i/e.length,c=s/e.length,l=r/e.length;return{upperPercent:o,lowerPercent:a,alphaPercent:c,numericPercent:l}}function Nj(e){const{upperPercent:t,lowerPercent:i}=e;return i===0&&t>.6}function Mj(e){const{upperPercent:t,lowerPercent:i,alphaPercent:s,numericPercent:r}=e;return i>.2&&t<.8&&s>.6&&r<.2}function Lj(e){let t=0,i=0,s=0,r=0;for(let n=0;n<e.length;n++)s=e.charCodeAt(n),Iu(s)&&t++,W0(s)&&i++,Dj(s)&&r++;return(t===0||i===0)&&r===0?e.length<=30:t<=5}function Uk(e,t){if(!t||(t=t.trim(),t.length===0)||!Lj(e))return null;t.length>60&&(t=t.substring(0,60));const i=Tj(t);if(!Mj(i)){if(!Nj(i))return null;t=t.toLowerCase()}let s=null,r=0;for(e=e.toLowerCase();r<t.length&&(s=_0(e,t,0,r))===null;)r=Fk(t,r+1);return s}var zte=Mk(z0,Uk,$j),Hte=Mk(z0,Uk,Ij),Wte=new sc(1e4),Mf=128;function V0(){const e=[],t=[];for(let i=0;i<=Mf;i++)t[i]=0;for(let i=0;i<=Mf;i++)e.push(t.slice(0));return e}function jk(e){const t=[];for(let i=0;i<=e;i++)t[i]=0;return t}var Bte=jk(2*Mf),_te=jk(2*Mf),Vte=V0(),qte=V0(),Gte=V0(),zk;(function(e){e[e.Diag=1]="Diag",e[e.Left=2]="Left",e[e.LeftLeft=3]="LeftLeft"})(zk||(zk={}));var Hk;(function(e){e.Default=[-100,0];function t(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}e.isDefault=t})(Hk||(Hk={}));var Jte=class{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}},q0=Object.create(null);function m(e,t){if(Oe(t)){const i=q0[t];if(i===void 0)throw new Error(`${e} references an unknown codicon: ${t}`);t=i}return q0[e]=t,{id:e}}function Rj(){return q0}var Oj={add:m("add",6e4),plus:m("plus",6e4),gistNew:m("gist-new",6e4),repoCreate:m("repo-create",6e4),lightbulb:m("lightbulb",60001),lightBulb:m("light-bulb",60001),repo:m("repo",60002),repoDelete:m("repo-delete",60002),gistFork:m("gist-fork",60003),repoForked:m("repo-forked",60003),gitPullRequest:m("git-pull-request",60004),gitPullRequestAbandoned:m("git-pull-request-abandoned",60004),recordKeys:m("record-keys",60005),keyboard:m("keyboard",60005),tag:m("tag",60006),gitPullRequestLabel:m("git-pull-request-label",60006),tagAdd:m("tag-add",60006),tagRemove:m("tag-remove",60006),person:m("person",60007),personFollow:m("person-follow",60007),personOutline:m("person-outline",60007),personFilled:m("person-filled",60007),sourceControl:m("source-control",60008),mirror:m("mirror",60009),mirrorPublic:m("mirror-public",60009),star:m("star",60010),starAdd:m("star-add",60010),starDelete:m("star-delete",60010),starEmpty:m("star-empty",60010),comment:m("comment",60011),commentAdd:m("comment-add",60011),alert:m("alert",60012),warning:m("warning",60012),search:m("search",60013),searchSave:m("search-save",60013),logOut:m("log-out",60014),signOut:m("sign-out",60014),logIn:m("log-in",60015),signIn:m("sign-in",60015),eye:m("eye",60016),eyeUnwatch:m("eye-unwatch",60016),eyeWatch:m("eye-watch",60016),circleFilled:m("circle-filled",60017),primitiveDot:m("primitive-dot",60017),closeDirty:m("close-dirty",60017),debugBreakpoint:m("debug-breakpoint",60017),debugBreakpointDisabled:m("debug-breakpoint-disabled",60017),debugHint:m("debug-hint",60017),terminalDecorationSuccess:m("terminal-decoration-success",60017),primitiveSquare:m("primitive-square",60018),edit:m("edit",60019),pencil:m("pencil",60019),info:m("info",60020),issueOpened:m("issue-opened",60020),gistPrivate:m("gist-private",60021),gitForkPrivate:m("git-fork-private",60021),lock:m("lock",60021),mirrorPrivate:m("mirror-private",60021),close:m("close",60022),removeClose:m("remove-close",60022),x:m("x",60022),repoSync:m("repo-sync",60023),sync:m("sync",60023),clone:m("clone",60024),desktopDownload:m("desktop-download",60024),beaker:m("beaker",60025),microscope:m("microscope",60025),vm:m("vm",60026),deviceDesktop:m("device-desktop",60026),file:m("file",60027),more:m("more",60028),ellipsis:m("ellipsis",60028),kebabHorizontal:m("kebab-horizontal",60028),mailReply:m("mail-reply",60029),reply:m("reply",60029),organization:m("organization",60030),organizationFilled:m("organization-filled",60030),organizationOutline:m("organization-outline",60030),newFile:m("new-file",60031),fileAdd:m("file-add",60031),newFolder:m("new-folder",60032),fileDirectoryCreate:m("file-directory-create",60032),trash:m("trash",60033),trashcan:m("trashcan",60033),history:m("history",60034),clock:m("clock",60034),folder:m("folder",60035),fileDirectory:m("file-directory",60035),symbolFolder:m("symbol-folder",60035),logoGithub:m("logo-github",60036),markGithub:m("mark-github",60036),github:m("github",60036),terminal:m("terminal",60037),console:m("console",60037),repl:m("repl",60037),zap:m("zap",60038),symbolEvent:m("symbol-event",60038),error:m("error",60039),stop:m("stop",60039),variable:m("variable",60040),symbolVariable:m("symbol-variable",60040),array:m("array",60042),symbolArray:m("symbol-array",60042),symbolModule:m("symbol-module",60043),symbolPackage:m("symbol-package",60043),symbolNamespace:m("symbol-namespace",60043),symbolObject:m("symbol-object",60043),symbolMethod:m("symbol-method",60044),symbolFunction:m("symbol-function",60044),symbolConstructor:m("symbol-constructor",60044),symbolBoolean:m("symbol-boolean",60047),symbolNull:m("symbol-null",60047),symbolNumeric:m("symbol-numeric",60048),symbolNumber:m("symbol-number",60048),symbolStructure:m("symbol-structure",60049),symbolStruct:m("symbol-struct",60049),symbolParameter:m("symbol-parameter",60050),symbolTypeParameter:m("symbol-type-parameter",60050),symbolKey:m("symbol-key",60051),symbolText:m("symbol-text",60051),symbolReference:m("symbol-reference",60052),goToFile:m("go-to-file",60052),symbolEnum:m("symbol-enum",60053),symbolValue:m("symbol-value",60053),symbolRuler:m("symbol-ruler",60054),symbolUnit:m("symbol-unit",60054),activateBreakpoints:m("activate-breakpoints",60055),archive:m("archive",60056),arrowBoth:m("arrow-both",60057),arrowDown:m("arrow-down",60058),arrowLeft:m("arrow-left",60059),arrowRight:m("arrow-right",60060),arrowSmallDown:m("arrow-small-down",60061),arrowSmallLeft:m("arrow-small-left",60062),arrowSmallRight:m("arrow-small-right",60063),arrowSmallUp:m("arrow-small-up",60064),arrowUp:m("arrow-up",60065),bell:m("bell",60066),bold:m("bold",60067),book:m("book",60068),bookmark:m("bookmark",60069),debugBreakpointConditionalUnverified:m("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:m("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:m("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:m("debug-breakpoint-data-unverified",60072),debugBreakpointData:m("debug-breakpoint-data",60073),debugBreakpointDataDisabled:m("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:m("debug-breakpoint-log-unverified",60074),debugBreakpointLog:m("debug-breakpoint-log",60075),debugBreakpointLogDisabled:m("debug-breakpoint-log-disabled",60075),briefcase:m("briefcase",60076),broadcast:m("broadcast",60077),browser:m("browser",60078),bug:m("bug",60079),calendar:m("calendar",60080),caseSensitive:m("case-sensitive",60081),check:m("check",60082),checklist:m("checklist",60083),chevronDown:m("chevron-down",60084),chevronLeft:m("chevron-left",60085),chevronRight:m("chevron-right",60086),chevronUp:m("chevron-up",60087),chromeClose:m("chrome-close",60088),chromeMaximize:m("chrome-maximize",60089),chromeMinimize:m("chrome-minimize",60090),chromeRestore:m("chrome-restore",60091),circleOutline:m("circle-outline",60092),circle:m("circle",60092),debugBreakpointUnverified:m("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:m("terminal-decoration-incomplete",60092),circleSlash:m("circle-slash",60093),circuitBoard:m("circuit-board",60094),clearAll:m("clear-all",60095),clippy:m("clippy",60096),closeAll:m("close-all",60097),cloudDownload:m("cloud-download",60098),cloudUpload:m("cloud-upload",60099),code:m("code",60100),collapseAll:m("collapse-all",60101),colorMode:m("color-mode",60102),commentDiscussion:m("comment-discussion",60103),creditCard:m("credit-card",60105),dash:m("dash",60108),dashboard:m("dashboard",60109),database:m("database",60110),debugContinue:m("debug-continue",60111),debugDisconnect:m("debug-disconnect",60112),debugPause:m("debug-pause",60113),debugRestart:m("debug-restart",60114),debugStart:m("debug-start",60115),debugStepInto:m("debug-step-into",60116),debugStepOut:m("debug-step-out",60117),debugStepOver:m("debug-step-over",60118),debugStop:m("debug-stop",60119),debug:m("debug",60120),deviceCameraVideo:m("device-camera-video",60121),deviceCamera:m("device-camera",60122),deviceMobile:m("device-mobile",60123),diffAdded:m("diff-added",60124),diffIgnored:m("diff-ignored",60125),diffModified:m("diff-modified",60126),diffRemoved:m("diff-removed",60127),diffRenamed:m("diff-renamed",60128),diff:m("diff",60129),diffSidebyside:m("diff-sidebyside",60129),discard:m("discard",60130),editorLayout:m("editor-layout",60131),emptyWindow:m("empty-window",60132),exclude:m("exclude",60133),extensions:m("extensions",60134),eyeClosed:m("eye-closed",60135),fileBinary:m("file-binary",60136),fileCode:m("file-code",60137),fileMedia:m("file-media",60138),filePdf:m("file-pdf",60139),fileSubmodule:m("file-submodule",60140),fileSymlinkDirectory:m("file-symlink-directory",60141),fileSymlinkFile:m("file-symlink-file",60142),fileZip:m("file-zip",60143),files:m("files",60144),filter:m("filter",60145),flame:m("flame",60146),foldDown:m("fold-down",60147),foldUp:m("fold-up",60148),fold:m("fold",60149),folderActive:m("folder-active",60150),folderOpened:m("folder-opened",60151),gear:m("gear",60152),gift:m("gift",60153),gistSecret:m("gist-secret",60154),gist:m("gist",60155),gitCommit:m("git-commit",60156),gitCompare:m("git-compare",60157),compareChanges:m("compare-changes",60157),gitMerge:m("git-merge",60158),githubAction:m("github-action",60159),githubAlt:m("github-alt",60160),globe:m("globe",60161),grabber:m("grabber",60162),graph:m("graph",60163),gripper:m("gripper",60164),heart:m("heart",60165),home:m("home",60166),horizontalRule:m("horizontal-rule",60167),hubot:m("hubot",60168),inbox:m("inbox",60169),issueReopened:m("issue-reopened",60171),issues:m("issues",60172),italic:m("italic",60173),jersey:m("jersey",60174),json:m("json",60175),bracket:m("bracket",60175),kebabVertical:m("kebab-vertical",60176),key:m("key",60177),law:m("law",60178),lightbulbAutofix:m("lightbulb-autofix",60179),linkExternal:m("link-external",60180),link:m("link",60181),listOrdered:m("list-ordered",60182),listUnordered:m("list-unordered",60183),liveShare:m("live-share",60184),loading:m("loading",60185),location:m("location",60186),mailRead:m("mail-read",60187),mail:m("mail",60188),markdown:m("markdown",60189),megaphone:m("megaphone",60190),mention:m("mention",60191),milestone:m("milestone",60192),gitPullRequestMilestone:m("git-pull-request-milestone",60192),mortarBoard:m("mortar-board",60193),move:m("move",60194),multipleWindows:m("multiple-windows",60195),mute:m("mute",60196),noNewline:m("no-newline",60197),note:m("note",60198),octoface:m("octoface",60199),openPreview:m("open-preview",60200),package:m("package",60201),paintcan:m("paintcan",60202),pin:m("pin",60203),play:m("play",60204),run:m("run",60204),plug:m("plug",60205),preserveCase:m("preserve-case",60206),preview:m("preview",60207),project:m("project",60208),pulse:m("pulse",60209),question:m("question",60210),quote:m("quote",60211),radioTower:m("radio-tower",60212),reactions:m("reactions",60213),references:m("references",60214),refresh:m("refresh",60215),regex:m("regex",60216),remoteExplorer:m("remote-explorer",60217),remote:m("remote",60218),remove:m("remove",60219),replaceAll:m("replace-all",60220),replace:m("replace",60221),repoClone:m("repo-clone",60222),repoForcePush:m("repo-force-push",60223),repoPull:m("repo-pull",60224),repoPush:m("repo-push",60225),report:m("report",60226),requestChanges:m("request-changes",60227),rocket:m("rocket",60228),rootFolderOpened:m("root-folder-opened",60229),rootFolder:m("root-folder",60230),rss:m("rss",60231),ruby:m("ruby",60232),saveAll:m("save-all",60233),saveAs:m("save-as",60234),save:m("save",60235),screenFull:m("screen-full",60236),screenNormal:m("screen-normal",60237),searchStop:m("search-stop",60238),server:m("server",60240),settingsGear:m("settings-gear",60241),settings:m("settings",60242),shield:m("shield",60243),smiley:m("smiley",60244),sortPrecedence:m("sort-precedence",60245),splitHorizontal:m("split-horizontal",60246),splitVertical:m("split-vertical",60247),squirrel:m("squirrel",60248),starFull:m("star-full",60249),starHalf:m("star-half",60250),symbolClass:m("symbol-class",60251),symbolColor:m("symbol-color",60252),symbolConstant:m("symbol-constant",60253),symbolEnumMember:m("symbol-enum-member",60254),symbolField:m("symbol-field",60255),symbolFile:m("symbol-file",60256),symbolInterface:m("symbol-interface",60257),symbolKeyword:m("symbol-keyword",60258),symbolMisc:m("symbol-misc",60259),symbolOperator:m("symbol-operator",60260),symbolProperty:m("symbol-property",60261),wrench:m("wrench",60261),wrenchSubaction:m("wrench-subaction",60261),symbolSnippet:m("symbol-snippet",60262),tasklist:m("tasklist",60263),telescope:m("telescope",60264),textSize:m("text-size",60265),threeBars:m("three-bars",60266),thumbsdown:m("thumbsdown",60267),thumbsup:m("thumbsup",60268),tools:m("tools",60269),triangleDown:m("triangle-down",60270),triangleLeft:m("triangle-left",60271),triangleRight:m("triangle-right",60272),triangleUp:m("triangle-up",60273),twitter:m("twitter",60274),unfold:m("unfold",60275),unlock:m("unlock",60276),unmute:m("unmute",60277),unverified:m("unverified",60278),verified:m("verified",60279),versions:m("versions",60280),vmActive:m("vm-active",60281),vmOutline:m("vm-outline",60282),vmRunning:m("vm-running",60283),watch:m("watch",60284),whitespace:m("whitespace",60285),wholeWord:m("whole-word",60286),window:m("window",60287),wordWrap:m("word-wrap",60288),zoomIn:m("zoom-in",60289),zoomOut:m("zoom-out",60290),listFilter:m("list-filter",60291),listFlat:m("list-flat",60292),listSelection:m("list-selection",60293),selection:m("selection",60293),listTree:m("list-tree",60294),debugBreakpointFunctionUnverified:m("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:m("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:m("debug-breakpoint-function-disabled",60296),debugStackframeActive:m("debug-stackframe-active",60297),circleSmallFilled:m("circle-small-filled",60298),debugStackframeDot:m("debug-stackframe-dot",60298),terminalDecorationMark:m("terminal-decoration-mark",60298),debugStackframe:m("debug-stackframe",60299),debugStackframeFocused:m("debug-stackframe-focused",60299),debugBreakpointUnsupported:m("debug-breakpoint-unsupported",60300),symbolString:m("symbol-string",60301),debugReverseContinue:m("debug-reverse-continue",60302),debugStepBack:m("debug-step-back",60303),debugRestartFrame:m("debug-restart-frame",60304),debugAlt:m("debug-alt",60305),callIncoming:m("call-incoming",60306),callOutgoing:m("call-outgoing",60307),menu:m("menu",60308),expandAll:m("expand-all",60309),feedback:m("feedback",60310),gitPullRequestReviewer:m("git-pull-request-reviewer",60310),groupByRefType:m("group-by-ref-type",60311),ungroupByRefType:m("ungroup-by-ref-type",60312),account:m("account",60313),gitPullRequestAssignee:m("git-pull-request-assignee",60313),bellDot:m("bell-dot",60314),debugConsole:m("debug-console",60315),library:m("library",60316),output:m("output",60317),runAll:m("run-all",60318),syncIgnored:m("sync-ignored",60319),pinned:m("pinned",60320),githubInverted:m("github-inverted",60321),serverProcess:m("server-process",60322),serverEnvironment:m("server-environment",60323),pass:m("pass",60324),issueClosed:m("issue-closed",60324),stopCircle:m("stop-circle",60325),playCircle:m("play-circle",60326),record:m("record",60327),debugAltSmall:m("debug-alt-small",60328),vmConnect:m("vm-connect",60329),cloud:m("cloud",60330),merge:m("merge",60331),export:m("export",60332),graphLeft:m("graph-left",60333),magnet:m("magnet",60334),notebook:m("notebook",60335),redo:m("redo",60336),checkAll:m("check-all",60337),pinnedDirty:m("pinned-dirty",60338),passFilled:m("pass-filled",60339),circleLargeFilled:m("circle-large-filled",60340),circleLarge:m("circle-large",60341),circleLargeOutline:m("circle-large-outline",60341),combine:m("combine",60342),gather:m("gather",60342),table:m("table",60343),variableGroup:m("variable-group",60344),typeHierarchy:m("type-hierarchy",60345),typeHierarchySub:m("type-hierarchy-sub",60346),typeHierarchySuper:m("type-hierarchy-super",60347),gitPullRequestCreate:m("git-pull-request-create",60348),runAbove:m("run-above",60349),runBelow:m("run-below",60350),notebookTemplate:m("notebook-template",60351),debugRerun:m("debug-rerun",60352),workspaceTrusted:m("workspace-trusted",60353),workspaceUntrusted:m("workspace-untrusted",60354),workspaceUnknown:m("workspace-unknown",60355),terminalCmd:m("terminal-cmd",60356),terminalDebian:m("terminal-debian",60357),terminalLinux:m("terminal-linux",60358),terminalPowershell:m("terminal-powershell",60359),terminalTmux:m("terminal-tmux",60360),terminalUbuntu:m("terminal-ubuntu",60361),terminalBash:m("terminal-bash",60362),arrowSwap:m("arrow-swap",60363),copy:m("copy",60364),personAdd:m("person-add",60365),filterFilled:m("filter-filled",60366),wand:m("wand",60367),debugLineByLine:m("debug-line-by-line",60368),inspect:m("inspect",60369),layers:m("layers",60370),layersDot:m("layers-dot",60371),layersActive:m("layers-active",60372),compass:m("compass",60373),compassDot:m("compass-dot",60374),compassActive:m("compass-active",60375),azure:m("azure",60376),issueDraft:m("issue-draft",60377),gitPullRequestClosed:m("git-pull-request-closed",60378),gitPullRequestDraft:m("git-pull-request-draft",60379),debugAll:m("debug-all",60380),debugCoverage:m("debug-coverage",60381),runErrors:m("run-errors",60382),folderLibrary:m("folder-library",60383),debugContinueSmall:m("debug-continue-small",60384),beakerStop:m("beaker-stop",60385),graphLine:m("graph-line",60386),graphScatter:m("graph-scatter",60387),pieChart:m("pie-chart",60388),bracketDot:m("bracket-dot",60389),bracketError:m("bracket-error",60390),lockSmall:m("lock-small",60391),azureDevops:m("azure-devops",60392),verifiedFilled:m("verified-filled",60393),newline:m("newline",60394),layout:m("layout",60395),layoutActivitybarLeft:m("layout-activitybar-left",60396),layoutActivitybarRight:m("layout-activitybar-right",60397),layoutPanelLeft:m("layout-panel-left",60398),layoutPanelCenter:m("layout-panel-center",60399),layoutPanelJustify:m("layout-panel-justify",60400),layoutPanelRight:m("layout-panel-right",60401),layoutPanel:m("layout-panel",60402),layoutSidebarLeft:m("layout-sidebar-left",60403),layoutSidebarRight:m("layout-sidebar-right",60404),layoutStatusbar:m("layout-statusbar",60405),layoutMenubar:m("layout-menubar",60406),layoutCentered:m("layout-centered",60407),target:m("target",60408),indent:m("indent",60409),recordSmall:m("record-small",60410),errorSmall:m("error-small",60411),terminalDecorationError:m("terminal-decoration-error",60411),arrowCircleDown:m("arrow-circle-down",60412),arrowCircleLeft:m("arrow-circle-left",60413),arrowCircleRight:m("arrow-circle-right",60414),arrowCircleUp:m("arrow-circle-up",60415),layoutSidebarRightOff:m("layout-sidebar-right-off",60416),layoutPanelOff:m("layout-panel-off",60417),layoutSidebarLeftOff:m("layout-sidebar-left-off",60418),blank:m("blank",60419),heartFilled:m("heart-filled",60420),map:m("map",60421),mapHorizontal:m("map-horizontal",60421),foldHorizontal:m("fold-horizontal",60421),mapFilled:m("map-filled",60422),mapHorizontalFilled:m("map-horizontal-filled",60422),foldHorizontalFilled:m("fold-horizontal-filled",60422),circleSmall:m("circle-small",60423),bellSlash:m("bell-slash",60424),bellSlashDot:m("bell-slash-dot",60425),commentUnresolved:m("comment-unresolved",60426),gitPullRequestGoToChanges:m("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:m("git-pull-request-new-changes",60428),searchFuzzy:m("search-fuzzy",60429),commentDraft:m("comment-draft",60430),send:m("send",60431),sparkle:m("sparkle",60432),insert:m("insert",60433),mic:m("mic",60434),thumbsdownFilled:m("thumbsdown-filled",60435),thumbsupFilled:m("thumbsup-filled",60436),coffee:m("coffee",60437),snake:m("snake",60438),game:m("game",60439),vr:m("vr",60440),chip:m("chip",60441),piano:m("piano",60442),music:m("music",60443),micFilled:m("mic-filled",60444),repoFetch:m("repo-fetch",60445),copilot:m("copilot",60446),lightbulbSparkle:m("lightbulb-sparkle",60447),robot:m("robot",60448),sparkleFilled:m("sparkle-filled",60449),diffSingle:m("diff-single",60450),diffMultiple:m("diff-multiple",60451),surroundWith:m("surround-with",60452),share:m("share",60453),gitStash:m("git-stash",60454),gitStashApply:m("git-stash-apply",60455),gitStashPop:m("git-stash-pop",60456),vscode:m("vscode",60457),vscodeInsiders:m("vscode-insiders",60458),codeOss:m("code-oss",60459),runCoverage:m("run-coverage",60460),runAllCoverage:m("run-all-coverage",60461),coverage:m("coverage",60462),githubProject:m("github-project",60463),mapVertical:m("map-vertical",60464),foldVertical:m("fold-vertical",60464),mapVerticalFilled:m("map-vertical-filled",60465),foldVerticalFilled:m("fold-vertical-filled",60465),goToSearch:m("go-to-search",60466),percentage:m("percentage",60467),sortPercentage:m("sort-percentage",60467),attach:m("attach",60468),goToEditingSession:m("go-to-editing-session",60469),editSession:m("edit-session",60470),codeReview:m("code-review",60471),copilotWarning:m("copilot-warning",60472),python:m("python",60473),copilotLarge:m("copilot-large",60474),copilotWarningLarge:m("copilot-warning-large",60475),keyboardTab:m("keyboard-tab",60476),copilotBlocked:m("copilot-blocked",60477),copilotNotConnected:m("copilot-not-connected",60478),flag:m("flag",60479),lightbulbEmpty:m("lightbulb-empty",60480),symbolMethodArrow:m("symbol-method-arrow",60481),copilotUnavailable:m("copilot-unavailable",60482),repoPinned:m("repo-pinned",60483),keyboardTabAbove:m("keyboard-tab-above",60484),keyboardTabBelow:m("keyboard-tab-below",60485),gitPullRequestDone:m("git-pull-request-done",60486),mcp:m("mcp",60487),extensionsLarge:m("extensions-large",60488),layoutPanelDock:m("layout-panel-dock",60489),layoutSidebarLeftDock:m("layout-sidebar-left-dock",60490),layoutSidebarRightDock:m("layout-sidebar-right-dock",60491),copilotInProgress:m("copilot-in-progress",60492),copilotError:m("copilot-error",60493),copilotSuccess:m("copilot-success",60494),chatSparkle:m("chat-sparkle",60495),searchSparkle:m("search-sparkle",60496),editSparkle:m("edit-sparkle",60497),copilotSnooze:m("copilot-snooze",60498),sendToRemoteAgent:m("send-to-remote-agent",60499),commentDiscussionSparkle:m("comment-discussion-sparkle",60500),chatSparkleWarning:m("chat-sparkle-warning",60501),chatSparkleError:m("chat-sparkle-error",60502),collection:m("collection",60503),newCollection:m("new-collection",60504),thinking:m("thinking",60505),build:m("build",60506),commentDiscussionQuote:m("comment-discussion-quote",60507),cursor:m("cursor",60508),eraser:m("eraser",60509),fileText:m("file-text",60510),quotes:m("quotes",60512),rename:m("rename",60513),runWithDeps:m("run-with-deps",60514),debugConnected:m("debug-connected",60515),strikethrough:m("strikethrough",60516),openInProduct:m("open-in-product",60517),indexZero:m("index-zero",60518),agent:m("agent",60519),editCode:m("edit-code",60520),repoSelected:m("repo-selected",60521),skip:m("skip",60522),mergeInto:m("merge-into",60523),gitBranchChanges:m("git-branch-changes",60524),gitBranchStagedChanges:m("git-branch-staged-changes",60525),gitBranchConflicts:m("git-branch-conflicts",60526),gitBranch:m("git-branch",60527),gitBranchCreate:m("git-branch-create",60527),gitBranchDelete:m("git-branch-delete",60527),searchLarge:m("search-large",60528),terminalGitBash:m("terminal-git-bash",60529),windowActive:m("window-active",60530),forward:m("forward",60531),download:m("download",60532),clockface:m("clockface",60533),unarchive:m("unarchive",60534),sessionInProgress:m("session-in-progress",60535),collectionSmall:m("collection-small",60536),vmSmall:m("vm-small",60537),cloudSmall:m("cloud-small",60538),addSmall:m("add-small",60539),removeSmall:m("remove-small",60540),worktreeSmall:m("worktree-small",60541),worktree:m("worktree",60542)},Fj={dialogError:m("dialog-error","error"),dialogWarning:m("dialog-warning","warning"),dialogInfo:m("dialog-info","info"),dialogClose:m("dialog-close","close"),treeItemExpanded:m("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:m("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:m("tree-filter-on-type-off","list-selection"),treeFilterClear:m("tree-filter-clear","close"),treeItemLoading:m("tree-item-loading","loading"),menuSelection:m("menu-selection","check"),menuSubmenu:m("menu-submenu","chevron-right"),menuBarMore:m("menubar-more","more"),scrollbarButtonLeft:m("scrollbar-button-left","triangle-left"),scrollbarButtonRight:m("scrollbar-button-right","triangle-right"),scrollbarButtonUp:m("scrollbar-button-up","triangle-up"),scrollbarButtonDown:m("scrollbar-button-down","triangle-down"),toolBarMore:m("toolbar-more","more"),quickInputBack:m("quick-input-back","arrow-left"),dropDownButton:m("drop-down-button",60084),symbolCustomColor:m("symbol-customcolor",60252),exportIcon:m("export",60332),workspaceUnspecified:m("workspace-unspecified",60355),newLine:m("newline",60394),thumbsDownFilled:m("thumbsdown-filled",60435),thumbsUpFilled:m("thumbsup-filled",60436),gitFetch:m("git-fetch",60445),lightbulbSparkleAutofix:m("lightbulb-sparkle-autofix",60447),debugBreakpointPending:m("debug-breakpoint-pending",60377)},oe={...Oj,...Fj},Ac;(function(e){function t(i){return!!i&&typeof i=="object"&&typeof i.id=="string"}e.isThemeColor=t})(Ac||(Ac={}));var Dt;(function(e){e.iconNameSegment="[A-Za-z0-9]+",e.iconNameExpression="[A-Za-z0-9-]+",e.iconModifierExpression="~[A-Za-z]+",e.iconNameCharacter="[A-Za-z0-9~-]";const t=new RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function i(g){const v=t.exec(g.id);if(!v)return i(oe.error);const[,b,S]=v,E=["codicon","codicon-"+b];return S&&E.push("codicon-modifier-"+S.substring(1)),E}e.asClassNameArray=i;function s(g){return i(g).join(" ")}e.asClassName=s;function r(g){return"."+i(g).join(".")}e.asCSSSelector=r;function n(g){return!!g&&typeof g=="object"&&typeof g.id=="string"&&(typeof g.color>"u"||Ac.isThemeColor(g.color))}e.isThemeIcon=n;const o=new RegExp(`^\\$\\((${e.iconNameExpression}(?:${e.iconModifierExpression})?)\\)$`);function a(g){const v=o.exec(g);if(!v)return;const[,b]=v;return{id:b}}e.fromString=a;function c(g){return{id:g}}e.fromId=c;function l(g,v){let b=g.id;const S=b.lastIndexOf("~");return S!==-1&&(b=b.substring(0,S)),v&&(b=`${b}~${v}`),{id:b}}e.modify=l;function u(g){const v=g.id.lastIndexOf("~");if(v!==-1)return g.id.substring(v+1)}e.getModifier=u;function h(g,v){return g.id===v.id&&g.color?.id===v.color?.id}e.isEqual=h;function f(g){return g?.id===oe.file.id}e.isFile=f;function p(g){return g?.id===oe.folder.id}e.isFolder=p})(Dt||(Dt={}));var G0=new RegExp(`\\$\\(${Dt.iconNameExpression}(?:${Dt.iconModifierExpression})?\\)`,"g"),Uj=new RegExp(`(\\\\)?${G0.source}`,"g");function jj(e){return e.replace(Uj,(t,i)=>i?t:`\\${t}`)}var Zte=new RegExp(`\\\\${G0.source}`,"g"),Qte=new RegExp(`(\\s)?(\\\\)?${G0.source}(\\s)?`,"g"),Yte=new RegExp(`\\$\\(${Dt.iconNameCharacter}+\\)`,"g"),Wk;(function(e){e[e.Paragraph=0]="Paragraph",e[e.Break=1]="Break"})(Wk||(Wk={}));var Qn=class yM{static lift(t){const i=new yM(t.value,t);return i.uris=t.uris,i.baseUri=t.baseUri?y.revive(t.baseUri):void 0,i}constructor(t="",i=!1){if(this.value=t,typeof this.value!="string")throw $e("value");typeof i=="boolean"?(this.isTrusted=i,this.supportThemeIcons=!1,this.supportHtml=!1,this.supportAlertSyntax=!1):(this.isTrusted=i.isTrusted??void 0,this.supportThemeIcons=i.supportThemeIcons??!1,this.supportHtml=i.supportHtml??!1,this.supportAlertSyntax=i.supportAlertSyntax??!1)}appendText(t,i=0){return this.value+=zj(this.supportThemeIcons?jj(t):t).replace(/([ \t]+)/g,(s,r)=>"&nbsp;".repeat(r.length)).replace(/\>/gm,"\\>").replace(/\n/g,i===1?`\\
`:`

`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,i){return this.value+=`
${Hj(i,t)}
`,this}appendLink(t,i,s){return this.value+="[",this.value+=this.c(i,"]"),this.value+="](",this.value+=this.c(String(t),")"),s&&(this.value+=` "${this.c(this.c(s,'"'),")")}"`),this.value+=")",this}c(t,i){const s=new RegExp(Un(i),"g");return t.replace(s,(r,n)=>t.charAt(n-1)!=="\\"?`\\${r}`:r)}};function Yn(e){return e instanceof Qn?!0:e&&typeof e=="object"?typeof e.value=="string"&&(typeof e.isTrusted=="boolean"||typeof e.isTrusted=="object"||e.isTrusted===void 0)&&(typeof e.supportThemeIcons=="boolean"||e.supportThemeIcons===void 0)&&(typeof e.supportAlertSyntax=="boolean"||e.supportAlertSyntax===void 0):!1}function zj(e){return e.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Hj(e,t){const i=e.match(/^`+/gm)?.reduce((r,n)=>r.length>n.length?r:n).length??0,s=i>=3?i+1:3;return[`${"`".repeat(s)}${t}`,e,`${"`".repeat(s)}`].join(`
`)}function Wj(e){const t=[],i=e.split("|").map(r=>r.trim());e=i[0];const s=i[1];if(s){const r=/height=(\d+)/.exec(s),n=/width=(\d+)/.exec(s),o=r?r[1]:"",a=n?n[1]:"",c=isFinite(parseInt(a)),l=isFinite(parseInt(o));c&&t.push(`width="${a}"`),l&&t.push(`height="${o}"`)}return{href:e,dimensions:t}}function J0(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ia=J0();function Bk(e){ia=e}var _k=/[&<>"']/,Bj=new RegExp(_k.source,"g"),Vk=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,_j=new RegExp(Vk.source,"g"),Vj={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qk=e=>Vj[e];function gs(e,t){if(t){if(_k.test(e))return e.replace(Bj,qk)}else if(Vk.test(e))return e.replace(_j,qk);return e}var qj=/(^|[^\[])\^/g;function wt(e,t){let i=typeof e=="string"?e:e.source;t=t||"";const s={replace:(r,n)=>{let o=typeof n=="string"?n:n.source;return o=o.replace(qj,"$1"),i=i.replace(r,o),s},getRegex:()=>new RegExp(i,t)};return s}function Gk(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}var Du={exec:()=>null};function Jk(e,t){const i=e.replace(/\|/g,(n,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),s=i.split(/ \|/);let r=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),t)if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;r<s.length;r++)s[r]=s[r].trim().replace(/\\\|/g,"|");return s}function Pu(e,t,i){const s=e.length;if(s===0)return"";let r=0;for(;r<s;){const n=e.charAt(s-r-1);if(n===t&&!i)r++;else if(n!==t&&i)r++;else break}return e.slice(0,s-r)}function Gj(e,t){if(e.indexOf(t[1])===-1)return-1;let i=0;for(let s=0;s<e.length;s++)if(e[s]==="\\")s++;else if(e[s]===t[0])i++;else if(e[s]===t[1]&&(i--,i<0))return s;return-1}function Zk(e,t,i,s){const r=t.href,n=t.title?gs(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){s.state.inLink=!0;const a={type:"link",raw:i,href:r,title:n,text:o,tokens:s.inlineTokens(o)};return s.state.inLink=!1,a}return{type:"image",raw:i,href:r,title:n,text:gs(o)}}function Jj(e,t){const i=e.match(/^(\s+)(?:```)/);if(i===null)return t;const s=i[1];return t.split(`
`).map(r=>{const n=r.match(/^\s+/);if(n===null)return r;const[o]=n;return o.length>=s.length?r.slice(s.length):r}).join(`
`)}var Lf=class{options;rules;lexer;constructor(e){this.options=e||ia}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Pu(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],s=Jj(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=Pu(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Pu(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=Pu(t[0],`
`).split(`
`),s="",r="";const n=[];for(;i.length>0;){let o=!1;const a=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))a.push(i[c]),o=!0;else if(!o)a.push(i[c]);else break;i=i.slice(c);const l=a.join(`
`),u=l.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");s=s?`${s}
${l}`:l,r=r?`${r}
${u}`:u;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,n,!0),this.lexer.state.top=h,i.length===0)break;const f=n[n.length-1];if(f?.type==="code")break;if(f?.type==="blockquote"){const p=f,g=p.raw+`
`+i.join(`
`),v=this.blockquote(g);n[n.length-1]=v,s=s.substring(0,s.length-p.raw.length)+v.raw,r=r.substring(0,r.length-p.text.length)+v.text;break}else if(f?.type==="list"){const p=f,g=p.raw+`
`+i.join(`
`),v=this.list(g);n[n.length-1]=v,s=s.substring(0,s.length-f.raw.length)+v.raw,r=r.substring(0,r.length-p.raw.length)+v.raw,i=g.substring(n[n.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:n,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const s=i.length>1,r={type:"list",raw:"",ordered:s,start:s?+i.slice(0,-1):"",loose:!1,items:[]};i=s?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=s?i:"[*+-]");const n=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o=!1;for(;e;){let a=!1,c="",l="";if(!(t=n.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let u=t[2].split(`
`,1)[0].replace(/^\t+/,b=>" ".repeat(3*b.length)),h=e.split(`
`,1)[0],f=!u.trim(),p=0;if(this.options.pedantic?(p=2,l=u.trimStart()):f?p=t[1].length+1:(p=t[2].search(/[^ ]/),p=p>4?1:p,l=u.slice(p),p+=t[1].length),f&&/^ *$/.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),a=!0),!a){const b=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),S=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),E=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),k=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const j=e.split(`
`,1)[0];if(h=j,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),E.test(h)||k.test(h)||b.test(h)||S.test(e))break;if(h.search(/[^ ]/)>=p||!h.trim())l+=`
`+h.slice(p);else{if(f||u.search(/[^ ]/)>=4||E.test(u)||k.test(u)||S.test(u))break;l+=`
`+h}!f&&!h.trim()&&(f=!0),c+=j+`
`,e=e.substring(j.length+1),u=h.slice(p)}}r.loose||(o?r.loose=!0:/\n *\n *$/.test(c)&&(o=!0));let g=null,v;this.options.gfm&&(g=/^\[[ xX]\] /.exec(l),g&&(v=g[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),r.items.push({type:"list_item",raw:c,task:!!g,checked:v,loose:!1,text:l,tokens:[]}),r.raw+=c}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd(),r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd(),r.raw=r.raw.trimEnd();for(let a=0;a<r.items.length;a++)if(this.lexer.state.top=!1,r.items[a].tokens=this.lexer.blockTokens(r.items[a].text,[]),!r.loose){const c=r.items[a].tokens.filter(u=>u.type==="space"),l=c.length>0&&c.some(u=>/\n.*\n/.test(u.raw));r.loose=l}if(r.loose)for(let a=0;a<r.items.length;a++)r.items[a].loose=!0;return r}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:s,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=Jk(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),r=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],n={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===s.length){for(const o of s)/^ *-+: *$/.test(o)?n.align.push("right"):/^ *:-+: *$/.test(o)?n.align.push("center"):/^ *:-+ *$/.test(o)?n.align.push("left"):n.align.push(null);for(let o=0;o<i.length;o++)n.header.push({text:i[o],tokens:this.lexer.inline(i[o]),header:!0,align:n.align[o]});for(const o of r)n.rows.push(Jk(o,n.header.length).map((a,c)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:n.align[c]})));return n}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:gs(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const n=Pu(i.slice(0,-1),"\\");if((i.length-n.length)%2===0)return}else{const n=Gj(t[2],"()");if(n>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+n;t[2]=t[2].substring(0,n),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let s=t[2],r="";if(this.options.pedantic){const n=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);n&&(s=n[1],r=n[3])}else r=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(i)?s=s.slice(1):s=s.slice(1,-1)),Zk(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=(i[2]||i[1]).replace(/\s+/g," "),r=t[s.toLowerCase()];if(!r){const n=i[0].charAt(0);return{type:"text",raw:n,text:n}}return Zk(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const n=[...s[0]].length-1;let o,a,c=n,l=0;const u=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+n);(s=u.exec(t))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(a=[...o].length,s[3]||s[4]){c+=a;continue}else if((s[5]||s[6])&&n%3&&!((n+a)%3)){l+=a;continue}if(c-=a,c>0)continue;a=Math.min(a,a+c+l);const h=[...s[0]][0].length,f=e.slice(0,n+s.index+h+a);if(Math.min(n,a)%2){const g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const s=/[^ ]/.test(i),r=/^ /.test(i)&&/ $/.test(i);return s&&r&&(i=i.substring(1,i.length-1)),i=gs(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,s;return t[2]==="@"?(i=gs(t[1]),s="mailto:"+i):(i=gs(t[1]),s=i),{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=gs(t[0]),s="mailto:"+i;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(r!==t[0]);i=gs(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=gs(t[0]),{type:"text",raw:t[0],text:i}}}},Zj=/^(?: *(?:\n|$))+/,Qj=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Yj=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Tu=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Xj=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Qk=/(?:[*+-]|\d{1,9}[.)])/,Yk=wt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Qk).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Z0=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Kj=/^[^\n]+/,Q0=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ez=wt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Q0).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),tz=wt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Qk).getRegex(),Rf="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Y0=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,iz=wt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Y0).replace("tag",Rf).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Xk=wt(Z0).replace("hr",Tu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rf).getRegex(),sz=wt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Xk).getRegex(),X0={blockquote:sz,code:Qj,def:ez,fences:Yj,heading:Xj,hr:Tu,html:iz,lheading:Yk,list:tz,newline:Zj,paragraph:Xk,table:Du,text:Kj},Kk=wt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Tu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rf).getRegex(),rz={...X0,table:Kk,paragraph:wt(Z0).replace("hr",Tu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Kk).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rf).getRegex()},nz={...X0,html:wt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Y0).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Du,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:wt(Z0).replace("hr",Tu).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Yk).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},e$=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,oz=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,t$=/^( {2,}|\\)\n(?!\s*$)/,az=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Nu="\\p{P}\\p{S}",cz=wt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Nu).getRegex(),lz=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,uz=wt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Nu).getRegex(),hz=wt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Nu).getRegex(),dz=wt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Nu).getRegex(),fz=wt(/\\([punct])/,"gu").replace(/punct/g,Nu).getRegex(),pz=wt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),gz=wt(Y0).replace("(?:-->|$)","-->").getRegex(),mz=wt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",gz).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Of=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,vz=wt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Of).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),i$=wt(/^!?\[(label)\]\[(ref)\]/).replace("label",Of).replace("ref",Q0).getRegex(),s$=wt(/^!?\[(ref)\](?:\[\])?/).replace("ref",Q0).getRegex(),wz=wt("reflink|nolink(?!\\()","g").replace("reflink",i$).replace("nolink",s$).getRegex(),K0={_backpedal:Du,anyPunctuation:fz,autolink:pz,blockSkip:lz,br:t$,code:oz,del:Du,emStrongLDelim:uz,emStrongRDelimAst:hz,emStrongRDelimUnd:dz,escape:e$,link:vz,nolink:s$,punctuation:cz,reflink:i$,reflinkSearch:wz,tag:mz,text:az,url:Du},bz={...K0,link:wt(/^!?\[(label)\]\((.*?)\)/).replace("label",Of).getRegex(),reflink:wt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Of).getRegex()},ew={...K0,escape:wt(e$).replace("])","~|])").getRegex(),url:wt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},yz={...ew,br:wt(t$).replace("{2,}","*").getRegex(),text:wt(ew.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ff={normal:X0,gfm:rz,pedantic:nz},Mu={normal:K0,gfm:ew,breaks:yz,pedantic:bz},sa=class $5{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||ia,this.options.tokenizer=this.options.tokenizer||new Lf,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const i={block:Ff.normal,inline:Mu.normal};this.options.pedantic?(i.block=Ff.pedantic,i.inline=Mu.pedantic):this.options.gfm&&(i.block=Ff.gfm,this.options.breaks?i.inline=Mu.breaks:i.inline=Mu.gfm),this.tokenizer.rules=i}static get rules(){return{block:Ff,inline:Mu}}static lex(t,i){return new $5(i).lex(t)}static lexInline(t,i){return new $5(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let i=0;i<this.inlineQueue.length;i++){const s=this.inlineQueue[i];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,i=[],s=!1){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(a,c,l)=>c+"    ".repeat(l.length));let r,n,o;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},t,i))?(t=t.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+r.raw,n.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),i.push(r);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=t.slice(1);let l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},c),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(o=t.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){n=i[i.length-1],s&&n?.type==="paragraph"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(r),s=o.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&n.type==="text"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(r);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,i}inline(t,i=[]){return this.inlineQueue.push({src:t,tokens:i}),i}inlineTokens(t,i=[]){let s,r,n,o=t,a,c,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(s=u.call({lexer:this},t,i))?(t=t.substring(s.raw.length),i.push(s),!0):!1))){if(s=this.tokenizer.escape(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.tag(t)){t=t.substring(s.raw.length),r=i[i.length-1],r&&s.type==="text"&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):i.push(s);continue}if(s=this.tokenizer.link(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(s.raw.length),r=i[i.length-1],r&&s.type==="text"&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):i.push(s);continue}if(s=this.tokenizer.emStrong(t,o,l)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.codespan(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.br(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.del(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.autolink(t)){t=t.substring(s.raw.length),i.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(t))){t=t.substring(s.raw.length),i.push(s);continue}if(n=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const h=t.slice(1);let f;this.options.extensions.startInline.forEach(p=>{f=p.call({lexer:this},h),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(n=t.substring(0,u+1))}if(s=this.tokenizer.inlineText(n)){t=t.substring(s.raw.length),s.raw.slice(-1)!=="_"&&(l=s.raw.slice(-1)),c=!0,r=i[i.length-1],r&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):i.push(s);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return i}},Uf=class{options;parser;constructor(e){this.options=e||ia}space(e){return""}code({text:e,lang:t,escaped:i}){const s=(t||"").match(/^\S*/)?.[0],r=e.replace(/\n$/,"")+`
`;return s?'<pre><code class="language-'+gs(s)+'">'+(i?r:gs(r,!0))+`</code></pre>
`:"<pre><code>"+(i?r:gs(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let s="";for(let o=0;o<e.items.length;o++){const a=e.items[o];s+=this.listitem(a)}const r=t?"ol":"ul",n=t&&i!==1?' start="'+i+'"':"";return"<"+r+n+`>
`+s+"</"+r+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let r=0;r<e.header.length;r++)i+=this.tablecell(e.header[r]);t+=this.tablerow({text:i});let s="";for(let r=0;r<e.rows.length;r++){const n=e.rows[r];i="";for(let o=0;o<n.length;o++)i+=this.tablecell(n[o]);s+=this.tablerow({text:i})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+s+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const s=this.parser.parseInline(i),r=Gk(e);if(r===null)return s;e=r;let n='<a href="'+e+'"';return t&&(n+=' title="'+t+'"'),n+=">"+s+"</a>",n}image({href:e,title:t,text:i}){const s=Gk(e);if(s===null)return i;e=s;let r=`<img src="${e}" alt="${i}"`;return t&&(r+=` title="${t}"`),r+=">",r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}},tw=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},ra=class I5{options;renderer;textRenderer;constructor(t){this.options=t||ia,this.options.renderer=this.options.renderer||new Uf,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new tw}static parse(t,i){return new I5(i).parse(t)}static parseInline(t,i){return new I5(i).parseInline(t)}parse(t,i=!0){let s="";for(let r=0;r<t.length;r++){const n=t[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const a=n,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){s+=c||"";continue}}const o=n;switch(o.type){case"space":{s+=this.renderer.space(o);continue}case"hr":{s+=this.renderer.hr(o);continue}case"heading":{s+=this.renderer.heading(o);continue}case"code":{s+=this.renderer.code(o);continue}case"table":{s+=this.renderer.table(o);continue}case"blockquote":{s+=this.renderer.blockquote(o);continue}case"list":{s+=this.renderer.list(o);continue}case"html":{s+=this.renderer.html(o);continue}case"paragraph":{s+=this.renderer.paragraph(o);continue}case"text":{let a=o,c=this.renderer.text(a);for(;r+1<t.length&&t[r+1].type==="text";)a=t[++r],c+=`
`+this.renderer.text(a);i?s+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c}]}):s+=c;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}parseInline(t,i){i=i||this.renderer;let s="";for(let r=0;r<t.length;r++){const n=t[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const a=this.options.extensions.renderers[n.type].call({parser:this},n);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)){s+=a||"";continue}}const o=n;switch(o.type){case"escape":{s+=i.text(o);break}case"html":{s+=i.html(o);break}case"link":{s+=i.link(o);break}case"image":{s+=i.image(o);break}case"strong":{s+=i.strong(o);break}case"em":{s+=i.em(o);break}case"codespan":{s+=i.codespan(o);break}case"br":{s+=i.br(o);break}case"del":{s+=i.del(o);break}case"text":{s+=i.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}},jf=class{options;constructor(e){this.options=e||ia}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}},Az=class{defaults=J0();options=this.setOptions;parse=this.parseMarkdown(sa.lex,ra.parse);parseInline=this.parseMarkdown(sa.lexInline,ra.parseInline);Parser=ra;Renderer=Uf;TextRenderer=tw;Lexer=sa;Tokenizer=Lf;Hooks=jf;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const s of e)switch(i=i.concat(t.call(this,s)),s.type){case"table":{const r=s;for(const n of r.header)i=i.concat(this.walkTokens(n.tokens,t));for(const n of r.rows)for(const o of n)i=i.concat(this.walkTokens(o.tokens,t));break}case"list":{const r=s;i=i.concat(this.walkTokens(r.items,t));break}default:{const r=s;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(n=>{const o=r[n].flat(1/0);i=i.concat(this.walkTokens(o,t))}):r.tokens&&(i=i.concat(this.walkTokens(r.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const s={...i};if(s.async=this.defaults.async||s.async||!1,i.extensions&&(i.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const n=t.renderers[r.name];n?t.renderers[r.name]=function(...o){let a=r.renderer.apply(this,o);return a===!1&&(a=n.apply(this,o)),a}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const n=t[r.level];n?n.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),s.extensions=t),i.renderer){const r=this.defaults.renderer||new Uf(this.defaults);for(const n in i.renderer){if(!(n in r))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const o=n,a=i.renderer[o],c=r[o];r[o]=(...l)=>{let u=a.apply(r,l);return u===!1&&(u=c.apply(r,l)),u||""}}s.renderer=r}if(i.tokenizer){const r=this.defaults.tokenizer||new Lf(this.defaults);for(const n in i.tokenizer){if(!(n in r))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const o=n,a=i.tokenizer[o],c=r[o];r[o]=(...l)=>{let u=a.apply(r,l);return u===!1&&(u=c.apply(r,l)),u}}s.tokenizer=r}if(i.hooks){const r=this.defaults.hooks||new jf;for(const n in i.hooks){if(!(n in r))throw new Error(`hook '${n}' does not exist`);if(n==="options")continue;const o=n,a=i.hooks[o],c=r[o];jf.passThroughHooks.has(n)?r[o]=l=>{if(this.defaults.async)return Promise.resolve(a.call(r,l)).then(h=>c.call(r,h));const u=a.call(r,l);return c.call(r,u)}:r[o]=(...l)=>{let u=a.apply(r,l);return u===!1&&(u=c.apply(r,l)),u}}s.hooks=r}if(i.walkTokens){const r=this.defaults.walkTokens,n=i.walkTokens;s.walkTokens=function(o){let a=[];return a.push(n.call(this,o)),r&&(a=a.concat(r.call(this,o))),a}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return sa.lex(e,t??this.defaults)}parser(e,t){return ra.parse(e,t??this.defaults)}parseMarkdown(e,t){return(s,r)=>{const n={...r},o={...this.defaults,...n},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&n.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof s>"u"||s===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(s):s).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(s=o.hooks.preprocess(s));let c=e(s,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let l=t(c,o);return o.hooks&&(l=o.hooks.postprocess(l)),l}catch(c){return a(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+gs(i.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(i);throw i}}},na=new Az;function ft(e,t){return na.parse(e,t)}ft.options=ft.setOptions=function(e){return na.setOptions(e),ft.defaults=na.defaults,Bk(ft.defaults),ft},ft.getDefaults=J0,ft.defaults=ia,ft.use=function(...e){return na.use(...e),ft.defaults=na.defaults,Bk(ft.defaults),ft},ft.walkTokens=function(e,t){return na.walkTokens(e,t)},ft.parseInline=na.parseInline,ft.Parser=ra,ft.parser=ra.parse,ft.Renderer=Uf,ft.TextRenderer=tw,ft.Lexer=sa,ft.lexer=sa.lex,ft.Tokenizer=Lf,ft.Hooks=jf,ft.parse=ft;var Xte=ft.options,Kte=ft.setOptions,eie=ft.use,tie=ft.walkTokens,iie=ft.parseInline,sie=ra.parse,rie=sa.lex,Qs=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),Sz=/^(.+)\/(.+?)(;.+)?$/;function r$(e,t){const i=Sz.exec(e);return i?`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`:t?void 0:e}function n$(e){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(e)}var Pi=Symbol("unset"),Ez=class{constructor(){this.root=new iw,this.a=0}get size(){return this.a}get nodes(){return this.root.children?.values()||Bt.empty()}get entries(){return this.root.children?.entries()||Bt.empty()}insert(e,t,i){this.c(e,s=>s._value=t,i)}mutate(e,t){this.c(e,i=>i._value=t(i._value===Pi?void 0:i._value))}mutatePath(e,t){this.c(e,()=>{},i=>t(i))}delete(e){const t=this.b(e);if(!t)return;let i=t.length-1;const s=t[i].node._value;if(s!==Pi){for(this.a--,t[i].node._value=Pi;i>0;i--){const{node:r,part:n}=t[i];if(r.children?.size||r._value!==Pi)break;t[i-1].node.children.delete(n)}return s}}*deleteRecursive(e){const t=this.b(e);if(!t)return;const i=t[t.length-1].node;for(let s=t.length-1;s>0;s--){const r=t[s-1];if(r.node.children.delete(t[s].part),r.node.children.size>0||r.node._value!==Pi)break}for(const s of o$(i))s._value!==Pi&&(this.a--,yield s._value);i===this.root&&(this.root._value=Pi,this.root.children=void 0)}find(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return;t=s}return t._value===Pi?void 0:t._value}hasKeyOrParent(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return!1;if(s._value!==Pi)return!0;t=s}return!1}hasKeyOrChildren(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return!1;t=s}return!0}hasKey(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return!1;t=s}return t._value!==Pi}b(e){const t=[{part:"",node:this.root}];let i=0;for(const s of e){const r=t[i].node.children?.get(s);if(!r)return;t.push({part:s,node:r}),i++}return t}c(e,t,i){let s=this.root;for(const o of e){if(s.children)if(s.children.has(o))s=s.children.get(o);else{const a=new iw;s.children.set(o,a),s=a}else{const a=new iw;s.children=new Map([[o,a]]),s=a}i?.(s)}const r=s._value===Pi?0:1;t(s);const n=s._value===Pi?0:1;this.a+=n-r}*values(){for(const{_value:e}of o$(this.root))e!==Pi&&(yield e)}};function*o$(e){const t=[e];for(;t.length>0;){const i=t.pop();if(yield i,i.children)for(const s of i.children.values())t.push(s)}}var iw=class{constructor(){this._value=Pi}get value(){return this._value===Pi?void 0:this._value}set value(e){this._value=e===void 0?Pi:e}},ms=class Qa{constructor(t,i){this.lineNumber=t,this.column=i}with(t=this.lineNumber,i=this.column){return t===this.lineNumber&&i===this.column?this:new Qa(t,i)}delta(t=0,i=0){return this.with(Math.max(1,this.lineNumber+t),Math.max(1,this.column+i))}equals(t){return Qa.equals(this,t)}static equals(t,i){return!t&&!i?!0:!!t&&!!i&&t.lineNumber===i.lineNumber&&t.column===i.column}isBefore(t){return Qa.isBefore(this,t)}static isBefore(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<i.column}isBeforeOrEqual(t){return Qa.isBeforeOrEqual(this,t)}static isBeforeOrEqual(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<=i.column}static compare(t,i){const s=t.lineNumber|0,r=i.lineNumber|0;if(s===r){const n=t.column|0,o=i.column|0;return n-o}return s-r}clone(){return new Qa(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new Qa(t.lineNumber,t.column)}static isIPosition(t){return!!t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},rt=class ti{constructor(t,i,s,r){t>s||t===s&&i>r?(this.startLineNumber=s,this.startColumn=r,this.endLineNumber=t,this.endColumn=i):(this.startLineNumber=t,this.startColumn=i,this.endLineNumber=s,this.endColumn=r)}isEmpty(){return ti.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(t){return ti.containsPosition(this,t)}static containsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<t.startColumn||i.lineNumber===t.endLineNumber&&i.column>t.endColumn)}static strictContainsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<=t.startColumn||i.lineNumber===t.endLineNumber&&i.column>=t.endColumn)}containsRange(t){return ti.containsRange(this,t)}static containsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>t.endColumn)}strictContainsRange(t){return ti.strictContainsRange(this,t)}static strictContainsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<=t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>=t.endColumn)}plusRange(t){return ti.plusRange(this,t)}static plusRange(t,i){let s,r,n,o;return i.startLineNumber<t.startLineNumber?(s=i.startLineNumber,r=i.startColumn):i.startLineNumber===t.startLineNumber?(s=i.startLineNumber,r=Math.min(i.startColumn,t.startColumn)):(s=t.startLineNumber,r=t.startColumn),i.endLineNumber>t.endLineNumber?(n=i.endLineNumber,o=i.endColumn):i.endLineNumber===t.endLineNumber?(n=i.endLineNumber,o=Math.max(i.endColumn,t.endColumn)):(n=t.endLineNumber,o=t.endColumn),new ti(s,r,n,o)}intersectRanges(t){return ti.intersectRanges(this,t)}static intersectRanges(t,i){let s=t.startLineNumber,r=t.startColumn,n=t.endLineNumber,o=t.endColumn;const a=i.startLineNumber,c=i.startColumn,l=i.endLineNumber,u=i.endColumn;return s<a?(s=a,r=c):s===a&&(r=Math.max(r,c)),n>l?(n=l,o=u):n===l&&(o=Math.min(o,u)),s>n||s===n&&r>o?null:new ti(s,r,n,o)}equalsRange(t){return ti.equalsRange(this,t)}static equalsRange(t,i){return!t&&!i?!0:!!t&&!!i&&t.startLineNumber===i.startLineNumber&&t.startColumn===i.startColumn&&t.endLineNumber===i.endLineNumber&&t.endColumn===i.endColumn}getEndPosition(){return ti.getEndPosition(this)}static getEndPosition(t){return new ms(t.endLineNumber,t.endColumn)}getStartPosition(){return ti.getStartPosition(this)}static getStartPosition(t){return new ms(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(t,i){return new ti(this.startLineNumber,this.startColumn,t,i)}setStartPosition(t,i){return new ti(t,i,this.endLineNumber,this.endColumn)}collapseToStart(){return ti.collapseToStart(this)}static collapseToStart(t){return new ti(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return ti.collapseToEnd(this)}static collapseToEnd(t){return new ti(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new ti(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(t,i=t){return new ti(t.lineNumber,t.column,i.lineNumber,i.column)}static lift(t){return t?new ti(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(t){return!!t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn)}static areIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<=i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<=t.startColumn)}static areOnlyIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber-1||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn-1||i.endLineNumber<t.startLineNumber-1||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn-1)}static compareRangesUsingStarts(t,i){if(t&&i){const n=t.startLineNumber|0,o=i.startLineNumber|0;if(n===o){const a=t.startColumn|0,c=i.startColumn|0;if(a===c){const l=t.endLineNumber|0,u=i.endLineNumber|0;if(l===u){const h=t.endColumn|0,f=i.endColumn|0;return h-f}return l-u}return a-c}return n-o}return(t?1:0)-(i?1:0)}static compareRangesUsingEnds(t,i){return t.endLineNumber===i.endLineNumber?t.endColumn===i.endColumn?t.startLineNumber===i.startLineNumber?t.startColumn-i.startColumn:t.startLineNumber-i.startLineNumber:t.endColumn-i.endColumn:t.endLineNumber-i.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}},xz=class{constructor(){this.a=new Map,this.b=new Map,this.c=new I,this.onDidChange=this.c.event,this.d=null}handleChange(e){this.c.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this.a.set(e,t),this.handleChange([e]),te(()=>{this.a.get(e)===t&&(this.a.delete(e),this.handleChange([e]))})}get(e){return this.a.get(e)||null}registerFactory(e,t){this.b.get(e)?.dispose();const i=new Cz(this,e,t);return this.b.set(e,i),te(()=>{const s=this.b.get(e);!s||s!==i||(this.b.delete(e),s.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this.b.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this.b.get(e);return!!(!i||i.isResolved)}setColorMap(e){this.d=e,this.c.fire({changedLanguages:Array.from(this.a.keys()),changedColorMap:!0})}getColorMap(){return this.d}getDefaultBackground(){return this.d&&this.d.length>2?this.d[2]:null}},Cz=class extends Z{get isResolved(){return this.c}constructor(e,t,i){super(),this.f=e,this.g=t,this.h=i,this.a=!1,this.b=null,this.c=!1}dispose(){this.a=!0,super.dispose()}async resolve(){return this.b||(this.b=this.j()),this.b}async j(){const e=await this.h.tokenizationSupport;this.c=!0,e&&!this.a&&this.D(this.f.register(this.g,e))}},a$;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(a$||(a$={}));var c$;(function(e){e[e.Method=0]="Method",e[e.Function=1]="Function",e[e.Constructor=2]="Constructor",e[e.Field=3]="Field",e[e.Variable=4]="Variable",e[e.Class=5]="Class",e[e.Struct=6]="Struct",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Event=10]="Event",e[e.Operator=11]="Operator",e[e.Unit=12]="Unit",e[e.Value=13]="Value",e[e.Constant=14]="Constant",e[e.Enum=15]="Enum",e[e.EnumMember=16]="EnumMember",e[e.Keyword=17]="Keyword",e[e.Text=18]="Text",e[e.Color=19]="Color",e[e.File=20]="File",e[e.Reference=21]="Reference",e[e.Customcolor=22]="Customcolor",e[e.Folder=23]="Folder",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue",e[e.Tool=27]="Tool",e[e.Snippet=28]="Snippet"})(c$||(c$={}));var l$;(function(e){const t=new Map;t.set(0,oe.symbolMethod),t.set(1,oe.symbolFunction),t.set(2,oe.symbolConstructor),t.set(3,oe.symbolField),t.set(4,oe.symbolVariable),t.set(5,oe.symbolClass),t.set(6,oe.symbolStruct),t.set(7,oe.symbolInterface),t.set(8,oe.symbolModule),t.set(9,oe.symbolProperty),t.set(10,oe.symbolEvent),t.set(11,oe.symbolOperator),t.set(12,oe.symbolUnit),t.set(13,oe.symbolValue),t.set(15,oe.symbolEnum),t.set(14,oe.symbolConstant),t.set(15,oe.symbolEnum),t.set(16,oe.symbolEnumMember),t.set(17,oe.symbolKeyword),t.set(28,oe.symbolSnippet),t.set(18,oe.symbolText),t.set(19,oe.symbolColor),t.set(20,oe.symbolFile),t.set(21,oe.symbolReference),t.set(22,oe.symbolCustomColor),t.set(23,oe.symbolFolder),t.set(24,oe.symbolTypeParameter),t.set(25,oe.account),t.set(26,oe.issues),t.set(27,oe.tools);function i(o){let a=t.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=oe.symbolProperty),a}e.toIcon=i;function s(o){switch(o){case 0:return d(848,null);case 1:return d(849,null);case 2:return d(850,null);case 3:return d(851,null);case 4:return d(852,null);case 5:return d(853,null);case 6:return d(854,null);case 7:return d(855,null);case 8:return d(856,null);case 9:return d(857,null);case 10:return d(858,null);case 11:return d(859,null);case 12:return d(860,null);case 13:return d(861,null);case 14:return d(862,null);case 15:return d(863,null);case 16:return d(864,null);case 17:return d(865,null);case 18:return d(866,null);case 19:return d(867,null);case 20:return d(868,null);case 21:return d(869,null);case 22:return d(870,null);case 23:return d(871,null);case 24:return d(872,null);case 25:return d(873,null);case 26:return d(874,null);case 27:return d(875,null);case 28:return d(876,null);default:return""}}e.toLabel=s;const r=new Map;r.set("method",0),r.set("function",1),r.set("constructor",2),r.set("field",3),r.set("variable",4),r.set("class",5),r.set("struct",6),r.set("interface",7),r.set("module",8),r.set("property",9),r.set("event",10),r.set("operator",11),r.set("unit",12),r.set("value",13),r.set("constant",14),r.set("enum",15),r.set("enum-member",16),r.set("enumMember",16),r.set("keyword",17),r.set("snippet",28),r.set("text",18),r.set("color",19),r.set("file",20),r.set("reference",21),r.set("customcolor",22),r.set("folder",23),r.set("type-parameter",24),r.set("typeParameter",24),r.set("account",25),r.set("issue",26),r.set("tool",27);function n(o,a){let c=r.get(o);return typeof c>"u"&&!a&&(c=9),c}e.fromString=n})(l$||(l$={}));var u$;(function(e){e[e.Deprecated=1]="Deprecated"})(u$||(u$={}));var h$;(function(e){e[e.None=0]="None",e[e.KeepWhitespace=1]="KeepWhitespace",e[e.InsertAsSnippet=4]="InsertAsSnippet"})(h$||(h$={}));var d$;(function(e){e[e.Word=0]="Word",e[e.Line=1]="Line",e[e.Suggest=2]="Suggest"})(d$||(d$={}));var f$;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(f$||(f$={}));var zf;(function(e){e[e.Automatic=0]="Automatic",e[e.Explicit=1]="Explicit"})(zf||(zf={}));var Sc;(function(e){e[e.Code=1]="Code",e[e.Label=2]="Label"})(Sc||(Sc={}));var Hf;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(Hf||(Hf={}));var p$;(function(e){e[e.Invoke=1]="Invoke",e[e.Auto=2]="Auto"})(p$||(p$={}));var g$;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(g$||(g$={}));var m$;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(m$||(m$={}));var v$;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(v$||(v$={}));function kz(e){return!!e&&y.isUri(e.uri)&&rt.isIRange(e.range)&&(rt.isIRange(e.originSelectionRange)||rt.isIRange(e.targetSelectionRange))}function $z(e){return!!e&&y.isUri(e.uri)&&rt.isIRange(e.range)}var w$;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(w$||(w$={}));var nie={17:d(877,null),16:d(878,null),4:d(879,null),13:d(880,null),8:d(881,null),9:d(882,null),21:d(883,null),23:d(884,null),7:d(885,null),0:d(886,null),11:d(887,null),10:d(888,null),19:d(889,null),5:d(890,null),1:d(891,null),2:d(892,null),20:d(893,null),15:d(894,null),18:d(895,null),24:d(896,null),3:d(897,null),6:d(898,null),14:d(899,null),22:d(900,null),25:d(901,null),12:d(902,null)},b$;(function(e){e[e.Deprecated=1]="Deprecated"})(b$||(b$={}));var sw;(function(e){const t=new Map;t.set(0,oe.symbolFile),t.set(1,oe.symbolModule),t.set(2,oe.symbolNamespace),t.set(3,oe.symbolPackage),t.set(4,oe.symbolClass),t.set(5,oe.symbolMethod),t.set(6,oe.symbolProperty),t.set(7,oe.symbolField),t.set(8,oe.symbolConstructor),t.set(9,oe.symbolEnum),t.set(10,oe.symbolInterface),t.set(11,oe.symbolFunction),t.set(12,oe.symbolVariable),t.set(13,oe.symbolConstant),t.set(14,oe.symbolString),t.set(15,oe.symbolNumber),t.set(16,oe.symbolBoolean),t.set(17,oe.symbolArray),t.set(18,oe.symbolObject),t.set(19,oe.symbolKey),t.set(20,oe.symbolNull),t.set(21,oe.symbolEnumMember),t.set(22,oe.symbolStruct),t.set(23,oe.symbolEvent),t.set(24,oe.symbolOperator),t.set(25,oe.symbolTypeParameter);function i(n){let o=t.get(n);return o||(console.info("No codicon found for SymbolKind "+n),o=oe.symbolProperty),o}e.toIcon=i;const s=new Map;s.set(0,20),s.set(1,8),s.set(2,8),s.set(3,8),s.set(4,5),s.set(5,0),s.set(6,9),s.set(7,3),s.set(8,2),s.set(9,15),s.set(10,7),s.set(11,1),s.set(12,4),s.set(13,14),s.set(14,18),s.set(15,13),s.set(16,13),s.set(17,13),s.set(18,13),s.set(19,17),s.set(20,13),s.set(21,16),s.set(22,6),s.set(23,10),s.set(24,11),s.set(25,24);function r(n){let o=s.get(n);return o===void 0&&(console.info("No completion kind found for SymbolKind "+n),o=20),o}e.toCompletionKind=r})(sw||(sw={}));var Ec=class Po{static{this.Comment=new Po("comment")}static{this.Imports=new Po("imports")}static{this.Region=new Po("region")}static fromValue(t){switch(t){case"comment":return Po.Comment;case"imports":return Po.Imports;case"region":return Po.Region}return new Po(t)}constructor(t){this.value=t}},y$;(function(e){e[e.AIGenerated=1]="AIGenerated"})(y$||(y$={}));var Wf;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(Wf||(Wf={}));var rw;(function(e){function t(i){return!i||typeof i!="object"?!1:typeof i.id=="string"&&typeof i.title=="string"}e.is=t})(rw||(rw={}));var xc;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(xc||(xc={}));var Lu;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(Lu||(Lu={}));var Ru;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(Ru||(Ru={}));var A$;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(A$||(A$={}));var S$;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(S$||(S$={}));var E$;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(E$||(E$={}));var oie=new xz,x$;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(x$||(x$={}));var C$;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(C$||(C$={}));var ji;(function(e){e[e.Hint=1]="Hint",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"})(ji||(ji={})),function(e){function t(c,l){return l-c}e.compare=t;const i=Object.create(null);i[e.Error]=d(2179,null),i[e.Warning]=d(2180,null),i[e.Info]=d(2181,null);function s(c){return i[c]||""}e.toString=s;const r=Object.create(null);r[e.Error]=d(2182,null),r[e.Warning]=d(2183,null),r[e.Info]=d(2184,null);function n(c){return r[c]||""}e.toStringPlural=n;function o(c){switch(c){case Lt.Error:return e.Error;case Lt.Warning:return e.Warning;case Lt.Info:return e.Info;case Lt.Ignore:return e.Hint}}e.fromSeverity=o;function a(c){switch(c){case e.Error:return Lt.Error;case e.Warning:return Lt.Warning;case e.Info:return Lt.Info;case e.Hint:return Lt.Ignore}}e.toSeverity=a}(ji||(ji={}));var k$;(function(e){const t="";function i(r){return s(r,!0)}e.makeKey=i;function s(r,n){const o=[t];return r.source?o.push(r.source.replace("\xA6","\\\xA6")):o.push(t),r.code?typeof r.code=="string"?o.push(r.code.replace("\xA6","\\\xA6")):o.push(r.code.value.replace("\xA6","\\\xA6")):o.push(t),r.severity!==void 0&&r.severity!==null?o.push(ji.toString(r.severity)):o.push(t),r.message&&n?o.push(r.message.replace("\xA6","\\\xA6")):o.push(t),r.startLineNumber!==void 0&&r.startLineNumber!==null?o.push(r.startLineNumber.toString()):o.push(t),r.startColumn!==void 0&&r.startColumn!==null?o.push(r.startColumn.toString()):o.push(t),r.endLineNumber!==void 0&&r.endLineNumber!==null?o.push(r.endLineNumber.toString()):o.push(t),r.endColumn!==void 0&&r.endColumn!==null?o.push(r.endColumn.toString()):o.push(t),o.push(t),o.join("\xA6")}e.makeKeyOptionalMessage=s})(k$||(k$={}));var aie=H("markerService"),Iz=class{constructor(){this.a=new Map}add(e,t){ki(Oe(e)),ki(At(t)),ki(!this.a.has(e),"There is already an extension with this id"),this.a.set(e,t)}knows(e){return this.a.has(e)}as(e){return this.a.get(e)||null}dispose(){this.a.forEach(e=>{hE(e.dispose)&&e.dispose()}),this.a.clear()}},Qt=new Iz,nw=H("fileService");function Cc(e){return e.create===!0}var is;(function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"})(is||(is={}));var Xn;(function(e){e[e.Readonly=1]="Readonly",e[e.Locked=2]="Locked"})(Xn||(Xn={}));var $$;(function(e){e[e.UPDATED=2]="UPDATED",e[e.ADDED=4]="ADDED",e[e.DELETED=8]="DELETED"})($$||($$={}));var I$;(function(e){e[e.None=0]="None",e[e.FileReadWrite=2]="FileReadWrite",e[e.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",e[e.FileReadStream=16]="FileReadStream",e[e.FileFolderCopy=8]="FileFolderCopy",e[e.PathCaseSensitive=1024]="PathCaseSensitive",e[e.Readonly=2048]="Readonly",e[e.Trash=4096]="Trash",e[e.FileWriteUnlock=8192]="FileWriteUnlock",e[e.FileAtomicRead=16384]="FileAtomicRead",e[e.FileAtomicWrite=32768]="FileAtomicWrite",e[e.FileAtomicDelete=65536]="FileAtomicDelete",e[e.FileClone=131072]="FileClone",e[e.FileRealpath=262144]="FileRealpath"})(I$||(I$={}));var he;(function(e){e.FileExists="EntryExists",e.FileNotFound="EntryNotFound",e.FileNotADirectory="EntryNotADirectory",e.FileIsADirectory="EntryIsADirectory",e.FileExceedsStorageQuota="EntryExceedsStorageQuota",e.FileTooLarge="EntryTooLarge",e.FileWriteLocked="EntryWriteLocked",e.NoPermissions="NoPermissions",e.Unavailable="Unavailable",e.Unknown="Unknown"})(he||(he={}));var Bf=class AM extends Error{static create(t,i){const s=new AM(t.toString(),i);return D$(s,i),s}constructor(t,i){super(t),this.code=i}};function nn(e,t){return Bf.create(e,t)}function Dz(e){return e||nn(d(2089,null),he.Unknown)}function D$(e,t){return e.name=t?`${t} (FileSystemError)`:"FileSystemError",e}function _f(e){if(!e)return he.Unknown;if(e instanceof Bf)return e.code;const t=/^(.+) \(FileSystemError\)$/.exec(e.name);if(!t)return he.Unknown;switch(t[1]){case he.FileExists:return he.FileExists;case he.FileIsADirectory:return he.FileIsADirectory;case he.FileNotADirectory:return he.FileNotADirectory;case he.FileNotFound:return he.FileNotFound;case he.FileTooLarge:return he.FileTooLarge;case he.FileWriteLocked:return he.FileWriteLocked;case he.NoPermissions:return he.NoPermissions;case he.Unavailable:return he.Unavailable}return he.Unknown}function Pz(e){if(e instanceof Vf)return e.fileOperationResult;switch(_f(e)){case he.FileNotFound:return 1;case he.FileIsADirectory:return 0;case he.FileNotADirectory:return 9;case he.FileWriteLocked:return 5;case he.NoPermissions:return 6;case he.FileExists:return 4;case he.FileTooLarge:return 7;default:return 10}}var P$;(function(e){e[e.CREATE=0]="CREATE",e[e.DELETE=1]="DELETE",e[e.MOVE=2]="MOVE",e[e.COPY=3]="COPY",e[e.WRITE=4]="WRITE"})(P$||(P$={}));var T$;(function(e){e[e.UPDATED=0]="UPDATED",e[e.ADDED=1]="ADDED",e[e.DELETED=2]="DELETED"})(T$||(T$={}));var cie=class iv{static{this.a=null}constructor(t,i){this.c=i,this.b=void 0,this.d=new Tt(()=>{const s=Zn.forUris(()=>this.c);return s.fill(this.rawAdded.map(r=>[r,!0])),s}),this.f=new Tt(()=>{const s=Zn.forUris(()=>this.c);return s.fill(this.rawUpdated.map(r=>[r,!0])),s}),this.g=new Tt(()=>{const s=Zn.forUris(()=>this.c);return s.fill(this.rawDeleted.map(r=>[r,!0])),s}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(const s of t){switch(s.type){case 1:this.rawAdded.push(s.resource);break;case 0:this.rawUpdated.push(s.resource);break;case 2:this.rawDeleted.push(s.resource);break}this.b!==iv.a&&(typeof s.cId=="number"?this.b===void 0?this.b=s.cId:this.b!==s.cId&&(this.b=iv.a):this.b!==void 0&&(this.b=iv.a))}}contains(t,...i){return this.h(t,{includeChildren:!1},...i)}affects(t,...i){return this.h(t,{includeChildren:!0},...i)}h(t,i,...s){if(!t)return!1;const r=s.length>0;return!!((!r||s.includes(1))&&(this.d.value.get(t)||i.includeChildren&&this.d.value.findSuperstr(t))||(!r||s.includes(0))&&(this.f.value.get(t)||i.includeChildren&&this.f.value.findSuperstr(t))||(!r||s.includes(2))&&(this.g.value.findSubstr(t)||i.includeChildren&&this.g.value.findSuperstr(t)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(t){return this.b===t}hasCorrelation(){return typeof this.b=="number"}};function Tz(e,t,i){return!e||!t||e===t||t.length>e.length?!1:(t.charAt(t.length-1)!==St&&(t+=St),i?lf(e,t):e.indexOf(t)===0)}var Vf=class extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}},N$;(function(e){e[e.FILE_IS_DIRECTORY=0]="FILE_IS_DIRECTORY",e[e.FILE_NOT_FOUND=1]="FILE_NOT_FOUND",e[e.FILE_NOT_MODIFIED_SINCE=2]="FILE_NOT_MODIFIED_SINCE",e[e.FILE_MODIFIED_SINCE=3]="FILE_MODIFIED_SINCE",e[e.FILE_MOVE_CONFLICT=4]="FILE_MOVE_CONFLICT",e[e.FILE_WRITE_LOCKED=5]="FILE_WRITE_LOCKED",e[e.FILE_PERMISSION_DENIED=6]="FILE_PERMISSION_DENIED",e[e.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",e[e.FILE_INVALID_PATH=8]="FILE_INVALID_PATH",e[e.FILE_NOT_DIRECTORY=9]="FILE_NOT_DIRECTORY",e[e.FILE_OTHER_ERROR=10]="FILE_OTHER_ERROR"})(N$||(N$={}));var M$;(function(e){e[e.FILE=0]="FILE",e[e.FOLDER=1]="FOLDER",e[e.ROOT_FOLDER=2]="ROOT_FOLDER"})(M$||(M$={}));var Nz="";function L$(e){if(!(typeof e.size!="number"||typeof e.mtime!="number"))return e.mtime.toString(29)+e.size.toString(31)}var R$=class Ji{static{this.KB=1024}static{this.MB=Ji.KB*Ji.KB}static{this.GB=Ji.MB*Ji.KB}static{this.TB=Ji.GB*Ji.KB}static formatSize(t){return Cs(t)||(t=0),t<Ji.KB?d(2090,null,t.toFixed(0)):t<Ji.MB?d(2091,null,(t/Ji.KB).toFixed(2)):t<Ji.GB?d(2092,null,(t/Ji.MB).toFixed(2)):t<Ji.TB?d(2093,null,(t/Ji.GB).toFixed(2)):d(2094,null,(t/Ji.TB).toFixed(2))}},Mz=class extends Z{get onDidChange(){return this.j.event}constructor(e,t="",i="",s=!0,r){super(),this.j=this.D(new I),this.z=!0,this.m=e,this.n=t,this.w=i,this.z=s,this.F=r}get id(){return this.m}get label(){return this.n}set label(e){this.G(e)}G(e){this.n!==e&&(this.n=e,this.j.fire({label:e}))}get tooltip(){return this.u||""}set tooltip(e){this.H(e)}H(e){this.u!==e&&(this.u=e,this.j.fire({tooltip:e}))}get class(){return this.w}set class(e){this.I(e)}I(e){this.w!==e&&(this.w=e,this.j.fire({class:e}))}get enabled(){return this.z}set enabled(e){this.J(e)}J(e){this.z!==e&&(this.z=e,this.j.fire({enabled:e}))}get checked(){return this.C}set checked(e){this.L(e)}L(e){this.C!==e&&(this.C=e,this.j.fire({checked:e}))}async run(e,t){this.F&&await this.F(e)}},lie=class D5{constructor(){this.id=D5.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...t){let i=[];for(const s of t)s.length&&(i.length?i=[...i,new D5,...s]:i=s);return i}static{this.ID="vs.actions.separator"}async run(){}},uie=class SM extends Mz{static{this.ID="vs.actions.empty"}constructor(){super(SM.ID,d(44,null),void 0,!1)}},Lz={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},Rz={id:"default",displayName:d(4484,null),providerDisplayName:d(4485,null)},Oz="workbench.editors.textDiffEditor",Fz="workbench.editors.binaryResourceDiffEditor",O$;(function(e){e[e.PROGRAMMATIC=1]="PROGRAMMATIC",e[e.USER=2]="USER",e[e.EDIT=3]="EDIT",e[e.NAVIGATION=4]="NAVIGATION",e[e.JUMP=5]="JUMP"})(O$||(O$={}));var F$;(function(e){e[e.IDENTICAL=1]="IDENTICAL",e[e.SIMILAR=2]="SIMILAR",e[e.DIFFERENT=3]="DIFFERENT"})(F$||(F$={}));function ow(e,t,i){for(const s of i.visibleEditorPanes)if(s.group.id===t&&e.matches(s.input))return s.getViewState()}function Uz(e){if(Ys(e))return!1;const t=e;return y.isUri(t?.resource)}function on(e){if(Ys(e))return!1;const t=e;return t?.original!==void 0&&t.modified!==void 0}function Ou(e){if(Ys(e))return!1;const t=e;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function oa(e){if(Ys(e)||on(e))return!1;const t=e;return t?.primary!==void 0&&t.secondary!==void 0}function aa(e){if(Ys(e))return!1;const t=e;return y.isUri(t?.base?.resource)&&y.isUri(t?.input1?.resource)&&y.isUri(t?.input2?.resource)&&y.isUri(t?.result?.resource)}var U$;(function(e){e[e.SHORT=0]="SHORT",e[e.MEDIUM=1]="MEDIUM",e[e.LONG=2]="LONG"})(U$||(U$={}));var j$;(function(e){e[e.EXPLICIT=1]="EXPLICIT",e[e.AUTO=2]="AUTO",e[e.FOCUS_CHANGE=3]="FOCUS_CHANGE",e[e.WINDOW_CHANGE=4]="WINDOW_CHANGE"})(j$||(j$={}));var jz=class{constructor(){this.a=new Map}registerSource(e,t){let i=this.a.get(e);return i||(i={source:e,label:t},this.a.set(e,i)),i.source}getSourceLabel(e){return this.a.get(e)?.label??e}},hie=new jz,z$;(function(e){e[e.None=0]="None",e[e.Readonly=2]="Readonly",e[e.Untitled=4]="Untitled",e[e.Singleton=8]="Singleton",e[e.RequiresTrust=16]="RequiresTrust",e[e.CanSplitInGroup=32]="CanSplitInGroup",e[e.ForceDescription=64]="ForceDescription",e[e.CanDropIntoEditor=128]="CanDropIntoEditor",e[e.MultipleEditors=256]="MultipleEditors",e[e.Scratchpad=512]="Scratchpad"})(z$||(z$={}));var H$=class extends Z{};function Ys(e){return e instanceof H$}function zz(e){const t=e;return y.isUri(t?.preferredResource)}function Hz(e){const t=e;return Ys(t?.primary)&&Ys(t?.secondary)}function W$(e){const t=e;return Ys(t?.modified)&&Ys(t?.original)}var B$;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.REPLACE=1]="REPLACE",e[e.MOVE=2]="MOVE",e[e.UNPIN=3]="UNPIN"})(B$||(B$={}));var _$;(function(e){e[e.GROUP_ACTIVE=0]="GROUP_ACTIVE",e[e.GROUP_INDEX=1]="GROUP_INDEX",e[e.GROUP_LABEL=2]="GROUP_LABEL",e[e.GROUP_LOCKED=3]="GROUP_LOCKED",e[e.EDITORS_SELECTION=4]="EDITORS_SELECTION",e[e.EDITOR_OPEN=5]="EDITOR_OPEN",e[e.EDITOR_CLOSE=6]="EDITOR_CLOSE",e[e.EDITOR_MOVE=7]="EDITOR_MOVE",e[e.EDITOR_ACTIVE=8]="EDITOR_ACTIVE",e[e.EDITOR_LABEL=9]="EDITOR_LABEL",e[e.EDITOR_CAPABILITIES=10]="EDITOR_CAPABILITIES",e[e.EDITOR_PIN=11]="EDITOR_PIN",e[e.EDITOR_TRANSIENT=12]="EDITOR_TRANSIENT",e[e.EDITOR_STICKY=13]="EDITOR_STICKY",e[e.EDITOR_DIRTY=14]="EDITOR_DIRTY",e[e.EDITOR_WILL_DISPOSE=15]="EDITOR_WILL_DISPOSE"})(_$||(_$={}));var Kn;(function(e){e[e.PRIMARY=1]="PRIMARY",e[e.SECONDARY=2]="SECONDARY",e[e.BOTH=3]="BOTH",e[e.ANY=4]="ANY"})(Kn||(Kn={}));var Wz=class{getOriginalUri(e,t){if(!e)return;if(aa(e))return aw.getOriginalUri(e.result,t);if(t?.supportSideBySide){const{primary:s,secondary:r}=this.a(e);if(s&&r){if(t?.supportSideBySide===Kn.BOTH)return{primary:this.getOriginalUri(s,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Kn.ANY)return this.getOriginalUri(s,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Kn.PRIMARY?s:r}}if(on(e)||Ou(e)||oa(e)||aa(e))return;const i=zz(e)?e.preferredResource:e.resource;return!i||!t?.filterByScheme?i:this.b(i,t.filterByScheme)}a(e){return Hz(e)||oa(e)?{primary:e.primary,secondary:e.secondary}:W$(e)||on(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(aa(e))return aw.getCanonicalUri(e.result,t);if(t?.supportSideBySide){const{primary:s,secondary:r}=this.a(e);if(s&&r){if(t?.supportSideBySide===Kn.BOTH)return{primary:this.getCanonicalUri(s,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Kn.ANY)return this.getCanonicalUri(s,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Kn.PRIMARY?s:r}}if(on(e)||Ou(e)||oa(e)||aa(e))return;const i=e.resource;return!i||!t?.filterByScheme?i:this.b(i,t.filterByScheme)}b(e,t){if(Array.isArray(t)){if(t.some(i=>e.scheme===i))return e}else if(t===e.scheme)return e}},V$;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.KEYBOARD=1]="KEYBOARD",e[e.MOUSE=2]="MOUSE"})(V$||(V$={}));var aw=new Wz,q$;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(q$||(q$={}));var Bz=class{constructor(){this.c=new Map,this.d=new Map}start(e){const t=this.a=e.get(Xo);for(const[i,s]of this.c)this.e(i,s,t);this.c.clear()}e(e,t,i){const s=i.createInstance(t);this.d.set(e,s)}registerFileEditorFactory(e){if(this.b)throw new Error("Can only register one file editor factory.");this.b=e}getFileEditorFactory(){return rc(this.b)}registerEditorSerializer(e,t){if(this.c.has(e)||this.d.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.a?this.e(e,t,this.a):this.c.set(e,t),te(()=>{this.c.delete(e),this.d.delete(e)})}getEditorSerializer(e){return this.d.get(typeof e=="string"?e:e.typeId)}};Qt.add(Lz.EditorFactory,new Bz);var G$;(function(e){e[e.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",e[e.SEQUENTIAL=1]="SEQUENTIAL"})(G$||(G$={}));var J$;(function(e){e[e.Failed=0]="Failed",e[e.Completed=1]="Completed",e[e.InProgress=2]="InProgress",e[e.NeedsInput=3]="NeedsInput"})(J$||(J$={}));var Z$="local",die=H("chatSessionsService"),xr;(function(e){e.scheme=V.vscodeLocalChatSession;function t(n){const o=fc(W.wrap(new TextEncoder().encode(n)),!1,!0);return y.from({scheme:e.scheme,authority:Z$,path:"/"+o})}e.forSession=t;function i(n){const o=r(n);return o?.chatSessionType===Z$?o.sessionId:void 0}e.parseLocalSessionId=i;function s(n){return!!i(n)}e.isLocalSession=s;function r(n){if(n.scheme!==e.scheme||!n.authority)return;const o=n.path.split("/");if(o.length!==2)return;const a=n.authority,c=qo(o[1]);return{chatSessionType:a,sessionId:new TextDecoder().decode(c.buffer)}}})(xr||(xr={}));function cw(e){const t=xr.parseLocalSessionId(e);return t||e.toString()}var Q$;(function(e){e[e.NotOmitted=0]="NotOmitted",e[e.Partial=1]="Partial",e[e.Full=2]="Full"})(Q$||(Q$={}));var lw;(function(e){e.icon=oe.error;function t(n){return{filterUri:n.resource,owner:n.owner,problemMessage:n.message,filterRange:{startLineNumber:n.startLineNumber,endLineNumber:n.endLineNumber,startColumn:n.startColumn,endColumn:n.endColumn}}}e.fromMarker=t;function i(n){return{id:s(n),name:r(n),icon:e.icon,value:n,kind:"diagnostic",...n}}e.toEntry=i;function s(n){return[n.filterUri,n.owner,n.filterSeverity,n.filterRange?.startLineNumber,n.filterRange?.startColumn].join(":")}e.id=s;function r(n){let o;if(function(c){c[c.MaxChars=30]="MaxChars",c[c.MaxSpaceLookback=10]="MaxSpaceLookback"}(o||(o={})),n.problemMessage){if(n.problemMessage.length<30)return n.problemMessage;const c=n.problemMessage.lastIndexOf(" ",30);return c===-1||c+10<30?n.problemMessage.substring(0,30)+"\u2026":n.problemMessage.substring(0,c)+"\u2026"}let a=d(6521,null);return n.filterUri&&(a=d(6522,null,Li(n.filterUri))),a}e.label=r})(lw||(lw={}));var uw;(function(e){function t(i){return y.isUri(i.value)?i.value:$z(i.value)?i.value.uri:void 0}e.toUri=t})(uw||(uw={}));function _z(e){return e.kind==="image"}function hw(e){return e.kind==="promptFile"}function Vz(e){return e.kind==="promptText"}var eo;(function(e){e.Instruction="vscode.prompt.instructions.root",e.InstructionReference="vscode.prompt.instructions",e.PromptFile="vscode.prompt.file"})(eo||(eo={}));function qf(e,t,i,s=!1,r){return{id:`${t}__${e.toString()}`,name:`prompt:${Li(e)}`,value:e,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:t!==eo.InstructionReference,originLabel:i,toolReferences:r,automaticallyAdded:s}}function qz(e,t=!1,i){return{id:"vscode.prompt.instructions.text",name:"prompt:instructionsList",value:e,kind:"promptText",modelDescription:"Prompt instructions list",automaticallyAdded:t,toolReferences:i}}function Gz(e,t){return{kind:"tool",id:e.id,icon:Dt.isThemeIcon(e.icon)?e.icon:void 0,name:e.displayName,value:void 0,range:t}}var Y$=class{constructor(e){this.a=new Set,this.b=[],e&&this.add(...e)}add(...e){for(const t of e)this.a.has(t.id)||(this.a.add(t.id),this.b.push(t))}insertFirst(e){this.a.has(e.id)||(this.a.add(e.id),this.b.unshift(e))}remove(e){this.a.delete(e.id),this.b=this.b.filter(t=>t.id!==e.id)}has(e){return this.a.has(e.id)}asArray(){return this.b.slice(0)}get length(){return this.b.length}},to;(function(e){e.AgentEnabled="chat.agent.enabled",e.Edits2Enabled="chat.edits2.enabled",e.ExtensionToolsEnabled="chat.extensionTools.enabled",e.EditRequests="chat.editRequests",e.GlobalAutoApprove="chat.tools.global.autoApprove",e.AutoApproveEdits="chat.tools.edits.autoApprove",e.AutoApprovedUrls="chat.tools.urls.autoApprove",e.EligibleForAutoApproval="chat.tools.eligibleForAutoApproval",e.EnableMath="chat.math.enabled",e.CheckpointsEnabled="chat.checkpoints.enabled",e.ThinkingStyle="chat.agent.thinkingStyle",e.ThinkingGenerateTitles="chat.agent.thinking.generateTitles",e.TodosShowWidget="chat.tools.todos.showWidget",e.NotifyWindowOnResponseReceived="chat.notifyWindowOnResponseReceived",e.ChatViewSessionsEnabled="chat.viewSessions.enabled",e.ChatViewSessionsOrientation="chat.viewSessions.orientation",e.ChatViewTitleEnabled="chat.viewTitle.enabled",e.ChatViewWelcomeEnabled="chat.viewWelcome.enabled",e.SubagentToolCustomAgents="chat.customAgentInSubagent.enabled",e.ShowCodeBlockProgressAnimation="chat.agent.codeBlockProgress",e.RestoreLastPanelSession="chat.restoreLastPanelSession",e.ExitAfterDelegation="chat.exitAfterDelegation",e.SuspendThrottling="chat.suspendThrottling"})(to||(to={}));var Ts;(function(e){e.Ask="ask",e.Edit="edit",e.Agent="agent"})(Ts||(Ts={}));var X$;(function(e){e.Collapsed="collapsed",e.CollapsedPreview="collapsedPreview",e.FixedScrolling="fixedScrolling"})(X$||(X$={}));var K$;(function(e){e.Off="off",e.WithThinking="withThinking",e.Always="always"})(K$||(K$={}));var ui;(function(e){e.Chat="panel",e.Terminal="terminal",e.Notebook="notebook",e.EditorInline="editor"})(ui||(ui={})),function(e){function t(i){switch(i){case"panel":return e.Chat;case"terminal":return e.Terminal;case"notebook":return e.Notebook;case"editor":return e.EditorInline}return e.Chat}e.fromRaw=t}(ui||(ui={}));var fie=new Set([V.vscodeChatEditor,V.walkThrough,V.vscodeLocalChatSession,V.vscodeSettings,V.webviewPanel,V.vscodeUserData,V.extension,"ccreq","openai-codex"]),pie=new C("inModelsEditor",!1),gie=new C("inModelsSearch",!1),an=class{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return Jz(e,this)}},eI=new Map,dw=new WeakMap;function Jz(e,t){const i=dw.get(e);if(i)return i;const s=Zz(e,t);if(s){let r=eI.get(s)??0;r++,eI.set(s,r);const n=r===1?s:`${s}#${r}`;return dw.set(e,n),n}}function Zz(e,t){const i=dw.get(e);if(i)return i;const s=t.owner?Yz(t.owner)+".":"";let r;const n=t.debugNameSource;if(n!==void 0)if(typeof n=="function"){if(r=n(),r!==void 0)return s+r}else return s+n;const o=t.referenceFn;if(o!==void 0&&(r=fw(o),r!==void 0))return s+r;if(t.owner!==void 0){const a=Qz(t.owner,e);if(a!==void 0)return s+a}}function Qz(e,t){for(const i in e)if(e[i]===t)return i}var tI=new Map,iI=new WeakMap;function Yz(e){const t=iI.get(e);if(t)return t;const i=sI(e)??"Object";let s=tI.get(i)??0;s++,tI.set(i,s);const r=s===1?i:`${i}#${s}`;return iI.set(e,r),r}function sI(e){const t=e.constructor;if(t)return t.name==="Object"?void 0:t.name}function fw(e){const t=e.toString(),s=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(s?s[1]:void 0)?.trim()}function Cr(e,t){return e===t}function Xz(){return(e,t)=>e===t}function Kz(e,t,i){return Ci(e,t,i??Cr)}function eH(e){return(t,i)=>Ci(t,i,e??Cr)}function Fu(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Fu(e[i],t[i]))return!1;return!0}if(e&&typeof e=="object"&&t&&typeof t=="object"&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){const i=e,s=t,r=Object.keys(i),n=Object.keys(s),o=new Set(n);if(r.length!==n.length)return!1;for(const a of r)if(!o.has(a)||!Fu(i[a],s[a]))return!1;return!0}return!1}function tH(){return(e,t)=>Fu(e,t)}function iH(e,t){return JSON.stringify(e)===JSON.stringify(t)}function sH(){return(e,t)=>JSON.stringify(e)===JSON.stringify(t)}function rH(){return(e,t)=>e.equals(t)}function nH(e,t,i){return e==null||t===void 0||t===null?t===e:i(e,t)}function oH(e){return(t,i)=>t==null||i===void 0||i===null?i===t:e(t,i)}var rI;(function(e){e.strict=Cr,e.strictC=Xz,e.array=Kz,e.arrayC=eH,e.structural=Fu,e.structuralC=tH,e.jsonStringify=iH,e.jsonStringifyC=sH,e.thisC=rH,e.ifDefined=nH,e.ifDefinedC=oH})(rI||(rI={}));function nI(e){const t=new Error("BugIndicatingErrorRecovery: "+e);lt(t),console.error("recovered from an error that indicates a bug",t)}var ca;function pw(e){ca?ca instanceof oI?ca.loggers.push(e):ca=new oI([ca,e]):ca=e}function Yt(){return ca}var gw=void 0;function aH(e){gw=e}function cH(e){gw&&gw(e)}var oI=class{constructor(e){this.loggers=e}handleObservableCreated(e,t){for(const i of this.loggers)i.handleObservableCreated(e,t)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e,t){for(const i of this.loggers)i.handleAutorunCreated(e,t)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const s of this.loggers)s.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const s of this.loggers)s.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}};function mw(e,t){const i=new vw(e,t);try{e(i)}finally{i.finish()}}function lH(e,t,i){e?t(e):mw(t,i)}var vw=class{constructor(e,t){this._fn=e,this.b=t,this.a=[],Yt()?.handleBeginTransaction(this)}getDebugName(){return this.b?this.b():fw(this._fn)}updateObserver(e,t){if(!this.a){nI("Transaction already finished!"),mw(i=>{i.updateObserver(e,t)});return}this.a.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.a;if(!e){nI("transaction.finish() has already been called!");return}for(let t=0;t<e.length;t++){const{observer:i,observable:s}=e[t];i.endUpdate(s)}this.a=null,Yt()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this.a}},Xs;(function(e){let t=!1;function i(){t=!0}e.enable=i;function s(){if(!t)return;const r=Error,n=r.stackTraceLimit;r.stackTraceLimit=3;const o=new Error().stack;return r.stackTraceLimit=n,uH.fromStack(o,2)}e.ofCaller=s})(Xs||(Xs={}));var uH=class EM{static fromStack(t,i){const s=t.split(`
`),r=hH(s[i+1]);if(r)return new EM(r.fileName,r.line,r.column,r.id)}constructor(t,i,s,r){this.fileName=t,this.line=i,this.column=s,this.id=r}};function hH(e){const t=e.match(/\((.*):(\d+):(\d+)\)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:e};const i=e.match(/at ([^\(\)]*):(\d+):(\d+)/);if(i)return{fileName:i[1],line:parseInt(i[2]),column:parseInt(i[3]),id:e}}var ww;function dH(e){ww=e}var aI;function fH(e){aI=e}var cI;function pH(e){cI=e}var bw;function gH(e){bw=e}var lI=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t,i=Xs.ofCaller()){const s=t===void 0?void 0:e,r=t===void 0?e:t;return ww({owner:s,debugName:()=>{const n=fw(r);if(n!==void 0)return n;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(a)return`${this.debugName}.${a[2]}`;if(!s)return`${this.debugName} (mapped)`},debugReferenceFn:r},n=>r(this.read(n),n),i)}flatten(){return ww({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(aI(this,t)),this}keepObserved(e){return e.add(cI(this)),this}get b(){return this.get()}get debug(){return new mH(this)}},mH=class{constructor(e){this.observable=e}getDependencyGraph(){return bw(this.observable,{type:"dependencies"})}getObserverGraph(){return bw(this.observable,{type:"observers"})}},Gf=class extends lI{constructor(e){super(),this.f=new Set,Yt()?.handleObservableCreated(this,e)}addObserver(e){const t=this.f.size;this.f.add(e),t===0&&this.g(),t!==this.f.size&&Yt()?.handleOnListenerCountChanged(this,this.f.size)}removeObserver(e){const t=this.f.delete(e);t&&this.f.size===0&&this.h(),t&&Yt()?.handleOnListenerCountChanged(this,this.f.size)}g(){}h(){}log(){const e=!!Yt();return cH(this),e||Yt()?.handleObservableCreated(this,Xs.ofCaller()),this}debugGetObservers(){return this.f}};function ss(e,t,i=Xs.ofCaller()){let s;return typeof e=="string"?s=new an(void 0,e,void 0):s=new an(e,void 0,void 0),new Uu(s,t,Cr,i)}var Uu=class extends Gf{get debugName(){return this.c.getDebugName(this)??"ObservableValue"}constructor(e,t,i,s){super(s),this.c=e,this.d=i,this.a=t,Yt()?.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this.a}set(e,t,i){if(i===void 0&&this.d(this.a,e))return;let s;t||(t=s=new vw(()=>{},()=>`Setting ${this.debugName}`));try{const r=this.a;this.i(e),Yt()?.handleObservableUpdated(this,{oldValue:r,newValue:e,change:i,didChange:!0,hadValue:!0});for(const n of this.f)t.updateObserver(n,this),n.handleChange(this,i)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this.a}`}i(e){this.a=e}debugGetState(){return{value:this.a}}debugSetValue(e){this.a=e}},vH=class extends Gf{get debugName(){return this.e.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i,s){super(s),this.e=e,this.i=i,this.c=!0,this.d=[],this.k=0,this.a=t}get(){return this.j(),this.a}j(){if(!this.c)if(this.c=!0,this.d.length>0){for(const e of this.d){Yt()?.handleObservableUpdated(this,{change:e,didChange:!0,oldValue:"(unknown)",newValue:this.a,hadValue:!0});for(const t of this.f)t.handleChange(this,e)}this.d.length=0}else{Yt()?.handleObservableUpdated(this,{change:void 0,didChange:!0,oldValue:"(unknown)",newValue:this.a,hadValue:!0});for(const e of this.f)e.handleChange(this,void 0)}}l(){if(this.k++,this.k===1)for(const e of this.f)e.beginUpdate(this)}m(){if(this.k--,this.k===0){this.j();const e=[...this.f];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this.f.has(e)&&this.k>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.f.has(e)&&this.k>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this.i(this.a,e))return;let s;t||(t=s=new vw(()=>{},()=>`Setting ${this.debugName}`));try{if(this.c=!1,this.n(e),i!==void 0&&this.d.push(i),t.updateObserver({beginUpdate:()=>this.l(),endUpdate:()=>this.m(),handleChange:(r,n)=>{},handlePossibleChange:r=>{}},this),this.k>1)for(const r of this.f)r.handlePossibleChange(this)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this.a}`}n(e){this.a=e}};function wH(e,t,i=Xs.ofCaller()){return e.lazy?new vH(new an(e.owner,e.debugName,void 0),t,e.equalsFn??Cr,i):new Uu(new an(e.owner,e.debugName,void 0),t,e.equalsFn??Cr,i)}var uI;(function(e){e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(uI||(uI={}));function bH(e){switch(e){case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}var Jf=class{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,s){this._debugNameData=e,this._runFn=t,this.k=i,this.a=2,this.b=0,this.c=!1,this.f=new Set,this.g=new Set,this.i=!1,this.j=0,this.p=void 0,this.q=void 0,this.h=this.k?.createChangeSummary(void 0),Yt()?.handleAutorunCreated(this,s),this.l(),nc(this)}dispose(){if(!this.c){this.c=!0;for(const e of this.f)e.removeObserver(this);this.f.clear(),this.p!==void 0&&this.p.dispose(),this.q!==void 0&&this.q.dispose(),Yt()?.handleAutorunDisposed(this),oc(this)}}l(){const e=this.g;this.g=this.f,this.f=e,this.a=3;try{if(!this.c){Yt()?.handleAutorunStarted(this);const t=this.h,i=this.q;i!==void 0&&(this.q=void 0);try{this.i=!0,this.k&&(this.k.beforeUpdate?.(this,t),this.h=this.k.createChangeSummary(t)),this.p!==void 0&&(this.p.dispose(),this.p=void 0),this._runFn(this,t)}catch(s){su(s)}finally{this.i=!1,i!==void 0&&i.dispose()}}}finally{this.c||Yt()?.handleAutorunFinished(this);for(const t of this.g)t.removeObserver(this);this.g.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this.a===3&&(this.r(),this.a=1),this.b++}endUpdate(e){try{if(this.b===1){this.j=1;do{if(this.r())return;if(this.a===1){this.a=3;for(const t of this.f)if(t.reportChanges(),this.a===2)break}this.j++,this.a!==3&&this.l()}while(this.a!==3)}}finally{this.b--}lE(()=>this.b>=0)}handlePossibleChange(e){this.a===3&&this.m(e)&&(this.r(),this.a=1)}handleChange(e,t){if(this.m(e)){Yt()?.handleAutorunDependencyChanged(this,e,t);try{(this.k?this.k.handleChange({changedObservable:e,change:t,didChange:s=>s===e},this.h):!0)&&(this.r(),this.a=2)}catch(i){su(i)}}}m(e){return this.f.has(e)&&!this.g.has(e)}n(){if(!this.i)throw new qt("The reader object cannot be used outside its compute function!")}readObservable(e){if(this.n(),this.c)return e.get();e.addObserver(this);const t=e.get();return this.f.add(e),this.g.delete(e),t}get store(){if(this.n(),this.c)throw new qt("Cannot access store after dispose");return this.p===void 0&&(this.p=new ie),this.p}get delayedStore(){if(this.n(),this.c)throw new qt("Cannot access store after dispose");return this.q===void 0&&(this.q=new ie),this.q}debugGetState(){return{isRunning:this.i,updateCount:this.b,dependencies:this.f,state:this.a,stateStr:bH(this.a)}}debugRerun(){this.i?this.a=2:this.l()}r(){return this.j>100?(su(new qt(`Autorun '${this.debugName}' is stuck in an infinite update loop.`)),!0):!1}};function Zf(e,t=Xs.ofCaller()){return new Jf(new an(void 0,void 0,e),e,void 0,t)}var hI;(function(e){e[e.initial=0]="initial",e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(hI||(hI={}));function yH(e){switch(e){case 0:return"initial";case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}var vs=class extends Gf{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,s=void 0,r,n){super(n),this._debugNameData=e,this._computeFn=t,this.w=i,this.x=s,this.y=r,this.a=0,this.c=void 0,this.i=0,this.j=new Set,this.k=new Set,this.l=void 0,this.m=!1,this.n=!1,this.p=!1,this.q=!1,this.s=!1,this.t=void 0,this.u=void 0,this.v=null,this.l=this.w?.createChangeSummary(void 0)}h(){this.a=0,this.c=void 0,Yt()?.handleDerivedCleared(this);for(const e of this.j)e.removeObserver(this);this.j.clear(),this.t!==void 0&&(this.t.dispose(),this.t=void 0),this.u!==void 0&&(this.u.dispose(),this.u=void 0),this.x?.()}get(){if(this.n,this.f.size===0){let t;try{this.s=!0;let i;this.w&&(i=this.w.createChangeSummary(void 0),this.w.beforeUpdate?.(this,i)),t=this._computeFn(this,i)}finally{this.s=!1}return this.h(),t}else{do{if(this.a===1){for(const t of this.j)if(t.reportChanges(),this.a===2)break}this.a===1&&(this.a=3),this.a!==3&&this.A()}while(this.a!==3);return this.c}}A(){let e=!1;this.n=!0,this.p=!1;const t=this.k;this.k=this.j,this.j=t;try{const i=this.l;this.s=!0,this.w&&(this.q=!0,this.w.beforeUpdate?.(this,i),this.q=!1,this.l=this.w?.createChangeSummary(i));const s=this.a!==0,r=this.c;this.a=3;const n=this.u;n!==void 0&&(this.u=void 0);try{this.t!==void 0&&(this.t.dispose(),this.t=void 0),this.c=this._computeFn(this,i)}finally{this.s=!1;for(const o of this.k)o.removeObserver(this);this.k.clear(),n!==void 0&&n.dispose()}e=this.p||s&&!this.y(r,this.c),Yt()?.handleObservableUpdated(this,{oldValue:r,newValue:this.c,change:void 0,didChange:e,hadValue:s})}catch(i){su(i)}if(this.n=!1,!this.p&&e)for(const i of this.f)i.handleChange(this,void 0);else this.p=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this.m)throw new qt("Cyclic deriveds are not supported yet!");this.i++,this.m=!0;try{const t=this.i===1;if(this.a===3&&(this.a=1,!t))for(const i of this.f)i.handlePossibleChange(this);if(t)for(const i of this.f)i.beginUpdate(this)}finally{this.m=!1}}endUpdate(e){if(this.i--,this.i===0){const t=[...this.f];for(const i of t)i.endUpdate(this);if(this.v){const i=[...this.v];this.v=null;for(const s of i)s.endUpdate(this)}}lE(()=>this.i>=0)}handlePossibleChange(e){if(this.a===3&&this.j.has(e)&&!this.k.has(e)){this.a=1;for(const t of this.f)t.handlePossibleChange(this)}}handleChange(e,t){if(this.j.has(e)&&!this.k.has(e)||this.q){Yt()?.handleDerivedDependencyChanged(this,e,t);let i=!1;try{i=this.w?this.w.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this.l):!0}catch(r){su(r)}const s=this.a===3;if(i&&(this.a===1||s)&&(this.a=2,s))for(const r of this.f)r.handlePossibleChange(this)}}B(){if(!this.s)throw new qt("The reader object cannot be used outside its compute function!")}readObservable(e){this.B(),e.addObserver(this);const t=e.get();return this.j.add(e),this.k.delete(e),t}reportChange(e){this.B(),this.p=!0;for(const t of this.f)t.handleChange(this,e)}get store(){return this.B(),this.t===void 0&&(this.t=new ie),this.t}get delayedStore(){return this.B(),this.u===void 0&&(this.u=new ie),this.u}addObserver(e){const t=!this.f.has(e)&&this.i>0;super.addObserver(e),t&&(this.v?.delete(e)||e.beginUpdate(this))}removeObserver(e){this.f.has(e)&&this.i>0&&(this.v||(this.v=new Set),this.v.add(e)),super.removeObserver(e)}debugGetState(){return{state:this.a,stateStr:yH(this.a),updateCount:this.i,isComputing:this.n,dependencies:this.j,value:this.c}}debugSetValue(e){this.c=e}debugRecompute(){this.n?this.a=2:this.A()}setValue(e,t,i){this.c=e;const s=this.f;t.updateObserver(this,this);for(const r of s)r.handleChange(this,i)}};function AH(e,t,i=Xs.ofCaller()){return t!==void 0?new vs(new an(e,void 0,t),t,void 0,void 0,Cr,i):new vs(new an(void 0,void 0,e),e,void 0,void 0,Cr,i)}function dI(e,t,i=Xs.ofCaller()){return new vs(new an(e.owner,e.debugName,e.debugReferenceFn),t,void 0,e.onLastObserverRemoved,e.equalsFn??Cr,i)}dH(dI);function ju(...e){let t,i,s,r;return e.length===2?[i,s]=e:[t,i,s,r]=e,new io(new an(t,void 0,s),i,s,()=>io.globalTransaction,Cr,r??Xs.ofCaller())}var io=class extends Gf{constructor(e,t,i,s,r,n){super(n),this.e=e,this.i=t,this._getValue=i,this.j=s,this.k=r,this.c=!1,this.n=o=>{const a=this._getValue(o),c=this.a,l=!this.c||!this.k(c,a);let u=!1;l&&(this.a=a,this.c&&(u=!0,lH(this.j(),h=>{Yt()?.handleObservableUpdated(this,{oldValue:c,newValue:a,change:void 0,didChange:l,hadValue:this.c});for(const f of this.f)h.updateObserver(f,this),f.handleChange(this,void 0)},()=>{const h=this.l();return"Event fired"+(h?`: ${h}`:"")})),this.c=!0),u||Yt()?.handleObservableUpdated(this,{oldValue:c,newValue:a,change:void 0,didChange:l,hadValue:this.c})}}l(){return this.e.getDebugName(this)}get debugName(){const e=this.l();return"From Event"+(e?`: ${e}`:"")}g(){this.d=this.i(this.n)}h(){this.d.dispose(),this.d=void 0,this.c=!1,this.a=void 0}get(){return this.d?(this.c||this.n(void 0),this.a):this._getValue(void 0)}debugSetValue(e){this.a=e}debugGetState(){return{value:this.a,hasValue:this.c}}};(function(e){e.Observer=io;function t(i,s){let r=!1;io.globalTransaction===void 0&&(io.globalTransaction=i,r=!0);try{s()}finally{r&&(io.globalTransaction=void 0)}}e.batchEventsGlobally=t})(ju||(ju={}));function SH(e){const t=new fI(!1,void 0);return e.addObserver(t),te(()=>{e.removeObserver(t)})}pH(SH);function EH(e,t){const i=new fI(!0,t);e.addObserver(i);try{i.beginUpdate(e)}finally{i.endUpdate(e)}return te(()=>{e.removeObserver(i)})}fH(EH);var fI=class{constructor(e,t){this.b=e,this.c=t,this.a=0}beginUpdate(e){this.a++}endUpdate(e){this.a===1&&this.b&&(this.c?this.c(e.get()):e.reportChanges()),this.a--}handlePossibleChange(e){}handleChange(e,t){}};function pI(e){return new xH(e)}var xH=class extends lI{constructor(e){super(),this.a=e}get debugName(){return this.toString()}get(){return this.a}addObserver(e){}removeObserver(e){}log(){return this}toString(){return`Const: ${this.a}`}},gI=class{constructor(){this.a=new Set,this.b=wH({equalsFn:()=>!1},this),this.observable=this.b}get size(){return this.a.size}has(e){return this.a.has(e)}add(e,t){return this.a.has(e)||(this.a.add(e),this.b.set(this,t)),this}delete(e,t){const i=this.a.delete(e);return i&&this.b.set(this,t),i}clear(e){this.a.size>0&&(this.a.clear(),this.b.set(this,e))}forEach(e,t){this.a.forEach((i,s,r)=>{e.call(t,i,s,this)})}*entries(){for(const e of this.a)yield[e,e]}*keys(){yield*this.a.keys()}*values(){yield*this.a.values()}[Symbol.iterator](){return this.values()}get[Symbol.toStringTag](){return"ObservableSet"}},Qf;function CH(e){Qf||(Qf=new mI,pw(Qf)),Qf.addFilteredObj(e)}var mI=class{constructor(){this.a=0,this.f=new WeakMap}addFilteredObj(e){this.b||(this.b=new Set),this.b.add(e)}c(e){return this.b?.has(e)??!0}d(e){return kH([kc(DH("|  ",this.a)),e])}e(e){return e.hadValue?e.didChange?[kc(" "),Ns(Ks(e.oldValue,70),{color:"red",strikeThrough:!0}),kc(" "),Ns(Ks(e.newValue,60),{color:"green"})]:[kc(" (unchanged)")]:[kc(" "),Ns(Ks(e.newValue,60),{color:"green"}),kc(" (initial)")]}handleObservableCreated(e){if(e instanceof vs){const t=e;if(this.f.set(t,new Set),!1){const s=[];t.__debugUpdating=s;const r=t.beginUpdate;t.beginUpdate=o=>(s.push(o),r.apply(t,[o]));const n=t.endUpdate;t.endUpdate=o=>{const a=s.indexOf(o);return a===-1&&console.error("endUpdate called without beginUpdate",t.debugName,o.debugName),s.splice(a,1),n.apply(t,[o])}}}}handleOnListenerCountChanged(e,t){}handleObservableUpdated(e,t){if(this.c(e)){if(e instanceof vs){this._handleDerivedRecomputed(e,t);return}console.log(...this.d([$c("observable value changed"),Ns(e.debugName,{color:"BlueViolet"}),...this.e(t)]))}}formatChanges(e){if(e.size!==0)return Ns(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,t,i){this.c(e)&&this.f.get(e)?.add(t)}_handleDerivedRecomputed(e,t){if(!this.c(e))return;const i=this.f.get(e);i&&(console.log(...this.d([$c("derived recomputed"),Ns(e.debugName,{color:"BlueViolet"}),...this.e(t),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),i.clear())}handleDerivedCleared(e){this.c(e)&&console.log(...this.d([$c("derived cleared"),Ns(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,t){this.c(e)&&console.log(...this.d([$c("observable from event triggered"),Ns(e.debugName,{color:"BlueViolet"}),...this.e(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this.c(e)&&this.f.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,t,i){this.c(e)&&this.f.get(e).add(t)}handleAutorunStarted(e){const t=this.f.get(e);t&&(this.c(e)&&console.log(...this.d([$c("autorun"),Ns(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.a++)}handleAutorunFinished(e){this.a--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),this.c(e)&&console.log(...this.d([$c("transaction"),Ns(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.a++}handleEndTransaction(){this.a--}};function kH(e){const t=new Array,i=[];let s="";function r(o){if("length"in o)for(const a of o)a&&r(a);else"text"in o?(s+=`%c${o.text}`,t.push(o.style),o.data&&i.push(...o.data)):"data"in o&&i.push(...o.data)}r(e);const n=[s,...t];return n.push(...i),n}function kc(e){return Ns(e,{color:"black"})}function $c(e){return Ns(PH(`${e}: `,10),{color:"black",bold:!0})}function Ns(e,t={color:"black"}){function i(r){return Object.entries(r).reduce((n,[o,a])=>`${n}${o}:${a};`,"")}const s={color:t.color};return t.strikeThrough&&(s["text-decoration"]="line-through"),t.bold&&(s["font-weight"]="bold"),{text:e,style:i(s)}}function Ks(e,t){switch(typeof e){case"number":return""+e;case"string":return e.length+2<=t?`"${e}"`:`"${e.substr(0,t-7)}"+...`;case"boolean":return e?"true":"false";case"undefined":return"undefined";case"object":return e===null?"null":Array.isArray(e)?$H(e,t):IH(e,t);case"symbol":return e.toString();case"function":return`[[Function${e.name?" "+e.name:""}]]`;default:return""+e}}function $H(e,t){let i="[ ",s=!0;for(const r of e){if(s||(i+=", "),i.length-5>t){i+="...";break}s=!1,i+=`${Ks(r,t-i.length)}`}return i+=" ]",i}function IH(e,t){if(typeof e.toString=="function"&&e.toString!==Object.prototype.toString){const n=e.toString();return n.length<=t?n:n.substring(0,t-3)+"..."}const i=sI(e);let s=i?i+"(":"{ ",r=!0;for(const[n,o]of Object.entries(e)){if(r||(s+=", "),s.length-5>t){s+="...";break}r=!1,s+=`${n}: ${Ks(o,t-s.length)}`}return s+=i?")":" }",s}function DH(e,t){let i="";for(let s=1;s<=t;s++)i+=e;return i}function PH(e,t){for(;e.length<t;)e+=" ";return e}var TH=class P5{static createHost(t,i){return new P5(t,i)}static createClient(t,i){return new P5(t,i)}constructor(t,i){this.b=t,this.c=i,this.a=this.b({handleNotification:n=>{const o=n,a=this.c().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:n=>{const o=n;try{return{type:"result",value:this.c().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const s=new Proxy({},{get:(n,o)=>async(...a)=>{const c=await this.a.sendRequest([o,a]);if(c.type==="error")throw c.value;return c.value}}),r=new Proxy({},{get:(n,o)=>(...a)=>{this.a.sendNotification([o,a])}});this.api={notifications:r,requests:s}}};function NH(e,t){const i=globalThis;let s=[],r;const{channel:n,handler:o}=MH({sendNotification:c=>{r?r.sendNotification(c):s.push(c)}});let a;return(i.$$debugValueEditor_debugChannels??(i.$$debugValueEditor_debugChannels={}))[e]=c=>{a=t(),r=c;for(const l of s)c.sendNotification(l);return s=[],o},TH.createClient(n,()=>{if(!a)throw new Error("Not supported");return a})}function MH(e){let t;return{channel:s=>(t=s,{sendNotification:r=>{e.sendNotification(r)},sendRequest:r=>{throw new Error("not supported")}}),handler:{handleRequest:s=>s.type==="notification"?t?.handleNotification(s.data):t?.handleRequest(s.data)}}}var LH=class{constructor(){this.a=void 0}throttle(e,t){this.a===void 0&&(this.a=setTimeout(()=>{this.a=void 0,e()},t))}dispose(){this.a!==void 0&&clearTimeout(this.a)}};function vI(e,t){for(const i in t)e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?vI(e[i],t[i]):e[i]=t[i]}function wI(e,t){for(const i in t)t[i]===null?delete e[i]:e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?wI(e[i],t[i]):e[i]=t[i]}var RH=class Bd{static{this.a=void 0}static getInstance(){return Bd.a===void 0&&(Bd.a=new Bd),Bd.a}j(){const t=[],i=[...this.h];if(i.length===0)return;const s=i.flatMap(n=>n.debugGetUpdatingObservers()??[]).map(n=>n.observer),r=new Set;for(;s.length>0;){const n=s.shift();if(r.has(n))continue;r.add(n);const o=this.m(n,a=>{r.has(a)||s.push(a)});o&&t.push(o)}return{names:i.map(n=>n.getDebugName()??"tx"),affected:t}}k(t){const i=this.f.get(t);if(!i){lt(new qt("No info found"));return}return i}l(t){const i=this.f.get(t);if(!i){lt(new qt("No info found"));return}return i}m(t,i){if(t instanceof vs){const s=[...t.debugGetObservers()];for(const c of s)i(c);const r=this.k(t);if(!r)return;const n=t.debugGetState(),o={name:t.debugName,instanceId:r.instanceId,updateCount:n.updateCount},a=[...r.changedObservables].map(c=>this.f.get(c)?.instanceId).filter(fs);if(n.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(n.state){case 0:return{...o,type:"observable/derived",state:"noValue"};case 3:return{...o,type:"observable/derived",state:"upToDate"};case 2:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(t instanceof Jf){const s=this.l(t);if(!s)return;const r={name:t.debugName,instanceId:s.instanceId,updateCount:s.updateCount},n=[...s.changedObservables].map(o=>this.f.get(o).instanceId);if(t.debugGetState().isRunning)return{...r,type:"autorun",state:"updating",changedDependencies:n};switch(t.debugGetState().state){case 3:return{...r,type:"autorun",state:"upToDate"};case 2:return{...r,type:"autorun",state:"stale",changedDependencies:n};case 1:return{...r,type:"autorun",state:"possiblyStale"}}}}n(t){const i=this.k(t);if(i)return{name:t.debugName,instanceId:i.instanceId}}p(t){if(t instanceof vs)return{name:t.toString(),instanceId:this.k(t)?.instanceId};const i=this.l(t);if(i)return{name:t.toString(),instanceId:i.instanceId}}constructor(){this.b=0,this.c=0,this.e=new Map,this.f=new WeakMap,this.g=new Map,this.h=new Set,this.i=NH("observableDevTools",()=>({notifications:{setDeclarationIdFilter:t=>{},logObservableValue:t=>{console.log("logObservableValue",t)},flushUpdates:()=>{this.v()},resetUpdates:()=>{this.q=null,this.i.api.notifications.handleChange(this.s,!0)}},requests:{getDeclarations:()=>{const t={};for(const i of this.e.values())t[i.id]=i;return{decls:t}},getSummarizedInstances:()=>null,getObservableValueInfo:t=>({observers:[...this.g.get(t).debugGetObservers()].map(s=>this.p(s)).filter(fs)}),getDerivedInfo:t=>{const i=this.g.get(t);return{dependencies:[...i.debugGetState().dependencies].map(s=>this.n(s)).filter(fs),observers:[...i.debugGetObservers()].map(s=>this.p(s)).filter(fs)}},getAutorunInfo:t=>({dependencies:[...this.g.get(t).debugGetState().dependencies].map(s=>this.n(s)).filter(fs)}),getTransactionState:()=>this.j(),setValue:(t,i)=>{const s=this.g.get(t);if(s instanceof vs)s.debugSetValue(i);else if(s instanceof Uu)s.debugSetValue(i);else if(s instanceof io)s.debugSetValue(i);else throw new qt("Observable is not supported");const r=[...s.debugGetObservers()];for(const n of r)n.beginUpdate(s);for(const n of r)n.handleChange(s,void 0);for(const n of r)n.endUpdate(s)},getValue:t=>{const i=this.g.get(t);if(i instanceof vs)return Ks(i.debugGetState().value,200);if(i instanceof Uu)return Ks(i.debugGetState().value,200)},logValue:t=>{const i=this.g.get(t);if(i&&"get"in i)console.log("Logged Value:",i.get());else throw new qt("Observable is not supported")},rerun:t=>{const i=this.g.get(t);if(i instanceof vs)i.debugRecompute();else if(i instanceof Jf)i.debugRerun();else throw new qt("Observable is not supported")}}})),this.q=null,this.r=new LH,this.s={},this.v=()=>{this.q!==null&&(this.i.api.notifications.handleChange(this.q,!1),this.q=null)},Xs.enable()}u(t){wI(this.s,t),this.q===null?this.q=t:vI(this.q,t),this.r.throttle(this.v,10)}w(t,i){if(!i)return-1;let s=this.e.get(i.id);return s===void 0&&(s={id:this.b++,type:t,url:i.fileName,line:i.line,column:i.column},this.e.set(i.id,s),this.u({decls:{[s.id]:s}})),s.id}handleObservableCreated(t,i){const r={declarationId:this.w("observable/value",i),instanceId:this.c++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this.f.set(t,r)}handleOnListenerCountChanged(t,i){const s=this.k(t);if(s){if(s.listenerCount===0&&i>0){const r=t instanceof vs?"observable/derived":"observable/value";this.g.set(s.instanceId,t),this.u({instances:{[s.instanceId]:{instanceId:s.instanceId,declarationId:s.declarationId,formattedValue:s.lastValue,type:r,name:t.debugName}}})}else s.listenerCount>0&&i===0&&(this.u({instances:{[s.instanceId]:null}}),this.g.delete(s.instanceId));s.listenerCount=i}}handleObservableUpdated(t,i){if(t instanceof vs){this._handleDerivedRecomputed(t,i);return}const s=this.k(t);s&&i.didChange&&(s.lastValue=Ks(i.newValue,30),s.listenerCount>0&&this.u({instances:{[s.instanceId]:{formattedValue:s.lastValue}}}))}handleAutorunCreated(t,i){const r={declarationId:this.w("autorun",i),instanceId:this.c++,updateCount:0,changedObservables:new Set};this.f.set(t,r),this.g.set(r.instanceId,t),r&&this.u({instances:{[r.instanceId]:{instanceId:r.instanceId,declarationId:r.declarationId,runCount:0,type:"autorun",name:t.debugName}}})}handleAutorunDisposed(t){const i=this.l(t);i&&(this.u({instances:{[i.instanceId]:null}}),this.f.delete(t),this.g.delete(i.instanceId))}handleAutorunDependencyChanged(t,i,s){const r=this.l(t);r&&r.changedObservables.add(i)}handleAutorunStarted(t){}handleAutorunFinished(t){const i=this.l(t);i&&(i.changedObservables.clear(),i.updateCount++,this.u({instances:{[i.instanceId]:{runCount:i.updateCount}}}))}handleDerivedDependencyChanged(t,i,s){const r=this.k(t);r&&r.changedObservables.add(i)}_handleDerivedRecomputed(t,i){const s=this.k(t);if(!s)return;const r=Ks(i.newValue,30);s.updateCount++,s.changedObservables.clear(),s.lastValue=r,s.listenerCount>0&&this.u({instances:{[s.instanceId]:{formattedValue:r,recomputationCount:s.updateCount}}})}handleDerivedCleared(t){const i=this.k(t);i&&(i.lastValue=void 0,i.changedObservables.clear(),i.listenerCount>0&&this.u({instances:{[i.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(t){this.h.add(t)}handleEndTransaction(t){this.h.delete(t)}};function OH(e,t){const i=t?.debugNamePostProcessor??(n=>n),s=zu.from(e,i);if(!s)return"";const r=new Set;return t.type==="observers"?yI(s,0,r,t).trim():bI(s,0,r,t).trim()}function bI(e,t,i,s){const r="		".repeat(t),n=[];if(i.has(e.sourceObj))return n.push(`${r}* ${e.type} ${e.name} (already listed)`),n.join(`
`);if(i.add(e.sourceObj),n.push(`${r}* ${e.type} ${e.name}:`),n.push(`${r}  value: ${Ks(e.value,50)}`),n.push(`${r}  state: ${e.state}`),e.dependencies.length>0){n.push(`${r}  dependencies:`);for(const a of e.dependencies){const c=zu.from(a,s.debugNamePostProcessor??(l=>l))??zu.unknown(a);n.push(bI(c,t+1,i,s))}}return n.join(`
`)}function yI(e,t,i,s){const r="		".repeat(t),n=[];if(i.has(e.sourceObj))return n.push(`${r}* ${e.type} ${e.name} (already listed)`),n.join(`
`);if(i.add(e.sourceObj),n.push(`${r}* ${e.type} ${e.name}:`),n.push(`${r}  value: ${Ks(e.value,50)}`),n.push(`${r}  state: ${e.state}`),e.observers.length>0){n.push(`${r}  observers:`);for(const a of e.observers){const c=zu.from(a,s.debugNamePostProcessor??(l=>l))??zu.unknown(a);n.push(yI(c,t+1,i,s))}}return n.join(`
`)}var zu=class Jl{static from(t,i){if(t instanceof Jf){const s=t.debugGetState();return new Jl(t,i(t.debugName),"autorun",void 0,s.stateStr,Array.from(s.dependencies),[])}else if(t instanceof vs){const s=t.debugGetState();return new Jl(t,i(t.debugName),"derived",s.value,s.stateStr,Array.from(s.dependencies),Array.from(t.debugGetObservers()))}else if(t instanceof Uu){const s=t.debugGetState();return new Jl(t,i(t.debugName),"observableValue",s.value,"upToDate",[],Array.from(t.debugGetObservers()))}else if(t instanceof io){const s=t.debugGetState();return new Jl(t,i(t.debugName),"fromEvent",s.value,s.hasValue?"upToDate":"initial",[],Array.from(t.debugGetObservers()))}}static unknown(t){return new Jl(t,"(unknown)","unknown",void 0,"unknown",[],[])}constructor(t,i,s,r,n,o,a){this.sourceObj=t,this.name=i,this.type=s,this.value=r,this.state=n,this.dependencies=o,this.observers=a}};gH(OH),aH(CH);var FH=!1;FH&&pw(new mI),On&&On.VSCODE_DEV_DEBUG_OBSERVABLES&&pw(RH.getInstance());var er;(function(e){e.Internal={type:"internal",label:"Built-In"},e.External={type:"external",label:"External"};function t(r){switch(r.type){case"extension":return`extension:${r.extensionId.value}`;case"mcp":return`mcp:${r.collectionId}:${r.definitionId}`;case"user":return`user:${r.file.toString()}`;case"internal":return"internal";case"external":return"external"}}e.toKey=t;function i(r,n){return t(r)===t(n)}e.equals=i;function s(r){return r.type==="internal"?{ordinal:1,label:d(6534,null)}:r.type==="mcp"?{ordinal:2,label:r.label}:r.type==="user"?{ordinal:0,label:d(6535,null)}:{ordinal:3,label:r.label}}e.classify=s})(er||(er={}));function UH(e){return typeof e=="object"&&typeof e.sessionId=="string"&&y.isUri(e.sessionResource)}var Ic;(function(e){e.Hidden="hidden",e.HiddenAfterComplete="hiddenAfterComplete"})(Ic||(Ic={}));var jH=class{constructor(e,t,i,s,r,n){this.id=e,this.referenceName=t,this.icon=i,this.source=s,this.description=r,this.legacyFullNames=n,this.c=new gI,this.f=new gI,this.isHomogenous=AH(o=>!Bt.some(this.c.observable.read(o),a=>!er.equals(a.source,this.source))&&!Bt.some(this.f.observable.read(o),a=>!er.equals(a.source,this.source)))}addTool(e,t){return this.c.add(e,t),te(()=>{this.c.delete(e)})}addToolSet(e,t){return e===this?Z.None:(this.f.add(e,t),te(()=>{this.f.delete(e)}))}getTools(e){return Bt.concat(this.c.observable.read(e),...Bt.map(this.f.observable.read(e),t=>t.getTools(e)))}},Yf=H("ILanguageModelToolsService"),yw;(function(e){e.execute="execute",e.edit="edit",e.search="search",e.agent="agent",e.read="read",e.web="web",e.todo="todo"})(yw||(yw={}));var Xf;(function(e){e.runSubagent="runSubagent",e.vscode="vscode"})(Xf||(Xf={}));var Kf;(function(e){e.LATEST_PROTOCOL_VERSION="2025-11-25",e.JSONRPC_VERSION="2.0",e.PARSE_ERROR=-32700,e.INVALID_REQUEST=-32600,e.METHOD_NOT_FOUND=-32601,e.INVALID_PARAMS=-32602,e.INTERNAL_ERROR=-32603,e.URL_ELICITATION_REQUIRED=-32042})(Kf||(Kf={}));function zH(e,t){return Ye.toKey(e)+"/"+t}var AI;(function(e){e[e.WorkspaceFolder=0]="WorkspaceFolder",e[e.Workspace=100]="Workspace",e[e.User=200]="User",e[e.Extension=300]="Extension",e[e.Filesystem=400]="Filesystem",e[e.RemoteBoost=-50]="RemoteBoost"})(AI||(AI={}));var SI;(function(e){function t(i,s){return i.id===s.id&&i.remoteAuthority===s.remoteAuthority&&i.label===s.label&&i.trustBehavior===s.trustBehavior}e.equals=t})(SI||(SI={}));var EI;(function(e){e[e.Initial=0]="Initial",e[e.Dynamic=1]="Dynamic"})(EI||(EI={}));var xI;(function(e){function t(r){return r}e.toSerialized=t;function i(r){return{id:r.id,label:r.label,cacheNonce:r.cacheNonce,staticMetadata:r.staticMetadata,launch:Hu.fromSerialized(r.launch),variableReplacement:r.variableReplacement?Aw.fromSerialized(r.variableReplacement):void 0}}e.fromSerialized=i;function s(r,n){return r.id===n.id&&r.label===n.label&&r.cacheNonce===n.cacheNonce&&Ci(r.roots,n.roots,(o,a)=>o.toString()===a.toString())&&Fi(r.launch,n.launch)&&Fi(r.presentation,n.presentation)&&Fi(r.variableReplacement,n.variableReplacement)&&Fi(r.devMode,n.devMode)}e.equals=s})(xI||(xI={}));var Aw;(function(e){function t(s){return s}e.toSerialized=t;function i(s){return{section:s.section,folder:s.folder?{...s.folder,uri:y.revive(s.folder.uri)}:void 0,target:s.target}}e.fromSerialized=i})(Aw||(Aw={}));var CI;(function(e){e.Empty={working:!1,starting:[],serversRequiringInteraction:[]}})(CI||(CI={}));var kI;(function(e){e[e.HasUnknown=0]="HasUnknown",e[e.LoadingUnknown=1]="LoadingUnknown",e[e.AllKnown=2]="AllKnown"})(kI||(kI={}));var mie=H("IMcpService"),$I;(function(e){let t;(function(i){i[i.Trusted=0]="Trusted",i[i.TrustedOnNonce=1]="TrustedOnNonce",i[i.Untrusted=2]="Untrusted",i[i.Unknown=3]="Unknown"})(t=e.Kind||(e.Kind={}))})($I||($I={}));var II;(function(e){e[e.Unknown=0]="Unknown",e[e.Cached=1]="Cached",e[e.Outdated=2]="Outdated",e[e.RefreshingFromUnknown=3]="RefreshingFromUnknown",e[e.RefreshingFromCached=4]="RefreshingFromCached",e[e.Live=5]="Live"})(II||(II={}));var DI;(function(e){e[e.Stdio=1]="Stdio",e[e.HTTP=2]="HTTP"})(DI||(DI={}));var Hu;(function(e){function t(r){return r}e.toSerialized=t;function i(r){switch(r.type){case 2:return{type:r.type,uri:y.revive(r.uri),headers:r.headers,authentication:r.authentication};case 1:return{type:r.type,cwd:r.cwd,command:r.command,args:r.args,env:r.env,envFile:r.envFile}}}e.fromSerialized=i;async function s(r){const n=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(JSON.stringify(r)));return t0(W.wrap(new Uint8Array(n)))}e.hash=s})(Hu||(Hu={}));var PI;(function(e){let t;(function(i){i[i.Stopped=0]="Stopped",i[i.Starting=1]="Starting",i[i.Running=2]="Running",i[i.Error=3]="Error"})(t=e.Kind||(e.Kind={})),e.toString=i=>{switch(i.state){case 0:return d(10003,null);case 1:return d(10004,null);case 2:return d(10005,null);case 3:return d(10006,null,i.message);default:kv(i)}},e.toKindString=i=>{switch(i){case 0:return"stopped";case 1:return"starting";case 2:return"running";case 3:return"error";default:kv(i)}},e.canBeStarted=i=>i===3||i===0,e.isRunning=i=>!e.canBeStarted(i.state)})(PI||(PI={}));var TI=class xM extends Error{static{this.d="User interaction required: "}static is(t){return t.message.startsWith(this.d)}constructor(t){super(`${xM.d}${t}`),this.reason=t}},NI;(function(e){e[e.Disabled=0]="Disabled",e[e.DisabledByAccess=1]="DisabledByAccess",e[e.Enabled=2]="Enabled"})(NI||(NI={}));var MI;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(MI||(MI={}));var LI;(function(e){e.Readme="readme",e.Manifest="manifest",e.Configuration="configuration"})(LI||(LI={}));var HH=H("IMcpWorkbenchService"),RI=class extends Z{constructor(t,i){super(),this.f=t,this.D(i.onChange(this.update,this))}set mcpServer(t){this.f.forEach(i=>i.mcpServer=t)}update(t){for(const i of this.f)t&&i.mcpServer?t.id===i.mcpServer.id&&(i.mcpServer=t):i.update()}};RI=__decorate([__param(1,HH)],RI);var wie=new C("mcpServersGalleryStatus","unavailable"),bie=new C("hasInstalledMcpServers",!0),OI;(function(e){e.scheme="mcp-resource";const t="dylo78gyp";function i(r,n){return typeof n=="string"&&(n=y.parse(n)),n.with({scheme:e.scheme,authority:t0(W.fromString(r.id)),path:["",n.scheme,n.authority||t].join("/")+n.path})}e.fromServer=i;function s(r){if(typeof r=="string"&&(r=y.parse(r)),r.scheme!==e.scheme)throw new Error(`Invalid MCP resource URI: ${r.toString()}`);const n=r.path.split("/");if(n.length<3)throw new Error(`Invalid MCP resource URI: ${r.toString()}`);const[,o,a,...c]=n,l=new URL(`${o}://${a.toLowerCase()===t?"":a}`);return l.pathname=c.length?"/"+c.join("/"):"",l.search=r.query,l.hash=r.fragment,{definitionId:LO(r.authority).toString(),resourceURL:l}}e.toServer=s})(OI||(OI={}));var FI;(function(e){e[e.Logging=1]="Logging",e[e.Completions=2]="Completions",e[e.Prompts=4]="Prompts",e[e.PromptsListChanged=8]="PromptsListChanged",e[e.Resources=16]="Resources",e[e.ResourcesSubscribe=32]="ResourcesSubscribe",e[e.ResourcesListChanged=64]="ResourcesListChanged",e[e.Tools=128]="Tools",e[e.ToolsListChanged=256]="ToolsListChanged"})(FI||(FI={}));var yie=H("IMcpServerSampling"),UI;(function(e){e.Prefix="mcp_",e[e.MaxPrefixLen=18]="MaxPrefixLen",e[e.MaxLength=64]="MaxLength"})(UI||(UI={}));var jI;(function(e){e[e.Form=0]="Form",e[e.URL=1]="URL"})(jI||(jI={}));var Aie=H("IMcpElicitationService");function zI(){return Object.create(null)}var la="**",Sw="/",ep="[/\\\\]",tp="[^/\\\\]",WH=/\//g;function HI(e,t){switch(e){case 0:return"";case 1:return`${tp}*?`;default:return`(?:${ep}|${tp}+${ep}${t?`|${ep}${tp}+`:""})*?`}}function Dc(e,t){if(!e)return[];const i=[];let s=!1,r=!1,n="";for(const o of e){switch(o){case t:if(!s&&!r){i.push(n),n="";continue}break;case"{":s=!0;break;case"}":s=!1;break;case"[":r=!0;break;case"]":r=!1;break}n+=o}return n&&i.push(n),i}function WI(e){if(!e)return"";let t="";const i=Dc(e,Sw);if(i.every(s=>s===la))t=".*";else{let s=!1;i.forEach((r,n)=>{if(r===la){if(s)return;t+=HI(2,n===i.length-1)}else{let o=!1,a="",c=!1,l="";for(const u of r){if(u!=="}"&&o){a+=u;continue}if(c&&(u!=="]"||!l)){let h;u==="-"?h=u:(u==="^"||u==="!")&&!l?h="^":u===Sw?h="":h=Un(u),l+=h;continue}switch(u){case"{":o=!0;continue;case"[":c=!0;continue;case"}":{const f=`(?:${Dc(a,",").map(p=>WI(p)).join("|")})`;t+=f,o=!1,a="";break}case"]":{t+="["+l+"]",c=!1,l="";break}case"?":t+=tp;continue;case"*":t+=HI(1);continue;default:t+=Un(u)}}n<i.length-1&&(i[n+1]!==la||n+2<i.length)&&(t+=ep)}s=r===la})}return t}var BH=/^\*\*\/\*\.[\w\.-]+$/,_H=/^\*\*\/([\w\.-]+)\/?$/,VH=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,qH=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,GH=/^\*\*((\/[\w\.-]+)+)\/?$/,JH=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,BI=new sc(1e4),_I=function(){return!1},kr=function(){return null};function Ew(e,t){if(!e)return kr;let i;typeof e!="string"?i=e.pattern:i=e,i=i.trim();const s=t.ignoreCase??!1,r={...t,equals:s?$s:(c,l)=>c===l,endsWith:s?f2:(c,l)=>c.endsWith(l),isEqualOrParent:(c,l)=>Vo(c,l,!$t||s)},n=`${s?i.toLowerCase():i}_${!!t.trimForExclusions}_${s}`;let o=BI.get(n);if(o)return VI(o,e,r);let a;return BH.test(i)?o=ZH(i.substring(4),i,r):(a=_H.exec(xw(i,r)))?o=QH(a[1],i,r):(t.trimForExclusions?qH:VH).test(i)?o=YH(i,r):(a=GH.exec(xw(i,r)))?o=qI(a[1].substring(1),i,!0,r):(a=JH.exec(xw(i,r)))?o=qI(a[1],i,!1,r):o=XH(i,r),BI.set(n,o),VI(o,e,r)}function VI(e,t,i){if(typeof t=="string")return e;const s=function(r,n){return i.isEqualOrParent(r,t.base)?e(h2(r.substring(t.base.length),St),n):null};return s.allBasenames=e.allBasenames,s.allPaths=e.allPaths,s.basenames=e.basenames,s.patterns=e.patterns,s}function xw(e,t){return t.trimForExclusions&&e.endsWith("/**")?e.substring(0,e.length-2):e}function ZH(e,t,i){return function(s,r){return typeof s=="string"&&i.endsWith(s,e)?t:null}}function QH(e,t,i){const s=`/${e}`,r=`\\${e}`,n=function(a,c){return typeof a!="string"?null:c?i.equals(c,e)?t:null:i.equals(a,e)||i.endsWith(a,s)||i.endsWith(a,r)?t:null},o=[e];return n.basenames=o,n.patterns=[t],n.allBasenames=o,n}function YH(e,t){const i=ZI(e.slice(1,-1).split(",").map(a=>Ew(a,t)).filter(a=>a!==kr),e),s=i.length;if(!s)return kr;if(s===1)return i[0];const r=function(a,c){for(let l=0,u=i.length;l<u;l++)if(i[l](a,c))return e;return null},n=i.find(a=>!!a.allBasenames);n&&(r.allBasenames=n.allBasenames);const o=i.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function qI(e,t,i,s){const r=St===Be.sep,n=r?e:e.replace(WH,St),o=St+n,a=Be.sep+e;let c;return i?c=function(l,u){return typeof l=="string"&&(s.equals(l,n)||s.endsWith(l,o)||!r&&(s.equals(l,e)||s.endsWith(l,a)))?t:null}:c=function(l,u){return typeof l=="string"&&(s.equals(l,n)||!r&&s.equals(l,e))?t:null},c.allPaths=[(i?"*/":"./")+e],c}function XH(e,t){try{const i=new RegExp(`^${WI(e)}$`,t.ignoreCase?"i":void 0);return function(s){return i.lastIndex=0,typeof s=="string"&&i.test(s)?e:null}}catch{return kr}}function ua(e,t,i){return!e||typeof t!="string"?!1:tr(e,i)(t)}function tr(e,t={}){if(!e)return _I;if(typeof e=="string"||KH(e)){const i=Ew(e,t);if(i===kr)return _I;const s=function(r,n){return!!i(r,n)};return i.allBasenames&&(s.allBasenames=i.allBasenames),i.allPaths&&(s.allPaths=i.allPaths),s}return eW(e,t)}function KH(e){const t=e;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function GI(e){return e.allBasenames||[]}function JI(e){return e.allPaths||[]}function eW(e,t){const i=ZI(Object.getOwnPropertyNames(e).map(a=>tW(a,e[a],t)).filter(a=>a!==kr)),s=i.length;if(!s)return kr;if(!i.some(a=>!!a.requiresSiblings)){if(s===1)return i[0];const a=function(u,h){let f;for(let p=0,g=i.length;p<g;p++){const v=i[p](u,h);if(typeof v=="string")return v;Hn(v)&&(f||(f=[]),f.push(v))}return f?(async()=>{for(const p of f){const g=await p;if(typeof g=="string")return g}return null})():null},c=i.find(u=>!!u.allBasenames);c&&(a.allBasenames=c.allBasenames);const l=i.reduce((u,h)=>h.allPaths?u.concat(h.allPaths):u,[]);return l.length&&(a.allPaths=l),a}const r=function(a,c,l){let u,h;for(let f=0,p=i.length;f<p;f++){const g=i[f];g.requiresSiblings&&l&&(c||(c=vt(a)),u||(u=c.substring(0,c.length-cf(a).length)));const v=g(a,c,u,l);if(typeof v=="string")return v;Hn(v)&&(h||(h=[]),h.push(v))}return h?(async()=>{for(const f of h){const p=await f;if(typeof p=="string")return p}return null})():null},n=i.find(a=>!!a.allBasenames);n&&(r.allBasenames=n.allBasenames);const o=i.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function tW(e,t,i){if(t===!1)return kr;const s=Ew(e,i);if(s===kr)return kr;if(typeof t=="boolean")return s;if(t){const r=t.when;if(typeof r=="string"){const n=(o,a,c,l)=>{if(!l||!s(o,a))return null;const u=r.replace("$(basename)",()=>c),h=l(u);return Hn(h)?h.then(f=>f?e:null):h?e:null};return n.requiresSiblings=!0,n}}return s}function ZI(e,t){const i=e.filter(a=>!!a.basenames);if(i.length<2)return e;const s=i.reduce((a,c)=>{const l=c.basenames;return l?a.concat(l):a},[]);let r;if(t){r=[];for(let a=0,c=s.length;a<c;a++)r.push(t)}else r=i.reduce((a,c)=>{const l=c.patterns;return l?a.concat(l):a},[]);const n=function(a,c){if(typeof a!="string")return null;if(!c){let u;for(u=a.length;u>0;u--){const h=a.charCodeAt(u-1);if(h===47||h===92)break}c=a.substring(u)}const l=s.indexOf(c);return l!==-1?r[l]:null};n.basenames=s,n.patterns=r,n.allBasenames=s;const o=e.filter(a=>!a.basenames);return o.push(n),o}function QI(e,t){return Ci(e,t,(i,s)=>typeof i=="string"&&typeof s=="string"?i===s:typeof i!="string"&&typeof s!="string"?i.base===s.base&&i.pattern===s.pattern:!1)}var iW=H("notebookDocumentService"),Cw=["W","X","Y","Z","a","b","c","d","e","f"],sW=new RegExp(`^[${Cw.join("")}]+`),YI=7;function kw(e){if(e.scheme!==V.vscodeNotebookCell)return;const t=e.fragment.indexOf("s");if(t<0)return;const i=parseInt(e.fragment.substring(0,t).replace(sW,""),YI),s=qo(e.fragment.substring(t+1)).toString();if(!isNaN(i))return{handle:i,notebook:e.with({scheme:s,fragment:null})}}function rW(e,t){const i=t.toString(YI),r=`${i.length<Cw.length?Cw[i.length-1]:"z"}${i}s${fc(W.fromString(e.scheme),!0,!0)}`;return e.with({scheme:V.vscodeNotebookCell,fragment:r})}function nW(e){if(e.scheme!==V.vscodeNotebookMetadata)return;const t=qo(e.fragment).toString();return e.with({scheme:t,fragment:null})}function oW(e){const t=`${fc(W.fromString(e.scheme),!0,!0)}`;return e.with({scheme:V.vscodeNotebookMetadata,fragment:t})}function XI(e){if(e.scheme!==V.vscodeNotebookCellOutput)return;const t=new URLSearchParams(e.query),i=t.get("openIn");if(!i)return;const s=t.get("outputId")??void 0,r=kw(e.with({scheme:V.vscodeNotebookCell,query:null})),n=t.get("outputIndex")?parseInt(t.get("outputIndex")||"",10):void 0,o=r?r.notebook:e.with({scheme:t.get("notebookScheme")||V.file,fragment:null,query:null}),a=t.get("cellIndex")?parseInt(t.get("cellIndex")||"",10):void 0;return{notebook:o,openIn:i,outputId:s,outputIndex:n,cellHandle:r?.handle,cellFragment:e.fragment,cellIndex:a}}var aW=class{constructor(){this.a=new kt}getNotebook(e){if(e.scheme===V.vscodeNotebookCell){const t=kw(e);if(t){const i=this.a.get(t.notebook);if(i)return i}}if(e.scheme===V.vscodeNotebookCellOutput){const t=XI(e);if(t){const i=this.a.get(t.notebook);if(i)return i}}return this.a.get(e)}addNotebookDocument(e){this.a.set(e.uri,e)}removeNotebookDocument(e){this.a.delete(e.uri)}};De(iW,aW,1);var Pc;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(Pc||(Pc={}));var Sie=["application/json","application/javascript","text/html","image/svg+xml",Qs.latex,Qs.markdown,"image/png","image/jpeg",Qs.text],Eie=[Qs.latex,Qs.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Qs.text],KI;(function(e){e[e.Running=1]="Running",e[e.Idle=2]="Idle"})(KI||(KI={}));var e6;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(e6||(e6={}));var t6;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(t6||(t6={}));var i6;(function(e){e[e.WithHardKernelDependency=0]="WithHardKernelDependency",e[e.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",e[e.Pure=2]="Pure",e[e.Never=3]="Never"})(i6||(i6={}));var s6;(function(e){e.Always="always",e.Never="never",e.Optional="optional"})(s6||(s6={}));var ir;(function(e){e[e.ModelChange=1]="ModelChange",e[e.Move=2]="Move",e[e.ChangeCellLanguage=5]="ChangeCellLanguage",e[e.Initialize=6]="Initialize",e[e.ChangeCellMetadata=7]="ChangeCellMetadata",e[e.Output=8]="Output",e[e.OutputItem=9]="OutputItem",e[e.ChangeCellContent=10]="ChangeCellContent",e[e.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",e[e.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",e[e.ChangeCellMime=13]="ChangeCellMime",e[e.Unknown=100]="Unknown"})(ir||(ir={}));var r6;(function(e){e[e.Handle=0]="Handle",e[e.Index=1]="Index"})(r6||(r6={}));var n6;(function(e){e[e.Replace=1]="Replace",e[e.Output=2]="Output",e[e.Metadata=3]="Metadata",e[e.CellLanguage=4]="CellLanguage",e[e.DocumentMetadata=5]="DocumentMetadata",e[e.Move=6]="Move",e[e.OutputItems=7]="OutputItems",e[e.PartialMetadata=8]="PartialMetadata",e[e.PartialInternalMetadata=9]="PartialInternalMetadata"})(n6||(n6={}));var o6;(function(e){e.scheme=V.vscodeNotebookMetadata;function t(s){return oW(s)}e.generate=t;function i(s){return nW(s)}e.parse=i})(o6||(o6={}));var $w;(function(e){e.scheme=V.vscodeNotebookCell;function t(l,u){return rW(l,u)}e.generate=t;function i(l){return kw(l)}e.parse=i;function s(l,u){return l.with({scheme:V.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:u??"",notebookScheme:l.scheme!==V.file?l.scheme:""}).toString()})}e.generateCellOutputUriWithId=s;function r(l,u,h){return l.with({scheme:V.vscodeNotebookCellOutput,fragment:u.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(h)}).toString()})}e.generateCellOutputUriWithIndex=r;function n(l,u,h,f,p){return l.with({scheme:V.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"notebookOutputEditor",notebook:l.toString(),cellIndex:String(h),outputId:f,outputIndex:String(p)}).toString()})}e.generateOutputEditorUri=n;function o(l){return XI(l)}e.parseCellOutputUri=o;function a(l,u,h){return e.generate(l,u).with({scheme:h})}e.generateCellPropertyUri=a;function c(l,u){if(l.scheme===u)return e.parse(l.with({scheme:e.scheme}))}e.parseCellPropertyUri=c})($w||($w={}));var xie=new C("notebookEditorCursorAtBoundary","none"),Cie=new C("notebookEditorCursorAtLineBoundary","none"),a6;(function(e){e.default="default",e.option="option"})(a6||(a6={}));var c6;(function(e){e.Cells="cells",e.Text="text",e.None="none"})(c6||(c6={}));var l6;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(l6||(l6={}));var kie=class sv{static{this.d="notebook/"}static create(t,i){return`${sv.d}${t}/${i??t}`}static parse(t){if(t.startsWith(sv.d)){const i=t.substring(sv.d.length).split("/");if(i.length===2)return{notebookType:i[0],viewType:i[1]}}}},cW=new TextDecoder;function lW(e){const t=[];let i=!1;for(const o of e)(t.length===0||i)&&(t.push(o),i=!0);let s=hW(t);const r=W.concat(t.map(o=>W.wrap(o))),n=mW(r);return s=s||n.byteLength!==r.byteLength,{data:n,didCompression:s}}var ip="\x1B[A",Iw=ip.split("").map(e=>e.charCodeAt(0)),uW=10;function hW(e){let t=!1;return e.forEach((i,s)=>{if(s===0||i.length<ip.length)return;const r=e[s-1],n=i.subarray(0,ip.length);if(n[0]===Iw[0]&&n[1]===Iw[1]&&n[2]===Iw[2]){const o=r.lastIndexOf(uW);if(o===-1)return;t=!0,e[s-1]=r.subarray(0,o),e[s]=i.subarray(ip.length)}}),t}function dW(e){let t=e;do e=t,t=e.replace(/[^\n]\x08/gm,"");while(t.length<e.length);return e}function fW(e){for(e=e.replace(/\r+\n/gm,`
`);e.search(/\r[^$]/g)>-1;){const t=e.match(/^(.*)\r+/m)[1];let i=e.match(/\r+(.*)$/m)[1];i=i+t.slice(i.length,t.length),e=e.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,i)}return e}var pW=8,gW=13;function mW(e){return!e.buffer.includes(pW)&&!e.buffer.includes(gW)?e:W.fromString(fW(dW(cW.decode(e.buffer))))}var u6;(function(e){e.Delimiter="\0"})(u6||(u6={}));var h6;(function(e){e[e.IsSame=0]="IsSame",e[e.Disconnected=1]="Disconnected",e[e.IsChild=2]="IsChild",e[e.IsParent=3]="IsParent"})(h6||(h6={}));var Ve=class zs{static fromExtHostTestItem(t,i,s=t.parent){if(t._isRoot)return new zs([i]);const r=[t.id];for(let n=s;n&&n.id!==i;n=n.parent)r.push(n.id);return r.push(i),new zs(r.reverse())}static isRoot(t){return!t.includes("\0")}static root(t){const i=t.indexOf("\0");return i===-1?t:t.slice(0,i)}static fromString(t){return new zs(t.split("\0"))}static join(t,i){return new zs([...t.path,i])}static split(t){return t.split("\0")}static joinToString(t,i){return t.toString()+"\0"+i}static parentId(t){const i=t.lastIndexOf("\0");return i===-1?void 0:t.slice(0,i)}static localId(t){const i=t.lastIndexOf("\0");return i===-1?t:t.slice(i+1)}static isChild(t,i){return i[t.length]==="\0"&&i.startsWith(t)}static compare(t,i){return t===i?0:zs.isChild(t,i)?2:zs.isChild(i,t)?3:1}static getLengthOfCommonPrefix(t,i){if(t===0)return 0;let s=0;for(;s<t-1;){for(let r=1;r<t;r++){const n=i(r-1),o=i(r);if(n.path[s]!==o.path[s])return s}s++}return s}constructor(t,i=t.length){if(this.path=t,this.d=i,t.length===0||i<1)throw new Error("cannot create test with empty path")}get rootId(){return new zs(this.path,1)}get parentId(){return this.d>1?new zs(this.path,this.d-1):void 0}get localId(){return this.path[this.d-1]}get controllerId(){return this.path[0]}get isRoot(){return this.d===1}*idsFromRoot(){for(let t=1;t<=this.d;t++)yield new zs(this.path,t)}*idsToRoot(){for(let t=this.d;t>0;t--)yield new zs(this.path,t)}compare(t){if(typeof t=="string")return zs.compare(this.toString(),t);for(let i=0;i<t.d&&i<this.d;i++)if(t.path[i]!==this.path[i])return 1;return t.d>this.d?2:t.d<this.d?3:0}toJSON(){return this.toString()}toString(){if(!this.c){this.c=this.path[0];for(let t=1;t<this.d;t++)this.c+="\0",this.c+=this.path[t]}return this.c}},d6;(function(e){e[e.Unset=0]="Unset",e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(d6||(d6={}));var f6;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(f6||(f6={}));var p6;(function(e){e[e.Refresh=2]="Refresh",e[e.CodeRelatedToTest=4]="CodeRelatedToTest",e[e.TestRelatedToCode=8]="TestRelatedToCode"})(p6||(p6={}));var g6;(function(e){e[e.Run=2]="Run",e[e.Debug=4]="Debug",e[e.Coverage=8]="Coverage",e[e.HasNonDefaultProfile=16]="HasNonDefaultProfile",e[e.HasConfigurable=32]="HasConfigurable",e[e.SupportsContinuousRun=64]="SupportsContinuousRun"})(g6||(g6={}));var $ie={2:d(13974,null),4:d(13975,null),8:d(13976,null)},vW=e=>"runId"in e,Tc;(function(e){e.serialize=t=>({range:t.range.toJSON(),uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({range:rt.lift(i.range),uri:t.asCanonicalUri(y.revive(i.uri))})})(Tc||(Tc={}));var m6;(function(e){e[e.Error=0]="Error",e[e.Output=1]="Output"})(m6||(m6={}));var sp;(function(e){e.serialize=t=>({label:t.label,uri:t.uri?.toJSON(),position:t.position?.toJSON()}),e.deserialize=(t,i)=>({label:i.label,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,position:i.position?ms.lift(i.position):void 0})})(sp||(sp={}));var rp;(function(e){e.serialize=t=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&Tc.serialize(t.location),stackTrace:t.stackTrace?.map(sp.serialize)}),e.deserialize=(t,i)=>({message:i.message,type:0,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&Tc.deserialize(t,i.location),stackTrace:i.stackTrace&&i.stackTrace.map(s=>sp.deserialize(t,s))})})(rp||(rp={}));var np;(function(e){e.serialize=t=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&Tc.serialize(t.location)}),e.deserialize=(t,i)=>({message:i.message,type:1,offset:i.offset,length:i.length,location:i.location&&Tc.deserialize(t,i.location)})})(np||(np={}));var op;(function(e){e.serialize=t=>t.type===0?rp.serialize(t):np.serialize(t),e.deserialize=(t,i)=>i.type===0?rp.deserialize(t,i):np.deserialize(t,i),e.isDiffable=t=>t.type===0&&t.actual!==void 0&&t.expected!==void 0})(op||(op={}));var Wu;(function(e){e.serializeWithoutMessages=t=>({state:t.state,duration:t.duration,messages:[]}),e.serialize=t=>({state:t.state,duration:t.duration,messages:t.messages.map(op.serialize)}),e.deserialize=(t,i)=>({state:i.state,duration:i.duration,messages:i.messages.map(s=>op.deserialize(t,s))})})(Wu||(Wu={}));var v6="\0",ap=(e,t)=>e+v6+t,w6=e=>{const t=e.indexOf(v6);return{ctrlId:e.slice(0,t),tagId:e.slice(t+1)}},cp;(function(e){e.serialize=t=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?.toJSON(),range:t.range?.toJSON()||null,description:t.description,error:t.error,sortText:t.sortText}),e.deserialize=(t,i)=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,range:i.range?rt.lift(i.range):null,description:i.description,error:i.error,sortText:i.sortText})})(cp||(cp={}));var b6;(function(e){e[e.NotExpandable=0]="NotExpandable",e[e.Expandable=1]="Expandable",e[e.BusyExpanding=2]="BusyExpanding",e[e.Expanded=3]="Expanded"})(b6||(b6={}));var so;(function(e){e.serialize=t=>({expand:t.expand,item:cp.serialize(t.item)}),e.deserialize=(t,i)=>({controllerId:Ve.root(i.item.extId),expand:i.expand,item:cp.deserialize(t,i.item)})})(so||(so={}));var Bu;(function(e){e.serialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.uri!==void 0&&(i.uri=t.item.uri?.toJSON()),t.item.range!==void 0&&(i.range=t.item.range?.toJSON()),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}},e.deserialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.range!==void 0&&(i.range=t.item.range?rt.lift(t.item.range):null),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}}})(Bu||(Bu={}));var Dw=(e,t)=>{t.expand!==void 0&&(e.expand=t.expand),t.item!==void 0&&(e.item=e.item?Object.assign(e.item,t.item):t.item)},y6;(function(e){e.serializeWithoutMessages=t=>({...so.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(Wu.serializeWithoutMessages)}),e.serialize=t=>({...so.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(Wu.serialize)}),e.deserialize=(t,i)=>({...so.deserialize(t,i),ownComputedState:i.ownComputedState,computedState:i.computedState,tasks:i.tasks.map(s=>Wu.deserialize(t,s)),retired:!0})})(y6||(y6={}));var Pw;(function(e){e.empty=()=>({covered:0,total:0}),e.sum=(t,i)=>{t.covered+=i.covered,t.total+=i.total}})(Pw||(Pw={}));var A6;(function(e){e.serialize=t=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({id:i.id,statement:i.statement,branch:i.branch,declaration:i.declaration,testIds:i.testIds,uri:t.asCanonicalUri(y.revive(i.uri))}),e.empty=(t,i)=>({id:t,uri:i,statement:Pw.empty()})})(A6||(A6={}));function Tw(e){return{...e,location:e.location?.toJSON()}}function Nw(e){return e.location=e.location?ms.isIPosition(e.location)?ms.lift(e.location):rt.lift(e.location):void 0,e}var S6;(function(e){e[e.Declaration=0]="Declaration",e[e.Statement=1]="Statement",e[e.Branch=2]="Branch"})(S6||(S6={}));var E6;(function(e){e.serialize=t=>t.type===0?up.serialize(t):hp.serialize(t),e.deserialize=t=>t.type===0?up.deserialize(t):hp.deserialize(t)})(E6||(E6={}));var lp;(function(e){e.serialize=Tw,e.deserialize=Nw})(lp||(lp={}));var up;(function(e){e.serialize=Tw,e.deserialize=Nw})(up||(up={}));var hp;(function(e){e.serialize=t=>({...Tw(t),branches:t.branches?.map(lp.serialize)}),e.deserialize=t=>({...Nw(t),branches:t.branches?.map(lp.deserialize)})})(hp||(hp={}));var x6;(function(e){e[e.Add=0]="Add",e[e.Update=1]="Update",e[e.DocumentSynced=2]="DocumentSynced",e[e.Remove=3]="Remove",e[e.IncrementPendingExtHosts=4]="IncrementPendingExtHosts",e[e.Retire=5]="Retire",e[e.AddTag=6]="AddTag",e[e.RemoveTag=7]="RemoveTag"})(x6||(x6={}));var dp;(function(e){e.deserialize=(t,i)=>i.op===0?{op:i.op,item:so.deserialize(t,i.item)}:i.op===1?{op:i.op,item:Bu.deserialize(i.item)}:i.op===2?{op:i.op,uri:t.asCanonicalUri(y.revive(i.uri)),docv:i.docv}:i,e.serialize=t=>t.op===0?{op:t.op,item:so.serialize(t.item)}:t.op===1?{op:t.op,item:Bu.serialize(t.item)}:t})(dp||(dp={}));var wW=class{constructor(e){this.l=e,this.f=new Map,this.g=new Map,this.h=new Set,this.j=0,this.k=0,this.tags=this.f}apply(e){const t=this.x();for(const i of e)switch(i.op){case 0:this.p(so.deserialize(this.l,i.item),t);break;case 1:this.q(Bu.deserialize(i.item),t);break;case 3:this.v(i.itemId,t);break;case 5:this.w(i.itemId);break;case 4:this.updatePendingRoots(i.amount);break;case 6:this.f.set(i.tag.id,i.tag);break;case 7:this.f.delete(i.id);break}t.complete?.()}p(e,t){const i=Ve.parentId(e.item.extId)?.toString();let s;if(!i)s=this.y(e),this.h.add(s),this.g.set(e.item.extId,s);else if(this.g.has(i)){const r=this.g.get(i);r.children.add(e.item.extId),s=this.y(e,r),this.g.set(e.item.extId,s)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return t.add?.(s),e.expand===2&&this.j++,s}q(e,t){const i=this.g.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.j--,e.expand===2&&this.j++),Dw(i,e),t.update?.(i),i}v(e,t){const i=this.g.get(e);if(!i)return;const s=Ve.parentId(i.item.extId)?.toString();s?this.g.get(s).children.delete(i.item.extId):this.h.delete(i);const r=[[e]];for(;r.length;)for(const n of r.pop()){const o=this.g.get(n);o&&(r.push(o.children),this.g.delete(n),t.remove?.(o,o!==i),o.expand===2&&this.j--)}}w(e){}updatePendingRoots(e){this.k+=e}x(){return{}}},Iie=H("IAiSettingsSearchService"),ro;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(ro||(ro={}));var bW=H("editorGroupsService"),C6;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(C6||(C6={}));var k6;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(k6||(k6={}));var $6;(function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST",e[e.NEXT=2]="NEXT",e[e.PREVIOUS=3]="PREVIOUS"})($6||($6={}));var I6;(function(e){e[e.MAXIMIZE=0]="MAXIMIZE",e[e.EXPAND=1]="EXPAND",e[e.EVEN=2]="EVEN"})(I6||(I6={}));var D6;(function(e){e[e.COPY_EDITORS=0]="COPY_EDITORS",e[e.MOVE_EDITORS=1]="MOVE_EDITORS"})(D6||(D6={}));var P6;(function(e){e[e.CREATION_TIME=0]="CREATION_TIME",e[e.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",e[e.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(P6||(P6={}));var T6;(function(e){e[e.NEW_EDITOR=1]="NEW_EDITOR",e[e.MOVE_EDITOR=2]="MOVE_EDITOR",e[e.COPY_EDITOR=3]="COPY_EDITOR"})(T6||(T6={}));var N6=H("editorService"),yW=-1,AW=-2,no;(function(e){e.Extensions="Extensions",e.IntegratedTerminal="IntegratedTerminal",e.InteractiveSession="InteractiveSession",e.Telemetry="Telemetry",e.Update="Update"})(no||(no={}));var Die={[no.Extensions]:{name:{key:"extensionsConfigurationTitle",value:d(145,null)}},[no.IntegratedTerminal]:{name:{key:"terminalIntegratedConfigurationTitle",value:d(146,null)}},[no.InteractiveSession]:{name:{key:"interactiveSessionConfigurationTitle",value:d(147,null)}},[no.Telemetry]:{name:{key:"telemetryConfigurationTitle",value:d(148,null)}},[no.Update]:{name:{key:"updateConfigurationTitle",value:d(149,null)}}},gi=H("configurationService"),M6;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.USER=2]="USER",e[e.USER_LOCAL=3]="USER_LOCAL",e[e.USER_REMOTE=4]="USER_REMOTE",e[e.WORKSPACE=5]="WORKSPACE",e[e.WORKSPACE_FOLDER=6]="WORKSPACE_FOLDER",e[e.DEFAULT=7]="DEFAULT",e[e.MEMORY=8]="MEMORY"})(M6||(M6={}));function Mw(e,t){const i=Object.create(null);for(const s in e)L6(i,s,e[s],t);return i}function L6(e,t,i,s){const r=t.split("."),n=r.pop();let o=e;for(let a=0;a<r.length;a++){const c=r[a];let l=o[c];switch(typeof l){case"undefined":l=o[c]=Object.create(null);break;case"object":if(l===null){s(`Ignoring ${t} as ${r.slice(0,a+1).join(".")} is null`);return}break;default:s(`Ignoring ${t} as ${r.slice(0,a+1).join(".")} is ${JSON.stringify(l)}`);return}o=l}if(typeof o=="object"&&o!==null)try{o[n]=i}catch{s(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(o)}`)}else s(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(o)}`)}function SW(e,t){const i=t.split(".");R6(e,i)}function R6(e,t){if(!e)return;const i=e,s=t.shift();if(t.length===0){delete i[s];return}if(Object.keys(i).indexOf(s)!==-1){const r=i[s];typeof r=="object"&&!Array.isArray(r)&&(R6(r,t),Object.keys(r).length===0&&delete i[s])}}function fp(e,t,i){function s(o,a){let c=o;for(const l of a){if(typeof c!="object"||c===null)return;c=c[l]}return c}const r=t.split("."),n=s(e,r);return typeof n>"u"?i:n}function EW(e){return e.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}function xW(e){let t=!1;const i=new Map,s=new Map;if(CW(e,u=>{if(e===u)return!0;const h=JSON.stringify(u);if(h.length<30)return!0;const f=i.get(h);if(!f){const p={schemas:[u]};return i.set(h,p),s.set(u,p),!0}return f.schemas.push(u),s.set(u,f),t=!0,!1}),i.clear(),!t)return JSON.stringify(e);let n="$defs";for(;e.hasOwnProperty(n);)n+="_";const o=[];function a(u){return JSON.stringify(u,(h,f)=>{if(f!==u){const p=s.get(f);if(p&&p.schemas.length>1)return p.id||(p.id=`_${o.length}`,o.push(p.schemas[0])),{$ref:`#/${n}/${p.id}`}}return f})}const c=a(e),l=[];for(let u=0;u<o.length;u++)l.push(`"_${u}":${a(o[u])}`);return l.length?`${c.substring(0,c.length-1)},"${n}":{${l.join(",")}}}`:c}function Nc(e){return typeof e=="object"&&e!==null}function CW(e,t){if(!e||typeof e!="object")return;const i=(...c)=>{for(const l of c)Nc(l)&&o.push(l)},s=(...c)=>{for(const l of c)if(Nc(l))for(const u in l){const h=l[u];Nc(h)&&o.push(h)}},r=(...c)=>{for(const l of c)if(Array.isArray(l))for(const u of l)Nc(u)&&o.push(u)},n=c=>{if(Array.isArray(c))for(const l of c)Nc(l)&&o.push(l);else Nc(c)&&o.push(c)},o=[e];let a=o.pop();for(;a;)t(a)&&(i(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),s(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),r(a.anyOf,a.allOf,a.oneOf,a.prefixItems),n(a.items)),a=o.pop()}var pp={JSONContribution:"base.contributions.json"};function O6(e){return e.length>0&&e.charAt(e.length-1)==="#"?e.substring(0,e.length-1):e}var kW=class extends Z{constructor(){super(...arguments),this.a={},this.b={},this.c=this.D(new I),this.onDidChangeSchema=this.c.event,this.f=this.D(new I),this.onDidChangeSchemaAssociations=this.f.event}registerSchema(e,t,i){const s=O6(e);this.a[s]=t,this.c.fire(e),i&&i.add(te(()=>{delete this.a[s],this.c.fire(e)}))}registerSchemaAssociation(e,t){const i=O6(e);return this.b[i]||(this.b[i]=[]),this.b[i].includes(t)||(this.b[i].push(t),this.f.fire()),te(()=>{const s=this.b[i];if(s){const r=s.indexOf(t);r!==-1&&(s.splice(r,1),s.length===0&&delete this.b[i],this.f.fire())}})}notifySchemaChanged(e){this.c.fire(e)}getSchemaContributions(){return{schemas:this.a}}getSchemaContent(e){const t=this.a[e];return t?xW(t):void 0}hasSchemaContent(e){return!!this.a[e]}getSchemaAssociations(){return this.b}},$W=new kW;Qt.add(pp.JSONContribution,$W);var F6;(function(e){e.Multiline="multilineText",e.Singleline="singlelineText"})(F6||(F6={}));var oo={Configuration:"base.contributions.configuration"},U6;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.MACHINE=2]="MACHINE",e[e.APPLICATION_MACHINE=3]="APPLICATION_MACHINE",e[e.WINDOW=4]="WINDOW",e[e.RESOURCE=5]="RESOURCE",e[e.LANGUAGE_OVERRIDABLE=6]="LANGUAGE_OVERRIDABLE",e[e.MACHINE_OVERRIDABLE=7]="MACHINE_OVERRIDABLE"})(U6||(U6={}));var gp={properties:{},patternProperties:{}},mp={properties:{},patternProperties:{}},vp={properties:{},patternProperties:{}},wp={properties:{},patternProperties:{}},bp={properties:{},patternProperties:{}},yp={properties:{},patternProperties:{}},_u={properties:{},patternProperties:{}},ha="vscode://schemas/settings/resourceLanguage",Ap=Qt.as(pp.JSONContribution),IW=class extends Z{constructor(){super(),this.a=[],this.n=new Set,this.q=this.D(new I),this.onDidSchemaChange=this.q.event,this.r=this.D(new I),this.onDidUpdateConfiguration=this.r.event,this.b=new Map,this.c={id:"defaultOverrides",title:d(1843,null),properties:{}},this.f=[this.c],this.m={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.g={},this.h=new Map,this.j={},Ap.registerSchema(ha,this.m),this.N()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.F(e,t,i),Ap.registerSchema(ha,this.m),this.q.fire(),this.r.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.G(e,t),Ap.registerSchema(ha,this.m),this.q.fire(),this.r.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.G(t,i),this.F(e,!1,i),Ap.registerSchema(ha,this.m),this.q.fire(),this.r.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.s(e,t),this.q.fire(),this.r.fire({properties:t,defaultsOverrides:!0})}s(e,t){this.a.push(...e);const i=[];for(const{overrides:s,source:r}of e)for(const n in s){t.add(n);const o=this.b.get(n)??this.b.set(n,{configurationDefaultOverrides:[]}).get(n),a=s[n];if(o.configurationDefaultOverrides.push({value:a,source:r}),$r.test(n)){const c=this.y(n,a,r,o.configurationDefaultOverrideValue);if(!c)continue;o.configurationDefaultOverrideValue=c,this.w(n,c,r),i.push(...Vu(n))}else{const c=this.z(n,a,r,o.configurationDefaultOverrideValue);if(!c)continue;o.configurationDefaultOverrideValue=c;const l=this.g[n];l&&(this.O(n,l),this.J(n,l))}}this.C(i)}deregisterDefaultConfigurations(e){const t=new Set;this.u(e,t),this.q.fire(),this.r.fire({properties:t,defaultsOverrides:!0})}u(e,t){for(const i of e){const s=this.a.indexOf(i);s!==-1&&this.a.splice(s,1)}for(const{overrides:i,source:s}of e)for(const r in i){const n=this.b.get(r);if(!n)continue;const o=n.configurationDefaultOverrides.findIndex(a=>s?a.source?.id===s.id:a.value===i[r]);if(o!==-1){if(n.configurationDefaultOverrides.splice(o,1),n.configurationDefaultOverrides.length===0&&this.b.delete(r),$r.test(r)){let a;for(const c of n.configurationDefaultOverrides)a=this.y(r,c.value,c.source,a);a&&!Dv(a.value)?(n.configurationDefaultOverrideValue=a,this.w(r,a,s)):(this.b.delete(r),delete this.g[r],delete this.c.properties[r])}else{let a;for(const l of n.configurationDefaultOverrides)a=this.z(r,l.value,l.source,a);n.configurationDefaultOverrideValue=a;const c=this.g[r];c&&(this.O(r,c),this.J(r,c))}t.add(r)}}this.M()}w(e,t,i){const s={section:{id:this.c.id,title:this.c.title,order:this.c.order,extensionInfo:this.c.extensionInfo},type:"object",default:t.value,description:d(1844,null,EW(e)),$ref:ha,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.g[e]=s,this.c.properties[e]=s}y(e,t,i,s){const r=s?.value||{},n=s?.source??new Map;if(!(n instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const o of Object.keys(t)){const a=t[o];if(At(a)&&(au(r[o])||At(r[o]))){if(r[o]={...r[o]??{},...a},i)for(const l in a)n.set(`${o}.${l}`,i)}else r[o]=a,i?n.set(o,i):n.delete(o)}return{value:r,source:n}}z(e,t,i,s){const r=this.g[e],n=s?.value??r?.defaultDefaultValue;let o=i;if(At(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(au(n)||At(n)))){if(o=s?.source??new Map,!(o instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&o.set(`${e}.${c}`,i);t={...At(n)?n:{},...t}}return{value:t,source:o}}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.u(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.s(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.G(e.removedConfigurations,i),e.addedConfigurations&&this.F(e.addedConfigurations,!1,i),this.q.fire(),this.r.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this.q.fire()}registerOverrideIdentifiers(e){this.C(e),this.q.fire()}C(e){for(const t of e)this.n.add(t);this.M()}F(e,t,i){e.forEach(s=>{this.H(s,t,s.extensionInfo,s.restrictedProperties,void 0,i),this.f.push(s),this.I(s)})}G(e,t){const i=s=>{if(s.properties)for(const r in s.properties){t.add(r);const n=this.g[r];n?.policy?.name&&this.h.delete(n.policy.name),delete this.g[r],this.L(r,s.properties[r])}s.allOf?.forEach(r=>i(r))};for(const s of e){i(s);const r=this.f.indexOf(s);r!==-1&&this.f.splice(r,1)}}H(e,t=!0,i,s,r=4,n){r=Wt(e.scope)?r:e.scope;const o=e.properties;if(o)for(const c in o){const l=o[c];if(l.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo},t&&PW(c,l,i?.id)){delete o[c];continue}l.source=i,l.defaultDefaultValue=o[c].default,this.O(c,l),$r.test(c)?l.scope=void 0:(l.scope=Wt(l.scope)?r:l.scope,l.restricted=Wt(l.restricted)?!!s?.includes(c):l.restricted),l.experiment?l.tags?.some(f=>f.toLowerCase()==="onexp")||(l.tags=l.tags??[],l.tags.push("onExP")):l.tags?.some(f=>f.toLowerCase()==="onexp")&&(console.error(`Invalid tag 'onExP' found for property '${c}'. Please use 'experiment' property instead.`),l.experiment={mode:"startup"});const u=o[c].hasOwnProperty("included")&&!o[c].included,h=o[c].policy?.name;u?(this.j[c]=o[c],h&&(this.h.set(h,c),n.add(c)),delete o[c]):(n.add(c),h&&this.h.set(h,c),this.g[c]=o[c],!o[c].deprecationMessage&&o[c].markdownDeprecationMessage&&(o[c].deprecationMessage=o[c].markdownDeprecationMessage))}const a=e.allOf;if(a)for(const c of a)this.H(c,t,i,s,r,n)}getConfigurations(){return this.f}getConfigurationProperties(){return this.g}getPolicyConfigurations(){return this.h}getExcludedConfigurationProperties(){return this.j}getRegisteredDefaultConfigurations(){return[...this.a]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[t,i]of this.b)i.configurationDefaultOverrideValue&&e.set(t,i.configurationDefaultOverrideValue);return e}I(e){const t=i=>{const s=i.properties;if(s)for(const n in s)this.J(n,s[n]);i.allOf?.forEach(t)};t(e)}J(e,t){switch(gp.properties[e]=t,t.scope){case 1:mp.properties[e]=t;break;case 2:wp.properties[e]=t;break;case 3:vp.properties[e]=t;break;case 7:bp.properties[e]=t;break;case 4:yp.properties[e]=t;break;case 5:_u.properties[e]=t;break;case 6:_u.properties[e]=t,this.m.properties[e]=t;break}}L(e,t){switch(delete gp.properties[e],t.scope){case 1:delete mp.properties[e];break;case 2:delete wp.properties[e];break;case 3:delete vp.properties[e];break;case 7:delete bp.properties[e];break;case 4:delete yp.properties[e];break;case 5:case 6:delete _u.properties[e],delete this.m.properties[e];break}}M(){for(const e of this.n.values()){const t=`[${e}]`,i={type:"object",description:d(1845,null),errorMessage:d(1846,null),$ref:ha};this.O(t,i),gp.properties[t]=i,mp.properties[t]=i,vp.properties[t]=i,wp.properties[t]=i,bp.properties[t]=i,yp.properties[t]=i,_u.properties[t]=i}}N(){const e={type:"object",description:d(1847,null),errorMessage:d(1848,null),$ref:ha};gp.patternProperties[ao]=e,mp.patternProperties[ao]=e,vp.patternProperties[ao]=e,wp.patternProperties[ao]=e,bp.patternProperties[ao]=e,yp.patternProperties[ao]=e,_u.patternProperties[ao]=e,this.q.fire()}O(e,t){const i=this.b.get(e)?.configurationDefaultOverrideValue;let s,r;i&&(!t.disallowConfigurationDefault||!i.source)&&(s=i.value,r=i.source),au(s)&&(s=t.defaultDefaultValue,r=void 0),au(s)&&(s=DW(t.type)),t.default=s,t.defaultValueSource=r}},j6="\\[([^\\]]+)\\]",z6=new RegExp(j6,"g"),ao=`^(${j6})+$`,$r=new RegExp(ao);function Vu(e){const t=[];if($r.test(e)){let i=z6.exec(e);for(;i?.length;){const s=i[1].trim();s&&t.push(s),i=z6.exec(e)}}return Tn(t)}function DW(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var Sp=new IW;Qt.add(oo.Configuration,Sp);function PW(e,t,i){return e.trim()?$r.test(e)?d(1850,null,e):Sp.getConfigurationProperties()[e]!==void 0&&(!i||!TW.has(i.toLowerCase()))?d(1851,null,e):t.policy?.name&&Sp.getPolicyConfigurations().get(t.policy?.name)!==void 0?d(1852,null,e,t.policy?.name,Sp.getPolicyConfigurations().get(t.policy?.name)):null:d(1849,null)}var TW=new Set(yi.defaultChatAgent?[yi.defaultChatAgent.extensionId,yi.defaultChatAgent.chatExtensionId].map(e=>e.toLowerCase()):[]),Lw="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",Pie=new RegExp(Lw),H6;(function(e){e.COMMAND="command",e.SETTINGS_SYNC="settingsSync"})(H6||(H6={}));var W6;(function(e){e.NoneOrRelevance="NoneOrRelevance",e.LastUpdatedDate="LastUpdatedDate",e.Title="Title",e.PublisherName="PublisherName",e.InstallCount="InstallCount",e.PublishedDate="PublishedDate",e.AverageRating="AverageRating",e.WeightedRating="WeightedRating"})(W6||(W6={}));var B6;(function(e){e[e.Default=0]="Default",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"})(B6||(B6={}));var _6;(function(e){e.Category="Category",e.ExtensionId="ExtensionId",e.ExtensionName="ExtensionName",e.ExcludeWithFlags="ExcludeWithFlags",e.Featured="Featured",e.SearchText="SearchText",e.Tag="Tag",e.Target="Target"})(_6||(_6={}));var V6;(function(e){e.Install="install",e.Uninstall="uninstall"})(V6||(V6={}));var q6;(function(e){e[e.None=1]="None",e[e.Install=2]="Install",e[e.Update=3]="Update",e[e.Migrate=4]="Migrate"})(q6||(q6={}));var Tie=H("extensionGalleryService"),G6;(function(e){e.Timeout="Timeout",e.Cancelled="Cancelled",e.ClientError="ClientError",e.ServerError="ServerError",e.Failed="Failed",e.DownloadFailedWriting="DownloadFailedWriting",e.Offline="Offline"})(G6||(G6={}));var J6;(function(e){e.NotFound="NotFound",e.Unsupported="Unsupported",e.Deprecated="Deprecated",e.Malicious="Malicious",e.Incompatible="Incompatible",e.IncompatibleApi="IncompatibleApi",e.IncompatibleTargetPlatform="IncompatibleTargetPlatform",e.ReleaseVersionNotFound="ReleaseVersionNotFound",e.Invalid="Invalid",e.Download="Download",e.DownloadSignature="DownloadSignature",e.DownloadFailedWriting="DownloadFailedWriting",e.UpdateMetadata="UpdateMetadata",e.Extract="Extract",e.Scanning="Scanning",e.ScanningExtension="ScanningExtension",e.ReadRemoved="ReadRemoved",e.UnsetRemoved="UnsetRemoved",e.Delete="Delete",e.Rename="Rename",e.IntializeDefaultProfile="IntializeDefaultProfile",e.AddToProfile="AddToProfile",e.InstalledExtensionNotFound="InstalledExtensionNotFound",e.PostInstall="PostInstall",e.CorruptZip="CorruptZip",e.IncompleteZip="IncompleteZip",e.PackageNotSigned="PackageNotSigned",e.SignatureVerificationInternal="SignatureVerificationInternal",e.SignatureVerificationFailed="SignatureVerificationFailed",e.NotAllowed="NotAllowed",e.Gallery="Gallery",e.Cancelled="Cancelled",e.Unknown="Unknown",e.Internal="Internal"})(J6||(J6={}));var Z6;(function(e){e.NotSigned="NotSigned",e.Success="Success",e.RequiredArgumentMissing="RequiredArgumentMissing",e.InvalidArgument="InvalidArgument",e.PackageIsUnreadable="PackageIsUnreadable",e.UnhandledException="UnhandledException",e.SignatureManifestIsMissing="SignatureManifestIsMissing",e.SignatureManifestIsUnreadable="SignatureManifestIsUnreadable",e.SignatureIsMissing="SignatureIsMissing",e.SignatureIsUnreadable="SignatureIsUnreadable",e.CertificateIsUnreadable="CertificateIsUnreadable",e.SignatureArchiveIsUnreadable="SignatureArchiveIsUnreadable",e.FileAlreadyExists="FileAlreadyExists",e.SignatureArchiveIsInvalidZip="SignatureArchiveIsInvalidZip",e.SignatureArchiveHasSameSignatureFile="SignatureArchiveHasSameSignatureFile",e.PackageIntegrityCheckFailed="PackageIntegrityCheckFailed",e.SignatureIsInvalid="SignatureIsInvalid",e.SignatureManifestIsInvalid="SignatureManifestIsInvalid",e.SignatureIntegrityCheckFailed="SignatureIntegrityCheckFailed",e.EntryIsMissing="EntryIsMissing",e.EntryIsTampered="EntryIsTampered",e.Untrusted="Untrusted",e.CertificateRevoked="CertificateRevoked",e.SignatureIsNotValid="SignatureIsNotValid",e.UnknownError="UnknownError",e.PackageIsInvalidZip="PackageIsInvalidZip",e.SignatureArchiveHasTooManyEntries="SignatureArchiveHasTooManyEntries"})(Z6||(Z6={}));var Nie=H("extensionManagementService"),Mie=H("IGlobalExtensionEnablementService"),Lie=H("IExtensionTipsService"),Rie=H("IAllowedExtensionsService"),Oie=sf(2002,"Extensions"),Fie=sf(2003,"Preferences"),NW="extensions.allowed";Qt.as(oo.Configuration).registerConfiguration({id:"extensions",order:30,title:d(1985,null),type:"object",properties:{[NW]:{type:"object",markdownDescription:d(1986,null),default:"*",defaultSnippets:[{body:{},description:d(1987,null)},{body:{"*":!0},description:d(1988,null)}],scope:1,policy:{name:"AllowedExtensions",category:no.Extensions,minimumVersion:"1.96",localization:{description:{key:"extensions.allowed.policy",value:d(1989,null)}}},additionalProperties:!1,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:["boolean","string"],enum:[!0,!1,"stable"],description:d(1990,null),enumDescriptions:[d(1991,null),d(1992,null),d(1993,null)]},{type:"array",items:{type:"string"},description:d(1994,null)}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:["boolean","string"],enum:[!0,!1,"stable"],description:d(1995,null),enumDescriptions:[d(1996,null),d(1997,null),d(1998,null)]},"\\*":{type:"boolean",enum:[!0,!1],description:d(1999,null),enumDescriptions:[d(2e3,null),d(2001,null)]}}}}});var qu=H("telemetryService"),Uie=H("customEndpointTelemetryService"),Q6;(function(e){e[e.NONE=0]="NONE",e[e.CRASH=1]="CRASH",e[e.ERROR=2]="ERROR",e[e.USAGE=3]="USAGE"})(Q6||(Q6={}));var Y6;(function(e){e.OFF="off",e.CRASH="crash",e.ERROR="error",e.ON="all"})(Y6||(Y6={}));var Rw=class{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}},MW=class{constructor(){this.telemetryLevel=0,this.sessionId="someValue.sessionId",this.machineId="someValue.machineId",this.sqmId="someValue.sqmId",this.devDeviceId="someValue.devDeviceId",this.firstSessionDate="someValue.firstSessionDate",this.sendErrorTelemetry=!1}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},jie=new MW,LW="telemetry",RW={id:LW,name:d(2342,null)},OW=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function FW(e){if(!e)return"none";const t=y0(e);return OW.has(t)?t:"other"}function UW(e,t){if(!e||!e.includes("/")&&!e.includes("\\"))return e;let i=e;const s=[];for(const a of t)for(;;){const c=a.exec(e);if(!c)break;s.push([c.index,a.lastIndex])}const r=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,n=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(i="";;){const a=n.exec(e);if(!a)break;const c=s.some(([l,u])=>a.index<u&&l<n.lastIndex);!r.test(a[0])&&!c&&(i+=e.substring(o,a.index)+"<REDACTED: user-file-path>",o=n.lastIndex)}return o<e.length&&(i+=e.substr(o)),i}function jW(e){if(!e)return e;const t=[{label:"URL",regex:/[a-zA-Z][a-zA-Z0-9+.-]*:\/\/[^\s]*/},{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"JWT",regex:/eyJ[0eXAiOiJKV1Qi|hbGci|a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const i of t)if(i.regex.test(e))return`<REDACTED: ${i.label}>`;return e}function X6(e,t){return e?mc(e,i=>{if(i instanceof Rw||Object.hasOwnProperty.call(i,"isTrustedTelemetryValue"))return i.value;if(typeof i=="string"){let s=i.replaceAll("%20"," ");s=UW(s,t);for(const r of t)s=s.replace(r,"");return s=jW(s),s}}):{}}function zW(e,t){return e.uuid&&t.uuid?e.uuid===t.uuid:e.id===t.id?!0:Hv(e.id,t.id)===0}var zie=new Ye("pprice.better-merge"),HW=class{constructor(){this.a=new Map,this.b=new WeakMap}register(e,t){this.a.set(e,t)}readActivationEvents(e){return this.b.has(e)||this.b.set(e,this.c(e)),this.b.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const s=this.readActivationEvents(i);s.length>0&&(t[Ye.toKey(i.identifier)]=s)}return t}c(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${Ye.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const s=this.a.get(i);if(!s)continue;const r=e.contributes[i],n=Array.isArray(r)?r:[r];try{t.push(...s(n))}catch(o){lt(o)}}return t}},WW=new HW,BW=Object.freeze({identifier:new Ye("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1,preRelease:!1}),K6=H("extensionService"),e7=class{constructor(e){this.dependency=e}},t7;(function(e){e[e.EagerAutoStart=1]="EagerAutoStart",e[e.EagerManualStart=2]="EagerManualStart",e[e.LazyAutoStart=3]="LazyAutoStart"})(t7||(t7={}));function et(e,t){return e.enabledApiProposals?e.enabledApiProposals.includes(t):!1}function T(e,t){if(!et(e,t))throw new Error(`Extension '${e.identifier.value}' CANNOT use API proposal: ${t}.
Its package.json#enabledApiProposals-property declares: ${e.enabledApiProposals?.join(", ")??"[]"} but NOT ${t}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${e.identifier.value}`)}var i7;(function(e){e[e.Normal=0]="Normal",e[e.Immediate=1]="Immediate"})(i7||(i7={}));var s7;(function(e){e[e.Upsert=0]="Upsert",e[e.SetTags=1]="SetTags",e[e.UpdateCanResolveChildren=2]="UpdateCanResolveChildren",e[e.RemoveChild=3]="RemoveChild",e[e.SetProp=4]="SetProp",e[e.Bulk=5]="Bulk",e[e.DocumentSynced=6]="DocumentSynced"})(s7||(s7={}));var Gu=(e,t)=>e===t,_W={range:(e,t)=>e===t?!0:!e||!t?!1:e.equalsRange(t),busy:Gu,label:Gu,description:Gu,error:Gu,sortText:Gu,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.includes(i)))},VW=Object.entries(_W),qW=(e,t)=>{let i;for(const[s,r]of VW)r(e[s],t[s])||(i?i[s]=t[s]:i={[s]:t[s]});return i},GW=class extends Z{get root(){return this.q.root}constructor(e){super(),this.q=e,this.f=this.D(new br(()=>this.flushDiff(),200)),this.g=this.D(new I),this.tree=new Map,this.j=new Map,this.m=[],this.onDidGenerateDiff=this.g.event,this.root.canResolveChildren=!0,this.y(this.root,void 0)}set resolveHandler(e){this.h=e;for(const t of this.tree.values())this.J(t)}get resolveHandler(){return this.h}collectDiff(){const e=this.m;return this.m=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.m)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.m[this.m.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){Dw(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){Dw(t.item,e.item);return}}break}}this.m.push(e),this.f.isScheduled()||this.f.schedule()}expand(e,t){const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const s=this.M(i);return s.isOpen()?this.L(i,t-1):s.wait().then(()=>this.L(i,t-1))}else if(i.expand===3)return i.resolveBarrier?.isOpen()===!1?i.resolveBarrier.wait().then(()=>this.L(i,t-1)):this.L(i,t-1)}}dispose(){for(const e of this.tree.values())this.q.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.m=[],super.dispose()}s(e,t){switch(t.op){case 3:this.O(Ve.joinToString(e.fullId,t.id));break;case 0:this.y(t.item,e);break;case 5:for(const i of t.ops)this.s(e,i);break;case 1:this.z(t.new,t.old,e.fullId.toString());break;case 2:this.J(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.w(e.actual.uri);break;default:kv(t)}}w(e){e&&this.pushDiff({op:2,uri:e,docv:this.q.getDocumentVersion(e)})}y(e,t){const i=Ve.fromExtHostTestItem(e,this.root.id,t?.actual),s=this.q.getApiFor(e);s.parent&&s.parent!==t?.actual&&this.q.getChildren(s.parent).delete(e.id);let r=this.tree.get(i.toString());if(!r){r={fullId:i,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.C,this),this.tree.set(r.fullId.toString(),r),this.G(e,t),this.pushDiff({op:0,item:{controllerId:this.q.controllerId,expand:r.expand,item:this.q.toITestItem(e)}}),this.I(e,r,t);return}if(r.actual===e){this.H(e,r,t);return}if(r.actual.uri?.toString()!==e.uri?.toString())return this.O(i.toString()),this.y(e,t);const n=this.q.getChildren(r.actual),o=r.actual,a=qW(this.q.toITestItem(o),this.q.toITestItem(e));this.q.getApiFor(o).listener=void 0,r.actual=e,r.resolveBarrier=void 0,r.expand=0,a&&(a.hasOwnProperty("tags")&&(this.z(e.tags,o.tags,i.toString()),delete a.tags),this.s(r,{op:4,update:a})),this.I(e,r,t);for(const[l,u]of n)this.q.getChildren(e).get(u.id)||this.O(Ve.joinToString(i,u.id));const c=r.expandLevels;c!==void 0&&queueMicrotask(()=>{r.expand===1&&(r.expandLevels=void 0,this.expand(i.toString(),c))}),this.w(r.actual.uri)}z(e,t,i){const s=new Set(t.map(r=>r.id));for(const r of e)s.delete(r.id)||this.C(r);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(r=>ap(this.q.controllerId,r.id))}}}),s.forEach(this.F,this)}C(e){const t=this.j.get(e.id);t?t.refCount++:(this.j.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:ap(this.q.controllerId,e.id)}}))}F(e){const t=this.j.get(e);t&&!--t.refCount&&(this.j.delete(e),this.pushDiff({op:7,id:ap(this.q.controllerId,e)}))}G(e,t){this.q.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}H(e,t,i){this.G(e,i);const s=this.q.getApiFor(e);s.parent=i?.actual,s.listener=r=>this.s(t,r),this.J(t)}I(e,t,i){this.H(e,t,i);for(const[s,r]of this.q.getChildren(e))this.y(r,t)}J(e){let t;this.h?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.M(e))}L(e,t){if(t<0)return;const i=[];for(const[s,r]of this.q.getChildren(e.actual)){const n=this.expand(Ve.joinToString(e.fullId,r.id),t);Hn(n)&&i.push(n)}if(i.length)return Promise.all(i).then(()=>{})}M(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this.h){const r=new ps;return r.open(),r}e.expand=2,this.N(e);const t=e.resolveBarrier=new ps,i=r=>{console.error(`Unhandled error in resolveHandler of test controller "${this.q.controllerId}"`,r)};let s;try{s=this.h(e.actual===this.root?void 0:e.actual)}catch(r){i(r)}return Hn(s)?s.catch(i).then(()=>{t.open(),this.J(e)}):(t.open(),this.J(e)),e.resolveBarrier}N(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}O(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const s=i.pop();if(s){this.q.getApiFor(s.actual).listener=void 0;for(const r of s.actual.tags)this.F(r.id);this.tree.delete(s.fullId.toString());for(const[r,n]of this.q.getChildren(s.actual))i.push(this.tree.get(Ve.joinToString(s.fullId,n.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.g.fire(e)}},JW=class extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}},Ep=class extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}},ZW=class extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}},QW=(e,t,i)=>{let s=new Map;return{get size(){return s.size},forEach(r,n){for(const o of s.values())r.call(n,o,this)},[Symbol.iterator](){return s.entries()},replace(r){const n=new Map,o=new Set(s.keys()),a={op:5,ops:[]};for(const c of r){if(!(c instanceof i))throw new Ep(c.id);const l=t(c).controllerId;if(l!==e.controllerId)throw new ZW(c.id,l,e.controllerId);if(n.has(c.id))throw new JW(c.id);n.set(c.id,c),o.delete(c.id),a.ops.push({op:0,item:c})}for(const c of o.keys())a.ops.push({op:3,id:c});e.listener?.(a),s=n},add(r){if(!(r instanceof i))throw new Ep(r.id);s.set(r.id,r),e.listener?.({op:0,item:r})},delete(r){s.delete(r)&&e.listener?.({op:3,id:r})},get(r){return s.get(r)},toJSON(){return Array.from(s.values())}}},r7=new WeakMap,YW=(e,t)=>{const i={controllerId:t};return r7.set(e,i),i},xp=e=>{const t=r7.get(e);if(!t)throw new Ep(e?.id||"<unknown>");return t},XW=H("remoteAuthorityResolverService"),n7;(function(e){e[e.WebSocket=0]="WebSocket",e[e.Managed=1]="Managed"})(n7||(n7={}));var o7=class{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}},KW=class{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}},zi;(function(e){e.Unknown="Unknown",e.NotAvailable="NotAvailable",e.TemporarilyNotAvailable="TemporarilyNotAvailable",e.NoResolverFound="NoResolverFound",e.InvalidAuthority="InvalidAuthority"})(zi||(zi={}));var Ow=class Ya extends _s{static isNotAvailable(t){return t instanceof Ya&&t._code===zi.NotAvailable}static isTemporarilyNotAvailable(t){return t instanceof Ya&&t._code===zi.TemporarilyNotAvailable}static isNoResolverFound(t){return t instanceof Ya&&t._code===zi.NoResolverFound}static isInvalidAuthority(t){return t instanceof Ya&&t._code===zi.InvalidAuthority}static isHandled(t){return t instanceof Ya&&t.isHandled}constructor(t,i=zi.Unknown,s){super(t),this._message=t,this._code=i,this._detail=s,this.isHandled=i===zi.NotAvailable&&s===!0,Object.setPrototypeOf(this,Ya.prototype)}};function a7(e){const t=e.indexOf("+");return t===-1?e:e.substring(0,t)}function le(e){return Object.assign(e,{apply:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const s=i.length===1?[]:i[1];return Reflect.construct(e,s,i[0].constructor)}},call:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const[s,...r]=i;return Reflect.construct(e,r,s.constructor)}}})}var Fw,Hi=Fw=class{#e;static isMarkdownString(t){return t instanceof Fw?!0:!t||typeof t!="object"?!1:t.appendCodeblock&&t.appendMarkdown&&t.appendText&&t.value!==void 0}constructor(t,i=!1){this.#e=new Qn(t,{supportThemeIcons:i})}get value(){return this.#e.value}set value(t){this.#e.value=t}get isTrusted(){return this.#e.isTrusted}set isTrusted(t){this.#e.isTrusted=t}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(t){this.#e.supportThemeIcons=t}get supportHtml(){return this.#e.supportHtml}set supportHtml(t){this.#e.supportHtml=t}get supportAlertSyntax(){return this.#e.supportAlertSyntax}set supportAlertSyntax(t){this.#e.supportAlertSyntax=t}get baseUri(){return this.#e.baseUri}set baseUri(t){this.#e.baseUri=t}appendText(t){return this.#e.appendText(t),this}appendMarkdown(t){return this.#e.appendMarkdown(t),this}appendCodeblock(t,i){return this.#e.appendCodeblock(i??"",t),this}};Hi=Fw=__decorate([le],Hi);var da,Pe=da=class{static Min(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let s=1;s<t.length;s++){const r=t[s];r.isBefore(i)&&(i=r)}return i}static Max(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let s=1;s<t.length;s++){const r=t[s];r.isAfter(i)&&(i=r)}return i}static isPosition(t){if(!t)return!1;if(t instanceof da)return!0;const{line:i,character:s}=t;return typeof i=="number"&&typeof s=="number"}static of(t){if(t instanceof da)return t;if(this.isPosition(t))return new da(t.line,t.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this.a}get character(){return this.b}constructor(t,i){if(t<0)throw $e("line must be non-negative");if(i<0)throw $e("character must be non-negative");this.a=t,this.b=i}isBefore(t){return this.a<t.a?!0:t.a<this.a?!1:this.b<t.b}isBeforeOrEqual(t){return this.a<t.a?!0:t.a<this.a?!1:this.b<=t.b}isAfter(t){return!this.isBeforeOrEqual(t)}isAfterOrEqual(t){return!this.isBefore(t)}isEqual(t){return this.a===t.a&&this.b===t.b}compareTo(t){return this.a<t.a?-1:this.a>t.line?1:this.b<t.b?-1:this.b>t.b?1:0}translate(t,i=0){if(t===null||i===null)throw $e();let s;return typeof t>"u"?s=0:typeof t=="number"?s=t:(s=typeof t.lineDelta=="number"?t.lineDelta:0,i=typeof t.characterDelta=="number"?t.characterDelta:0),s===0&&i===0?this:new da(this.line+s,this.character+i)}with(t,i=this.character){if(t===null||i===null)throw $e();let s;return typeof t>"u"?s=this.line:typeof t=="number"?s=t:(s=typeof t.line=="number"?t.line:this.line,i=typeof t.character=="number"?t.character:this.character),s===this.line&&i===this.character?this:new da(s,i)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};Pe=da=__decorate([le],Pe);var cn,xe=cn=class{static isRange(t){return t instanceof cn?!0:!t||typeof t!="object"?!1:Pe.isPosition(t.start)&&Pe.isPosition(t.end)}static of(t){if(t instanceof cn)return t;if(this.isRange(t))return new cn(t.start,t.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this.a}get end(){return this.b}constructor(t,i,s,r){let n,o;if(typeof t=="number"&&typeof i=="number"&&typeof s=="number"&&typeof r=="number"?(n=new Pe(t,i),o=new Pe(s,r)):Pe.isPosition(t)&&Pe.isPosition(i)&&(n=Pe.of(t),o=Pe.of(i)),!n||!o)throw new Error("Invalid arguments");n.isBefore(o)?(this.a=n,this.b=o):(this.a=o,this.b=n)}contains(t){return cn.isRange(t)?this.contains(t.start)&&this.contains(t.end):Pe.isPosition(t)?!(Pe.of(t).isBefore(this.a)||this.b.isBefore(t)):!1}isEqual(t){return this.a.isEqual(t.a)&&this.b.isEqual(t.b)}intersection(t){const i=Pe.Max(t.start,this.a),s=Pe.Min(t.end,this.b);if(!i.isAfter(s))return new cn(i,s)}union(t){if(this.contains(t))return this;if(t.contains(this))return t;const i=Pe.Min(t.start,this.a),s=Pe.Max(t.end,this.end);return new cn(i,s)}get isEmpty(){return this.a.isEqual(this.b)}get isSingleLine(){return this.a.line===this.b.line}with(t,i=this.end){if(t===null||i===null)throw $e();let s;return t?Pe.isPosition(t)?s=t:(s=t.start||this.start,i=t.end||this.end):s=this.start,s.isEqual(this.a)&&i.isEqual(this.end)?this:new cn(s,i)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return c7(this)}};xe=cn=__decorate([le],xe);function c7(e){return e.isEmpty?`[${e.start.line}:${e.start.character})`:`[${e.start.line}:${e.start.character} -> ${e.end.line}:${e.end.character})`}var Ju,xt=class{static{Ju=this}static{this.a="."}constructor(t){this.value=t}append(t){return new Ju(this.value?this.value+Ju.a+t:t)}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+Ju.a)}};xt=Ju=__decorate([le],xt),xt.Empty=new xt(""),xt.QuickFix=xt.Empty.append("quickfix"),xt.Refactor=xt.Empty.append("refactor"),xt.RefactorExtract=xt.Refactor.append("extract"),xt.RefactorInline=xt.Refactor.append("inline"),xt.RefactorMove=xt.Refactor.append("move"),xt.RefactorRewrite=xt.Refactor.append("rewrite"),xt.Source=xt.Empty.append("source"),xt.SourceOrganizeImports=xt.Source.append("organizeImports"),xt.SourceFixAll=xt.Source.append("fixAll"),xt.Notebook=xt.Empty.append("notebook");var fa;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(fa||(fa={}));var mi;(function(e){e[e.Hint=3]="Hint",e[e.Information=2]="Information",e[e.Warning=1]="Warning",e[e.Error=0]="Error"})(mi||(mi={}));var Zu=class{static is(t){return t?typeof t.message=="string"&&t.location&&xe.isRange(t.location.range)&&y.isUri(t.location.uri):!1}constructor(t,i){this.location=t,this.message=i}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.location.range.isEqual(i.location.range)&&t.location.uri.toString()===i.location.uri.toString()}};Zu=__decorate([le],Zu);var Cp=class{constructor(t,i,s=mi.Error){if(!xe.isRange(t))throw new TypeError("range must be set");if(!i)throw new TypeError("message must be set");this.range=t,this.message=i,this.severity=s}toJSON(){return{severity:mi[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.severity===i.severity&&t.code===i.code&&t.severity===i.severity&&t.source===i.source&&t.range.isEqual(i.range)&&Ci(t.tags,i.tags)&&Ci(t.relatedInformation,i.relatedInformation,Zu.isEqual)}};Cp=__decorate([le],Cp);var Uw,rs=Uw=class{static isLocation(t){return t instanceof Uw?!0:t?xe.isRange(t.range)&&y.isUri(t.uri):!1}constructor(t,i){if(this.uri=t,i)if(xe.isRange(i))this.range=xe.of(i);else if(Pe.isPosition(i))this.range=new xe(i,i);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};rs=Uw=__decorate([le],rs);var co,pa;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(pa||(pa={}));var Ir=class T5{static isNotebookRange(t){return t instanceof T5?!0:t?typeof t.start=="number"&&typeof t.end=="number":!1}get start(){return this.a}get end(){return this.b}get isEmpty(){return this.a===this.b}constructor(t,i){if(t<0)throw $e("start must be positive");if(i<0)throw $e("end must be positive");t<=i?(this.a=t,this.b=i):(this.a=i,this.b=t)}with(t){let i=this.a,s=this.b;return t.start!==void 0&&(i=t.start),t.end!==void 0&&(s=t.end),i===this.a&&s===this.b?this:new T5(i,s)}},kp=class N5{static validate(t){if(typeof t.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof t.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof t.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(t){return Array.isArray(t)&&t.every(i=>N5.isNotebookCellData(i))}static isNotebookCellData(t){return!0}constructor(t,i,s,r,n,o,a){this.kind=t,this.value=i,this.languageId=s,this.mime=r,this.outputs=n??[],this.metadata=o,this.executionSummary=a,N5.validate(this)}},l7=class{constructor(e){this.cells=e}},$p=co=class{static isNotebookCellEdit(t){return t instanceof co?!0:t?Ir.isNotebookRange(t)&&Array.isArray(t.newCells):!1}static replaceCells(t,i){return new co(t,i)}static insertCells(t,i){return new co(new Ir(t,t),i)}static deleteCells(t){return new co(t,[])}static updateCellMetadata(t,i){const s=new co(new Ir(t,t),[]);return s.newCellMetadata=i,s}static updateNotebookMetadata(t){const i=new co(new Ir(0,0),[]);return i.newNotebookMetadata=t,i}constructor(t,i){this.range=t,this.newCells=i}};$p=co=__decorate([le],$p);var u7=class kn{static isNotebookCellOutputItem(t){return t instanceof kn?!0:t?typeof t.mime=="string"&&t.data instanceof Uint8Array:!1}static error(t){const i={name:t.name,message:t.message,stack:t.stack};return kn.json(i,"application/vnd.code.notebook.error")}static stdout(t){return kn.text(t,"application/vnd.code.notebook.stdout")}static stderr(t){return kn.text(t,"application/vnd.code.notebook.stderr")}static bytes(t,i="application/octet-stream"){return new kn(t,i)}static#e=new TextEncoder;static text(t,i=Qs.text){const s=kn.#e.encode(String(t));return new kn(s,i)}static json(t,i="text/x-json"){const s=JSON.stringify(t,void 0,"	");return kn.text(s,i)}constructor(t,i){this.data=t,this.mime=i;const s=r$(i,!0);if(!s)throw new Error(`INVALID mime type: ${i}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=s}},Ip=class M5{static isNotebookCellOutput(t){return t instanceof M5?!0:!t||typeof t!="object"?!1:typeof t.id=="string"&&Array.isArray(t.items)}static ensureUniqueMimeTypes(t,i=!1){const s=new Set,r=new Set;for(let n=0;n<t.length;n++){const o=t[n],a=r$(o.mime);if(!s.has(a)||n$(a)){s.add(a);continue}r.add(n),i&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return r.size===0?t:t.filter((n,o)=>!r.has(o))}constructor(t,i,s){this.items=M5.ensureUniqueMimeTypes(t,!0),typeof i=="string"?(this.id=i,this.metadata=s):(this.id=Nt(),this.metadata=i??s)}},jw,Dr=jw=class extends xe{static isSelection(t){return t instanceof jw?!0:!t||typeof t!="object"?!1:xe.isRange(t)&&Pe.isPosition(t.anchor)&&Pe.isPosition(t.active)&&typeof t.isReversed=="boolean"}get anchor(){return this.c}get active(){return this.d}constructor(t,i,s,r){let n,o;if(typeof t=="number"&&typeof i=="number"&&typeof s=="number"&&typeof r=="number"?(n=new Pe(t,i),o=new Pe(s,r)):Pe.isPosition(t)&&Pe.isPosition(i)&&(n=Pe.of(t),o=Pe.of(i)),!n||!o)throw new Error("Invalid arguments");super(n,o),this.c=n,this.d=o}get isReversed(){return this.c===this.b}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return eB(this)}};Dr=jw=__decorate([le],Dr);function eB(e){let t=c7(e);return e.isEmpty||(e.active.isEqual(e.start)?t=`|${t}`:t=`${t}|`),t}var ga,ma=ga=class{static isSnippetString(t){return t instanceof ga?!0:!t||typeof t!="object"?!1:typeof t.value=="string"}static a(t){return t.replace(/\$|}|\\/g,"\\$&")}constructor(t){this.b=1,this.value=t||""}appendText(t){return this.value+=ga.a(t),this}appendTabstop(t=this.b++){return this.value+="$",this.value+=t,this}appendPlaceholder(t,i=this.b++){if(typeof t=="function"){const s=new ga;s.b=this.b,t(s),this.b=s.b,t=s.value}else t=ga.a(t);return this.value+="${",this.value+=i,this.value+=":",this.value+=t,this.value+="}",this}appendChoice(t,i=this.b++){const s=t.map(r=>r.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=i,this.value+="|",this.value+=s,this.value+="|}",this}appendVariable(t,i){if(typeof i=="function"){const s=new ga;s.b=this.b,i(s),this.b=s.b,i=s.value}else typeof i=="string"&&(i=i.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=t,i&&(this.value+=":",this.value+=i),this.value+="}",this}};ma=ga=__decorate([le],ma);var zw=class rv{static isSnippetTextEdit(t){return t instanceof rv?!0:t?xe.isRange(t.range)&&ma.isSnippetString(t.snippet):!1}static replace(t,i){return new rv(t,i)}static insert(t,i){return rv.replace(new xe(t,t),i)}constructor(t,i){this.range=t,this.snippet=i}},Hw,ut;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(ut||(ut={}));var Qu;(function(e){e[e.Deprecated=1]="Deprecated"})(Qu||(Qu={}));var Yu=Hw=class{static validate(t){if(!t.name)throw new Error("name must not be falsy")}constructor(t,i,s,r,n){this.name=t,this.kind=i,this.containerName=n,typeof s=="string"&&(this.containerName=s),r instanceof rs?this.location=r:s instanceof xe&&(this.location=new rs(r,s)),Hw.validate(this)}toJSON(){return{name:this.name,kind:ut[this.kind],location:this.location,containerName:this.containerName}}};Yu=Hw=__decorate([le],Yu);var va,sr;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(sr||(sr={}));var lo=va=class{static isTextEdit(t){return t instanceof va?!0:!t||typeof t!="object"?!1:xe.isRange(t)&&typeof t.newText=="string"}static replace(t,i){return new va(t,i)}static insert(t,i){return va.replace(new xe(t,t),i)}static delete(t){return va.replace(t,"")}static setEndOfLine(t){const i=new va(new xe(new Pe(0,0),new Pe(0,0)),"");return i.newEol=t,i}get range(){return this.a}set range(t){if(t&&!xe.isRange(t))throw $e("range");this.a=t}get newText(){return this.b||""}set newText(t){if(t&&typeof t!="string")throw $e("newText");this.b=t}get newEol(){return this.c}set newEol(t){if(t&&typeof t!="number")throw $e("newEol");this.c=t}constructor(t,i){this.a=t,this.b=i}toJSON(){return{range:this.range,newText:this.newText,newEol:this.c}}};lo=va=__decorate([le],lo);var h7;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.Cell=3]="Cell",e[e.CellReplace=5]="CellReplace",e[e.Snippet=6]="Snippet"})(h7||(h7={}));var wa=class{constructor(){this.a=[]}_allEntries(){return this.a}renameFile(t,i,s,r){this.a.push({_type:1,from:t,to:i,options:s,metadata:r})}createFile(t,i,s){this.a.push({_type:1,from:void 0,to:t,options:i,metadata:s})}deleteFile(t,i,s){this.a.push({_type:1,from:t,to:void 0,options:i,metadata:s})}b(t,i,s){this.a.push({_type:3,metadata:s,uri:t,edit:{editType:5,metadata:i}})}c(t,i,s,r){const n=i.start,o=i.end;(n!==o||s.length>0)&&this.a.push({_type:5,uri:t,index:n,count:o-n,cells:s,metadata:r})}d(t,i,s,r){this.a.push({_type:3,metadata:r,uri:t,edit:{editType:3,index:i,metadata:s}})}replace(t,i,s,r){this.a.push({_type:2,uri:t,edit:new lo(i,s),metadata:r})}insert(t,i,s,r){this.replace(t,new xe(i,i),s,r)}delete(t,i,s){this.replace(t,i,"",s)}has(t){return this.a.some(i=>i._type===2&&i.uri.toString()===t.toString())}set(t,i){if(i)for(const s of i){if(!s)continue;let r,n;Array.isArray(s)?(r=s[0],n=s[1]):r=s,$p.isNotebookCellEdit(r)?r.newCellMetadata?this.d(t,r.range.start,r.newCellMetadata,n):r.newNotebookMetadata?this.b(t,r.newNotebookMetadata,n):this.c(t,r.range,r.newCells,n):zw.isSnippetTextEdit(r)?this.a.push({_type:6,uri:t,range:r.range,edit:r.snippet,metadata:n,keepWhitespace:r.keepWhitespace}):this.a.push({_type:2,uri:t,edit:r,metadata:n})}else{for(let s=0;s<this.a.length;s++){const r=this.a[s];switch(r._type){case 2:case 6:case 3:case 5:r.uri.toString()===t.toString()&&(this.a[s]=void 0);break}}iR(this.a)}}get(t){const i=[];for(const s of this.a)s._type===2&&s.uri.toString()===t.toString()&&i.push(s.edit);return i}entries(){const t=new kt;for(const i of this.a)if(i._type===2){let s=t.get(i.uri);s||(s=[i.uri,[]],t.set(i.uri,s)),s[1].push(i.edit)}return[...t.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};wa=__decorate([le],wa);var Ww,Dp,Pr,Tr,Bw,Wi,_w,Vw;(function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"})(Vw||(Vw={}));var d7;(function(e){e[e.TerminalCommand=0]="TerminalCommand",e[e.Opener=1]="Opener",e[e.Command=3]="Command"})(d7||(d7={}));var Ce=Ww=class{static from(...t){let i=t;return new Ww(function(){if(i){for(const s of i)s&&typeof s.dispose=="function"&&s.dispose();i=void 0}})}#e;constructor(t){this.#e=t}dispose(){typeof this.#e=="function"&&(this.#e(),this.#e=void 0)}};Ce=Ww=__decorate([le],Ce);var f7=e=>{if(typeof e!="string"||e.length===0||!/^[0-9A-Za-z_\-]+$/.test(e))throw $e("connectionToken")},tB=class{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw $e("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw $e("port");typeof i<"u"&&f7(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}},Pp=class{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&f7(t)}},Mc=class nv extends Error{static NotAvailable(t,i){return new nv(t,zi.NotAvailable,i)}static TemporarilyNotAvailable(t){return new nv(t,zi.TemporarilyNotAvailable)}constructor(t,i=zi.Unknown,s){super(t),this._message=t,this._code=i,this._detail=s,Object.setPrototypeOf(this,nv.prototype)}},Lc;(function(e){e[e.Replace=1]="Replace",e[e.Append=2]="Append",e[e.Prepend=3]="Prepend"})(Lc||(Lc={}));var Tp=class{constructor(t,i){if(!t)throw new Error("Illegal argument, contents must be defined");Array.isArray(t)?this.contents=t:this.contents=[t],this.range=i}};Tp=__decorate([le],Tp);var Np=class extends Tp{constructor(t,i,s,r){super(t,i),this.canIncreaseVerbosity=s,this.canDecreaseVerbosity=r}};Np=__decorate([le],Np);var qw;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(qw||(qw={}));var Xu;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(Xu||(Xu={}));var Mp=class{constructor(t,i=Xu.Text){this.range=t,this.kind=i}toJSON(){return{range:this.range,kind:Xu[this.kind]}}};Mp=__decorate([le],Mp);var Lp=class{constructor(t,i){this.uri=t,this.highlights=i}toJSON(){return{uri:this.uri,highlights:this.highlights.map(t=>t.toJSON())}}};Lp=__decorate([le],Lp);var Ku=Dp=class{static validate(t){if(!t.name)throw new Error("name must not be falsy");if(!t.range.contains(t.selectionRange))throw new Error("selectionRange must be contained in fullRange");t.children?.forEach(Dp.validate)}constructor(t,i,s,r,n){this.name=t,this.detail=i,this.kind=s,this.range=r,this.selectionRange=n,this.children=[],Dp.validate(this)}};Ku=Dp=__decorate([le],Ku);var eh;(function(e){e[e.Invoke=1]="Invoke",e[e.Automatic=2]="Automatic"})(eh||(eh={}));var th=class{constructor(t,i){this.title=t,this.kind=i}};th=__decorate([le],th);var ih=class{constructor(t,i){if(this.range=t,this.parent=i,i&&!i.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};ih=__decorate([le],ih);var Gw=class{constructor(e,t,i,s,r,n){this.kind=e,this.name=t,this.detail=i,this.uri=s,this.range=r,this.selectionRange=n}},p7=class{constructor(e,t){this.fromRanges=t,this.from=e}},g7=class{constructor(e,t){this.fromRanges=t,this.to=e}},Rc;(function(e){e[e.Information=0]="Information",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(Rc||(Rc={}));var Rp=class{constructor(t,i){this.range=t,this.command=i}get isResolved(){return!!this.command}};Rp=__decorate([le],Rp);var Jw=class{constructor(t,i){this.label=t,this.documentation=i}};Jw=__decorate([le],Jw);var Zw=class{constructor(t,i){this.label=t,this.documentation=i,this.parameters=[]}};Zw=__decorate([le],Zw);var Qw=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};Qw=__decorate([le],Qw);var Yw;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(Yw||(Yw={}));var Xw;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(Xw||(Xw={}));var Op=class{constructor(t){this.value=t}};Op=__decorate([le],Op);var Fp=class{constructor(t,i,s){this.position=t,this.label=i,this.kind=s}};Fp=__decorate([le],Fp);var Oc;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Oc||(Oc={}));var me;(function(e){e[e.Text=0]="Text",e[e.Method=1]="Method",e[e.Function=2]="Function",e[e.Constructor=3]="Constructor",e[e.Field=4]="Field",e[e.Variable=5]="Variable",e[e.Class=6]="Class",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Unit=10]="Unit",e[e.Value=11]="Value",e[e.Enum=12]="Enum",e[e.Keyword=13]="Keyword",e[e.Snippet=14]="Snippet",e[e.Color=15]="Color",e[e.File=16]="File",e[e.Reference=17]="Reference",e[e.Folder=18]="Folder",e[e.EnumMember=19]="EnumMember",e[e.Constant=20]="Constant",e[e.Struct=21]="Struct",e[e.Event=22]="Event",e[e.Operator=23]="Operator",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue"})(me||(me={}));var sh;(function(e){e[e.Deprecated=1]="Deprecated"})(sh||(sh={}));var Up=class{constructor(t,i){this.label=t,this.kind=i}toJSON(){return{label:this.label,kind:this.kind&&me[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Up=__decorate([le],Up);var Fc=class{constructor(t=[],i=!1){this.items=t,this.isIncomplete=i}};Fc=__decorate([le],Fc);var Kw=class{constructor(t,i,s){this.insertText=t,this.range=i,this.command=s}};Kw=__decorate([le],Kw);var eb=class{constructor(t){this.commands=void 0,this.suppressSuggestions=void 0,this.items=t}};eb=__decorate([le],eb);var ba;(function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Line=2]="Line",e[e.Suggest=3]="Suggest"})(ba||(ba={}));var Uc;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(Uc||(Uc={}));var jc;(function(e){e[e.Code=1]="Code",e[e.Label=2]="Label"})(jc||(jc={}));var rh;(function(e){e[e.Active=-1]="Active",e[e.Beside=-2]="Beside",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven",e[e.Eight=8]="Eight",e[e.Nine=9]="Nine"})(rh||(rh={}));var uo;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(uo||(uo={}));function iB(e,t){return`${Ye.toKey(e)}.${t}`}var rr;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval"})(rr||(rr={}));var zc;(function(e){e[e.Manual=1]="Manual",e[e.AfterDelay=2]="AfterDelay",e[e.FocusOut=3]="FocusOut"})(zc||(zc={}));var jp;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(jp||(jp={}));var Hc;(function(e){e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Command=3]="Command"})(Hc||(Hc={}));var Wc;(function(e){e[e.Addition=1]="Addition",e[e.Deletion=2]="Deletion",e[e.Modification=3]="Modification"})(Wc||(Wc={}));var nh;(function(e){e[e.Undo=1]="Undo",e[e.Redo=2]="Redo"})(nh||(nh={}));var ya;(function(e){e[e.OpenOpen=0]="OpenOpen",e[e.ClosedClosed=1]="ClosedClosed",e[e.OpenClosed=2]="OpenClosed",e[e.ClosedOpen=3]="ClosedOpen"})(ya||(ya={})),function(e){function t(i){switch(i){case"keyboard":return e.Keyboard;case"mouse":return e.Mouse;case"api":case"code.jump":case"code.navigation":return e.Command}}e.fromValue=t}(Hc||(Hc={}));var Bc;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(Bc||(Bc={})),function(e){function t(i){switch(i){case e.Other:return"other";case e.Comment:return"comment";case e.String:return"string";case e.RegEx:return"regex"}return"other"}e.toString=t}(Bc||(Bc={}));var zp=class{constructor(t,i){if(i&&!y.isUri(i))throw $e("target");if(!xe.isRange(t)||t.isEmpty)throw $e("range");this.range=t,this.target=i}};zp=__decorate([le],zp);var _c=class{constructor(t,i,s,r){this.red=t,this.green=i,this.blue=s,this.alpha=r}};_c=__decorate([le],_c);var Hp=class{constructor(t,i){if(i&&!(i instanceof _c))throw $e("color");if(!xe.isRange(t)||t.isEmpty)throw $e("range");this.range=t,this.color=i}};Hp=__decorate([le],Hp);var Wp=class{constructor(t){if(!t||typeof t!="string")throw $e("label");this.label=t}};Wp=__decorate([le],Wp);var m7;(function(e){e[e.RGB=0]="RGB",e[e.HEX=1]="HEX",e[e.HSL=2]="HSL"})(m7||(m7={}));var Vc;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information"})(Vc||(Vc={}));var tb;(function(e){e[e.Unknown=0]="Unknown",e[e.Shutdown=1]="Shutdown",e[e.Process=2]="Process",e[e.User=3]="User",e[e.Extension=4]="Extension"})(tb||(tb={}));var oh;(function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"})(oh||(oh={}));var ib;(function(e){e[e.Sh=1]="Sh",e[e.Bash=2]="Bash",e[e.Fish=3]="Fish",e[e.Csh=4]="Csh",e[e.Ksh=5]="Ksh",e[e.Zsh=6]="Zsh",e[e.CommandPrompt=7]="CommandPrompt",e[e.GitBash=8]="GitBash",e[e.PowerShell=9]="PowerShell",e[e.Python=10]="Python",e[e.Julia=11]="Julia",e[e.NuShell=12]="NuShell",e[e.Node=13]="Node"})(ib||(ib={}));var sB=class{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw $e("startIndex");if(typeof t!="number"||t<1)throw $e("length");if(i!==void 0&&typeof i!="string")throw $e("tooltip")}},rB=class{constructor(e){this.uri=e}},nB=class{constructor(e){this.terminalCommand=e}},sb;(function(e){e[e.Panel=1]="Panel",e[e.Editor=2]="Editor"})(sb||(sb={}));var oB=class{constructor(e){if(this.options=e,typeof e!="object")throw $e("options")}},rb;(function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Method=2]="Method",e[e.Alias=3]="Alias",e[e.Argument=4]="Argument",e[e.Option=5]="Option",e[e.OptionValue=6]="OptionValue",e[e.Flag=7]="Flag",e[e.SymbolicLinkFile=8]="SymbolicLinkFile",e[e.SymbolicLinkFolder=9]="SymbolicLinkFolder",e[e.ScmCommit=10]="ScmCommit",e[e.ScmBranch=11]="ScmBranch",e[e.ScmTag=12]="ScmTag",e[e.ScmStash=13]="ScmStash",e[e.ScmRemote=14]="ScmRemote",e[e.PullRequest=15]="PullRequest",e[e.PullRequestDone=16]="PullRequestDone"})(rb||(rb={}));var aB=class{constructor(e,t,i,s,r,n,o,a){this.label=e,this.replacementRange=t,this.kind=i,this.detail=s,this.documentation=r,this.isFile=n,this.isDirectory=o,this.isKeyword=a}},cB=class{constructor(e,t){this.items=e??[],this.resourceOptions=t}},nb;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(nb||(nb={}));var ob;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(ob||(ob={}));var ab;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(ab||(ab={}));var ah=class{static{Pr=this}static{this.Clean=new Pr("clean","Clean")}static{this.Build=new Pr("build","Build")}static{this.Rebuild=new Pr("rebuild","Rebuild")}static{this.Test=new Pr("test","Test")}static from(t){switch(t){case"clean":return Pr.Clean;case"build":return Pr.Build;case"rebuild":return Pr.Rebuild;case"test":return Pr.Test;default:return}}constructor(t,i){if(this.label=i,typeof t!="string"||typeof i!="string")throw $e("name");this.c=t}get id(){return this.c}};ah=Pr=__decorate([le],ah);function v7(e){let t="";for(let i=0;i<e.length;i++)t+=e[i].replace(/,/g,",,")+",";return t}var qc=class{constructor(t,i,s){if(typeof t!="string")throw $e("process");this.e=[],this.c=t,i!==void 0&&(Array.isArray(i)?(this.e=i,this.f=s):this.f=i)}get process(){return this.c}set process(t){if(typeof t!="string")throw $e("process");this.c=t}get args(){return this.e}set args(t){Array.isArray(t)||(t=[]),this.e=t}get options(){return this.f}set options(t){this.f=t}computeId(){const t=[];if(t.push("process"),this.c!==void 0&&t.push(this.c),this.e&&this.e.length>0)for(const i of this.e)t.push(i);return v7(t)}};qc=__decorate([le],qc);var Aa=class{constructor(t,i,s){if(this.f=[],Array.isArray(i)){if(!t)throw $e("command can't be undefined or null");if(typeof t!="string"&&typeof t.value!="string")throw $e("command");this.e=t,i&&(this.f=i),this.g=s}else{if(typeof t!="string")throw $e("commandLine");this.c=t,this.g=i}}get commandLine(){return this.c}set commandLine(t){if(typeof t!="string")throw $e("commandLine");this.c=t}get command(){return this.e?this.e:""}set command(t){if(typeof t!="string"&&typeof t.value!="string")throw $e("command");this.e=t}get args(){return this.f}set args(t){this.f=t||[]}get options(){return this.g}set options(t){this.g=t}computeId(){const t=[];if(t.push("shell"),this.c!==void 0&&t.push(this.c),this.e!==void 0&&t.push(typeof this.e=="string"?this.e:this.e.value),this.f&&this.f.length>0)for(const i of this.f)t.push(typeof i=="string"?i:i.value);return v7(t)}};Aa=__decorate([le],Aa);var cb;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(cb||(cb={}));var ho;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace"})(ho||(ho={}));var lb=class{constructor(e){this.c=e}computeId(){return"customExecution"+Nt()}set callback(e){this.c=e}get callback(){return this.c}},Bp=class{static{Tr=this}static{this.c="customExecution"}static{this.e="process"}static{this.f="shell"}static{this.g="$empty"}constructor(t,i,s,r,n,o){this.k=!1,this.l=this.definition=t;let a;typeof i=="string"?(this.o=this.name=i,this.u=this.source=s,this.execution=r,a=n,this.k=!0):i===ho.Global||i===ho.Workspace?(this.target=i,this.o=this.name=s,this.u=this.source=r,this.execution=n,a=o):(this.target=i,this.o=this.name=s,this.u=this.source=r,this.execution=n,a=o),typeof a=="string"?(this.q=[a],this.r=!0):Array.isArray(a)?(this.q=a,this.r=!0):(this.q=[],this.r=!1),this.t=!1,this.x=Object.create(null),this.y=Object.create(null)}get _id(){return this.j}set _id(t){this.j=t}get _deprecated(){return this.k}A(){this.j!==void 0&&(this.j=void 0,this.m=void 0,this.B())}B(){this.p instanceof qc?this.l={type:Tr.e,id:this.p.computeId()}:this.p instanceof Aa?this.l={type:Tr.f,id:this.p.computeId()}:this.p instanceof lb?this.l={type:Tr.c,id:this.p.computeId()}:this.l={type:Tr.g,id:Nt()}}get definition(){return this.l}set definition(t){if(t==null)throw $e("Kind can't be undefined or null");this.A(),this.l=t}get scope(){return this.m}set target(t){this.A(),this.m=t}get name(){return this.o}set name(t){if(typeof t!="string")throw $e("name");this.A(),this.o=t}get execution(){return this.p}set execution(t){t===null&&(t=void 0),this.A(),this.p=t;const i=this.l.type;(Tr.g===i||Tr.e===i||Tr.f===i||Tr.c===i)&&this.B()}get problemMatchers(){return this.q}set problemMatchers(t){if(Array.isArray(t))this.A(),this.q=t,this.r=!0;else{this.A(),this.q=[],this.r=!1;return}}get hasDefinedMatchers(){return this.r}get isBackground(){return this.t}set isBackground(t){t!==!0&&t!==!1&&(t=!1),this.A(),this.t=t}get source(){return this.u}set source(t){if(typeof t!="string"||t.length===0)throw $e("source must be a string of length > 0");this.A(),this.u=t}get group(){return this.w}set group(t){t===null&&(t=void 0),this.A(),this.w=t}get detail(){return this.z}set detail(t){t===null&&(t=void 0),this.z=t}get presentationOptions(){return this.x}set presentationOptions(t){t==null&&(t=Object.create(null)),this.A(),this.x=t}get runOptions(){return this.y}set runOptions(t){t==null&&(t=Object.create(null)),this.A(),this.y=t}};Bp=Tr=__decorate([le],Bp);var fo;(function(e){e[e.SourceControl=1]="SourceControl",e[e.Window=10]="Window",e[e.Notification=15]="Notification"})(fo||(fo={}));var ub;(function(e){function t(i){const s=i;return Cs(s.value)?s.tooltip&&!Oe(s.tooltip)?(console.log("INVALID view badge, invalid tooltip",s.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",s.value),!1)}e.isViewBadge=t})(ub||(ub={}));var _p=Bw=class{static isTreeItem(t,i){const s=t;if(s.checkboxState!==void 0){const r=Cs(s.checkboxState)?s.checkboxState:At(s.checkboxState)&&Cs(s.checkboxState.state)?s.checkboxState.state:void 0,n=!Cs(s.checkboxState)&&At(s.checkboxState)?s.checkboxState.tooltip:void 0;if(r===void 0||r!==Nr.Checked&&r!==Nr.Unchecked||n!==void 0&&!Oe(n))return console.log("INVALID tree item, invalid checkboxState",s.checkboxState),!1}if(t instanceof Bw)return!0;if(s.label!==void 0&&!Oe(s.label)&&!s.label?.label)return console.log("INVALID tree item, invalid label",s.label),!1;if(s.id!==void 0&&!Oe(s.id))return console.log("INVALID tree item, invalid id",s.id),!1;if(s.iconPath!==void 0&&!Oe(s.iconPath)&&!y.isUri(s.iconPath)&&(!s.iconPath||!Oe(s.iconPath.id))){const r=s.iconPath;if(!r||!Oe(r.light)&&!y.isUri(r.light)&&!Oe(r.dark)&&!y.isUri(r.dark))return console.log("INVALID tree item, invalid iconPath",s.iconPath),!1}return s.description!==void 0&&!Oe(s.description)&&typeof s.description!="boolean"?(console.log("INVALID tree item, invalid description",s.description),!1):s.resourceUri!==void 0&&!y.isUri(s.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",s.resourceUri),!1):s.tooltip!==void 0&&!Oe(s.tooltip)&&!(s.tooltip instanceof Hi)?(console.log("INVALID tree item, invalid tooltip",s.tooltip),!1):s.command!==void 0&&!s.command.command?(console.log("INVALID tree item, invalid command",s.command),!1):s.collapsibleState!==void 0&&s.collapsibleState<Sa.None&&s.collapsibleState>Sa.Expanded?(console.log("INVALID tree item, invalid collapsibleState",s.collapsibleState),!1):s.contextValue!==void 0&&!Oe(s.contextValue)?(console.log("INVALID tree item, invalid contextValue",s.contextValue),!1):s.accessibilityInformation!==void 0&&!s.accessibilityInformation?.label?(console.log("INVALID tree item, invalid accessibilityInformation",s.accessibilityInformation),!1):!0}constructor(t,i=Sa.None){this.collapsibleState=i,y.isUri(t)?this.resourceUri=t:this.label=t}};_p=Bw=__decorate([le],_p);var Sa;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(Sa||(Sa={}));var Nr;(function(e){e[e.Unchecked=0]="Unchecked",e[e.Checked=1]="Checked"})(Nr||(Nr={}));var Vp=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(t){this.value=t}};Vp=__decorate([le],Vp);var qp=class extends Vp{},lB=class extends qp{#e;constructor(e){super(""),this.#e=e}asFile(){return this.#e}},uB=class{constructor(e,t,i,s){this.name=e,this.uri=t,this._itemId=i,this.c=s}data(){return this.c()}},Gc=class{#e=new Map;constructor(t){for(const[i,s]of t??[]){const r=this.#e.get(this.#t(i));r?r.push(s):this.#e.set(this.#t(i),[s])}}get(t){return this.#e.get(this.#t(t))?.[0]}set(t,i){this.#e.set(this.#t(t),[i])}forEach(t,i){for(const[s,r]of this.#e)for(const n of r)t.call(i,n,s,this)}*[Symbol.iterator](){for(const[t,i]of this.#e)for(const s of i)yield[t,s]}#t(t){return t.toLowerCase()}};Gc=__decorate([le],Gc);var hb=class{constructor(t,i,s){this.insertText=t,this.title=i,this.kind=s}};hb=__decorate([le],hb);var db;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(db||(db={}));var po=class ov{static{this.c="."}constructor(t){this.value=t}append(...t){return new ov((this.value?[this.value,...t]:t).join(ov.c))}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+ov.c)}};po.Empty=new po(""),po.Text=new po("text"),po.TextUpdateImports=po.Text.append("updateImports");var hB=class{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}},Ti=class{constructor(t,i){this.id=t,this.color=i}static isThemeIcon(t){return typeof t.id!="string"?(console.log("INVALID ThemeIcon, invalid id",t.id),!1):!0}};Ti=__decorate([le],Ti),Ti.File=new Ti("file"),Ti.Folder=new Ti("folder");var ch=class{constructor(t){this.id=t}};ch=__decorate([le],ch);var Jc;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.WorkspaceFolder=3]="WorkspaceFolder"})(Jc||(Jc={}));var Zc=class{get base(){return this.c}set base(t){this.c=t,this.e=y.file(t)}get baseUri(){return this.e}set baseUri(t){this.e=t,this.c=t.fsPath}constructor(t,i){if(typeof t!="string"&&(!t||!y.isUri(t)&&!y.isUri(t.uri)))throw $e("base");if(typeof i!="string")throw $e("pattern");typeof t=="string"?this.baseUri=y.file(t):y.isUri(t)?this.baseUri=t:this.baseUri=t.uri,this.pattern=i}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Zc=__decorate([le],Zc);var w7=new WeakMap;function dB(e,t){w7.set(e,t)}var Qc=class{constructor(t,i,s,r,n){this.enabled=typeof t=="boolean"?t:!0,typeof i=="string"&&(this.condition=i),typeof s=="string"&&(this.hitCondition=s),typeof r=="string"&&(this.logMessage=r),typeof n=="string"&&(this.mode=n)}get id(){return this.c||(this.c=w7.get(this)??Nt()),this.c}};Qc=__decorate([le],Qc);var Ea=class extends Qc{constructor(t,i,s,r,n,o){if(super(i,s,r,n,o),t===null)throw $e("location");this.location=t}};Ea=__decorate([le],Ea);var xa=class extends Qc{constructor(t,i,s,r,n,o){super(i,s,r,n,o),this.functionName=t}};xa=__decorate([le],xa);var Gp=class extends Qc{constructor(t,i,s,r,n,o,a,c){if(super(r,n,o,a,c),!i)throw $e("dataId");this.label=t,this.dataId=i,this.canPersist=s}};Gp=__decorate([le],Gp);var Yc=class{constructor(t,i,s){this.command=t,this.args=i||[],this.options=s}};Yc=__decorate([le],Yc);var Xc=class{constructor(t,i){this.port=t,this.host=i}};Xc=__decorate([le],Xc);var lh=class{constructor(t){this.path=t}};lh=__decorate([le],lh);var uh=class{constructor(t){this.implementation=t}};uh=__decorate([le],uh);var b7=class{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}},y7=class{constructor(e,t){this.session=e,this.threadId=t}},Jp=class{constructor(t,i){this.range=t,this.expression=i}};Jp=__decorate([le],Jp);var hh;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(hh||(hh={}));var ln;(function(e){e[e.Other=0]="Other",e[e.Empty=1]="Empty",e[e.TokenCancellation=2]="TokenCancellation",e[e.LostRace=3]="LostRace",e[e.NotTaken=4]="NotTaken"})(ln||(ln={}));var Zp=class{constructor(t,i){this.range=t,this.text=i}};Zp=__decorate([le],Zp);var Qp=class{constructor(t,i,s=!0){this.range=t,this.variableName=i,this.caseSensitiveLookup=s}};Qp=__decorate([le],Qp);var Yp=class{constructor(t,i){this.range=t,this.expression=i}};Yp=__decorate([le],Yp);var fb=class{constructor(t,i){this.frameId=t,this.stoppedLocation=i}};fb=__decorate([le],fb);var pb;(function(e){e[e.AIGenerated=1]="AIGenerated"})(pb||(pb={}));var dh;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(dh||(dh={}));var fB=class{constructor(e,t){this.newSymbolName=e,this.tags=t}},Kc;(function(e){e[e.Changed=1]="Changed",e[e.Created=2]="Created",e[e.Deleted=3]="Deleted"})(Kc||(Kc={}));var Xt=Wi=class extends Error{static FileExists(t){return new Wi(t,he.FileExists,Wi.FileExists)}static FileNotFound(t){return new Wi(t,he.FileNotFound,Wi.FileNotFound)}static FileNotADirectory(t){return new Wi(t,he.FileNotADirectory,Wi.FileNotADirectory)}static FileIsADirectory(t){return new Wi(t,he.FileIsADirectory,Wi.FileIsADirectory)}static NoPermissions(t){return new Wi(t,he.NoPermissions,Wi.NoPermissions)}static Unavailable(t){return new Wi(t,he.Unavailable,Wi.Unavailable)}constructor(t,i=he.Unknown,s){super(y.isUri(t)?t.toString(!0):t),this.code=s?.name??"Unknown",D$(this,i),Object.setPrototypeOf(this,Wi.prototype),typeof Error.captureStackTrace=="function"&&typeof s=="function"&&Error.captureStackTrace(this,s)}};Xt=Wi=__decorate([le],Xt);var gb=class{constructor(t,i,s){this.start=t,this.end=i,this.kind=s}};gb=__decorate([le],gb);var un;(function(e){e[e.Comment=1]="Comment",e[e.Imports=2]="Imports",e[e.Region=3]="Region"})(un||(un={}));var fh;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(fh||(fh={}));var mb;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(mb||(mb={}));var vb;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(vb||(vb={}));var ph;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(ph||(ph={}));var gh;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(gh||(gh={}));var mh;(function(e){e[e.Reply=1]="Reply",e[e.Comment=2]="Comment"})(mh||(mh={}));var wb=class{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}};function pB(e){return typeof e>"u"||dR(e)}var gB=class CM{constructor(t){if(this.c=0,this.e=0,this.f=!0,this.g=[],this.j=0,this.k=new Map,this.l=new Map,this.m=!1,t){this.m=!0;for(let i=0,s=t.tokenTypes.length;i<s;i++)this.k.set(t.tokenTypes[i],i);for(let i=0,s=t.tokenModifiers.length;i<s;i++)this.l.set(t.tokenModifiers[i],i)}}push(t,i,s,r,n){if(typeof t=="number"&&typeof i=="number"&&typeof s=="number"&&typeof r=="number"&&(typeof n=="number"||typeof n>"u"))return typeof n>"u"&&(n=0),this.p(t,i,s,r,n);if(xe.isRange(t)&&typeof i=="string"&&pB(s))return this.o(t,i,s);throw $e()}o(t,i,s){if(!this.m)throw new Error("Legend must be provided in constructor");if(t.start.line!==t.end.line)throw new Error("`range` cannot span multiple lines");if(!this.k.has(i))throw new Error("`tokenType` is not in the provided legend");const r=t.start.line,n=t.start.character,o=t.end.character-t.start.character,a=this.k.get(i);let c=0;if(s)for(const l of s){if(!this.l.has(l))throw new Error("`tokenModifier` is not in the provided legend");const u=this.l.get(l);c|=1<<u>>>0}this.p(r,n,o,a,c)}p(t,i,s,r,n){if(this.f&&(t<this.c||t===this.c&&i<this.e)){this.f=!1;const c=this.g.length/5|0;let l=0,u=0;for(let h=0;h<c;h++){let f=this.g[5*h],p=this.g[5*h+1];f===0?(f=l,p+=u):f+=l,this.g[5*h]=f,this.g[5*h+1]=p,l=f,u=p}}let o=t,a=i;this.f&&this.j>0&&(o-=this.c,o===0&&(a-=this.e)),this.g[this.j++]=o,this.g[this.j++]=a,this.g[this.j++]=s,this.g[this.j++]=r,this.g[this.j++]=n,this.c=t,this.e=i}static q(t){const i=[],s=t.length/5|0;for(let a=0;a<s;a++)i[a]=a;i.sort((a,c)=>{const l=t[5*a],u=t[5*c];if(l===u){const h=t[5*a+1],f=t[5*c+1];return h-f}return l-u});const r=new Uint32Array(t.length);let n=0,o=0;for(let a=0;a<s;a++){const c=5*i[a],l=t[c+0],u=t[c+1],h=t[c+2],f=t[c+3],p=t[c+4],g=l-n,v=g===0?u-o:u,b=5*a;r[b+0]=g,r[b+1]=v,r[b+2]=h,r[b+3]=f,r[b+4]=p,n=l,o=u}return r}build(t){return this.f?new el(new Uint32Array(this.g),t):new el(CM.q(this.g),t)}},el=class{constructor(e,t){this.resultId=t,this.data=e}},A7=class{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}},Xp=class{constructor(e,t){this.resultId=t,this.edits=e}},Kp;(function(e){e[e.Separate=0]="Separate",e[e.MergeWithParent=1]="MergeWithParent"})(Kp||(Kp={}));var mB=class{constructor(e){this.name=e}},bb;(function(e){e[e.Title=1]="Title",e[e.Inline=2]="Inline",e[e.Input=3]="Input"})(bb||(bb={}));var vh=class{static{this.Back={iconPath:new Ti("arrow-left")}}constructor(){}};vh=__decorate([le],vh);var wh;(function(e){e[e.Separator=-1]="Separator",e[e.Default=0]="Default"})(wh||(wh={}));var tl;(function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(tl||(tl={}));var Ca;(function(e){e[e.UI=1]="UI",e[e.Workspace=2]="Workspace"})(Ca||(Ca={}));var yb=class{static validate(e){if(typeof e.badge=="string"){let t=VE(e.badge,0);if(t<e.badge.length&&(t+=VE(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Ti.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}},eg=class{constructor(t){this.kind=t}};eg=__decorate([le],eg);var go;(function(e){e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.HighContrast=3]="HighContrast",e[e.HighContrastLight=4]="HighContrastLight"})(go||(go={}));var vB=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},Ab;(function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(Ab||(Ab={}));var tg;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(tg||(tg={}));var ig;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(ig||(ig={}));var wB=class{constructor(e,t){this.text=e,this.alignment=t}},Sb;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred"})(Sb||(Sb={}));var sg;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred",e[e.Hidden=-1]="Hidden"})(sg||(sg={}));var S7=class{constructor(e,t=[]){this.uri=e,this.provides=xs(t)}},bB=class{constructor(e){this.label=e}},bh;(function(e){e[e.Named=1]="Named",e[e.Indexed=2]="Indexed"})(bh||(bh={}));var Eb=class{constructor(t,i){this.label=t,this.timestamp=i}};Eb=__decorate([le],Eb);var il;(function(e){e[e.Production=1]="Production",e[e.Development=2]="Development",e[e.Test=3]="Test"})(il||(il={}));var rg;(function(e){e[e.Node=1]="Node",e[e.Webworker=2]="Webworker"})(rg||(rg={}));var mo;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(mo||(mo={}));var yB=class{constructor(e,t){this.ranges=e,this.wordPattern=t}},AB=class{constructor(e){this.c=e}get autoForwardAction(){return this.c}},xb;(function(e){e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(xb||(xb={}));var sl;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(sl||(sl={}));var E7=class{constructor(e,t,i){this.controllerId=e,this.profileId=t,this.kind=i}},ng=class{constructor(t=void 0,i=void 0,s=void 0,r=!1,n=!0){this.include=t,this.exclude=i,this.profile=s,this.continuous=r,this.preserveFocus=n}};ng=__decorate([le],ng);var og=_w=class{static diff(t,i,s){const r=new _w(t);return r.expectedOutput=i,r.actualOutput=s,r}constructor(t){this.message=t}};og=_w=__decorate([le],og);var yh=class{constructor(t){this.id=t}};yh=__decorate([le],yh);var SB=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},ag=class{constructor(e,t){this.covered=e,this.total=t,cg(this)}};function cg(e){if(e){if(e.covered>e.total)throw new Error(`The total number of covered items (${e.covered}) cannot be greater than the total (${e.total})`);if(e.total<0)throw new Error(`The number of covered items (${e.total}) cannot be negative`)}}var lg=class kM{static fromDetails(t,i){const s=new ag(0,0),r=new ag(0,0),n=new ag(0,0);for(const a of i)if("branches"in a){s.total+=1,s.covered+=a.executed?1:0;for(const c of a.branches)r.total+=1,r.covered+=c.executed?1:0}else n.total+=1,n.covered+=a.executed?1:0;const o=new kM(t,s,r.total>0?r:void 0,n.total>0?n:void 0);return o.detailedCoverage=i,o}constructor(t,i,s,r,n=[]){this.uri=t,this.statementCoverage=i,this.branchCoverage=s,this.declarationCoverage=r,this.includesTests=n}},x7=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}},C7=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}},k7=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}},Cb;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(Cb||(Cb={}));var kb;(function(e){e[e.Untrusted=0]="Untrusted",e[e.Trusted=1]="Trusted",e[e.Unspecified=2]="Unspecified"})(kb||(kb={}));var $b;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})($b||($b={}));var Ib=class{constructor(e,t,i,s,r,n){this.kind=e,this.name=t,this.detail=i,this.uri=s,this.range=r,this.selectionRange=n}},Db=class{constructor(e){this.uri=e}},ug=class{constructor(e,t){this.original=e,this.modified=t}},$7=class{constructor(e,t,i,s){this.base=e,this.input1=t,this.input2=i,this.result=s}},Pb=class{constructor(e,t){this.uri=e,this.viewType=t}},I7=class{constructor(e){this.viewType=e}},Tb=class{constructor(e,t){this.uri=e,this.notebookType=t}},Nb=class{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}},D7=class{constructor(){}},P7=class{constructor(e,t){this.uri=e,this.inputBoxUri=t}},T7=class{constructor(){}},N7=class{constructor(e){this.textDiffs=e}},Mb;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(Mb||(Mb={}));var Lb;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(Lb||(Lb={}));var Rb;(function(e){e[e.Short=1]="Short",e[e.Medium=2]="Medium",e[e.Full=3]="Full"})(Rb||(Rb={}));var EB=class{constructor(e,t,i){this.id=e,this.label=t,this.values=i}},Mr;(function(e){e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.Saved=3]="Saved"})(Mr||(Mr={}));var Ob;(function(e){e[e.Keep=1]="Keep",e[e.Undo=2]="Undo",e[e.UserModification=3]="UserModification"})(Ob||(Ob={}));var Fb;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful",e[e.Undone=2]="Undone",e[e.Accepted=3]="Accepted",e[e.Bug=4]="Bug"})(Fb||(Fb={}));var Ah;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful"})(Ah||(Ah={}));var hg=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Hi(e):e}},Sh=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Hi(e):e,this.vulnerabilities=t}},dg=class{constructor(e,t,i,s){this.title=e,this.message=t,this.data=i,this.buttons=s}},fg=class{constructor(e,t){this.value=e,this.baseUri=t}},Ub=class{constructor(e,t,i){this.value=e,this.title=t,this.readOnly=i}},jb=class{constructor(e,t){this.uris=e,this.callback=t,this.applied=new Promise(i=>{this.didGetApplied=i})}},Eh=class{constructor(e,t){this.value=e,this.value2=e,this.title=t}},zb=class{constructor(e){this.value=e}},pg=class{constructor(e,t){this.value=e,this.task=t}},rl=class{constructor(e,t,i){this.value=e,this.id=t,this.metadata=i}},xh=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Hi(e):e}},gg=class{constructor(e){this.value=e}},ka=class{constructor(e,t,i){this.value=e,this.iconPath=t,this.options=i}},mg=class{constructor(e,t,i){this.value=e,this.isEdit=t,this.undoStopId=i}},vg=class{constructor(e,t,i){this.value=e,this.license=t,this.snippet=i}},wg=class{constructor(e,t){this.uri=e,this.range=t}},Hb=class{constructor(e){this.extensions=e}},Wb=class{constructor(e,t,i,s,r){this.uri=e,this.title=t,this.description=i,this.author=s,this.linkTag=r}toJSON(){return{$mid:26,uri:this.uri,title:this.title,description:this.description,author:this.author}}},Ch=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},bg=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},kh=class{constructor(e){this.toolName=e}},Bb=class{constructor(e,t,i){this.toolName=e,this.toolCallId=t,this.isError=i}},yg=class{constructor(e,t,i,s,r,n,o){this.prompt=e,this.command=t,this.references=i,this.participant=s,this.toolReferences=r,this.editedFileEvents=n,this.id=o}},M7=class{constructor(e,t,i,s){this.response=e,this.result=t,this.participant=i,this.command=s}},xB=class{constructor(e,t,i,s){this.response=e,this.result=t,this.participant=i,this.command=s}},nr;(function(e){e[e.Panel=1]="Panel",e[e.Terminal=2]="Terminal",e[e.Notebook=3]="Notebook",e[e.Editor=4]="Editor"})(nr||(nr={}));var _b;(function(e){e[e.Failed=0]="Failed",e[e.Completed=1]="Completed",e[e.InProgress=2]="InProgress"})(_b||(_b={}));var CB=class{constructor(e,t,i,s){this.modifiedUri=e,this.insertions=t,this.deletions=i,this.originalUri=s}},Vb;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(Vb||(Vb={}));var qb;(function(e){e[e.NoReason=0]="NoReason",e[e.FilteredContentRetry=1]="FilteredContentRetry",e[e.CopyrightContentRetry=2]="CopyrightContentRetry"})(qb||(qb={}));var L7=class{constructor(e,t,i,s){this.editor=e,this.document=t,this.selection=i,this.wholeRange=s}},R7=class{constructor(e){this.cell=e}},O7=class{constructor(e,t,i){this.mimeType=e,this.data=t,this.reference=i}},Gb=class{constructor(e){this.diagnostics=e}},ns;(function(e){e[e.User=1]="User",e[e.Assistant=2]="Assistant",e[e.System=3]="System"})(ns||(ns={}));var nl=class{constructor(e,t,i){this.callId=e,this.content=t,this.isError=i??!1}},Jb;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(Jb||(Jb={}));var F7=class L5{static User(t,i){return new L5(ns.User,t,i)}static Assistant(t,i){return new L5(ns.Assistant,t,i)}set content(t){typeof t=="string"?this.c=[new zt(t)]:this.c=t}get content(){return this.c}constructor(t,i,s){this.c=[],this.role=t,this.content=i,this.name=s}},U7=class R5{static User(t,i){return new R5(ns.User,t,i)}static Assistant(t,i){return new R5(ns.Assistant,t,i)}set content(t){typeof t=="string"?this.c=[new zt(t)]:this.c=t}get content(){return this.c}set content2(t){t&&(this.content=t.map(i=>typeof i=="string"?new zt(i):i))}get content2(){return this.content.map(t=>t instanceof zt?t.value:t)}constructor(t,i,s){this.c=[],this.role=t,this.content=i,this.name=s}},$a=class{constructor(e,t,i){this.callId=e,this.name=t,this.input=i}},Ag;(function(e){e[e.Assistant=0]="Assistant",e[e.User=1]="User",e[e.Extension=2]="Extension"})(Ag||(Ag={}));var zt=class{constructor(e,t){this.value=e,t=t}toJSON(){return{$mid:21,value:this.value,audience:this.audience}}},vi=class av{constructor(t,i,s){this.mimeType=i,this.data=t,this.audience=s}static image(t,i){return new av(t,i)}static json(t,i="text/x-json"){const s=JSON.stringify(t,void 0,"	");return new av(W.fromString(s).buffer,i)}static text(t,i=Qs.text){return new av(W.fromString(t).buffer,i)}toJSON(){return{$mid:24,mimeType:this.mimeType,data:this.data,audience:this.audience}}},Zb;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(Zb||(Zb={}));var ol=class{constructor(e,t,i){this.value=e,this.id=t,this.metadata=i}toJSON(){return{$mid:22,value:this.value,id:this.id,metadata:this.metadata}}},Lr=class{constructor(e){this.value=e}toJSON(){return{$mid:23,value:this.value}}},hn=class Vr extends Error{static#e="LanguageModelError";static NotFound(t){return new Vr(t,Vr.NotFound.name)}static NoPermissions(t){return new Vr(t,Vr.NoPermissions.name)}static Blocked(t){return new Vr(t,Vr.Blocked.name)}static tryDeserialize(t){if(t.name===Vr.#e)return new Vr(t.message,t.code,t.cause)}constructor(t,i,s){super(t,{cause:s}),this.name=Vr.#e,this.code=i??""}},Sg=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},j7=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},kB=class extends Sg{},Eg;(function(e){e[e.Auto=1]="Auto",e[e.Required=2]="Required"})(Eg||(Eg={}));var z7=class{constructor(e,t){this.id=e,this.label=t}},H7=class{constructor(e,t,i){this.label=e,this.name=t,this.instructions=i}},Qb;(function(e){e[e.SymbolInformation=1]="SymbolInformation",e[e.CommandInformation=2]="CommandInformation",e[e.SearchInformation=3]="SearchInformation",e[e.SettingInformation=4]="SettingInformation"})(Qb||(Qb={}));var Yb;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(Yb||(Yb={}));var Xb;(function(e){e[e.Started=1]="Started",e[e.Recognizing=2]="Recognizing",e[e.Recognized=3]="Recognized",e[e.Stopped=4]="Stopped",e[e.Error=5]="Error"})(Xb||(Xb={}));var Kb;(function(e){e[e.Started=1]="Started",e[e.Stopped=2]="Stopped",e[e.Error=3]="Error"})(Kb||(Kb={}));var ey;(function(e){e[e.Recognized=1]="Recognized",e[e.Stopped=2]="Stopped"})(ey||(ey={}));var xg;(function(e){e[e.Initial=0]="Initial",e[e.Dynamic=1]="Dynamic"})(xg||(xg={}));var W7=class{constructor(e,t,i,s={},r,n){this.label=e,this.command=t,this.args=i,this.env=s,this.version=r,this.metadata=n}},B7=class{constructor(e,t,i={},s,r,n){this.label=e,this.uri=t,this.headers=i,this.version=s,this.metadata=r,this.authentication=n}},or;(function(e){function t(s){const{selectionStartLineNumber:r,selectionStartColumn:n,positionLineNumber:o,positionColumn:a}=s,c=new Pe(r-1,n-1),l=new Pe(o-1,a-1);return new Dr(c,l)}e.to=t;function i(s){const{anchor:r,active:n}=s;return{selectionStartLineNumber:r.line+1,selectionStartColumn:r.character+1,positionLineNumber:n.line+1,positionColumn:n.character+1}}e.from=i})(or||(or={}));var U;(function(e){function t(s){if(!s)return;const{start:r,end:n}=s;return{startLineNumber:r.line+1,startColumn:r.character+1,endLineNumber:n.line+1,endColumn:n.character+1}}e.from=t;function i(s){if(!s)return;const{startLineNumber:r,startColumn:n,endLineNumber:o,endColumn:a}=s;return new xe(r-1,n-1,o-1,a-1)}e.to=i})(U||(U={}));var Ms;(function(e){function t(s){return{uri:s.uri,range:U.from(s.range)}}e.from=t;function i(s){return new rs(y.revive(s.uri),U.to(s.range))}e.to=i})(Ms||(Ms={}));var ty;(function(e){function t(i){switch(i){case 1:return mo.Comment;case 0:return mo.Other;case 3:return mo.RegEx;case 2:return mo.String}}e.to=t})(ty||(ty={}));var Xe;(function(e){function t(s){return new Pe(s.lineNumber-1,s.column-1)}e.to=t;function i(s){return{lineNumber:s.line+1,column:s.character+1}}e.from=i})(Xe||(Xe={}));var Ia;(function(e){function t(r,n,o){return gt(xs(r).map(a=>i(a,n,o)))}e.from=t;function i(r,n,o){if(typeof r=="string")return{$serialized:!0,language:r,isBuiltin:o?.isBuiltin};if(r)return{$serialized:!0,language:r.language,scheme:s(r.scheme,n),pattern:_i.from(r.pattern)??void 0,exclusive:r.exclusive,notebookType:r.notebookType,isBuiltin:o?.isBuiltin}}function s(r,n){return n&&typeof r=="string"?n.transformOutgoingScheme(r):r}})(Ia||(Ia={}));var Cg;(function(e){function t(s){switch(s){case fa.Unnecessary:return 1;case fa.Deprecated:return 2}}e.from=t;function i(s){switch(s){case 1:return fa.Unnecessary;case 2:return fa.Deprecated;default:return}}e.to=i})(Cg||(Cg={}));var Da;(function(e){function t(s){let r;return s.code&&(Oe(s.code)||Cs(s.code)?r=String(s.code):r={value:String(s.code.value),target:s.code.target}),{...U.from(s.range),message:s.message,source:s.source,code:r,severity:$h.from(s.severity),relatedInformation:s.relatedInformation&&s.relatedInformation.map(kg.from),tags:Array.isArray(s.tags)?gt(s.tags.map(Cg.from)):void 0}}e.from=t;function i(s){const r=new Cp(U.to(s),s.message,$h.to(s.severity));return r.source=s.source,r.code=Oe(s.code)?s.code:s.code?.value,r.relatedInformation=s.relatedInformation&&s.relatedInformation.map(kg.to),r.tags=s.tags&&gt(s.tags.map(Cg.to)),r}e.to=i})(Da||(Da={}));var kg;(function(e){function t(s){return{...U.from(s.location.range),message:s.message,resource:s.location.uri}}e.from=t;function i(s){return new Zu(new rs(s.resource,U.to(s)),s.message)}e.to=i})(kg||(kg={}));var $h;(function(e){function t(s){switch(s){case mi.Error:return ji.Error;case mi.Warning:return ji.Warning;case mi.Information:return ji.Info;case mi.Hint:return ji.Hint}return ji.Error}e.from=t;function i(s){switch(s){case ji.Info:return mi.Information;case ji.Warning:return mi.Warning;case ji.Error:return mi.Error;case ji.Hint:return mi.Hint;default:return mi.Error}}e.to=i})($h||($h={}));var Kt;(function(e){function t(s){return typeof s=="number"&&s>=rh.One?s-1:s===rh.Beside?AW:yW}e.from=t;function i(s){if(typeof s=="number"&&s>=0)return s+1;throw new Error("invalid 'EditorGroupColumn'")}e.to=i})(Kt||(Kt={}));function $B(e){return typeof e.range<"u"}function _7(e){return e.length===0?!0:!!$B(e[0])}var pe;(function(e){function t(a){return a.map(e.from)}e.fromMany=t;function i(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function s(a){let c;if(i(a)){const{language:h,value:f}=a;c={value:"```"+h+`
`+f+"\n```\n"}}else Hi.isMarkdownString(a)?c={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,supportAlertSyntax:a.supportAlertSyntax,baseUri:a.baseUri}:typeof a=="string"?c={value:a}:c={value:""};const l=Object.create(null);c.uris=l;const u=({href:h})=>{try{let f=y.parse(h,!0);f=f.with({query:r(f.query,l)}),l[h]=f}catch{}return""};return ft.walkTokens(ft.lexer(c.value),h=>{h.type==="link"?u({href:h.href}):h.type==="image"&&typeof h.href=="string"&&u(Wj(h.href))}),c}e.from=s;function r(a,c){if(!a)return a;let l;try{l=qx(a)}catch{}if(!l)return a;let u=!1;return l=mc(l,h=>{if(y.isUri(h)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return c[f]=h,u=!0,f}else return}),u?JSON.stringify(l):a}function n(a){const c=new Hi(a.value,a.supportThemeIcons);return c.isTrusted=a.isTrusted,c.supportHtml=a.supportHtml,c.supportAlertSyntax=a.supportAlertSyntax,c.baseUri=a.baseUri?y.from(a.baseUri):void 0,c}e.to=n;function o(a){if(a)return typeof a=="string"?a:e.from(a)}e.fromStrict=o})(pe||(pe={}));function IB(e){return _7(e)?e.map(t=>({range:U.from(t.range),hoverMessage:Array.isArray(t.hoverMessage)?pe.fromMany(t.hoverMessage):t.hoverMessage?pe.from(t.hoverMessage):void 0,renderOptions:t.renderOptions})):e.map(t=>({range:U.from(t)}))}function $g(e){return typeof e>"u"?e:typeof e=="string"?y.file(e):e}var al;(function(e){function t(i){return typeof i>"u"?i:{contentText:i.contentText,contentIconPath:i.contentIconPath?$g(i.contentIconPath):void 0,border:i.border,borderColor:i.borderColor,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,color:i.color,backgroundColor:i.backgroundColor,margin:i.margin,width:i.width,height:i.height}}e.from=t})(al||(al={}));var Ig;(function(e){function t(i){return typeof i>"u"?i:{backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?$g(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?al.from(i.before):void 0,after:i.after?al.from(i.after):void 0}}e.from=t})(Ig||(Ig={}));var iy;(function(e){function t(i){if(typeof i>"u")return i;switch(i){case ya.OpenOpen:return 0;case ya.ClosedClosed:return 1;case ya.OpenClosed:return 2;case ya.ClosedOpen:return 3}}e.from=t})(iy||(iy={}));var sy;(function(e){function t(i){return{isWholeLine:i.isWholeLine,rangeBehavior:i.rangeBehavior?iy.from(i.rangeBehavior):void 0,overviewRulerLane:i.overviewRulerLane,light:i.light?Ig.from(i.light):void 0,dark:i.dark?Ig.from(i.dark):void 0,backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?$g(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?al.from(i.before):void 0,after:i.after?al.from(i.after):void 0}}e.from=t})(sy||(sy={}));var ei;(function(e){function t(s){return{text:s.newText,eol:s.newEol&&hl.from(s.newEol),range:U.from(s.range)}}e.from=t;function i(s){const r=new lo(U.to(s.range),s.text);return r.newEol=typeof s.eol>"u"?void 0:hl.to(s.eol),r}e.to=i})(ei||(ei={}));var os;(function(e){function t(s,r){const n={edits:[]};if(s instanceof wa){const o=new ou;for(const a of s._allEntries())a._type===1&&y.isUri(a.to)&&a.from===void 0&&o.add(a.to);for(const a of s._allEntries())if(a._type===1){let c;a.options?.contents&&(ArrayBuffer.isView(a.options.contents)?c={type:"base64",value:fc(W.wrap(a.options.contents))}:c={type:"dataTransferItem",id:a.options.contents._itemId}),n.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:c},metadata:a.metadata})}else a._type===2?n.edits.push({resource:a.uri,textEdit:ei.from(a.edit),versionId:o.has(a.uri)?void 0:r?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===6?n.edits.push({resource:a.uri,textEdit:{range:U.from(a.range),text:a.edit.value,insertAsSnippet:!0,keepWhitespace:a.keepWhitespace},versionId:o.has(a.uri)?void 0:r?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===3?n.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookVersionId:r?.getNotebookDocumentVersion(a.uri)}):a._type===5&&n.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:r?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:1,index:a.index,count:a.count,cells:a.cells.map(fl.from)}})}return n}e.from=t;function i(s){const r=new wa,n=new kt;for(const o of s.edits)if(o.textEdit){const a=o,c=y.revive(a.resource),l=U.to(a.textEdit.range),u=a.textEdit.text,h=a.textEdit.insertAsSnippet;let f;h?f=zw.replace(l,new ma(u)):f=lo.replace(l,u);const p=n.get(c);p?p.push(f):n.set(c,[f])}else r.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of n)r.set(o,a);return r}e.to=i})(os||(os={}));var Ls;(function(e){const t=Object.create(null);t[ut.File]=0,t[ut.Module]=1,t[ut.Namespace]=2,t[ut.Package]=3,t[ut.Class]=4,t[ut.Method]=5,t[ut.Property]=6,t[ut.Field]=7,t[ut.Constructor]=8,t[ut.Enum]=9,t[ut.Interface]=10,t[ut.Function]=11,t[ut.Variable]=12,t[ut.Constant]=13,t[ut.String]=14,t[ut.Number]=15,t[ut.Boolean]=16,t[ut.Array]=17,t[ut.Object]=18,t[ut.Key]=19,t[ut.Null]=20,t[ut.EnumMember]=21,t[ut.Struct]=22,t[ut.Event]=23,t[ut.Operator]=24,t[ut.TypeParameter]=25;function i(r){return typeof t[r]=="number"?t[r]:6}e.from=i;function s(r){for(const n in t)if(t[n]===r)return Number(n);return ut.Property}e.to=s})(Ls||(Ls={}));var dn;(function(e){function t(s){switch(s){case Qu.Deprecated:return 1}}e.from=t;function i(s){switch(s){case 1:return Qu.Deprecated}}e.to=i})(dn||(dn={}));var Pa;(function(e){function t(s){return{name:s.name,kind:Ls.from(s.kind),tags:s.tags&&s.tags.map(dn.from),containerName:s.containerName,location:Bi.from(s.location)}}e.from=t;function i(s){const r=new Yu(s.name,Ls.to(s.kind),s.containerName,Bi.to(s.location));return r.tags=s.tags&&s.tags.map(dn.to),r}e.to=i})(Pa||(Pa={}));var ry;(function(e){function t(s){const r={name:s.name||"!!MISSING: name!!",detail:s.detail,range:U.from(s.range),selectionRange:U.from(s.selectionRange),kind:Ls.from(s.kind),tags:s.tags?.map(dn.from)??[]};return s.children&&(r.children=s.children.map(t)),r}e.from=t;function i(s){const r=new Ku(s.name,s.detail,Ls.to(s.kind),U.to(s.range),U.to(s.selectionRange));return nu(s.tags)&&(r.tags=s.tags.map(dn.to)),s.children&&(r.children=s.children.map(i)),r}e.to=i})(ry||(ry={}));var Ta;(function(e){function t(s){const r=new Gw(Ls.to(s.kind),s.name,s.detail||"",y.revive(s.uri),U.to(s.range),U.to(s.selectionRange));return r._sessionId=s._sessionId,r._itemId=s._itemId,r}e.to=t;function i(s,r,n){if(r=r??s._sessionId,n=n??s._itemId,r===void 0||n===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:n,name:s.name,detail:s.detail,kind:Ls.from(s.kind),uri:s.uri,range:U.from(s.range),selectionRange:U.from(s.selectionRange),tags:s.tags?.map(dn.from)}}e.from=i})(Ta||(Ta={}));var ny;(function(e){function t(i){return new p7(Ta.to(i.from),i.fromRanges.map(s=>U.to(s)))}e.to=t})(ny||(ny={}));var oy;(function(e){function t(i){return new g7(Ta.to(i.to),i.fromRanges.map(s=>U.to(s)))}e.to=t})(oy||(oy={}));var Bi;(function(e){function t(s){return{range:s.range&&U.from(s.range),uri:s.uri}}e.from=t;function i(s){return new rs(y.revive(s.uri),U.to(s.range))}e.to=i})(Bi||(Bi={}));var Ih;(function(e){function t(s){const r=s,n=s;return{originSelectionRange:r.originSelectionRange?U.from(r.originSelectionRange):void 0,uri:r.targetUri?r.targetUri:n.uri,range:U.from(r.targetRange?r.targetRange:n.range),targetSelectionRange:r.targetSelectionRange?U.from(r.targetSelectionRange):void 0}}e.from=t;function i(s){return{targetUri:y.revive(s.uri),targetRange:U.to(s.range),targetSelectionRange:s.targetSelectionRange?U.to(s.targetSelectionRange):void 0,originSelectionRange:s.originSelectionRange?U.to(s.originSelectionRange):void 0}}e.to=i})(Ih||(Ih={}));var Dh;(function(e){function t(s){return{range:U.from(s.range),contents:pe.fromMany(s.contents),canIncreaseVerbosity:s.canIncreaseVerbosity,canDecreaseVerbosity:s.canDecreaseVerbosity}}e.from=t;function i(s){const r=s.contents.map(pe.to),n=U.to(s.range),o=s.canIncreaseVerbosity,a=s.canDecreaseVerbosity;return new Np(r,n,o,a)}e.to=i})(Dh||(Dh={}));var ay;(function(e){function t(s){return{range:U.from(s.range),expression:s.expression}}e.from=t;function i(s){return new Jp(U.to(s.range),s.expression)}e.to=i})(ay||(ay={}));var Dg;(function(e){function t(s){if(s instanceof Zp)return{type:"text",range:U.from(s.range),text:s.text};if(s instanceof Qp)return{type:"variable",range:U.from(s.range),variableName:s.variableName,caseSensitiveLookup:s.caseSensitiveLookup};if(s instanceof Yp)return{type:"expression",range:U.from(s.range),expression:s.expression};throw new Error("Unknown 'InlineValue' type")}e.from=t;function i(s){switch(s.type){case"text":return{range:U.to(s.range),text:s.text};case"variable":return{range:U.to(s.range),variableName:s.variableName,caseSensitiveLookup:s.caseSensitiveLookup};case"expression":return{range:U.to(s.range),expression:s.expression}}}e.to=i})(Dg||(Dg={}));var Pg;(function(e){function t(s){return{frameId:s.frameId,stoppedLocation:U.from(s.stoppedLocation)}}e.from=t;function i(s){return new fb(s.frameId,U.to(s.stoppedLocation))}e.to=i})(Pg||(Pg={}));var cl;(function(e){function t(s){return{range:U.from(s.range),kind:s.kind}}e.from=t;function i(s){return new Mp(U.to(s.range),s.kind)}e.to=i})(cl||(cl={}));var cy;(function(e){function t(s){return{uri:s.uri,highlights:s.highlights.map(cl.from)}}e.from=t;function i(s){return new Lp(y.revive(s.uri),s.highlights.map(cl.to))}e.to=i})(cy||(cy={}));var ly;(function(e){function t(i){switch(i){case 1:return Oc.TriggerCharacter;case 2:return Oc.TriggerForIncompleteCompletions;case 0:default:return Oc.Invoke}}e.to=t})(ly||(ly={}));var uy;(function(e){function t(i){return{triggerKind:ly.to(i.triggerKind),triggerCharacter:i.triggerCharacter}}e.to=t})(uy||(uy={}));var Tg;(function(e){function t(s){switch(s){case sh.Deprecated:return 1}}e.from=t;function i(s){switch(s){case 1:return sh.Deprecated}}e.to=i})(Tg||(Tg={}));var hy;(function(e){function t(i,s,r){return"icon"in i&&"command"in i?{command:s.toInternal(i.command,r),icon:yo.fromThemeIcon(i.icon)}:{command:s.toInternal(i,r)}}e.from=t})(hy||(hy={}));var Ng;(function(e){const t=new Map([[me.Method,0],[me.Function,1],[me.Constructor,2],[me.Field,3],[me.Variable,4],[me.Class,5],[me.Interface,7],[me.Struct,6],[me.Module,8],[me.Property,9],[me.Unit,12],[me.Value,13],[me.Constant,14],[me.Enum,15],[me.EnumMember,16],[me.Keyword,17],[me.Snippet,28],[me.Text,18],[me.Color,19],[me.File,20],[me.Reference,21],[me.Folder,23],[me.Event,10],[me.Operator,11],[me.TypeParameter,24],[me.Issue,26],[me.User,25]]);function i(n){return t.get(n)??9}e.from=i;const s=new Map([[0,me.Method],[1,me.Function],[2,me.Constructor],[3,me.Field],[4,me.Variable],[5,me.Class],[7,me.Interface],[6,me.Struct],[8,me.Module],[9,me.Property],[12,me.Unit],[13,me.Value],[14,me.Constant],[15,me.Enum],[16,me.EnumMember],[17,me.Keyword],[28,me.Snippet],[18,me.Text],[19,me.Color],[20,me.File],[21,me.Reference],[23,me.Folder],[10,me.Event],[11,me.Operator],[24,me.TypeParameter],[25,me.User],[26,me.Issue]]);function r(n){return s.get(n)??me.Property}e.to=r})(Ng||(Ng={}));var dy;(function(e){function t(i,s){const r=new Up(i.label);return r.insertText=i.insertText,r.kind=Ng.to(i.kind),r.tags=i.tags?.map(Tg.to),r.detail=i.detail,r.documentation=Yn(i.documentation)?pe.to(i.documentation):i.documentation,r.sortText=i.sortText,r.filterText=i.filterText,r.preselect=i.preselect,r.commitCharacters=i.commitCharacters,rt.isIRange(i.range)?r.range=U.to(i.range):typeof i.range=="object"&&(r.range={inserting:U.to(i.range.insert),replacing:U.to(i.range.replace)}),r.keepWhitespace=typeof i.insertTextRules>"u"?!1:!!(i.insertTextRules&1),typeof i.insertTextRules<"u"&&i.insertTextRules&4?r.insertText=new ma(i.insertText):(r.insertText=i.insertText,r.textEdit=r.range instanceof xe?new lo(r.range,r.insertText):void 0),i.additionalTextEdits&&i.additionalTextEdits.length>0&&(r.additionalTextEdits=i.additionalTextEdits.map(n=>ei.to(n))),r.command=s&&i.command?s.fromInternal(i.command):void 0,r}e.to=t})(dy||(dy={}));var Mg;(function(e){function t(s){if(typeof s.label!="string"&&!Array.isArray(s.label))throw new TypeError("Invalid label");return{label:s.label,documentation:pe.fromStrict(s.documentation)}}e.from=t;function i(s){return{label:s.label,documentation:Yn(s.documentation)?pe.to(s.documentation):s.documentation}}e.to=i})(Mg||(Mg={}));var Lg;(function(e){function t(s){return{label:s.label,documentation:pe.fromStrict(s.documentation),parameters:Array.isArray(s.parameters)?s.parameters.map(Mg.from):[],activeParameter:s.activeParameter}}e.from=t;function i(s){return{label:s.label,documentation:Yn(s.documentation)?pe.to(s.documentation):s.documentation,parameters:Array.isArray(s.parameters)?s.parameters.map(Mg.to):[],activeParameter:s.activeParameter}}e.to=i})(Lg||(Lg={}));var Ph;(function(e){function t(s){return{activeSignature:s.activeSignature,activeParameter:s.activeParameter,signatures:Array.isArray(s.signatures)?s.signatures.map(Lg.from):[]}}e.from=t;function i(s){return{activeSignature:s.activeSignature,activeParameter:s.activeParameter,signatures:Array.isArray(s.signatures)?s.signatures.map(Lg.to):[]}}e.to=i})(Ph||(Ph={}));var fy;(function(e){function t(i,s){const r=new Fp(Xe.to(s.position),typeof s.label=="string"?s.label:s.label.map(py.to.bind(void 0,i)),s.kind&&Rg.to(s.kind));return r.textEdits=s.textEdits&&s.textEdits.map(ei.to),r.tooltip=Yn(s.tooltip)?pe.to(s.tooltip):s.tooltip,r.paddingLeft=s.paddingLeft,r.paddingRight=s.paddingRight,r}e.to=t})(fy||(fy={}));var py;(function(e){function t(i,s){const r=new Op(s.label);return r.tooltip=Yn(s.tooltip)?pe.to(s.tooltip):s.tooltip,rw.is(s.command)&&(r.command=i.fromInternal(s.command)),s.location&&(r.location=Bi.to(s.location)),r}e.to=t})(py||(py={}));var Rg;(function(e){function t(s){return s}e.from=t;function i(s){return s}e.to=i})(Rg||(Rg={}));var Na;(function(e){function t(s){return{range:U.from(s.range),url:s.target,tooltip:s.tooltip}}e.from=t;function i(s){let r;if(s.url)try{r=typeof s.url=="string"?y.parse(s.url,!0):y.revive(s.url)}catch{}const n=new zp(U.to(s.range),r);return n.tooltip=s.tooltip,n}e.to=i})(Na||(Na={}));var Og;(function(e){function t(s){const r=new Wp(s.label);return s.textEdit&&(r.textEdit=ei.to(s.textEdit)),s.additionalTextEdits&&(r.additionalTextEdits=s.additionalTextEdits.map(n=>ei.to(n))),r}e.to=t;function i(s){return{label:s.label,textEdit:s.textEdit?ei.from(s.textEdit):void 0,additionalTextEdits:s.additionalTextEdits?s.additionalTextEdits.map(r=>ei.from(r)):void 0}}e.from=i})(Og||(Og={}));var ll;(function(e){function t(s){return new _c(s[0],s[1],s[2],s[3])}e.to=t;function i(s){return[s.red,s.green,s.blue,s.alpha]}e.from=i})(ll||(ll={}));var gy;(function(e){function t(s){return{range:U.from(s.range)}}e.from=t;function i(s){return new ih(U.to(s.range))}e.to=i})(gy||(gy={}));var Fg;(function(e){function t(i){switch(i){case 2:return zc.AfterDelay;case 1:return zc.Manual;case 3:case 4:return zc.FocusOut}}e.to=t})(Fg||(Fg={}));var ul;(function(e){function t(s){switch(s){case rr.Off:return 0;case rr.Relative:return 2;case rr.Interval:return 3;case rr.On:default:return 1}}e.from=t;function i(s){switch(s){case 0:return rr.Off;case 2:return rr.Relative;case 3:return rr.Interval;case 1:default:return rr.On}}e.to=i})(ul||(ul={}));var hl;(function(e){function t(s){if(s===sr.CRLF)return 1;if(s===sr.LF)return 0}e.from=t;function i(s){if(s===1)return sr.CRLF;if(s===0)return sr.LF}e.to=i})(hl||(hl={}));var Ug;(function(e){function t(i){if(typeof i=="object")return i.viewId;switch(i){case fo.SourceControl:return 3;case fo.Window:return 10;case fo.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}e.from=t})(Ug||(Ug={}));var jg;(function(e){function t(s){const r={start:s.start+1,end:s.end+1};return s.kind&&(r.kind=zg.from(s.kind)),r}e.from=t;function i(s){const r={start:s.start-1,end:s.end-1};return s.kind&&(r.kind=zg.to(s.kind)),r}e.to=i})(jg||(jg={}));var zg;(function(e){function t(s){if(s)switch(s){case un.Comment:return Ec.Comment;case un.Imports:return Ec.Imports;case un.Region:return Ec.Region}}e.from=t;function i(s){if(s)switch(s.value){case Ec.Comment.value:return un.Comment;case Ec.Imports.value:return un.Imports;case Ec.Region.value:return un.Region}}e.to=i})(zg||(zg={}));var Th;(function(e){function t(i){if(i)return{pinned:typeof i.preview=="boolean"?!i.preview:void 0,inactive:i.background,preserveFocus:i.preserveFocus,selection:typeof i.selection=="object"?U.from(i.selection):void 0,override:typeof i.override=="boolean"?Rz.id:void 0}}e.from=t})(Th||(Th={}));var _i;(function(e){function t(n){return n instanceof Zc?n.toJSON():typeof n=="string"?n:i(n)||s(n)?new Zc(n.baseUri??n.base,n.pattern).toJSON():n}e.from=t;function i(n){const o=n;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function s(n){const o=n;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function r(n){return typeof n=="string"?n:new Zc(y.revive(n.baseUri),n.pattern)}e.to=r})(_i||(_i={}));var my;(function(e){function t(i){if(i){if(Array.isArray(i))return i.map(t);if(typeof i=="string")return i;{const s=i;return{language:s.language,scheme:s.scheme,pattern:_i.from(s.pattern)??void 0,exclusive:s.exclusive,notebookType:s.notebookType}}}else return}e.from=t})(my||(my={}));var Rr;(function(e){function t(s){return{start:s.start,end:s.end}}e.from=t;function i(s){return new Ir(s.start,s.end)}e.to=i})(Rr||(Rr={}));var dl;(function(e){function t(s){return{timing:typeof s.runStartTime=="number"&&typeof s.runEndTime=="number"?{startTime:s.runStartTime,endTime:s.runEndTime}:void 0,executionOrder:s.executionOrder,success:s.lastRunSuccess}}e.to=t;function i(s){return{lastRunSuccess:s.success,runStartTime:s.timing?.startTime,runEndTime:s.timing?.endTime,executionOrder:s.executionOrder}}e.from=i})(dl||(dl={}));var Nh;(function(e){function t(s){switch(s){case pa.Markup:return Pc.Markup;case pa.Code:default:return Pc.Code}}e.from=t;function i(s){switch(s){case Pc.Markup:return pa.Markup;case Pc.Code:default:return pa.Code}}e.to=i})(Nh||(Nh={}));var vo;(function(e){function t(s){const r={metadata:s.metadata??Object.create(null),cells:[]};for(const n of s.cells)kp.validate(n),r.cells.push(fl.from(n));return r}e.from=t;function i(s){const r=new l7(s.cells.map(fl.to));return Dv(s.metadata)||(r.metadata=s.metadata),r}e.to=i})(vo||(vo={}));var fl;(function(e){function t(s){return{cellKind:Nh.from(s.kind),language:s.languageId,mime:s.mime,source:s.value,metadata:s.metadata,internalMetadata:dl.from(s.executionSummary??{}),outputs:s.outputs?s.outputs.map(wo.from):[]}}e.from=t;function i(s){return new kp(Nh.to(s.cellKind),s.source,s.language,s.mime,s.outputs?s.outputs.map(wo.to):void 0,s.metadata,s.internalMetadata?dl.to(s.internalMetadata):void 0)}e.to=i})(fl||(fl={}));var pl;(function(e){function t(s){return{mime:s.mime,valueBytes:W.wrap(s.data)}}e.from=t;function i(s){return new u7(s.valueBytes.buffer,s.mime)}e.to=i})(pl||(pl={}));var wo;(function(e){function t(s){return{outputId:s.id,items:s.items.map(pl.from),metadata:s.metadata}}e.from=t;function i(s){const r=s.items.map(pl.to);return new Ip(r,s.outputId,s.metadata)}e.to=i})(wo||(wo={}));var Hg;(function(e){function t(r){return s(r)?{include:_i.from(r.include)??void 0,exclude:_i.from(r.exclude)??void 0}:_i.from(r)??void 0}e.from=t;function i(r){return s(r)?{include:_i.to(r.include),exclude:_i.to(r.exclude)}:_i.to(r)}e.to=i;function s(r){const n=r;return n?!Wt(n.include)&&!Wt(n.exclude):!1}})(Hg||(Hg={}));var vy;(function(e){function t(i,s,r){const n=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{alignment:i.alignment===tg.Left?1:2,command:s.toInternal(n,r),text:i.text,tooltip:i.tooltip,accessibilityInformation:i.accessibilityInformation,priority:i.priority}}e.from=t})(vy||(vy={}));var wy;(function(e){function t(i,s,r){const n=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{command:s.toInternal(n,r),label:i.label,description:i.description,detail:i.detail,documentation:i.documentation}}e.from=t})(wy||(wy={}));var by;(function(e){function t(i){return{transientOutputs:i?.transientOutputs??!1,transientCellMetadata:i?.transientCellMetadata??{},transientDocumentMetadata:i?.transientDocumentMetadata??{},cellContentMetadata:i?.cellContentMetadata??{}}}e.from=t})(by||(by={}));var Wg;(function(e){function t(s){return{uri:s.uri,provides:s.provides}}e.from=t;function i(s){return new S7(y.revive(s.uri),s.provides)}e.to=i})(Wg||(Wg={}));var gl;(function(e){function t(s){return{message:pe.fromStrict(s.message)||"",type:0,expected:s.expectedOutput,actual:s.actualOutput,contextValue:s.contextValue,location:s.location&&{range:U.from(s.location.range),uri:s.location.uri},stackTrace:s.stackTrace?.map(r=>({label:r.label,position:r.position&&Xe.from(r.position),uri:r.uri&&y.revive(r.uri).toJSON()}))}}e.from=t;function i(s){const r=new og(typeof s.message=="string"?s.message:pe.to(s.message));return r.actualOutput=s.actual,r.expectedOutput=s.expected,r.contextValue=s.contextValue,r.location=s.location?Bi.to(s.location):void 0,r}e.to=i})(gl||(gl={}));var ar;(function(e){e.namespace=ap,e.denamespace=w6})(ar||(ar={}));var yy;(function(e){function t(i){return{controllerId:i.controllerId,profileId:i.profileId,group:ml.from(i.kind)}}e.from=t})(yy||(yy={}));var ml;(function(e){const t={[sl.Coverage]:8,[sl.Debug]:4,[sl.Run]:2};function i(s){return t.hasOwnProperty(s)?t[s]:2}e.from=i})(ml||(ml={}));var bo;(function(e){function t(s){const r=xp(s).controllerId;return{extId:Ve.fromExtHostTestItem(s,r).toString(),label:s.label,uri:y.revive(s.uri),busy:s.busy,tags:s.tags.map(n=>ar.namespace(r,n.id)),range:rt.lift(U.from(s.range)),description:s.description||null,sortText:s.sortText||null,error:s.error&&pe.fromStrict(s.error)||null}}e.from=t;function i(s){return{parent:void 0,error:void 0,id:Ve.fromString(s.extId).localId,label:s.label,uri:y.revive(s.uri),tags:(s.tags||[]).map(r=>{const{tagId:n}=ar.denamespace(r);return new yh(n)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:U.to(s.range||void 0),canResolveChildren:!1,busy:s.busy,description:s.description||void 0,sortText:s.sortText||void 0}}e.toPlain=i})(bo||(bo={})),function(e){function t(s){return{id:s.id}}e.from=t;function i(s){return new yh(s.id)}e.to=i}(ar||(ar={}));var Ay;(function(e){const t=(s,r)=>{const n=s.value;if(!n)return;const o={...bo.toPlain(n.item),parent:r,taskStates:n.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(c=>c.type===0).map(gl.to)})),children:[]};if(s.children)for(const a of s.children.values()){const c=t(a,o);c&&o.children.push(c)}return o};function i(s){const r=new Ez;for(const a of s.items)r.insert(Ve.fromString(a.item.extId).path,a);const n=[r.nodes],o=[];for(;n.length;)for(const a of n.pop())a.value?o.push(a):a.children&&n.push(a.children.values());return{completedAt:s.completedAt,results:o.map(a=>t(a)).filter(fs)}}e.to=i})(Ay||(Ay={}));var Mh;(function(e){function t(a){return{covered:a.covered,total:a.total}}function i(a){return"line"in a?Xe.from(a):U.from(a)}function s(a){if(a)return"endLineNumber"in a?U.to(a):Xe.to(a)}function r(a){if(a.type===1){const c=[];if(a.branches)for(const l of a.branches)c.push({executed:l.count,location:s(l.location),label:l.label});return new x7(a.count,s(a.location),a.branches?.map(l=>new C7(l.count,s(l.location),l.label)))}else return new k7(a.name,a.count,s(a.location))}e.to=r;function n(a){if(typeof a.executed=="number"&&a.executed<0)throw new Error(`Invalid coverage count ${a.executed}`);return"branches"in a?{count:a.executed,location:i(a.location),type:1,branches:a.branches.length?a.branches.map(c=>({count:c.executed,location:c.location&&i(c.location),label:c.label})):void 0}:{type:0,name:a.name,count:a.executed,location:i(a.location)}}e.fromDetails=n;function o(a,c,l){return cg(l.statementCoverage),cg(l.branchCoverage),cg(l.declarationCoverage),{id:c,uri:l.uri,statement:t(l.statementCoverage),branch:l.branchCoverage&&t(l.branchCoverage),declaration:l.declarationCoverage&&t(l.declarationCoverage),testIds:l instanceof lg&&l.includesTests.length?l.includesTests.map(u=>Ve.fromExtHostTestItem(u,a).toString()):void 0}}e.fromFile=o})(Mh||(Mh={}));var Sy;(function(e){function t(i){switch(i){case 1:return eh.Invoke;case 2:return eh.Automatic}}e.to=t})(Sy||(Sy={}));var Ma;(function(e){function t(s){const r=new Ib(Ls.to(s.kind),s.name,s.detail||"",y.revive(s.uri),U.to(s.range),U.to(s.selectionRange));return r._sessionId=s._sessionId,r._itemId=s._itemId,r}e.to=t;function i(s,r,n){if(r=r??s._sessionId,n=n??s._itemId,r===void 0||n===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:n,kind:Ls.from(s.kind),name:s.name,detail:s.detail??"",uri:s.uri,range:U.from(s.range),selectionRange:U.from(s.selectionRange),tags:s.tags?.map(dn.from)}}e.from=i})(Ma||(Ma={}));var Bg;(function(e){function t(i){if(i)return{value:i.value,tooltip:i.tooltip}}e.from=t})(Bg||(Bg={}));var La;(function(e){function t(n,o,a){const c=o.fileData;return c?new lB(new uB(c.name,y.revive(c.uri),c.id,Ev(()=>a(c.id)))):n===Qs.uriList&&o.uriListData?new qp(r(o.uriListData)):new qp(o.asString)}e.to=t;async function i(n,o,a=Nt()){const c=await o.asString();if(n===Qs.uriList)return{id:a,asString:c,fileData:void 0,uriListData:s(c)};const l=o.asFile();return{id:a,asString:c,fileData:l?{name:l.name,uri:l.uri,id:l._itemId??l.id}:void 0}}e.from=i;function s(n){return j0.split(n).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function r(n){return j0.create(n.map(o=>typeof o=="string"?o:y.revive(o)))}})(La||(La={}));var vl;(function(e){function t(r,n){const o=r.items.map(([a,c])=>[a,La.to(a,c,n)]);return new Gc(o)}e.toDataTransfer=t;async function i(r){return{items:await Promise.all(Array.from(r,async([o,a])=>[o,await La.from(o,a)]))}}e.from=i;async function s(r){return{items:await Promise.all(Array.from(r,async([o,a])=>[o,await La.from(o,a,a.id)]))}}e.fromList=s})(vl||(vl={}));var _g;(function(e){function t(s,r){return{kind:"reply",agentId:s.participant??r?.agentId??"",subCommand:s.command??r?.command,message:s.prompt,title:s.label}}e.from=t;function i(s){return{prompt:s.message,label:s.title,participant:s.agentId,command:s.subCommand}}e.to=i})(_g||(_g={}));var wl;(function(e){function t(s){switch(s){case 0:return ns.System;case 1:return ns.User;case 2:return ns.Assistant}}e.to=t;function i(s){switch(s){case ns.System:return 0;case ns.User:return 1;case ns.Assistant:return 2}return 1}e.from=i})(wl||(wl={}));var V7;(function(e){function t(s){const r=s.content.map(a=>{if(a.type==="text")return new zt(a.value,a.audience);if(a.type==="tool_result"){const c=gt(a.value.map(l=>l.type==="text"?new zt(l.value,l.audience):l.type==="data"?new vi(l.data.buffer,l.mimeType):l.type==="prompt_tsx"?new Lr(l.value):void 0));return new nl(a.toolCallId,c,a.isError)}else{if(a.type==="image_url")return new vi(a.value.data.buffer,a.value.mimeType);if(a.type==="data")return new vi(a.data.buffer,a.mimeType);if(a.type==="tool_use")return new $a(a.toolCallId,a.name,a.parameters)}}).filter(a=>a!==void 0),n=wl.to(s.role);return new F7(n,r,s.name)}e.to=t;function i(s){const r=wl.from(s.role),n=s.name;let o=s.content;typeof o=="string"&&(o=[new zt(o)]);const a=o.map(c=>{if(c instanceof nl)return{type:"tool_result",toolCallId:c.callId,value:gt(c.content.map(l=>l instanceof zt?{type:"text",value:l.value,audience:l.audience}:l instanceof Lr?{type:"prompt_tsx",value:l.value}:l instanceof vi?{type:"data",mimeType:l.mimeType,data:W.wrap(l.data),audience:l.audience}:void 0)),isError:c.isError};if(c instanceof vi)return q7(c)?{type:"image_url",value:{mimeType:c.mimeType,data:W.wrap(c.data)}}:{type:"data",mimeType:c.mimeType,data:W.wrap(c.data),audience:c.audience};if(c instanceof $a)return{type:"tool_use",toolCallId:c.callId,name:c.name,parameters:c.input};if(c instanceof zt)return{type:"text",value:c.value};if(typeof c!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:c}});return{role:r,name:n,content:a}}e.from=i})(V7||(V7={}));var Vg;(function(e){function t(s){const r=s.content.map(a=>{if(a.type==="text")return new zt(a.value,a.audience);if(a.type==="tool_result"){const c=a.value.map(l=>l.type==="text"?new zt(l.value,l.audience):l.type==="data"?new vi(l.data.buffer,l.mimeType):new Lr(l.value));return new nl(a.toolCallId,c,a.isError)}else return a.type==="image_url"?new vi(a.value.data.buffer,a.value.mimeType):a.type==="data"?new vi(a.data.buffer,a.mimeType):a.type==="thinking"?new ol(a.value,a.id,a.metadata):new $a(a.toolCallId,a.name,a.parameters)}),n=wl.to(s.role);return new U7(n,r,s.name)}e.to=t;function i(s){const r=wl.from(s.role),n=s.name;let o=s.content;typeof o=="string"&&(o=[new zt(o)]);const a=o.map(c=>{if(c instanceof nl)return{type:"tool_result",toolCallId:c.callId,value:gt(c.content.map(l=>l instanceof zt?{type:"text",value:l.value,audience:l.audience}:l instanceof Lr?{type:"prompt_tsx",value:l.value}:l instanceof vi?{type:"data",mimeType:l.mimeType,data:W.wrap(l.data),audience:l.audience}:void 0)),isError:c.isError};if(c instanceof vi)return q7(c)?{type:"image_url",value:{mimeType:c.mimeType,data:W.wrap(c.data)}}:{type:"data",mimeType:c.mimeType,data:W.wrap(c.data),audience:c.audience};if(c instanceof $a)return{type:"tool_use",toolCallId:c.callId,name:c.name,parameters:c.input};if(c instanceof zt)return{type:"text",value:c.value};if(c instanceof ol)return{type:"thinking",value:c.value,id:c.id,metadata:c.metadata};if(typeof c!="string")throw new Error("Unexpected chat message content type llm 2");return{type:"text",value:c}});return{role:r,name:n,content:a}}e.from=i})(Vg||(Vg={}));function q7(e){switch(typeof e.mimeType=="string"?e.mimeType.toLowerCase():""){case"image/png":case"image/jpeg":case"image/jpg":case"image/gif":case"image/webp":case"image/bmp":return!0;default:return!1}}var Lh;(function(e){function t(s){return{kind:"markdownContent",content:pe.from(s.value)}}e.from=t;function i(s){return new hg(pe.to(s.content))}e.to=i})(Lh||(Lh={}));var qg;(function(e){function t(s){return{kind:"codeblockUri",uri:s.value,isEdit:s.isEdit,undoStopId:s.undoStopId}}e.from=t;function i(s){return new mg(y.revive(s.uri),s.isEdit,s.undoStopId)}e.to=i})(qg||(qg={}));var Gg;(function(e){function t(s){return{kind:"markdownVuln",content:pe.from(s.value),vulnerabilities:s.vulnerabilities}}e.from=t;function i(s){return new Sh(pe.to(s.content),s.vulnerabilities)}e.to=i})(Gg||(Gg={}));var Jg;(function(e){function t(i){return{kind:"confirmation",title:i.title,message:pe.from(i.message),data:i.data,buttons:i.buttons}}e.from=t})(Jg||(Jg={}));var Rh;(function(e){function t(s){const{value:r,baseUri:n}=s;function o(a,c){return a.map(l=>{const u=y.joinPath(c,l.name);return{label:l.name,uri:u,children:l.children&&o(l.children,u)}})}return{kind:"treeData",treeData:{label:Li(n),uri:n,children:o(r,n)}}}e.from=t;function i(s){const r=Zt(s.treeData);function n(c){return c.map(l=>({name:l.label,children:l.children&&n(l.children)}))}const o=r.uri,a=r.children?n(r.children):[];return new fg(a,o)}e.to=i})(Rh||(Rh={}));var Ey;(function(e){function t(s){return{kind:"multiDiffData",multiDiffData:{title:s.title,resources:s.value.map(r=>({originalUri:r.originalUri,modifiedUri:r.modifiedUri,goToFileUri:r.goToFileUri,added:r.added,removed:r.removed}))},readOnly:s.readOnly}}e.from=t;function i(s){const r=s.multiDiffData.resources.map(n=>({originalUri:n.originalUri?y.revive(n.originalUri):void 0,modifiedUri:n.modifiedUri?y.revive(n.modifiedUri):void 0,goToFileUri:n.goToFileUri?y.revive(n.goToFileUri):void 0,added:n.added,removed:n.removed}));return new Ub(r,s.multiDiffData.title,s.readOnly)}e.to=i})(Ey||(Ey={}));var bl;(function(e){function t(s){const r=o=>y.isUri(o),n=o=>"name"in o;return{kind:"inlineReference",name:s.title,inlineReference:r(s.value)?s.value:n(s.value)?Pa.from(s.value):Ms.from(s.value)}}e.from=t;function i(s){const r=Zt(s);return new Eh(y.isUri(r.inlineReference)?r.inlineReference:"location"in r.inlineReference?Pa.to(r.inlineReference):Ms.to(r.inlineReference),s.name)}e.to=i})(bl||(bl={}));var Oh;(function(e){function t(s){return{kind:"progressMessage",content:pe.from(s.value)}}e.from=t;function i(s){return new zb(s.content.value)}e.to=i})(Oh||(Oh={}));var Fh;(function(e){function t(s){return{kind:"thinking",value:s.value,id:s.id,metadata:s.metadata}}e.from=t;function i(s){return new rl(s.value??"",s.id,s.metadata)}e.to=i})(Fh||(Fh={}));var Uh;(function(e){function t(s){return{kind:"warning",content:pe.from(s.value)}}e.from=t;function i(s){return new xh(s.content.value)}e.to=i})(Uh||(Uh={}));var xy;(function(e){function t(i){return{kind:"extensions",extensions:i.extensions}}e.from=t})(xy||(xy={}));var Cy;(function(e){function t(i){return{kind:"pullRequest",author:i.author,title:i.title,description:i.description,uri:i.uri,linkTag:i.linkTag}}e.from=t})(Cy||(Cy={}));var ky;(function(e){function t(s){return{kind:"move",uri:s.uri,range:U.from(s.range)}}e.from=t;function i(s){return new wg(y.revive(s.uri),U.to(s.range))}e.to=i})(ky||(ky={}));var jh;(function(e){function t(s){return{kind:"prepareToolInvocation",toolName:s.toolName}}e.from=t;function i(s){return new kh(s.toolName)}e.to=i})(jh||(jh={}));var $y;(function(e){function t(n){return{kind:"toolInvocationSerialized",toolCallId:n.toolCallId,toolId:n.toolName,invocationMessage:n.invocationMessage?pe.from(n.invocationMessage):n.toolName,originMessage:n.originMessage?pe.from(n.originMessage):void 0,pastTenseMessage:n.pastTenseMessage?pe.from(n.pastTenseMessage):void 0,isConfirmed:n.isConfirmed,isComplete:n.isComplete??!0,source:er.External,toolSpecificData:n.toolSpecificData?i(n.toolSpecificData):void 0,presentation:n.presentation==="hidden"?Ic.Hidden:n.presentation==="hiddenAfterComplete"?Ic.HiddenAfterComplete:void 0,fromSubAgent:n.fromSubAgent}}e.from=t;function i(n){return"command"in n&&"language"in n?{kind:"terminal",command:n.command,language:n.language}:"commandLine"in n&&"language"in n?{kind:"terminal",commandLine:n.commandLine,language:n.language}:n}function s(n){const o=new Bb(n.toolId||n.toolName,n.toolCallId,n.isError);return n.invocationMessage&&(o.invocationMessage=n.invocationMessage),n.originMessage&&(o.originMessage=n.originMessage),n.pastTenseMessage&&(o.pastTenseMessage=n.pastTenseMessage),n.isConfirmed!==void 0&&(o.isConfirmed=n.isConfirmed),n.isComplete!==void 0&&(o.isComplete=n.isComplete),n.toolSpecificData&&(o.toolSpecificData=r(n.toolSpecificData)),o.fromSubAgent=n.fromSubAgent,o}e.to=s;function r(n){return n.kind==="terminal"?{command:n.command,language:n.language}:n.kind==="terminal2"?{commandLine:n.commandLine,language:n.language}:n}})($y||($y={}));var Zg;(function(e){function t(i){return{kind:"progressTask",content:pe.from(i.value)}}e.from=t})(Zg||(Zg={}));var Iy;(function(e){function t(i){return{kind:"progressTaskResult",content:typeof i=="string"?pe.from(i):void 0}}e.from=t})(Iy||(Iy={}));var zh;(function(e){function t(s,r,n){return{kind:"command",command:r.toInternal(s.value,n)??{command:s.value.command,title:s.value.title}}}e.from=t;function i(s,r){return new gg(r.fromInternal(s.command)??{command:s.command.id,title:s.command.title})}e.to=i})(zh||(zh={}));var Qg;(function(e){function t(s){return{kind:"textEdit",uri:s.uri,edits:s.edits.map(r=>ei.from(r)),done:s.isDone}}e.from=t;function i(s){const r=new Ch(y.revive(s.uri),s.edits.map(n=>ei.to(n)));return r.isDone=s.done,r}e.to=i})(Qg||(Qg={}));var Yg;(function(e){function t(i){return i.newCellMetadata?{editType:3,index:i.range.start,metadata:i.newCellMetadata}:i.newNotebookMetadata?{editType:5,metadata:i.newNotebookMetadata}:{editType:1,index:i.range.start,count:i.range.end-i.range.start,cells:i.newCells.map(fl.from)}}e.from=t})(Yg||(Yg={}));var Xg;(function(e){function t(i){return{kind:"notebookEdit",uri:i.uri,edits:i.edits.map(Yg.from),done:i.isDone}}e.from=t})(Xg||(Xg={}));var Ra;(function(e){function t(s){const r=Dt.isThemeIcon(s.iconPath)?s.iconPath:y.isUri(s.iconPath)?{light:y.revive(s.iconPath)}:s.iconPath&&"light"in s.iconPath&&"dark"in s.iconPath&&y.isUri(s.iconPath.light)&&y.isUri(s.iconPath.dark)?{light:y.revive(s.iconPath.light),dark:y.revive(s.iconPath.dark)}:void 0;return typeof s.value=="object"&&"variableName"in s.value?{kind:"reference",reference:{variableName:s.value.variableName,value:y.isUri(s.value.value)||!s.value.value?s.value.value:Ms.from(s.value.value)},iconPath:r,options:s.options}:{kind:"reference",reference:y.isUri(s.value)||typeof s.value=="string"?s.value:Ms.from(s.value),iconPath:r,options:s.options}}e.from=t;function i(s){const r=Zt(s),n=o=>y.isUri(o)?o:Ms.to(o);return new ka(typeof r.reference=="string"?r.reference:"variableName"in r.reference?{variableName:r.reference.variableName,value:r.reference.value&&n(r.reference.value)}:n(r.reference))}e.to=i})(Ra||(Ra={}));var Kg;(function(e){function t(i){return{kind:"codeCitation",value:i.value,license:i.license,snippet:i.snippet}}e.from=t})(Kg||(Kg={}));var Hh;(function(e){function t(r,n,o){return r instanceof hg?Lh.from(r):r instanceof Eh?bl.from(r):r instanceof ka?Ra.from(r):r instanceof zb?Oh.from(r):r instanceof rl?Fh.from(r):r instanceof fg?Rh.from(r):r instanceof Ub?Ey.from(r):r instanceof gg?zh.from(r,n,o):r instanceof Ch?Qg.from(r):r instanceof bg?Xg.from(r):r instanceof Sh?Gg.from(r):r instanceof mg?qg.from(r):r instanceof xh?Uh.from(r):r instanceof dg?Jg.from(r):r instanceof vg?Kg.from(r):r instanceof wg?ky.from(r):r instanceof Hb?xy.from(r):r instanceof kh?jh.from(r):r instanceof Wb?Cy.from(r):r instanceof Bb?$y.from(r):{kind:"markdownContent",content:pe.from("")}}e.from=t;function i(r,n){switch(r.kind){case"reference":return Ra.to(r);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return s(r,n)}}e.to=i;function s(r,n){switch(r.kind){case"markdownContent":return Lh.to(r);case"inlineReference":return bl.to(r);case"progressMessage":return;case"treeData":return Rh.to(r);case"command":return zh.to(r,n)}}e.toContent=s})(Hh||(Hh={}));var yl;(function(e){function t(i,s,r,n,o,a,c){const l=[],u=[];for(const p of i.variables.variables)p.kind==="tool"?l.push(p):p.kind==="toolset"?l.push(...p.value):u.push(p);const h=xr.parseLocalSessionId(i.sessionResource)??i.sessionResource.toString(),f={id:i.requestId,prompt:i.message,command:i.command,attempt:i.attempt??0,enableCommandDetection:i.enableCommandDetection??!0,isParticipantDetected:i.isParticipantDetected??!1,sessionId:h,references:u.map(p=>tm.to(p,n,c)).filter(fs),toolReferences:l.map(Oa.to),location:em.to(i.location),acceptedConfirmationData:i.acceptedConfirmationData,rejectedConfirmationData:i.rejectedConfirmationData,location2:s,toolInvocationToken:Object.freeze({sessionId:h,sessionResource:i.sessionResource}),tools:o,model:r,editedFileEvents:i.editedFileEvents,modeInstructions:i.modeInstructions?.content,modeInstructions2:Py.to(i.modeInstructions),isSubagent:i.isSubagent};return et(a,"chatParticipantPrivate")||(delete f.id,delete f.attempt,delete f.enableCommandDetection,delete f.isParticipantDetected,delete f.location,delete f.location2,delete f.editedFileEvents,delete f.sessionId,delete f.isSubagent),et(a,"chatParticipantAdditions")||(delete f.acceptedConfirmationData,delete f.rejectedConfirmationData,delete f.tools),f}e.to=t})(yl||(yl={}));var Dy;(function(e){function t(i){return{prompt:i.prompt,files:i.files.map(s=>y.revive(s))}}e.to=t})(Dy||(Dy={}));var em;(function(e){function t(s){switch(s){case ui.Notebook:return nr.Notebook;case ui.Terminal:return nr.Terminal;case ui.Chat:return nr.Panel;case ui.EditorInline:return nr.Editor}}e.to=t;function i(s){switch(s){case nr.Notebook:return ui.Notebook;case nr.Terminal:return ui.Terminal;case nr.Panel:return ui.Chat;case nr.Editor:return ui.EditorInline}}e.from=i})(em||(em={}));var tm;(function(e){function t(i,s,r){let n=i.value;if(!n){let a;try{a=JSON.stringify(i)}catch{a=`kind=${i.kind}, id=${i.id}, name=${i.name}`}r.error(`[ChatPromptReference] Ignoring invalid reference in variable: ${a}`);return}if(ff(n))n=y.revive(n);else if(n&&typeof n=="object"&&"uri"in n&&"range"in n&&ff(n.uri))n=Ms.to(Zt(n));else if(_z(i)){const a=i.references?.[0]?.reference;n=new O7(i.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(i.value))),a&&y.isUri(a)?a:void 0)}else if(i.kind==="diagnostic"){const a=i.filterSeverity&&$h.to(i.filterSeverity),c=i.filterUri&&y.revive(i.filterUri).toString();n=new Gb(s.map(([l,u])=>i.filterUri&&l.toString()!==c?[l,[]]:[l,u.filter(h=>!(a&&h.severity>a||i.filterRange&&!rt.areIntersectingOrTouching(i.filterRange,U.from(h.range))))]).filter(([,l])=>l.length>0))}let o;return(hw(i)||Vz(i))&&i.toolReferences&&(o=im.to(i.toolReferences)),{id:i.id,name:i.name,range:i.range&&[i.range.start,i.range.endExclusive],toolReferences:o,value:n,modelDescription:i.modelDescription}}e.to=t})(tm||(tm={}));var Oa;(function(e){function t(i){if(i.value)throw new Error("Invalid tool reference");return{name:i.id,range:i.range&&[i.range.start,i.range.endExclusive]}}e.to=t})(Oa||(Oa={}));var im;(function(e){function t(i){const s=[];for(const r of i)if(r.kind==="tool")s.push(Oa.to(r));else if(r.kind==="toolset")s.push(...r.value.map(Oa.to));else throw new Error("Invalid tool reference in prompt variables");return s}e.to=t})(im||(im={}));var Py;(function(e){function t(i){if(i)return{name:i.name,content:i.content,toolReferences:im.to(i.toolReferences),metadata:i.metadata}}e.to=t})(Py||(Py={}));var Ty;(function(e){function t(i,s,r){return{id:i.id,label:i.label,fullName:i.fullName,icon:i.icon?.id,value:i.values[0].value,insertText:i.insertText,detail:i.detail,documentation:i.documentation,command:s.toInternal(i.command,r)}}e.from=t})(Ty||(Ty={}));var Al;(function(e){function t(r){return{errorDetails:r.errorDetails,metadata:s(r.metadata),nextQuestion:r.nextQuestion,details:r.details}}e.to=t;function i(r){return{errorDetails:r.errorDetails,metadata:r.metadata,nextQuestion:r.nextQuestion,details:r.details}}e.from=i;function s(r){return mc(r,n=>{if(n.$mid===20)return new Sg(mc(n.content,s));if(n.$mid===21)return new zt(n.value);if(n.$mid===22)return new ol(n.value,n.id,n.metadata);if(n.$mid===23)return new Lr(n.value)})}})(Al||(Al={}));var Ny;(function(e){function t(i,s,r){if(s.action.kind==="vote")return;const n=Al.to(i);if(s.action.kind==="command"){const o=s.action.commandButton.command;return{action:{kind:"command",commandButton:{command:r.fromInternal(o)??{command:o.id,title:o.title}}},result:n}}else return s.action.kind==="followUp"?{action:{kind:"followUp",followup:_g.to(s.action.followup)},result:n}:s.action.kind==="inlineChat"?{action:{kind:"editor",accepted:s.action.action==="accepted"},result:n}:s.action.kind==="chatEditingSessionAction"?{action:{kind:"chatEditingSessionAction",outcome:new Map([["accepted",Mr.Accepted],["rejected",Mr.Rejected],["saved",Mr.Saved]]).get(s.action.outcome)??Mr.Rejected,uri:y.revive(s.action.uri),hasRemainingEdits:s.action.hasRemainingEdits},result:n}:s.action.kind==="chatEditingHunkAction"?{action:{kind:"chatEditingHunkAction",outcome:new Map([["accepted",Mr.Accepted],["rejected",Mr.Rejected]]).get(s.action.outcome)??Mr.Rejected,uri:y.revive(s.action.uri),hasRemainingEdits:s.action.hasRemainingEdits,lineCount:s.action.lineCount,linesAdded:s.action.linesAdded,linesRemoved:s.action.linesRemoved},result:n}:{action:s.action,result:n}}e.to=t})(Ny||(Ny={}));var sm;(function(e){function t(i,s,r){return"terminalCommand"in i?{terminalCommand:i.terminalCommand,shouldExecute:i.shouldExecute}:"uri"in i?{uri:i.uri}:s.toInternal(i,r)}e.from=t})(sm||(sm={}));var rm;(function(e){function t(i){return{...i,documentation:pe.fromStrict(i.documentation)}}e.from=t})(rm||(rm={}));var My;(function(e){function t(i,s){return Array.isArray(i)?{items:i.map(r=>rm.from(r))}:{items:i.items.map(r=>rm.from(r)),resourceOptions:i.resourceOptions?Ly.from(i.resourceOptions,s):void 0}}e.from=t})(My||(My={}));var Ly;(function(e){function t(i,s){return{...i,pathSeparator:s,cwd:i.cwd,globPattern:_i.from(i.globPattern)??void 0}}e.from=t})(Ly||(Ly={}));var Ry;(function(e){function t(i){return{kind:Oy.to(i.kind),acceptedLength:i.acceptedLength}}e.to=t})(Ry||(Ry={}));var Oy;(function(e){function t(i){switch(i){case 0:return ba.Word;case 1:return ba.Line;case 2:return ba.Suggest;default:return ba.Unknown}}e.to=t})(Oy||(Oy={}));var Fy;(function(e){function t(i,s){if(i.kind===Hf.Ignored){const r=i.supersededBy?s(i.supersededBy):void 0;return{kind:Uc.Ignored,supersededBy:r,userTypingDisagreed:i.userTypingDisagreed}}else if(i.kind===Hf.Accepted)return{kind:Uc.Accepted};return{kind:Uc.Rejected}}e.to=t})(Fy||(Fy={}));var Uy;(function(e){function t(s){return s===jc.Label?Sc.Label:Sc.Code}e.from=t;function i(s){switch(s){case Sc.Label:return jc.Label;default:return jc.Code}}e.to=i})(Uy||(Uy={}));var jy;(function(e){function t(i,s){return{id:s,label:i.label,description:i.description,canEdit:i.canEdit,collapsibleState:i.collapsibleState||0,contextValue:i.contextValue}}e.from=t})(jy||(jy={}));var zy;(function(e){function t(i){return i.type==="mcp"?new H7(i.label,i.serverLabel||i.label,i.instructions):i.type==="extension"?new z7(i.extensionId.value,i.label):void 0}e.to=t})(zy||(zy={}));var nm;(function(e){function t(s){return new Sg(s.content.map(r=>r.kind==="text"?new zt(r.value,r.audience):r.kind==="data"?new vi(r.value.data.buffer,r.value.mimeType,r.audience):new Lr(r.value)))}e.to=t;function i(s,r){s.toolResultMessage&&T(r,"chatParticipantPrivate");const n=c=>{c.audience&&T(r,"languageModelToolResultAudience")};let o=!1;const a={content:s.content.map(c=>{if(c instanceof zt)return n(c),{kind:"text",value:c.value,audience:c.audience};if(c instanceof Lr)return{kind:"promptTsx",value:c.value};if(c instanceof vi)return n(c),o=!0,{kind:"data",value:{mimeType:c.mimeType,data:W.wrap(c.data)},audience:c.audience};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:pe.fromStrict(s.toolResultMessage),toolResultDetails:s.toolResultDetails?.map(c=>y.isUri(c)?c:Ms.from(c))};return o?new pi(a):a}e.from=i})(nm||(nm={}));var G7;(function(e){function t(s){const r=new j7(s.content.map(n=>n.kind==="text"?new zt(n.value,n.audience):n.kind==="data"?new vi(n.value.data.buffer,n.value.mimeType,n.audience):new Lr(n.value)));return s.toolMetadata&&(r.toolMetadata=s.toolMetadata),r}e.to=t;function i(s,r){s.toolResultMessage&&T(r,"chatParticipantPrivate");const n=l=>{l.audience&&T(r,"languageModelToolResultAudience")};let o=!1,a;Array.isArray(s.toolResultDetails)?a=s.toolResultDetails?.map(l=>y.isUri(l)?l:Ms.from(l)):s.toolResultDetails2&&(a={output:{type:"data",mimeType:s.toolResultDetails2.mime,value:W.wrap(s.toolResultDetails2.value)}},o=!0);const c={content:s.content.map(l=>{if(l instanceof zt)return n(l),{kind:"text",value:l.value,audience:l.audience};if(l instanceof Lr)return{kind:"promptTsx",value:l.value};if(l instanceof vi)return n(l),o=!0,{kind:"data",value:{mimeType:l.mimeType,data:W.wrap(l.data)},audience:l.audience};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:pe.fromStrict(s.toolResultMessage),toolResultDetails:a,toolMetadata:s.toolMetadata};return o?new pi(c):c}e.from=i})(G7||(G7={}));var yo;(function(e){function t(r){return r}e.fromThemeIcon=t;function i(r){if(r){if(Dt.isThemeIcon(r))return r;if(y.isUri(r))return r;if(typeof r=="string")return y.file(r);if(typeof r=="object"&&r!==null&&"dark"in r){const n=typeof r.dark=="string"?y.file(r.dark):r.dark,o=typeof r.light=="string"?y.file(r.light):r.light;return n?{dark:n,light:o??n}:void 0}else return}else return}e.from=i;function s(r){if(r){if(Dt.isThemeIcon(r))return r;if(ff(r))return y.revive(r);{const n=r;return{light:y.revive(n.light),dark:y.revive(n.dark)}}}else return}e.to=s})(yo||(yo={}));var Hy;(function(e){function t(s){return{query:s.query,kind:i(s.kind),settings:s.settings}}e.fromSettingsSearchResult=t;function i(s){switch(s){case ro.EMBEDDED:return ro.EMBEDDED;case ro.LLM_RANKED:return ro.LLM_RANKED;case ro.CANCELED:return ro.CANCELED;default:throw new Error("Unknown AiSettingsSearchResultKind")}}})(Hy||(Hy={}));var Wh;(function(e){function t(s){return!!s.uri}function i(s){return Hu.toSerialized(t(s)?{type:2,uri:s.uri,headers:Object.entries(s.headers),authentication:s.authentication?{providerId:s.authentication.providerId,scopes:s.authentication.scopes}:void 0}:{type:1,cwd:s.cwd?.fsPath,args:s.args,command:s.command,env:s.env,envFile:void 0})}e.from=i})(Wh||(Wh={}));var Wy;(function(e){function t(i){switch(i){case Vc.Error:return 0;case Vc.Warning:return 1;case Vc.Information:return 2;default:throw new Error("Unknown SourceControlInputBoxValidationType")}}e.from=t})(Wy||(Wy={}));var J7=class O5{constructor(t,i){this.line=t,this.character=i}isBefore(t){return!1}isBeforeOrEqual(t){return!1}isAfter(t){return!1}isAfterOrEqual(t){return!1}isEqual(t){return!1}compareTo(t){return 0}translate(t,i){return new O5(0,0)}with(t){return new O5(0,0)}},Z7=class F5{constructor(t,i,s,r){this.isEmpty=!1,this.isSingleLine=!1,this.start=new J7(t,i),this.end=new J7(s,r)}contains(t){return!1}isEqual(t){return!1}intersection(t){}union(t){return new F5(0,0,0,0)}with(t){return new F5(0,0,0,0)}},fn=class{constructor(e,t,i){this.uri=e,this.ranges=t,this.previewText=i}},om=class{constructor(e,t,i){this.uri=e,this.text=t,this.lineNumber=i}},By=class{constructor(e){this.keyword=e}},pn;(function(e){e[e.None=1]="None",e[e.FilesExclude=2]="FilesExclude",e[e.SearchAndFilesExclude=3]="SearchAndFilesExclude"})(pn||(pn={}));var am;(function(e){e[e.Information=1]="Information",e[e.Warning=2]="Warning"})(am||(am={}));var cm=2e4,Q7="\u27EA ",Y7=" characters skipped \u27EB",DB=(Q7.length+Y7.length+5)*2,ere=H("searchService"),X7;(function(e){e[e.file=0]="file",e[e.text=1]="text",e[e.aiText=2]="aiText"})(X7||(X7={}));var K7;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.aiText=3]="aiText"})(K7||(K7={}));function _y(e){return!!e.rangeLocations&&!!e.previewText}var eD;(function(e){e[e.Normal=0]="Normal",e[e.NewSearchStarted=1]="NewSearchStarted"})(eD||(eD={}));var tD=class{constructor(e,t,i,s){this.rangeLocations=[],this.webviewIndex=s;const r=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&PB(r)){e=D2(e,i.matchLines);let n="",o=0,a=0;const c=Math.floor(i.charsPerLine/5);for(const l of r){const u=Math.max(l.startColumn-c,0),h=l.startColumn+i.charsPerLine;if(u>a+c+DB){const f=Q7+(u-a)+Y7;n+=f+e.slice(u,h),o+=u-(a+f.length)}else n+=e.slice(a,h);a=h,this.rangeLocations.push({source:l,preview:new TB(0,l.startColumn-o,l.endColumn-o)})}this.previewText=n}else{const n=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber,o=Xd(t,a=>({preview:new Vy(a.startLineNumber-n,a.startColumn,a.endLineNumber-n,a.endColumn),source:a}));this.rangeLocations=Array.isArray(o)?o:[o],this.previewText=e}}};function PB(e){const t=e[0].startLineNumber;for(const i of e)if(i.startLineNumber!==t||i.endLineNumber!==t)return!1;return!0}var Vy=class{constructor(e,t,i,s){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=s}},TB=class extends Vy{constructor(e,t,i){super(e,t,e,i)}},iD;(function(e){e.List="list",e.Tree="tree"})(iD||(iD={}));var sD;(function(e){e.Default="default",e.FileNames="fileNames",e.Type="type",e.Modified="modified",e.CountDescending="countDescending",e.CountAscending="countAscending"})(sD||(sD={}));var rD;(function(e){e.Auto="auto",e.Manual="manual",e.RunOnEmpty="runOnEmpty"})(rD||(rD={}));function NB(e,t=!0){const i=e&&e.files&&e.files.exclude,s=t&&e&&e.search&&e.search.exclude;if(!i&&!s)return;if(!i||!s)return i||s||void 0;let r=Object.create(null);return r=en(r,ot(i)),r=en(r,ot(s),!0),r}function nD(e,t){return e.excludePattern&&ua(e.excludePattern,t)?!1:e.includePattern||e.usingSearchPaths?e.includePattern&&ua(e.includePattern,t)?!0:e.usingSearchPaths?!!e.folderQueries&&e.folderQueries.some(i=>{const s=i.folder.fsPath;if(Vo(t,s)){const r=ac(s,t);return!i.includePattern||!!ua(i.includePattern,r)}else return!1}):!1:!0}var Ao;(function(e){e[e.unknownEncoding=1]="unknownEncoding",e[e.regexParseError=2]="regexParseError",e[e.globParseError=3]="globParseError",e[e.invalidLiteral=4]="invalidLiteral",e[e.rgProcessError=5]="rgProcessError",e[e.other=6]="other",e[e.canceled=7]="canceled"})(Ao||(Ao={}));var Fa=class extends Error{constructor(e,t){super(e),this.code=t}};function oD(e){const t={message:e.message,code:e.code};return new Error(JSON.stringify(t))}function MB(e){return!!e.path}function qy(e,t,i=!0){const s=e.searchPath?e.searchPath:e.relativePath;return i?$2(s,t):ua(t,s)}function Sl(e,t){const i={...e||{},...t||{}};return Object.keys(i).filter(s=>{const r=i[s];return typeof r=="boolean"&&r})}var aD=class{constructor(e,t){this.c=null,this.a=t.excludePattern?.map(s=>({...e.excludePattern||{},...s.pattern||{}}))??[],this.a.length===0&&(this.a=[e.excludePattern||{}]),this.b=this.a.map(s=>tr(s));let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this.c=tr(i))}d(e,t,i){let s=null;for(const r of this.b){const n=r(e,t,i);if(typeof n=="string"){s=n;break}}return s}matchesExcludesSync(e,t,i){return!!(this.b&&this.d(e,t,i))}includedInQuerySync(e,t,i){return!(this.b&&this.d(e,t,i)||this.c&&!this.c(e,t,i))}includedInQuery(e,t,i){const s=()=>this.c?!!this.c(e,t,i):!0;return Promise.all(this.b.map(r=>{const n=r(e,t,i);return Hn(n)?n.then(o=>o?!1:s()):s()})).then(r=>r.some(n=>!!n))}hasSiblingExcludeClauses(){return this.a.reduce((e,t)=>LB(t)||e,!1)}};function LB(e){for(const t in e)if(typeof e[t]!="boolean")return!0;return!1}function RB(e){if(!e)return;let t;return i=>(t||(t=(e()||Promise.resolve([])).then(s=>s?cD(s):{})),t.then(s=>!!s[i]))}function Gy(e){if(!e)return;let t;return i=>{if(!t){const s=e();t=s?cD(s):{}}return!!t[i]}}function cD(e){const t={};for(const i of e)t[i]=!0;return t}function lD(e){return e.flatMap(t=>t.patterns.map(i=>t.baseUri?{baseUri:t.baseUri,pattern:i}:i))}var Jy={matchLines:100,charsPerLine:1e4},OB=!1,FB=class{constructor(e,t,i){this.id=e,this.dependencies=t,this.callback=i}},Ua;(function(e){e[e.Uninitialized=1]="Uninitialized",e[e.InitializedInternal=2]="InitializedInternal",e[e.InitializedExternal=3]="InitializedExternal"})(Ua||(Ua={}));var UB=class $M{static{this.INSTANCE=new $M}constructor(){this.a=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope",this.b=typeof document=="object",this.c=[],this.d=Ua.Uninitialized}g(){if(this.d===Ua.Uninitialized){if(globalThis.define){this.d=Ua.InitializedExternal;return}}else return;this.d=Ua.InitializedInternal,globalThis.define=(t,i,s)=>{typeof t!="string"&&(s=i,i=t,t=null),(typeof i!="object"||!Array.isArray(i))&&(s=i,i=null),this.c.push(new FB(t,i,s))},globalThis.define.amd=!0,this.b?this.f=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${V.vscodeFileResource}://${lx}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this.a&&(this.f=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this.g(),this.d===Ua.InitializedExternal)return new Promise(o=>{const a=Nt();globalThis.define(a,[t],function(c){o(c)})});const i=await(this.a?this.i(t):this.b?this.h(t):this.j(t));if(!i){console.warn(`Did not receive a define call from script ${t}`);return}const s={},r=[],n=[];if(Array.isArray(i.dependencies))for(const o of i.dependencies)o==="exports"?r.push(s):n.push(o);if(n.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${n.join(", ")}`);return typeof i.callback=="function"?i.callback(...r)??s:i.callback}h(t){return new Promise((i,s)=>{const r=document.createElement("script");r.setAttribute("async","async"),r.setAttribute("type","text/javascript");const n=()=>{r.removeEventListener("load",o),r.removeEventListener("error",a)},o=c=>{n(),i(this.c.pop())},a=c=>{n(),s(c)};r.addEventListener("load",o),r.addEventListener("error",a),this.f&&(t=this.f.createScriptURL(t)),r.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(r)})}async i(t){return this.f&&(t=this.f.createScriptURL(t)),await import(t),this.c.pop()}async j(t){try{const i=(await import("fs")).default,s=(await import("vm")).default,r=(await import("module")).default,n=y.parse(t).fsPath,o=i.readFileSync(n).toString(),a=r.wrap(o.replace(/^#!.*/,""));return new s.Script(a).runInThisContext().apply(),this.c.pop()}catch(i){throw i}}},Zy=new Map;async function Qy(e,t,i){i===void 0&&(i=!!(globalThis._VSCODE_PRODUCT_JSON??globalThis.vscode?.context?.configuration()?.product)?.commit);const s=t?`${e}/${t}`:e;if(Zy.has(s))return Zy.get(s);let r;if(/^\w[\w\d+.-]*:\/\//.test(s))r=s;else{const c=`${OB&&i&&!Uo?K2:X2}/${s}`;r=mf.asBrowserUri(c).toString(!0)}const n=UB.INSTANCE.load(r);return Zy.set(s,n),n}var lm="utf8",Yy="utf8bom",um="utf16be",hm="utf16le",dm=[254,255],Xy=[255,254],Bh=[239,187,191],jB=512,zB=512,HB=512*8,WB=512*128,uD;(function(e){e[e.STREAM_IS_BINARY=1]="STREAM_IS_BINARY"})(uD||(uD={}));var BB=class extends Error{constructor(e,t){super(e),this.decodeStreamErrorKind=t}},_B=class IM{static async create(t){let i;if(t!==lm)i=(await Qy("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getDecoder(hD(t));else{const s=new TextDecoder;i={write(r){return s.decode(r,{stream:!0})},end(){return s.decode()}}}return new IM(i)}constructor(t){this.a=t}write(t){return this.a.write(t)}end(){return this.a.end()}};function VB(e,t){const i=t.minBytesRequiredForDetection??(t.guessEncoding?HB:zB);return new Promise((s,r)=>{const n=bf(h=>h.join("")),o=[];let a=0,c;const l=new Qe,u=async()=>{try{const h=await t_({buffer:W.concat(o),bytesRead:a},t.guessEncoding,t.candidateGuessEncodings);if(h.seemsBinary&&t.acceptTextOnly)throw new BB("Stream is binary but only text is accepted for decoding",1);h.encoding=await t.overwriteEncoding(h.encoding),c=await _B.create(h.encoding);const f=c.write(W.concat(o).buffer);n.write(f),o.length=0,a=0,s({stream:n,detected:h})}catch(h){l.cancel(),n.destroy(),r(h)}};Xv(e,{onData:async h=>{c?n.write(c.write(h.buffer)):(o.push(h),a+=h.byteLength,a>=i&&(e.pause(),await u(),setTimeout(()=>e.resume())))},onError:h=>n.error(h),onEnd:async()=>{c||await u(),n.end(c?.end())}},l.token)})}async function qB(e,t,i){const r=(await Qy("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getEncoder(hD(t),i);let n=!1,o=!1;return{read(){if(o)return null;const a=e.read();if(typeof a!="string"){if(o=!0,!n&&i?.addBOM)switch(t){case lm:case Yy:return W.wrap(Uint8Array.from(Bh));case um:return W.wrap(Uint8Array.from(dm));case hm:return W.wrap(Uint8Array.from(Xy))}const c=r.end();return c&&c.length>0?(n=!0,W.wrap(c)):null}return n=!0,W.wrap(r.write(a))}}}function hD(e){return e===Yy||e===null?lm:e}function GB(e,t){if(!e||t<dm.length)return null;const i=e.readUInt8(0),s=e.readUInt8(1);if(i===dm[0]&&s===dm[1])return um;if(i===Xy[0]&&s===Xy[1])return hm;if(t<Bh.length)return null;const r=e.readUInt8(2);return i===Bh[0]&&s===Bh[1]&&r===Bh[2]?Yy:null}var JB=["ascii","utf-16","utf-32"];async function ZB(e,t){const i=await Qy("jschardet","dist/jschardet.min.js"),s=e.slice(0,WB),r=KB(s.buffer);t&&(t=gt(t.map(a=>XB(a))),t.length===0&&(t=void 0));let n;try{n=i.detect(r,t?{detectEncodings:t}:void 0)}catch{return null}if(!n?.encoding)return null;const o=n.encoding.toLowerCase();return 0<=JB.indexOf(o)?null:YB(n.encoding)}var QB={ibm866:"cp866",big5:"cp950"};function dD(e){return e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function YB(e){const t=dD(e);return QB[t]||t}function XB(e){const t=dD(e),i=i_[t];return i?i.guessableName:void 0}function KB(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}function e_(e){switch(e){case"shiftjis":return"shift-jis";case"utf16le":return"utf-16le";case"utf16be":return"utf-16be";case"big5hkscs":return"big5-hkscs";case"eucjp":return"euc-jp";case"euckr":return"euc-kr";case"koi8r":return"koi8-r";case"koi8u":return"koi8-u";case"macroman":return"x-mac-roman";case"utf8bom":return"utf8";default:{const t=e.match(/windows(\d+)/);return t?"windows-"+t[1]:e}}}function t_({buffer:e,bytesRead:t},i,s){let r=GB(e,t),n=!1;if(r!==um&&r!==hm&&e){let o=!0,a=!0,c=!1;for(let l=0;l<t&&l<jB;l++){const u=l%2===1,h=e.readUInt8(l)===0;if(h&&(c=!0),o&&(u&&!h||!u&&h)&&(o=!1),a&&(u&&h||!u&&!h)&&(a=!1),h&&!o&&!a)break}c&&(o?r=hm:a?r=um:n=!0)}return i&&!n&&!r&&e?ZB(e.slice(0,t),s).then(o=>({seemsBinary:!1,encoding:o})):{seemsBinary:n,encoding:r}}var Ky={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},cp1125:{labelLong:"Cyrillic (CP 1125)",labelShort:"CP 1125",order:21,guessableName:"IBM1125"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:22,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:23,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:24},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:25},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:26,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:27,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:28,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:29,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:30},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:31},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:32},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:33},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:34},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:35},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:36},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:37,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:38},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:39,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:40,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:41,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:42},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:43},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:44},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:45},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:46,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:47},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:48}},i_=(()=>{const e={};for(const t in Ky)Ky[t].guessableName&&(e[t]=Ky[t]);return e})(),tre=H("textFileService"),fD;(function(e){e[e.FILE_IS_BINARY=0]="FILE_IS_BINARY"})(fD||(fD={}));var pD;(function(e){e[e.SAVED=0]="SAVED",e[e.DIRTY=1]="DIRTY",e[e.PENDING_SAVE=2]="PENDING_SAVE",e[e.CONFLICT=3]="CONFLICT",e[e.ORPHAN=4]="ORPHAN",e[e.ERROR=5]="ERROR"})(pD||(pD={}));var gD;(function(e){e[e.EDITOR=1]="EDITOR",e[e.REFERENCE=2]="REFERENCE",e[e.OTHER=3]="OTHER"})(gD||(gD={}));var mD;(function(e){e[e.Encode=0]="Encode",e[e.Decode=1]="Decode"})(mD||(mD={}));function s_(e){let t=!1;return{read(){return t?null:(t=!0,e)}}}function _h(e,t,i){return new uc(s=>fm(s,i)).isEqual(e,t)}function r_(e,t,i){return _h(e.uri,t.uri,i)?0:_o(e.uri.toString(),t.uri.toString())}function n_(e,t,i){return e.index!==t.index?e.index<t.index?-1:1:_h(e.uri,t.uri,i)?_o(e.name,t.name):_o(e.uri.toString(),t.uri.toString())}function vD(e,t,i,s){const r=e.slice(0).sort((o,a)=>i(o,a,s)),n=t.slice(0).sort((o,a)=>i(o,a,s));return KL(r,n,(o,a)=>i(o,a,s))}function fm(e,t){const i=t.getCapabilities(e.scheme);return!(i&&i&1024)}var eA=class U5 extends Ej{static toExtHostWorkspace(t,i,s,r){if(!t)return{workspace:null,added:[],removed:[]};const{id:n,name:o,folders:a,configuration:c,transient:l,isUntitled:u}=t,h=[],f=i;i?a.forEach((b,S)=>{const E=y.revive(b.uri),k=U5.o(s||i,E,r);k?(k.name=b.name,k.index=b.index,h.push(k)):h.push({uri:E,name:b.name,index:S})}):h.push(...a.map(({uri:b,name:S,index:E})=>({uri:y.revive(b),name:S,index:E}))),h.sort((b,S)=>b.index<S.index?-1:1);const p=new U5(n,o,h,!!l,c?y.revive(c):null,!!u,b=>fm(b,r)),{added:g,removed:v}=vD(f?f.workspaceFolders:[],p.workspaceFolders,r_,r);return{workspace:p,added:g,removed:v}}static o(t,i,s){for(let r=0;r<t.folders.length;r++){const n=t.workspaceFolders[r];if(_h(n.uri,i,s))return n}}constructor(t,i,s,r,n,o,a){super(t,s.map(c=>new F0(c)),r,n,a),this.t=i,this.u=o,this.q=[],this.s=Zn.forUris(a,()=>!0),s.forEach(c=>{this.q.push(c),this.s.set(c.uri,c)})}get name(){return this.t}get isUntitled(){return this.u}get workspaceFolders(){return this.q.slice(0)}getWorkspaceFolder(t,i){return i&&this.s.get(t)&&(t=dc(t)),this.s.findSubstr(t)}resolveWorkspaceFolder(t){return this.s.get(t)}},tA=class{constructor(t,i,s,r,n){this.c=new I,this.onDidChangeWorkspace=this.c.event,this.g=new I,this.onDidGrantWorkspaceTrust=this.g.event,this.u=[],this.v=!1,this.w=new Map,this.B=0,this.C=new cu,this.D=new Map,this.h=r,this.s=s,this.t=n,this.j=new wj,this.k=new ps,this.o=t.getProxy(Y.MainThreadWorkspace),this.q=t.getProxy(Y.MainThreadMessageService);const o=i.workspace;this.l=o?new eA(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,a=>fm(a,s)):void 0}$initializeWorkspace(t,i){this.v=i,this.$acceptWorkspaceData(t),this.k.open()}waitForInitializeCall(){return this.k.wait()}get workspace(){return this.x}get name(){return this.x?this.x.name:void 0}get workspaceFile(){if(this.x&&this.x.configuration)return this.x.isUntitled?y.from({scheme:V.untitled,path:Li(dc(this.x.configuration))}):this.x.configuration}get x(){return this.n||this.l}getWorkspaceFolders(){if(this.x)return this.x.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this.k.wait(),!!this.x)return this.x.workspaceFolders.slice(0)}updateWorkspaceFolders(t,i,s,...r){const n=[];if(Array.isArray(r)&&r.forEach(u=>{y.isUri(u.uri)&&!n.some(h=>_h(h.uri,u.uri,this.s))&&n.push({uri:u.uri,name:u.name||Zv(u.uri)})}),this.n||[i,s].some(u=>typeof u!="number"||u<0)||s===0&&n.length===0)return!1;const o=this.x?this.x.workspaceFolders:[];if(i+s>o.length)return!1;const a=o.slice(0);a.splice(i,s,...n.map(u=>({uri:u.uri,name:u.name||Zv(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const h=a[u];if(a.some((f,p)=>p!==u&&_h(h.uri,f.uri,this.s)))return!1}a.forEach((u,h)=>u.index=h);const{added:c,removed:l}=vD(o,a,n_,this.s);if(c.length===0&&l.length===0)return!1;if(this.o){const u=t.displayName||t.name;this.o.$updateWorkspaceFolders(u,i,s,n).then(void 0,h=>{this.n=void 0;const f={source:{identifier:t.identifier,label:t.displayName||t.name}};this.q.$showMessage(yj.Error,d(3054,null,u,h.toString()),f,[])})}return this.y(a),!0}getWorkspaceFolder(t,i){if(this.x)return this.x.getWorkspaceFolder(t,i)}async getWorkspaceFolder2(t,i){if(await this.k.wait(),!!this.x)return this.x.getWorkspaceFolder(t,i)}async resolveWorkspaceFolder(t){if(await this.k.wait(),!!this.x)return this.x.resolveWorkspaceFolder(t)}getPath(){if(!this.x)return;const{folders:t}=this.x;if(t.length!==0)return t[0].uri.fsPath}getRelativePath(t,i){let s,r="";if(typeof t=="string"?(s=y.file(t),r=t):typeof t<"u"&&(s=t,r=t.fsPath),!s)return r;const n=this.getWorkspaceFolder(s,!0);if(!n)return r;typeof i>"u"&&this.x&&(i=this.x.folders.length>1);let o=dx(n.uri,s);return i&&n.name&&(o=`${n.name}/${o}`),o}y(t){this.x&&(this.n=eA.toExtHostWorkspace({id:this.x.id,name:this.x.name,configuration:this.x.configuration,folders:t,isUntitled:this.x.isUntitled},this.x,void 0,this.s).workspace||void 0)}$acceptWorkspaceData(t){const{workspace:i,added:s,removed:r}=eA.toExtHostWorkspace(t,this.l,this.n,this.s);this.l=i||void 0,this.n=void 0,this.c.fire(Object.freeze({added:s,removed:r}))}findFiles(t,i,s,r,n=Fe.None){this.h.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${r.value}, entryPoint: findFiles`);let o="",a=!0;return i===null?a=!1:i!==void 0&&(typeof i=="string"?o=i:o=i.pattern),this.z({type:"include",value:t},{exclude:[o],maxResults:s,useExcludeSettings:a?pn.FilesExclude:pn.None,useIgnoreFiles:{local:!1}},n)}findFiles2(t,i={},s,r=Fe.None){return this.h.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${s.value}, entryPoint: findFiles2New`),this.z({type:"filePatterns",value:t},i,r)}async z(t,i,s){if(s.isCancellationRequested)return Promise.resolve([]);const r=t.type==="include"?[t.value]:t.value??[];if(!Array.isArray(r))throw console.error("Invalid file pattern provided",r),new Error(`Invalid file pattern provided ${JSON.stringify(r)}`);const n=r.map(o=>{const a=wD(i.exclude),c={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===pn.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==pn.SearchAndFilesExclude,maxResults:i.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:t.type==="include"?void 0:!0},l=pm(_i.from(o)),u=l?.folder;return t.type==="include"?c.includePattern=l?.pattern:c.filePattern=l?.pattern,{folder:u,options:c}});return this.A(n,s)}async A(t,i){const r=(await Promise.all(t?.map(a=>this.o.$startFileSearch(a.folder??null,a.options,i).then(c=>Array.isArray(c)?c.map(l=>y.revive(l)):[]))??[])).flat(),n=new uc(a=>fm(a,this.s)),o=new Map;for(const a of r){const c=n.getComparisonKey(a);o.has(c)||o.set(c,a)}return Array.from(o.values())}findTextInFiles2(t,i,s,r=Fe.None){this.h.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${s.value}, entryPoint: findTextInFiles2`);const n=f=>{if(!i)return{folder:void 0,options:{}};const p=f?pm(_i.from(f)):void 0,g=i.exclude?wD(i.exclude):void 0;return{options:{ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles?.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===pn.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==pn.SearchAndFilesExclude,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:i.previewOptions?{matchLines:i.previewOptions?.numMatchLines??100,charsPerLine:i.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:i.surroundingContext,includePattern:p?.pattern,excludePattern:g},folder:p?.folder}},a=(i?.include?.map(f=>n(f))??[n(void 0)]).filter(f=>!!f),c=new ie,l=c.add(new I),u=this.findTextInFilesBase(t,a,(f,p)=>l.fire({result:f,uri:p}),r);return{results:new $x(async f=>{c.add(l.event(p=>{const g=p.result,v=p.uri;_y(g)?f.emitOne(new fn(v,g.rangeLocations.map(b=>({previewRange:new xe(b.preview.startLineNumber,b.preview.startColumn,b.preview.endLineNumber,b.preview.endColumn),sourceRange:new xe(b.source.startLineNumber,b.source.startColumn,b.source.endLineNumber,b.source.endColumn)})),g.previewText)):f.emitOne(new om(v,g.text,g.lineNumber))})),await u}),complete:u.then(f=>(c.dispose(),{limitHit:f?.limitHit??!1}))}}async findTextInFilesBase(t,i,s,r=Fe.None){const n=this.j.getNext();let o=!1;if(r.onCancellationRequested(a=>{o=!0}),this.u[n]=a=>{if(o)return;const c=y.revive(a.resource);a.results.forEach(l=>{const u=Zt(l);s(u,c)})},r.isCancellationRequested)return{};try{const a=await Promise.all(i?.map(c=>this.o.$startTextSearch(t,c.folder??null,c.options,n,r)||{})??[]);return delete this.u[n],a.reduce((c,l)=>({limitHit:c?.limitHit||(l?.limitHit??!1),message:[c?.message??[],l?.message??[]].flat()}),{})??{limitHit:!1}}catch(a){throw delete this.u[n],a}}async findTextInFiles(t,i,s,r,n=Fe.None){this.h.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${r.value}, entryPoint: findTextInFiles`);const o=typeof i.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:i.previewOptions,a=pm(_i.from(i.include)),c=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,l={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof i.useSearchExclude=="boolean"?!i.useSearchExclude:!0,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:o,surroundingContext:i.afterContext,includePattern:a?.pattern,excludePattern:c?[{pattern:c}]:void 0},u=(h,f)=>{_y(h)?s({uri:f,preview:{text:h.previewText,matches:Xd(h.rangeLocations,p=>new xe(p.preview.startLineNumber,p.preview.startColumn,p.preview.endLineNumber,p.preview.endColumn))},ranges:Xd(h.rangeLocations,p=>new xe(p.source.startLineNumber,p.source.startColumn,p.source.endLineNumber,p.source.endColumn))}):s({uri:f,text:h.text,lineNumber:h.lineNumber})};return this.findTextInFilesBase(t,[{options:l,folder:a?.folder}],u,n)}$handleTextSearchResult(t,i){this.u[i]?.(t)}async save(t){const i=await this.o.$save(t,{saveAs:!1});return y.revive(i)}async saveAs(t){const i=await this.o.$save(t,{saveAs:!0});return y.revive(i)}saveAll(t){return this.o.$saveAll(t)}resolveProxy(t){return this.o.$resolveProxy(t)}lookupAuthorization(t){return this.o.$lookupAuthorization(t)}lookupKerberosAuthorization(t){return this.o.$lookupKerberosAuthorization(t)}loadCertificates(){return this.o.$loadCertificates()}get trusted(){return this.v}requestWorkspaceTrust(t){return this.o.$requestWorkspaceTrust(t)}$onDidGrantWorkspaceTrust(){this.v||(this.v=!0,this.g.fire())}registerEditSessionIdentityProvider(t,i){if(this.w.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this.w.set(t,i);const s=this.t.transformOutgoingScheme(t),r=this.B++;return this.o.$registerEditSessionIdentityProvider(r,s),te(()=>{this.w.delete(t),this.o.$unregisterEditSessionIdentityProvider(r)})}async $getEditSessionIdentifier(t,i){this.h.info("Getting edit session identifier for workspaceFolder",t);const s=await this.resolveWorkspaceFolder(y.revive(t));if(!s){this.h.warn("Unable to resolve workspace folder");return}this.h.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const r=this.w.get(s.uri.scheme);if(this.h.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!r),!r)return;const n=await r.provideEditSessionIdentity(s,i);if(this.h.info("Provider returned edit session identifier: ",n),!!n)return n}async $provideEditSessionIdentityMatch(t,i,s,r){this.h.info("Getting edit session identifier for workspaceFolder",t);const n=await this.resolveWorkspaceFolder(y.revive(t));if(!n){this.h.warn("Unable to resolve workspace folder");return}this.h.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const o=this.w.get(n.uri.scheme);if(this.h.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!o),!o)return;const a=await o.provideEditSessionIdentityMatch?.(i,s,r);if(this.h.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(t){return(i,s,r)=>{const n=function(a){i.call(s,a)};return n.extension=t,this.C.event(n,void 0,r)}}async $onWillCreateEditSessionIdentity(t,i,s){const r=await this.resolveWorkspaceFolder(y.revive(t));if(r===void 0)throw new Error("Unable to resolve workspace folder");await this.C.fireAsync({workspaceFolder:r},i,async(n,o)=>{const a=Date.now();await Promise.resolve(n),Date.now()-a>s&&this.h.warn("SLOW edit session create-participant",o.extension.identifier)}),i.isCancellationRequested}registerCanonicalUriProvider(t,i){if(this.D.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this.D.set(t,i);const s=this.t.transformOutgoingScheme(t),r=this.B++;return this.o.$registerCanonicalUriProvider(r,s),te(()=>{this.D.delete(t),this.o.$unregisterCanonicalUriProvider(r)})}async provideCanonicalUri(t,i,s){const r=this.D.get(t.scheme);if(!r)return;const n=await r.provideCanonicalUri?.(y.revive(t),i,s);if(n)return n}async $provideCanonicalUri(t,i,s){return this.provideCanonicalUri(y.revive(t),{targetScheme:i},s)}async decode(t,i){const[s,r]=this.F(i),n=await this.o.$resolveDecoding(s,r),o=(await VB(PO(W.wrap(t)),{...n,acceptTextOnly:!0,overwriteEncoding:a=>a===null||a===n.preferredEncoding?Promise.resolve(n.preferredEncoding):this.o.$validateDetectedEncoding(s,a,r)})).stream;return Ix(o,a=>a.join(""))}async encode(t,i){const[s,r]=this.F(i),{encoding:n,addBOM:o}=await this.o.$resolveEncoding(s,r);if(n===lm&&!o)return W.fromString(t).buffer;const a=await qB(s_(t),n,{addBOM:o});return DO(a).buffer}F(t){const i=ff(t?.uri)?t.uri:void 0,s=typeof t?.encoding=="string"?t.encoding:void 0;return[i,s?{encoding:s}:void 0]}};tA=__decorate([__param(0,ke),__param(1,jt),__param(2,yc),__param(3,Se),__param(4,Cu)],tA);var Rs=H("IExtHostWorkspace");function pm(e){let t,i;if(e)return typeof e=="string"?t=e:(t=e.pattern,i=y.revive(e.baseUri)),{pattern:t,folder:i}}function wD(e){return(e?.map(t=>{if(typeof t=="string")return t===""?void 0:{pattern:t,uri:void 0};{const i=pm(t);return i?{pattern:i.pattern,uri:i.folder}:void 0}})??[]).filter(t=>!!t)}var bD;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(bD||(bD={}));var yD;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(yD||(yD={}));var AD;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(AD||(AD={}));var iA;(function(e){e.DEFAULT={allowTrailingComma:!0}})(iA||(iA={}));function o_(e,t=!1){let i=0;const s=e.length;let r="",n=0,o=16,a=0;function c(v){let b=0,S=0;for(;b<v;){const E=e.charCodeAt(i);if(E>=48&&E<=57)S=S*16+E-48;else if(E>=65&&E<=70)S=S*16+E-65+10;else if(E>=97&&E<=102)S=S*16+E-97+10;else break;i++,b++}return b<v&&(S=-1),S}function l(v){i=v,r="",n=0,o=16,a=0}function u(){const v=i;if(e.charCodeAt(i)===48)i++;else for(i++;i<e.length&&El(e.charCodeAt(i));)i++;if(i<e.length&&e.charCodeAt(i)===46)if(i++,i<e.length&&El(e.charCodeAt(i)))for(i++;i<e.length&&El(e.charCodeAt(i));)i++;else return a=3,e.substring(v,i);let b=i;if(i<e.length&&(e.charCodeAt(i)===69||e.charCodeAt(i)===101))if(i++,(i<e.length&&e.charCodeAt(i)===43||e.charCodeAt(i)===45)&&i++,i<e.length&&El(e.charCodeAt(i))){for(i++;i<e.length&&El(e.charCodeAt(i));)i++;b=i}else a=3;return e.substring(v,b)}function h(){let v="",b=i;for(;;){if(i>=s){v+=e.substring(b,i),a=2;break}const S=e.charCodeAt(i);if(S===34){v+=e.substring(b,i),i++;break}if(S===92){if(v+=e.substring(b,i),i++,i>=s){a=2;break}switch(e.charCodeAt(i++)){case 34:v+='"';break;case 92:v+="\\";break;case 47:v+="/";break;case 98:v+="\b";break;case 102:v+="\f";break;case 110:v+=`
`;break;case 114:v+="\r";break;case 116:v+="	";break;case 117:{const k=c(4);k>=0?v+=String.fromCharCode(k):a=4;break}default:a=5}b=i;continue}if(S>=0&&S<=31)if(gm(S)){v+=e.substring(b,i),a=2;break}else a=6;i++}return v}function f(){if(r="",a=0,n=i,i>=s)return n=s,o=17;let v=e.charCodeAt(i);if(sA(v)){do i++,r+=String.fromCharCode(v),v=e.charCodeAt(i);while(sA(v));return o=15}if(gm(v))return i++,r+=String.fromCharCode(v),v===13&&e.charCodeAt(i)===10&&(i++,r+=`
`),o=14;switch(v){case 123:return i++,o=1;case 125:return i++,o=2;case 91:return i++,o=3;case 93:return i++,o=4;case 58:return i++,o=6;case 44:return i++,o=5;case 34:return i++,r=h(),o=10;case 47:{const b=i-1;if(e.charCodeAt(i+1)===47){for(i+=2;i<s&&!gm(e.charCodeAt(i));)i++;return r=e.substring(b,i),o=12}if(e.charCodeAt(i+1)===42){i+=2;const S=s-1;let E=!1;for(;i<S;){if(e.charCodeAt(i)===42&&e.charCodeAt(i+1)===47){i+=2,E=!0;break}i++}return E||(i++,a=1),r=e.substring(b,i),o=13}return r+=String.fromCharCode(v),i++,o=16}case 45:if(r+=String.fromCharCode(v),i++,i===s||!El(e.charCodeAt(i)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return r+=u(),o=11;default:for(;i<s&&p(v);)i++,v=e.charCodeAt(i);if(n!==i){switch(r=e.substring(n,i),r){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return r+=String.fromCharCode(v),i++,o=16}}function p(v){if(sA(v)||gm(v))return!1;switch(v){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function g(){let v;do v=f();while(v>=12&&v<=15);return v}return{setPosition:l,getPosition:()=>i,scan:t?g:f,getToken:()=>o,getTokenValue:()=>r,getTokenOffset:()=>n,getTokenLength:()=>i-n,getTokenError:()=>a}}function sA(e){return e===32||e===9||e===11||e===12||e===160||e===5760||e>=8192&&e<=8203||e===8239||e===8287||e===12288||e===65279}function gm(e){return e===10||e===13||e===8232||e===8233}function El(e){return e>=48&&e<=57}var SD;(function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"})(SD||(SD={}));function a_(e,t,i=iA.DEFAULT){const s=o_(e,!1);function r(z){return z?()=>z(s.getTokenOffset(),s.getTokenLength()):()=>!0}function n(z){return z?ue=>z(ue,s.getTokenOffset(),s.getTokenLength()):()=>!0}const o=r(t.onObjectBegin),a=n(t.onObjectProperty),c=r(t.onObjectEnd),l=r(t.onArrayBegin),u=r(t.onArrayEnd),h=n(t.onLiteralValue),f=n(t.onSeparator),p=r(t.onComment),g=n(t.onError),v=i&&i.disallowComments,b=i&&i.allowTrailingComma;function S(){for(;;){const z=s.scan();switch(s.getTokenError()){case 4:E(14);break;case 5:E(15);break;case 3:E(13);break;case 1:v||E(11);break;case 2:E(12);break;case 6:E(16);break}switch(z){case 12:case 13:v?E(10):p();break;case 16:E(1);break;case 15:case 14:break;default:return z}}}function E(z,ue=[],Le=[]){if(g(z),ue.length+Le.length>0){let ae=s.getToken();for(;ae!==17;){if(ue.indexOf(ae)!==-1){S();break}else if(Le.indexOf(ae)!==-1)break;ae=S()}}}function k(z){const ue=s.getTokenValue();return z?h(ue):a(ue),S(),!0}function j(){switch(s.getToken()){case 11:{let z=0;try{z=JSON.parse(s.getTokenValue()),typeof z!="number"&&(E(2),z=0)}catch{E(2)}h(z);break}case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return S(),!0}function O(){return s.getToken()!==10?(E(3,[],[2,5]),!1):(k(!1),s.getToken()===6?(f(":"),S(),B()||E(4,[],[2,5])):E(5,[],[2,5]),!0)}function Q(){o(),S();let z=!1;for(;s.getToken()!==2&&s.getToken()!==17;){if(s.getToken()===5){if(z||E(4,[],[]),f(","),S(),s.getToken()===2&&b)break}else z&&E(6,[],[]);O()||E(4,[],[2,5]),z=!0}return c(),s.getToken()!==2?E(7,[2],[]):S(),!0}function F(){l(),S();let z=!1;for(;s.getToken()!==4&&s.getToken()!==17;){if(s.getToken()===5){if(z||E(4,[],[]),f(","),S(),s.getToken()===4&&b)break}else z&&E(6,[],[]);B()||E(4,[],[4,5]),z=!0}return u(),s.getToken()!==4?E(8,[4],[]):S(),!0}function B(){switch(s.getToken()){case 3:return F();case 1:return Q();case 10:return k(!0);default:return j()}}return S(),s.getToken()===17?i.allowEmptyContent?!0:(E(4,[],[]),!1):B()?(s.getToken()!==17&&E(9,[],[]),!0):(E(4,[],[]),!1)}function Vh(e){return Object.isFrozen(e)?e:f0(e)}var xl=class To{static createEmptyModel(t){return new To({},[],[],void 0,t)}constructor(t,i,s,r,n){this.b=t,this.c=i,this.d=s,this.f=r,this.g=n,this.a=new Map}get rawConfiguration(){if(!this.h)if(this.f){const t=(Array.isArray(this.f)?this.f:[this.f]).map(i=>{if(i instanceof To)return i;const s=new c_("",this.g);return s.parseRaw(i),s.configurationModel});this.h=t.reduce((i,s)=>s===i?s:i.merge(s),t[0])}else this.h=this;return this.h}get contents(){return this.b}get overrides(){return this.d}get keys(){return this.c}get raw(){if(this.f&&!(Array.isArray(this.f)&&this.f.every(t=>t instanceof To)))return this.f}isEmpty(){return this.c.length===0&&Object.keys(this.b).length===0&&this.d.length===0}getValue(t){return t?fp(this.contents,t):this.contents}inspect(t,i){const s=this;return{get value(){return Vh(s.rawConfiguration.getValue(t))},get override(){return i?Vh(s.rawConfiguration.getOverrideValue(t,i)):void 0},get merged(){return Vh(i?s.rawConfiguration.override(i).getValue(t):s.rawConfiguration.getValue(t))},get overrides(){const r=[];for(const{contents:n,identifiers:o,keys:a}of s.rawConfiguration.overrides){const c=new To(n,a,[],void 0,s.g).getValue(t);c!==void 0&&r.push({identifiers:o,value:c})}return r.length?Vh(r):void 0}}}getOverrideValue(t,i){const s=this.k(i);return s?t?fp(s,t):s:void 0}getKeysForOverrideIdentifier(t){const i=[];for(const s of this.overrides)s.identifiers.includes(t)&&i.push(...s.keys);return Tn(i)}getAllOverrideIdentifiers(){const t=[];for(const i of this.overrides)t.push(...i.identifiers);return Tn(t)}override(t){let i=this.a.get(t);return i||(i=this.i(t),this.a.set(t,i)),i}merge(...t){const i=ot(this.contents),s=ot(this.overrides),r=[...this.keys],n=this.f?Array.isArray(this.f)?[...this.f]:[this.f]:[this];for(const o of t)if(n.push(...o.f?Array.isArray(o.f)?o.f:[o.f]:[o]),!o.isEmpty()){this.j(i,o.contents);for(const a of o.overrides){const[c]=s.filter(l=>Ci(l.identifiers,a.identifiers));c?(this.j(c.contents,a.contents),c.keys.push(...a.keys),c.keys=Tn(c.keys)):s.push(ot(a))}for(const a of o.keys)r.indexOf(a)===-1&&r.push(a)}return new To(i,r,s,!n.length||n.every(o=>o instanceof To)?void 0:n,this.g)}i(t){const i=this.k(t);if(!i||typeof i!="object"||!Object.keys(i).length)return this;const s={};for(const r of Tn([...Object.keys(this.contents),...Object.keys(i)])){let n=this.contents[r];const o=i[r];o&&(typeof n=="object"&&typeof o=="object"?(n=ot(n),this.j(n,o)):n=o),s[r]=n}return new To(s,this.keys,this.overrides,void 0,this.g)}j(t,i){for(const s of Object.keys(i)){if(s in t&&At(t[s])&&At(i[s])){this.j(t[s],i[s]);continue}t[s]=ot(i[s])}}k(t){let i=null,s=null;const r=n=>{n&&(s?this.j(s,n):s=ot(n))};for(const n of this.overrides)n.identifiers.length===1&&n.identifiers[0]===t?i=n.contents:n.identifiers.includes(t)&&r(n.contents);return r(i),s}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,i){this.l(t,i,!0)}setValue(t,i){this.l(t,i,!1)}removeValue(t){const i=this.keys.indexOf(t);i!==-1&&(this.keys.splice(i,1),SW(this.contents,t),$r.test(t)&&this.overrides.splice(this.overrides.findIndex(s=>Ci(s.identifiers,Vu(t))),1))}l(t,i,s){if(L6(this.contents,t,i,r=>this.g.error(r)),s=s||this.keys.indexOf(t)===-1,s&&this.keys.push(t),$r.test(t)){const r=this.contents[t],n=Vu(t),o={identifiers:n,keys:Object.keys(r),contents:Mw(r,c=>this.g.error(c))},a=this.overrides.findIndex(c=>Ci(c.identifiers,n));a!==-1?this.overrides[a]=o:this.overrides.push(o)}}},c_=class{constructor(e,t){this.f=e,this.g=t,this.a=null,this.b=null,this.c=[],this.d=[]}get configurationModel(){return this.b||xl.createEmptyModel(this.g)}get restrictedConfigurations(){return this.c}get errors(){return this.d}parse(e,t){if(!Wt(e)){const i=this.h(e);this.parseRaw(i,t)}}reparse(e){this.a&&this.parseRaw(this.a,e)}parseRaw(e,t){this.a=e;const{contents:i,keys:s,overrides:r,restricted:n,hasExcludedProperties:o}=this.i(e,t);this.b=new xl(i,s,r,o?[e]:void 0,this.g),this.c=n||[]}h(e){let t={},i=null,s=[];const r=[],n=[];function o(c){Array.isArray(s)?s.push(c):i!==null&&(s[i]=c)}const a={onObjectBegin:()=>{const c={};o(c),r.push(s),s=c,i=null},onObjectProperty:c=>{i=c},onObjectEnd:()=>{s=r.pop()},onArrayBegin:()=>{const c=[];o(c),r.push(s),s=c,i=null},onArrayEnd:()=>{s=r.pop()},onLiteralValue:o,onError:(c,l,u)=>{n.push({error:c,offset:l,length:u})}};if(e)try{a_(e,a),t=s[0]||{}}catch(c){this.g.error(`Error while parsing settings file ${this.f}: ${c}`),this.d=[c]}return t}i(e,t){const i=Qt.as(oo.Configuration),s=i.getConfigurationProperties(),r=i.getExcludedConfigurationProperties(),n=this.j(e,s,r,!0,t);e=n.raw;const o=Mw(e,l=>this.g.error(`Conflict in settings file ${this.f}: ${l}`)),a=Object.keys(e),c=this.m(e,l=>this.g.error(`Conflict in settings file ${this.f}: ${l}`));return{contents:o,keys:a,overrides:c,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}j(e,t,i,s,r){let n=!1;if(!r?.scopes&&!r?.skipRestricted&&!r?.skipUnregistered&&!r?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:n};const o={},a=[];for(const c in e)if($r.test(c)&&s){const l=this.j(e[c],t,i,!1,r);o[c]=l.raw,n=n||l.hasExcludedProperties,a.push(...l.restricted)}else{const l=t[c];l?.restricted&&a.push(c),this.l(c,l,i,r)?o[c]=e[c]:n=!0}return{raw:o,restricted:a,hasExcludedProperties:n}}l(e,t,i,s){if(s.exclude?.includes(e))return!1;if(s.include?.includes(e))return!0;if(s.skipRestricted&&t?.restricted||s.skipUnregistered&&!t)return!1;const r=t??i[e],n=r?typeof r.scope<"u"?r.scope:4:void 0;return n===void 0||s.scopes===void 0?!0:s.scopes.includes(n)}m(e,t){const i=[];for(const s of Object.keys(e))if($r.test(s)){const r={},n=e[s];for(const o in n)r[o]=n[o];i.push({identifiers:Vu(s),keys:Object.keys(r),contents:Mw(r,t)})}return i}},l_=class{constructor(e,t,i,s,r,n,o,a,c,l,u,h,f){this.a=e,this.b=t,this.c=i,this.overrideIdentifiers=s,this.d=r,this.f=n,this.g=o,this.h=a,this.i=c,this.j=l,this.k=u,this.l=h,this.m=f}get value(){return Vh(this.c)}n(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get q(){return this.p||(this.p=this.d.inspect(this.a,this.b.overrideIdentifier)),this.p}get defaultValue(){return this.q.merged}get default(){return this.n(this.q)}get s(){return this.r===void 0&&(this.r=this.f?this.f.inspect(this.a):null),this.r}get policyValue(){return this.s?.merged}get policy(){return this.s?.value!==void 0?{value:this.s.value}:void 0}get u(){return this.t===void 0&&(this.t=this.g?this.g.inspect(this.a):null),this.t}get applicationValue(){return this.u?.merged}get application(){return this.n(this.u)}get w(){return this.v||(this.v=this.h.inspect(this.a,this.b.overrideIdentifier)),this.v}get userValue(){return this.w.merged}get user(){return this.n(this.w)}get y(){return this.x||(this.x=this.i.inspect(this.a,this.b.overrideIdentifier)),this.x}get userLocalValue(){return this.y.merged}get userLocal(){return this.n(this.y)}get A(){return this.z||(this.z=this.j.inspect(this.a,this.b.overrideIdentifier)),this.z}get userRemoteValue(){return this.A.merged}get userRemote(){return this.n(this.A)}get D(){return this.B===void 0&&(this.B=this.k?this.k.inspect(this.a,this.b.overrideIdentifier):null),this.B}get workspaceValue(){return this.D?.merged}get workspace(){return this.n(this.D)}get F(){return this.E===void 0&&(this.E=this.l?this.l.inspect(this.a,this.b.overrideIdentifier):null),this.E}get workspaceFolderValue(){return this.F?.merged}get workspaceFolder(){return this.n(this.F)}get H(){return this.G===void 0&&(this.G=this.m.inspect(this.a,this.b.overrideIdentifier)),this.G}get memoryValue(){return this.H.merged}get memory(){return this.n(this.H)}},rA=class DM{constructor(t,i,s,r,n,o,a,c,l,u){this.j=t,this.l=i,this.m=s,this.n=r,this.p=n,this.q=o,this.r=a,this.s=c,this.t=l,this.u=u,this.h=null,this.i=new kt,this.v=null}getValue(t,i,s){return this.w(t,i,s).getValue(t)}updateValue(t,i,s={}){let r;s.resource?(r=this.t.get(s.resource),r||(r=xl.createEmptyModel(this.u),this.t.set(s.resource,r))):r=this.s,i===void 0?r.removeValue(t):r.setValue(t,i),s.resource||(this.h=null)}inspect(t,i,s){const r=this.w(t,i,s),n=this.A(i.resource,s),o=i.resource?this.t.get(i.resource)||this.s:this.s,a=new Set;for(const c of r.overrides)for(const l of c.identifiers)r.getOverrideValue(t,l)!==void 0&&a.add(l);return new l_(t,i,r.getValue(t),a.size?[...a]:void 0,this.j,this.l.isEmpty()?void 0:this.l,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,s?this.q:void 0,n||void 0,o)}keys(t){const i=this.A(void 0,t);return{default:this.j.keys.slice(0),policy:this.l.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this.q.keys.slice(0),workspaceFolder:i?i.keys.slice(0):[]}}updateDefaultConfiguration(t){this.j=t,this.h=null,this.i.clear()}updatePolicyConfiguration(t){this.l=t}updateApplicationConfiguration(t){this.m=t,this.h=null,this.i.clear()}updateLocalUserConfiguration(t){this.n=t,this.v=null,this.h=null,this.i.clear()}updateRemoteUserConfiguration(t){this.p=t,this.v=null,this.h=null,this.i.clear()}updateWorkspaceConfiguration(t){this.q=t,this.h=null,this.i.clear()}updateFolderConfiguration(t,i){this.r.set(t,i),this.i.delete(t)}deleteFolderConfiguration(t){this.folderConfigurations.delete(t),this.i.delete(t)}compareAndUpdateDefaultConfiguration(t,i){const s=[];if(!i){const{added:r,updated:n,removed:o}=So(this.j,t);i=[...r,...n,...o]}for(const r of i)for(const n of Vu(r)){const o=this.j.getKeysForOverrideIdentifier(n),a=t.getKeysForOverrideIdentifier(n),c=[...a.filter(l=>o.indexOf(l)===-1),...o.filter(l=>a.indexOf(l)===-1),...o.filter(l=>!Fi(this.j.override(n).getValue(l),t.override(n).getValue(l)))];s.push([n,c])}return this.updateDefaultConfiguration(t),{keys:i,overrides:s}}compareAndUpdatePolicyConfiguration(t){const{added:i,updated:s,removed:r}=So(this.l,t),n=[...i,...s,...r];return n.length&&this.updatePolicyConfiguration(t),{keys:n,overrides:[]}}compareAndUpdateApplicationConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.applicationConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateApplicationConfiguration(t),{keys:o,overrides:n}}compareAndUpdateLocalUserConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.localUserConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateLocalUserConfiguration(t),{keys:o,overrides:n}}compareAndUpdateRemoteUserConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.remoteUserConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateRemoteUserConfiguration(t),{keys:o,overrides:n}}compareAndUpdateWorkspaceConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.workspaceConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateWorkspaceConfiguration(t),{keys:o,overrides:n}}compareAndUpdateFolderConfiguration(t,i){const s=this.folderConfigurations.get(t),{added:r,updated:n,removed:o,overrides:a}=So(s,i),c=[...r,...n,...o];return(c.length||!s)&&this.updateFolderConfiguration(t,i),{keys:c,overrides:a}}compareAndDeleteFolderConfiguration(t){const i=this.folderConfigurations.get(t);if(!i)throw new Error("Unknown folder");this.deleteFolderConfiguration(t);const{added:s,updated:r,removed:n,overrides:o}=So(i,void 0);return{keys:[...s,...r,...n],overrides:o}}get defaults(){return this.j}get applicationConfiguration(){return this.m}get userConfiguration(){if(!this.v)if(this.p.isEmpty())this.v=this.n;else{const t=this.n.merge(this.p);this.v=new xl(t.contents,t.keys,t.overrides,void 0,this.u)}return this.v}get localUserConfiguration(){return this.n}get remoteUserConfiguration(){return this.p}get workspaceConfiguration(){return this.q}get folderConfigurations(){return this.r}w(t,i,s){let r=this.x(i,s);if(i.overrideIdentifier&&(r=r.override(i.overrideIdentifier)),!this.l.isEmpty()&&this.l.getValue(t)!==void 0){r=r.merge();for(const n of this.l.keys)r.setValue(n,this.l.getValue(n))}return r}x({resource:t},i){let s=this.y();if(i&&t){const r=i.getFolder(t);r&&(s=this.z(r.uri)||s);const n=this.t.get(t);n&&(s=s.merge(n))}return s}y(){return this.h||(this.h=this.j.merge(this.applicationConfiguration,this.userConfiguration,this.q,this.s)),this.h}z(t){let i=this.i.get(t);if(!i){const s=this.y(),r=this.r.get(t);r?(i=s.merge(r),this.i.set(t,i)):i=s}return i}A(t,i){if(i&&t){const s=i.getFolder(t);if(s)return this.r.get(s.uri)}}toData(){return{defaults:{contents:this.j.contents,overrides:this.j.overrides,keys:this.j.keys},policy:{contents:this.l.contents,overrides:this.l.overrides,keys:this.l.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this.q.contents,overrides:this.q.overrides,keys:this.q.keys},folders:[...this.r.keys()].reduce((t,i)=>{const{contents:s,overrides:r,keys:n}=this.r.get(i);return t.push([i,{contents:s,overrides:r,keys:n}]),t},[])}}allKeys(){const t=new Set;return this.j.keys.forEach(i=>t.add(i)),this.userConfiguration.keys.forEach(i=>t.add(i)),this.q.keys.forEach(i=>t.add(i)),this.r.forEach(i=>i.keys.forEach(s=>t.add(s))),[...t.values()]}B(){const t=new Set;return this.j.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.userConfiguration.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.q.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.r.forEach(i=>i.getAllOverrideIdentifiers().forEach(s=>t.add(s))),[...t.values()]}D(t){const i=new Set;return this.j.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s)),this.userConfiguration.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s)),this.q.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s)),this.r.forEach(s=>s.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r))),[...i.values()]}static parse(t,i){const s=this.E(t.defaults,i),r=this.E(t.policy,i),n=this.E(t.application,i),o=this.E(t.userLocal,i),a=this.E(t.userRemote,i),c=this.E(t.workspace,i),l=t.folders.reduce((u,h)=>(u.set(y.revive(h[0]),this.E(h[1],i)),u),new kt);return new DM(s,r,n,o,a,c,l,xl.createEmptyModel(i),new kt,i)}static E(t,i){return new xl(t.contents,t.keys,t.overrides,t.raw,i)}},u_=class{constructor(e,t,i,s,r){this.change=e,this.f=t,this.g=i,this.h=s,this.i=r,this.a=`
`,this.b=this.a.charCodeAt(0),this.c=46,this.affectedKeys=new Set,this.j=void 0;for(const n of e.keys)this.affectedKeys.add(n);for(const[,n]of e.overrides)for(const o of n)this.affectedKeys.add(o);this.d=this.a;for(const n of this.affectedKeys)this.d+=n+this.a}get previousConfiguration(){return!this.j&&this.f&&(this.j=rA.parse(this.f.data,this.i)),this.j}affectsConfiguration(e,t){const i=this.a+e,s=this.d.indexOf(i);if(s<0)return!1;const r=s+i.length;if(r>=this.d.length)return!1;const n=this.d.charCodeAt(r);if(n!==this.b&&n!==this.c)return!1;if(t){const o=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.f?.workspace):void 0,a=this.g.getValue(e,t,this.h);return!Fi(o,a)}return!0}};function So(e,t){const{added:i,removed:s,updated:r}=ED(t?.rawConfiguration,e?.rawConfiguration),n=[],o=e?.getAllOverrideIdentifiers()||[],a=t?.getAllOverrideIdentifiers()||[];if(t){const c=a.filter(l=>!o.includes(l));for(const l of c)n.push([l,t.getKeysForOverrideIdentifier(l)])}if(e){const c=o.filter(l=>!a.includes(l));for(const l of c)n.push([l,e.getKeysForOverrideIdentifier(l)])}if(t&&e){for(const c of o)if(a.includes(c)){const l=ED({contents:e.getOverrideValue(void 0,c)||{},keys:e.getKeysForOverrideIdentifier(c)},{contents:t.getOverrideValue(void 0,c)||{},keys:t.getKeysForOverrideIdentifier(c)});n.push([c,[...l.added,...l.removed,...l.updated]])}}return{added:i,removed:s,updated:r,overrides:n}}function ED(e,t){const i=e?t?e.keys.filter(n=>t.keys.indexOf(n)===-1):[...e.keys]:[],s=t?e?t.keys.filter(n=>e.keys.indexOf(n)===-1):[...t.keys]:[],r=[];if(e&&t){for(const n of t.keys)if(e.keys.indexOf(n)!==-1){const o=fp(t.contents,n),a=fp(e.contents,n);Fi(o,a)||r.push(n)}}return{added:i,removed:s,updated:r}}function mm(e,t){if(t){const i=t.split(".");let s=e;for(let r=0;s&&r<i.length;r++)s=s[i[r]];return s}}function h_(e){return e instanceof y}function d_(e){return At(e)&&e.uri instanceof y&&!!e.languageId&&typeof e.languageId=="string"}function f_(e){return At(e)&&!e.uri&&!!e.languageId&&typeof e.languageId=="string"}function p_(e){return At(e)&&e.uri instanceof y&&(!e.name||typeof e.name=="string")&&(!e.index||typeof e.index=="number")}function xD(e){if(h_(e))return{resource:e};if(d_(e))return{resource:e.uri,overrideIdentifier:e.languageId};if(f_(e))return{overrideIdentifier:e.languageId};if(p_(e))return{resource:e.uri};if(e===null)return{resource:null}}var nA=class{constructor(t,i,s){this.a=t.getProxy(Y.MainThreadConfiguration),this.c=i,this.b=s,this.d=new ps,this.e=null}getConfigProvider(){return this.d.wait().then(t=>this.e)}$initializeConfiguration(t){this.e=new g_(this.a,this.c,t,this.b),this.d.open()}$acceptConfigurationChanged(t,i){this.getConfigProvider().then(s=>s.$acceptConfigurationChanged(t,i))}};nA=__decorate([__param(0,ke),__param(1,Rs),__param(2,Se)],nA);var g_=class{constructor(e,t,i,s){this.a=new I,this.b=e,this.f=s,this.c=t,this.e=rA.parse(i,s),this.d=this.k(i.configurationScopes)}get onDidChangeConfiguration(){return this.a&&this.a.event}$acceptConfigurationChanged(e,t){const i={data:this.e.toData(),workspace:this.c.workspace};this.e=rA.parse(e,this.f),this.d=this.k(e.configurationScopes),this.a.fire(this.j(t,i))}getConfiguration(e,t,i){const s=xD(t)||{},r=this.g(this.e.getValue(e,s,this.c.workspace));e&&this.h(e,s,i?.identifier);function n(a){if(a==null)return null;if(typeof a=="boolean")return a?2:5;switch(a){case Jc.Global:return 2;case Jc.Workspace:return 5;case Jc.WorkspaceFolder:return 6}}const o={has(a){return typeof mm(r,a)<"u"},get:(a,c)=>{this.h(e?`${e}.${a}`:a,s,i?.identifier);let l=mm(r,a);if(typeof l>"u")l=c;else{let u;const h=(f,p)=>{if(At(f)){let g;const v=()=>{u=u||ot(r),g=g||mm(u,p)};return new Proxy(f,{get:(b,S)=>{if(typeof S=="string"&&S.toLowerCase()==="tojson")return v(),()=>g;if(u)return g=g||mm(u,p),g[S];const E=b[S];return typeof S=="string"?h(E,`${p}.${S}`):E},set:(b,S,E)=>(v(),g&&(g[S]=E),!0),deleteProperty:(b,S)=>(v(),g&&delete g[S],!0),defineProperty:(b,S,E)=>(v(),g&&Object.defineProperty(g,S,E),!0)})}return Array.isArray(f)?ot(f):f};l=h(l,a)}return l},update:(a,c,l,u)=>{a=e?`${e}.${a}`:a;const h=n(l);return c!==void 0?this.b.$updateConfigurationOption(h,a,c,s,u):this.b.$removeConfigurationOption(h,a,s,u)},inspect:a=>{a=e?`${e}.${a}`:a;const c=this.e.inspect(a,s,this.c.workspace);if(c)return{key:a,defaultValue:ot(c.policy?.value??c.default?.value),globalLocalValue:ot(c.userLocal?.value),globalRemoteValue:ot(c.userRemote?.value),globalValue:ot(c.user?.value??c.application?.value),workspaceValue:ot(c.workspace?.value),workspaceFolderValue:ot(c.workspaceFolder?.value),defaultLanguageValue:ot(c.default?.override),globalLocalLanguageValue:ot(c.userLocal?.override),globalRemoteLanguageValue:ot(c.userRemote?.override),globalLanguageValue:ot(c.user?.override??c.application?.override),workspaceLanguageValue:ot(c.workspace?.override),workspaceFolderLanguageValue:ot(c.workspaceFolder?.override),languageIds:ot(c.overrideIdentifiers)}}};return typeof r=="object"&&en(o,r,!1),Object.freeze(o)}g(e){const t=i=>At(i)?new Proxy(i,{get:(s,r)=>t(s[r]),set:(s,r,n)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(r)}' of object`)},deleteProperty:(s,r)=>{throw new Error(`TypeError: Cannot delete read only property '${String(r)}' of object`)},defineProperty:(s,r)=>{throw new Error(`TypeError: Cannot define property '${String(r)}' for a readonly object`)},setPrototypeOf:s=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}h(e,t,i){const s=$r.test(e)?5:this.d.get(e),r=i?`[${i.value}] `:"";if(s===5){typeof t?.resource>"u"&&this.f.warn(`${r}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(s===4){t?.resource&&this.f.warn(`${r}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}j(e,t){const i=new u_(e,t,this.e,this.c.workspace,this.f);return Object.freeze({affectsConfiguration:(s,r)=>i.affectsConfiguration(s,xD(r))})}k(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}},ws=H("IExtHostConfiguration"),m_=class{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}},qh=class PM extends Z{static isHostExtension(t,i,s){if(i.getExtensionDescription(t))return!1;const r=s.getExtensionDescription(t);return r?!!((r.main||r.browser)&&r.api==="none"):!1}constructor(t,i){super(),this.n=t,this.c=this.D(new I),this.onDidChange=this.c.event,this.f=0,this.g=i,this.q()}q(){this.g.sort(w_),this.h=new qn,this.j=[],this.m=new Map;for(const t of this.g){if(this.h.has(t.identifier)){console.error("Extension `"+t.identifier.value+"` is already registered");continue}this.h.set(t.identifier,t),this.j.push(t);const i=this.n.readActivationEvents(t);for(const s of i)this.m.has(s)||this.m.set(s,[]),this.m.get(s).push(t)}}set(t){return this.g=t,this.q(),this.f++,this.c.fire(void 0),{versionId:this.f}}deltaExtensions(t,i){this.g=kD(this.g,i),this.g=this.g.concat(t);const s=PM.r(this.g);return this.g=kD(this.g,s.map(r=>r.identifier)),this.q(),this.f++,this.c.fire(void 0),new m_(this.f,s)}static r(t){const i=new class{constructor(){this.c=new Map,this.d=new Set,this.e=[]}addNode(a){this.d.has(a)||(this.d.add(a),this.e.push(a))}addArc(a,c){this.addNode(a),this.addNode(c),this.c.has(a)?this.c.get(a).push(c):this.c.set(a,[c])}getArcs(a){return this.c.has(a)?this.c.get(a):[]}hasOnlyGoodArcs(a,c){const l=i.getArcs(a);for(let u=0;u<l.length;u++)if(!c.has(l[u]))return!1;return!0}getNodes(){return this.e}},s=new qn;for(const a of t)if(s.set(a.identifier,a),a.extensionDependencies)for(const c of a.extensionDependencies)i.addArc(Ye.toKey(a.identifier),Ye.toKey(c));const r=new Set;i.getNodes().filter(a=>i.getArcs(a).length===0).forEach(a=>r.add(a));const n=i.getNodes().filter(a=>!r.has(a));let o;do{o=!1;for(let a=0;a<n.length;a++){const c=n[a];i.hasOnlyGoodArcs(c,r)&&(n.splice(a,1),a--,r.add(c),o=!0)}}while(o);return n.map(a=>s.get(a))}containsActivationEvent(t){return this.m.has(t)}containsExtension(t){return this.h.has(t)}getExtensionDescriptionsForActivationEvent(t){const i=this.m.get(t);return i?i.slice(0):[]}getAllExtensionDescriptions(){return this.j.slice(0)}getSnapshot(){return new v_(this.f,this.getAllExtensionDescriptions())}getExtensionDescription(t){const i=this.h.get(t);return i||void 0}getExtensionDescriptionByUUID(t){for(const i of this.j)if(i.uuid===t)return i}getExtensionDescriptionByIdOrUUID(t,i){return this.getExtensionDescription(t)??(i?this.getExtensionDescriptionByUUID(i):void 0)}},v_=class{constructor(e,t){this.versionId=e,this.extensions=t}},CD;(function(e){e[e.Builtin=0]="Builtin",e[e.User=1]="User",e[e.Dev=2]="Dev"})(CD||(CD={}));function w_(e,t){const i=e.isBuiltin?0:e.isUnderDevelopment?2:1,s=t.isBuiltin?0:t.isUnderDevelopment?2:1;if(i!==s)return i-s;const r=Be.basename(e.extensionLocation.path),n=Be.basename(t.extensionLocation.path);return r<n?-1:r>n?1:0}function kD(e,t){const i=new Ko(t);return e.filter(s=>!i.has(s.identifier))}var vm=class TM{static{this.NONE=new TM(!1,-1,-1,-1)}constructor(t,i,s,r){this.startup=t,this.codeLoadingTime=i,this.activateCallTime=s,this.activateResolvedTime=r}},oA=class{constructor(e){this.a=e,this.b=-1,this.c=-1,this.d=-1,this.f=-1,this.g=-1,this.h=-1}j(e,t){return e===-1||t===-1?-1:t-e}build(){return new vm(this.a,this.j(this.b,this.c),this.j(this.d,this.f),this.j(this.g,this.h))}codeLoadingStart(){this.b=Date.now()}codeLoadingStop(){this.c=Date.now()}activateCallStart(){this.d=Date.now()}activateCallStop(){this.f=Date.now()}activateResolveStart(){this.g=Date.now()}activateResolveStop(){this.h=Date.now()}},wm=class{constructor(e,t,i,s,r,n){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=s,this.exports=r,this.disposable=n}},b_=class extends wm{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,Z.None)}},y_=class extends wm{constructor(){super(!1,null,vm.NONE,{activate:void 0,deactivate:void 0},void 0,Z.None)}},bm=class extends wm{constructor(e){super(!0,e,vm.NONE,{activate:void 0,deactivate:void 0},void 0,Z.None)}},aA=class{constructor(t,i,s,r){this.g=r,this.a=t,this.b=i,this.c=s,this.d=new qn,this.f=Object.create(null)}dispose(){for(const[t,i]of this.d)i.dispose()}async waitForActivatingExtensions(){const t=[];for(const[i,s]of this.d)t.push(s.wait());await Promise.all(t)}isActivated(t){const i=this.d.get(t);return!!(i&&i.value)}getActivatedExtension(t){const i=this.d.get(t);if(!i||!i.value)throw new Error(`Extension '${t.value}' is not known or not activated`);return i.value}async activateByEvent(t,i){if(this.f[t])return;const s=this.a.getExtensionDescriptionsForActivationEvent(t);await this.h(s.map(r=>({id:r.identifier,reason:{startup:i,extensionId:r.identifier,activationEvent:t}}))),this.f[t]=!0}activateById(t,i){const s=this.a.getExtensionDescription(t);if(!s)throw new Error(`Extension '${t.value}' is not known`);return this.h([{id:s.identifier,reason:i}])}async h(t){const i=t.filter(s=>!this.isActivated(s.id)).map(s=>this.j(s));await Promise.all(i.map(s=>s.wait()))}j(t){if(this.d.has(t.id))return this.d.get(t.id);if(this.l(t.id))return this.k(t,null,[],null);const i=this.a.getExtensionDescription(t.id);if(!i){const n=new Error(`Cannot activate unknown extension '${t.id.value}'`),o=this.k(t,null,[],new bm(n));return this.c.onExtensionActivationError(t.id,n,new e7(t.id.value)),o}const s=[],r=typeof i.extensionDependencies>"u"?[]:i.extensionDependencies;for(const n of r){if(this.m(n))continue;const o=this.d.get(n);if(o){s.push(o);continue}if(this.l(n)){s.push(this.j({id:this.b.getExtensionDescription(n).identifier,reason:t.reason}));continue}const a=this.a.getExtensionDescription(n);if(a){if(!a.main&&!a.browser)continue;s.push(this.j({id:a.identifier,reason:t.reason}));continue}const c=i.displayName||i.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${n}'`),u=this.k(t,i.displayName,[],new bm(l));return this.c.onExtensionActivationError(i.identifier,l,new e7(n)),u}return this.k(t,i.displayName,s,null)}k(t,i,s,r){const n=new cA(t.id,i,t.reason,s,r,this.c,this.g);return this.d.set(t.id,n),n}l(t){return qh.isHostExtension(t,this.a,this.b)}m(t){const i=this.b.getExtensionDescription(t);return i?!i.main&&!i.browser:!1}};aA=__decorate([__param(3,Se)],aA);var cA=class{get value(){return this.h}get friendlyName(){return this.d||this.c.value}constructor(t,i,s,r,n,o,a){this.c=t,this.d=i,this.f=s,this.g=r,this.h=n,this.j=o,this.k=a,this.a=new ps,this.b=!1,this.l()}dispose(){this.b=!0}wait(){return this.a.wait()}async l(){await this.m(),this.a.open()}async m(){if(!this.h){for(;this.g.length>0;){for(let t=0;t<this.g.length;t++){const i=this.g[t];if(i.value&&!i.value.activationFailed){this.g.splice(t,1),t--;continue}if(i.value&&i.value.activationFailed){const s=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${i.friendlyName}' failed to activate`);s.detail=i.value.activationFailedError,this.h=new bm(s),this.j.onExtensionActivationError(this.c,s,null);return}}this.g.length>0&&await Promise.race(this.g.map(t=>t.wait()))}await this.n()}}async n(){try{this.h=await this.j.actualActivateExtension(this.c,this.f)}catch(t){const i=new Error;if(t&&t.name&&(i.name=t.name),t&&t.message?i.message=`Activating extension '${this.c.value}' failed: ${t.message}.`:i.message=`Activating extension '${this.c.value}' failed: ${t}.`,t&&t.stack&&(i.stack=t.stack),this.h=new bm(i),this.b&&Mi(t))return;this.j.onExtensionActivationError(this.c,i,null),this.k.error(`Activating extension ${this.c.value} failed due to an error:`),this.k.error(t)}}};cA=__decorate([__param(6,Se)],cA);var $D=class{constructor(e,t){this.c=t,this.b=new I,this.onDidChangeStorage=this.b.event,this.a=e.getProxy(Y.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this.a.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const s=await this.a.$initializeExtensionStorage(e,t);let r;return s&&(r=this.d(e,t,s)),r||i}setValue(e,t,i){return this.a.$setValue(e,t,i)}$acceptValue(e,t,i){const s=this.d(e,t,i);s&&this.b.fire({shared:e,key:t,value:s})}d(e,t,i){try{return JSON.parse(i)}catch(s){this.c.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${s}`)}}},lA=H("IExtHostStorage"),ID=class{constructor(e,t,i){this.h=new Map,this.a=e,this.b=t,this.c=i,this.d=this.c.initializeExtensionStorage(this.b,this.a,Object.create(null)).then(s=>(this.f=s,this)),this.g=this.c.onDidChangeStorage(s=>{s.shared===this.b&&s.key===this.a&&(this.f=s.value)}),this.i=new br(()=>{const s=this.h;this.h=new Map,(async()=>{try{await this.c.setValue(this.b,this.a,this.f);for(const r of s.values())r.complete()}catch(r){for(const n of s.values())n.error(r)}})()},0)}keys(){return Object.entries(this.f??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this.d}get(e,t){let i=this.f[e];return typeof i>"u"&&(i=t),i}update(e,t){t!==null&&typeof t=="object"?this.f[e]=JSON.parse(JSON.stringify(t)):this.f[e]=t;const i=this.h.get(e);if(i!==void 0)return i.p;const s=new Ri;return this.h.set(e,s),this.i.isScheduled()||this.i.schedule(),s.p}dispose(){this.g.dispose()}},A_=class extends ID{setKeysForSync(e){this.c.registerExtensionStorageKeysToSync({id:this.a,version:this.j.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this.j=e}},Or,uA=Or=class{constructor(t,i){this.b=new Map,this.c=new bx,this.a=t.getProxy(Y.MainThreadFileSystem);const s=this;this.value=Object.freeze({async stat(r){try{let n;const o=s.b.get(r.scheme);return o?(await s.a.$ensureActivation(r.scheme),n=await o.impl.stat(r)):n=await s.a.$stat(r),{type:n.type,ctime:n.ctime,mtime:n.mtime,size:n.size,permissions:n.permissions===Xn.Readonly?1:void 0}}catch(n){Or.e(n)}},async readDirectory(r){try{const n=s.b.get(r.scheme);return n?(await s.a.$ensureActivation(r.scheme),(await n.impl.readDirectory(r)).slice()):await s.a.$readdir(r)}catch(n){return Or.e(n)}},async createDirectory(r){try{const n=s.b.get(r.scheme);return n&&!n.isReadonly?(await s.a.$ensureActivation(r.scheme),await s.d(n.impl,n.extUri,r)):await s.a.$mkdir(r)}catch(n){return Or.e(n)}},async readFile(r){try{const n=s.b.get(r.scheme);return n?(await s.a.$ensureActivation(r.scheme),(await n.impl.readFile(r)).slice()):(await s.a.$readFile(r)).buffer}catch(n){return Or.e(n)}},async writeFile(r,n){try{const o=s.b.get(r.scheme);return o&&!o.isReadonly?(await s.a.$ensureActivation(r.scheme),await s.d(o.impl,o.extUri,o.extUri.dirname(r)),await s.c.queueFor(r,()=>Promise.resolve(o.impl.writeFile(r,n,{create:!0,overwrite:!0})))):await s.a.$writeFile(r,W.wrap(n))}catch(o){return Or.e(o)}},async delete(r,n){try{const o=s.b.get(r.scheme);return o&&!o.isReadonly&&!n?.useTrash?(await s.a.$ensureActivation(r.scheme),await o.impl.delete(r,{recursive:!1,...n})):await s.a.$delete(r,{recursive:!1,useTrash:!1,atomic:!1,...n})}catch(o){return Or.e(o)}},async rename(r,n,o){try{return await s.a.$rename(r,n,{overwrite:!1,...o})}catch(a){return Or.e(a)}},async copy(r,n,o){try{return await s.a.$copy(r,n,{overwrite:!1,...o})}catch(a){return Or.e(a)}},isWritableFileSystem(r){const n=i.getCapabilities(r);if(typeof n=="number")return!(n&2048)}})}async d(t,i,s){const r=[];for(;!i.isEqual(s,i.dirname(s));)try{if(((await t.stat(s)).type&is.Directory)===0)throw Xt.FileExists(`Unable to create folder '${s.scheme===V.file?s.fsPath:s.toString(!0)}' that already exists but is not a directory`);break}catch(n){if(_f(n)!==he.FileNotFound)throw n;r.push(i.basename(s)),s=i.dirname(s)}for(let n=r.length-1;n>=0;n--){s=i.joinPath(s,r[n]);try{await t.createDirectory(s)}catch(o){if(_f(o)!==he.FileExists)throw o}}}static e(t){if(t instanceof Xt)throw t;if(t instanceof Bf)switch(t.code){case he.FileExists:throw Xt.FileExists(t.message);case he.FileNotFound:throw Xt.FileNotFound(t.message);case he.FileNotADirectory:throw Xt.FileNotADirectory(t.message);case he.FileIsADirectory:throw Xt.FileIsADirectory(t.message);case he.NoPermissions:throw Xt.NoPermissions(t.message);case he.Unavailable:throw Xt.Unavailable(t.message);default:throw new Xt(t.message,t.name)}if(!(t instanceof Error))throw new Xt(String(t));if(t.name==="ENOPRO"||t.message.includes("ENOPRO"))throw Xt.Unavailable(t.message);switch(t.name){case he.FileExists:throw Xt.FileExists(t.message);case he.FileNotFound:throw Xt.FileNotFound(t.message);case he.FileNotADirectory:throw Xt.FileNotADirectory(t.message);case he.FileIsADirectory:throw Xt.FileIsADirectory(t.message);case he.NoPermissions:throw Xt.NoPermissions(t.message);case he.Unavailable:throw Xt.Unavailable(t.message);default:throw new Xt(t.message,t.name)}}addFileSystemProvider(t,i,s){return this.b.set(t,{impl:i,extUri:s?.isCaseSensitive?Ke:tO,isReadonly:!!s?.isReadonly}),te(()=>this.b.delete(t))}getFileSystemProviderExtUri(t){return this.b.get(t)?.extUri??Ke}};uA=Or=__decorate([__param(0,ke),__param(1,yc)],uA);var Gh=H("IExtHostConsumerFileSystem"),hA=H("IExtensionStoragePaths"),dA=class{constructor(t,i,s){this.d=i,this.f=s,this.a=t.workspace??void 0,this.b=t.environment,this.whenReady=this.h().then(r=>this.c=r)}async g(t){return y.joinPath(this.b.workspaceStorageHome,t)}async h(){if(!this.a)return Promise.resolve(void 0);const t=this.a.id,i=await this.g(t);try{return await this.f.value.stat(i),this.d.trace("[ExtHostStorage] storage dir already exists",i),i}catch{}try{return this.d.trace("[ExtHostStorage] creating dir and metadata-file",i),await this.f.value.createDirectory(i),await this.f.value.writeFile(y.joinPath(i,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this.a.id,configuration:y.revive(this.a.configuration)?.toString(),name:this.a.name},void 0,2))),i}catch(s){this.d.error("[ExtHostStorage]",s);return}}workspaceValue(t){if(this.c)return y.joinPath(this.c,t.identifier.value)}globalValue(t){return y.joinPath(this.b.globalStorageHome,t.identifier.value.toLowerCase())}onWillDeactivateAll(){}};dA=__decorate([__param(0,jt),__param(1,Se),__param(2,Gh)],dA);var S_=H("tunnelService"),cre=H("sharedTunnelsService"),Os;(function(e){e.Http="http",e.Https="https"})(Os||(Os={}));var Fr;(function(e){e.ConstantPrivate="constantPrivate",e.Private="private",e.Public="public"})(Fr||(Fr={}));function E_(e){return!!e.forwardPort}var Eo;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(Eo||(Eo={}));function x_(e){if(e.scheme!=="http"&&e.scheme!=="https")return;const t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(e.authority);if(t)return{address:t[1],port:+t[2]}}var Jh=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function ja(e){return Jh.indexOf(e)>=0}var ym=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function gn(e){return ym.indexOf(e)>=0}function C_(e,t,i,s){if(i===1)return!1;if(i===2&&gn(t)){const r=/(\d+)\.(\d+)\.(\d+)/g.exec(s);if(r?.length===4&&parseInt(r[1])>=18)return!1}return e<1024}var k_=class{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this.b=i,this.a=new I,this.onDidDispose=this.a.event}dispose(){return this.a.fire(),this.b()}},fA=class extends Z{constructor(t,i){super(),this.q=t,this.r=i,this.a=new I,this.onTunnelOpened=this.a.event,this.b=new I,this.onTunnelClosed=this.b.event,this.c=new I,this.onAddedTunnelProvider=this.c.event,this.f=new Map,this.h=!1,this.j=!0,this.m=[],this.n=new Set}get hasTunnelProvider(){return!!this.g}get s(){const t=this.r.getValue("remote.localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(t){return this.g=t,t?(this.c.fire(),{dispose:()=>{this.g=void 0,this.h=!1,this.m=[]}}):(this.h=!1,this.m=[],this.c.fire(),{dispose:()=>{}})}setTunnelFeatures(t){this.h=t.elevation,this.m=t.privacyOptions,this.j=t.protocol}get canChangeProtocol(){return this.j}get canElevate(){return this.h}get canChangePrivacy(){return this.m.length>0}get privacyOptions(){return this.m}get tunnels(){return this.t()}async t(){const t=[],i=Array.from(this.f.values());for(const s of i){const r=Array.from(s.values());for(const n of r){const o=await n.value;o&&typeof o!="string"&&t.push(o)}}return t}async dispose(){super.dispose();for(const t of this.f.values()){for(const{value:i}of t.values())await i.then(s=>typeof s!="string"?s?.dispose():void 0);t.clear()}this.f.clear()}setEnvironmentTunnel(t,i,s,r,n){this.y(t,i,Promise.resolve({tunnelRemoteHost:t,tunnelRemotePort:i,localAddress:s,privacy:r,protocol:n,dispose:()=>Promise.resolve()}))}async getExistingTunnel(t,i){(gn(t)||ja(t))&&(t=Jh[0]);const s=this.C(t,i);if(s)return++s.refcount,s.value}openTunnel(t,i,s,r,n,o=!1,a,c){this.q.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${s} on local port ${n}.`);const l=this.g??t;if(!l)return;if(i||(i="localhost"),r||(r=this.s),this.g&&this.n.has(s)){this.q.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.F(l,i,s,r,n,o,a,c);return u?u.then(h=>{if(h){if(typeof h=="string")return this.q.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.z(i,s),h}else{this.q.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.z(i,s);return}this.q.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.u(h);return(h.tunnelRemoteHost!==i||h.tunnelRemotePort!==s)&&this.q.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&h.privacy!==a&&this.q.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this.a.fire(f),f}):(this.q.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}u(t){return{tunnelRemotePort:t.tunnelRemotePort,tunnelRemoteHost:t.tunnelRemoteHost,tunnelLocalPort:t.tunnelLocalPort,localAddress:t.localAddress,privacy:t.privacy,protocol:t.protocol,dispose:async()=>{this.q.trace(`ForwardedPorts: (TunnelService) dispose request for ${t.tunnelRemoteHost}:${t.tunnelRemotePort} `);const i=this.f.get(t.tunnelRemoteHost);if(i){const s=i.get(t.tunnelRemotePort);s&&(s.refcount--,await this.w(t.tunnelRemoteHost,t.tunnelRemotePort,s))}}}}async w(t,i,s){if(s.refcount<=0){this.q.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${t}:${i}.`);const r=s.value.then(async n=>{n&&typeof n!="string"&&(await n.dispose(!0),this.b.fire({host:n.tunnelRemoteHost,port:n.tunnelRemotePort}))});return this.f.has(t)&&this.f.get(t).delete(i),r}}async closeTunnel(t,i){this.q.trace(`ForwardedPorts: (TunnelService) close request for ${t}:${i} `);const s=this.f.get(t);if(s&&s.has(i)){const r=s.get(i);r.refcount=0,await this.w(t,i,r)}}y(t,i,s){this.f.has(t)||this.f.set(t,new Map),this.f.get(t).set(i,{refcount:1,value:s})}async z(t,i){const s=this.f.get(t);if(s){const r=s.get(i),n=r?await r.value:void 0;(!n||typeof n=="string")&&s.delete(i),s.size===0&&this.f.delete(t)}}C(t,i){const s=[t];ja(t)?(s.push(...Jh),s.push(...ym)):gn(t)&&s.push(...ym);const r=s.map(n=>this.f.get(n));for(const n of r){const o=n?.get(i);if(o)return o}}canTunnel(t){return!!x_(t)}G(t,i,s,r,n,o,a){this.q.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${s} on local port ${r}.`);const c=s;this.n.add(c);const l=r===void 0?s:r,u={elevationRequired:n?this.isPortPrivileged(l):!1},h={remoteAddress:{host:i,port:s},localAddressPort:r,privacy:o,public:o?o!==Fr.Private:void 0,protocol:a},f=t.forwardPort(h,u);return f?(this.y(i,s,f),f.finally(()=>{this.q.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this.n.delete(c)})):this.n.delete(c),f}};fA=__decorate([__param(0,Se),__param(1,gi)],fA);var $_=class extends k_{},pA;(function(e){function t(s){return{remoteAddress:s.remoteAddress,localAddress:s.localAddress,public:!!s.public,privacy:s.privacy??(s.public?Fr.Public:Fr.Private),protocol:s.protocol}}e.fromApiTunnel=t;function i(s){return{remoteAddress:{host:s.tunnelRemoteHost,port:s.tunnelRemotePort},localAddress:s.localAddress,public:s.privacy!==Fr.ConstantPrivate&&s.privacy!==Fr.ConstantPrivate,privacy:s.privacy,protocol:s.protocol}}e.fromServiceTunnel=i})(pA||(pA={}));var Am=H("IExtHostTunnelService"),Sm=class extends Z{constructor(t,i,s){super(),this.r=s,this.f=()=>Promise.resolve(!0),this.g=new Map,this.h=new I,this.onDidChangeTunnels=this.h.event,this.n=0,this.q=new Map,this.a=t.getProxy(Y.MainThreadTunnelService)}async openTunnel(t,i){this.r.trace(`ForwardedPorts: (ExtHostTunnelService) ${t.identifier.value} called openTunnel API for ${i.remoteAddress.host}:${i.remoteAddress.port}.`);const s=await this.a.$openTunnel(i,t.displayName);if(s){const r=new $_(s.remoteAddress,s.localAddress,()=>this.a.$closeTunnel(s.remoteAddress));return this.D(r),r}}async getTunnels(){return this.a.$getTunnels()}s(){return this.n++}registerPortsAttributesProvider(t,i){t.portRange===void 0&&t.commandPattern===void 0&&this.r.error("PortAttributesProvider must specify either a portRange or a commandPattern");const s=this.s();return this.q.set(s,{selector:t,provider:i}),this.a.$registerPortsAttributesProvider(t,s),new Ce(()=>{this.q.delete(s),this.a.$unregisterPortsAttributesProvider(s)})}async $providePortAttributes(t,i,s,r,n){const o=[];for(const c of t){const l=this.q.get(c);if(!l)return[];o.push(...await Promise.all(i.map(async u=>{let h;try{h=await l.provider.providePortAttributes({port:u,pid:s,commandLine:r},n)}catch{h=await l.provider.providePortAttributes(u,s,r,n)}return{providedAttributes:h,port:u}})))}const a=o.filter(c=>!!c.providedAttributes);return a.length>0?a.map(c=>({autoForwardAction:c.providedAttributes.autoForwardAction,port:c.port})):[]}async $registerCandidateFinder(t){}registerTunnelProvider(t,i){if(this.b)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this.b=async(r,n)=>await t.provideTunnel(r,n,Fe.None)??void 0;const s=i.tunnelFeatures?{elevation:!!i.tunnelFeatures?.elevation,privacyOptions:i.tunnelFeatures?.privacyOptions,protocol:i.tunnelFeatures.protocol===void 0?!0:i.tunnelFeatures.protocol}:void 0;return this.a.$setTunnelProvider(s,!0),Promise.resolve(te(()=>{this.b=void 0,this.a.$setTunnelProvider(void 0,!1)}))}hasTunnelProvider(){return this.a.$hasTunnelProvider()}async setTunnelFactory(t,i){if(t){t.candidatePortSource!==void 0&&this.a.$setCandidatePortSource(t.candidatePortSource),t.showCandidatePort&&(this.f=t.showCandidatePort,this.a.$setCandidateFilter());const s=t.tunnelFactory??(i?this.u(i):void 0);if(s){this.b=s;let r=t.tunnelFeatures?.privacyOptions??[];t.tunnelFeatures?.public&&r.length===0&&(r=[{id:"private",label:d(3052,null),themeIcon:"lock"},{id:"public",label:d(3053,null),themeIcon:"eye"}]);const n=t.tunnelFeatures?{elevation:!!t.tunnelFeatures?.elevation,public:!!t.tunnelFeatures?.public,privacyOptions:r,protocol:!0}:void 0;this.a.$setTunnelProvider(n,!!t.tunnelFactory)}}else this.b=void 0;return te(()=>{this.b=void 0})}u(t){}async $closeTunnel(t,i){if(this.g.has(t.host)){const s=this.g.get(t.host);s.has(t.port)&&(i&&s.get(t.port).disposeListener.dispose(),await s.get(t.port).tunnel.dispose(),s.delete(t.port))}}async $onDidTunnelsChange(){this.h.fire()}async $forwardPort(t,i){if(this.b)try{this.r.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const s=this.b(t,i);if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),s!==void 0){const r=await s;if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),r===void 0){this.r.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this.g.has(t.remoteAddress.host)||this.g.set(t.remoteAddress.host,new Map);const n=this.D(r.onDidDispose(()=>(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this.a.$closeTunnel(r.remoteAddress))));return this.g.get(t.remoteAddress.host).set(t.remoteAddress.port,{tunnel:r,disposeListener:n}),pA.fromApiTunnel(r)}else this.r.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(s){if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),s instanceof Error)return s.message}}async $applyCandidateFilter(t){const i=await Promise.all(t.map(r=>this.f(r.host,r.port,r.detail??""))),s=t.filter((r,n)=>i[n]);return this.r.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${t.map(r=>r.port).join(", ")} to ${s.map(r=>r.port).join(", ")}`),s}};Sm=__decorate([__param(0,ke),__param(1,jt),__param(2,Se)],Sm);function I_(e){return[...e.entries()]}function D_(e){return e?[...e.entries()]:[]}var P_=class{constructor(e){this.b=e,this.a=new Map}dispose(){for(const e of this.a.values())e.dispose()}startBuffering(e,t,i=5){const s=t(r=>{const n=Oe(r)?r:r.data;let o=this.a.get(e);if(o){o.data.push(n);return}const a=setTimeout(()=>this.flushBuffer(e),i);o={data:[n],timeoutId:a,dispose:()=>{clearTimeout(a),this.flushBuffer(e),s.dispose()}},this.a.set(e,o)});return s}stopBuffering(e){this.a.get(e)?.dispose()}flushBuffer(e){const t=this.a.get(e);t&&(this.a.delete(e),this.b(e,t.data.join("")))}},za=(e,t,i,s)=>{let r=t;return{enumerable:!0,configurable:!1,get(){return r},set(n){if(!i(r,n)){const o=r;r=n,e.listener?.(s(n,o))}}}},Cl=(e,t)=>e===t,xo={range:(e,t)=>e===t?!0:!e||!t?!1:e.isEqual(t),label:Cl,description:Cl,sortText:Cl,busy:Cl,error:Cl,canResolveChildren:Cl,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.find(s=>i.id===s.id)))},kl=e=>t=>({op:4,update:e(t)}),T_=(e,t)=>({range:(()=>{let i;const s=kl(r=>({range:rt.lift(U.from(r))}));return{enumerable:!0,configurable:!1,get(){return i},set(r){e.listener?.({op:6}),xo.range(i,r)||(i=r,e.listener?.(s(r)))}}})(),label:za(e,t,xo.label,kl(i=>({label:i}))),description:za(e,void 0,xo.description,kl(i=>({description:i}))),sortText:za(e,void 0,xo.sortText,kl(i=>({sortText:i}))),canResolveChildren:za(e,!1,xo.canResolveChildren,i=>({op:2,state:i})),busy:za(e,!1,xo.busy,kl(i=>({busy:i}))),error:za(e,void 0,xo.error,kl(i=>({error:pe.fromStrict(i)||null}))),tags:za(e,[],xo.tags,(i,s)=>({op:1,new:i.map(ar.from),old:s.map(ar.from)}))}),N_=e=>{const t=Ve.fromString(e.extId),i=new Zh(t.controllerId,t.localId,e.label,y.revive(e.uri)||void 0);return i.range=U.to(e.range||void 0),i.description=e.description||void 0,i.sortText=e.sortText||void 0,i.tags=e.tags.map(s=>ar.to({id:w6(s).tagId})),i},DD=e=>{let t;for(const i of e.tests){const s=N_(i.item);xp(s).parent=t,t=s}return t},Zh=class NM{constructor(t,i,s,r){if(i.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(i)} symbol`);const n=YW(this,t);Object.defineProperties(this,{id:{value:i,enumerable:!0,writable:!1},uri:{value:r,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return n.parent instanceof gA?void 0:n.parent}},children:{value:QW(n,xp,NM),enumerable:!0,writable:!1},...T_(n,s)})}},gA=class extends Zh{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}},M_=class extends GW{constructor(e,t,i){super({controllerId:e,getDocumentVersion:s=>s&&i.getDocument(s)?.version,getApiFor:xp,getChildren:s=>s.children,root:new gA(e,t),toITestItem:bo.from})}},Qh;(function(e){e[e.Desktop=1]="Desktop",e[e.Web=2]="Web"})(Qh||(Qh={}));var PD;(function(e){e[e.VersionMismatch=55]="VersionMismatch",e[e.UnexpectedError=81]="UnexpectedError"})(PD||(PD={}));var TD;(function(e){e[e.Initialized=0]="Initialized",e[e.Ready=1]="Ready",e[e.Terminate=2]="Terminate"})(TD||(TD={}));function ND(e){const t=W.alloc(1);switch(e){case 0:t.writeUInt8(1,0);break;case 1:t.writeUInt8(2,0);break;case 2:t.writeUInt8(3,0);break}return t}function L_(e,t){if(e.byteLength!==1)return!1;switch(e.readUInt8(0)){case 1:return t===0;case 2:return t===1;case 3:return t===2;default:return!1}}var MD;(function(e){e.Start="START_NATIVE_LOG",e.End="END_NATIVE_LOG"})(MD||(MD={}));var mA=class extends Z{constructor(t,i,s){super(),this.n=i,this.a=this.D(new I),this.onDidChangeTelemetryEnabled=this.a.event,this.b=this.D(new I),this.onDidChangeTelemetryConfiguration=this.b.event,this.c={usage:!0,error:!0},this.f=0,this.h=!1,this.m=new Map,this.h=this.n.environment.isExtensionTelemetryLoggingOnly;const r=i.remote.isRemote?"remoteExtHostTelemetry":t?"workerExtHostTelemetry":"extHostTelemetry";this.j=this.D(s.createLogger(r,{name:d(3049,null,this.h?" (Not Sent)":""),hidden:!0,group:RW}))}getTelemetryConfiguration(){return this.f===3}getTelemetryDetails(){return{isCrashEnabled:this.f>=1,isErrorsEnabled:this.c.error?this.f>=2:!1,isUsageEnabled:this.c.usage?this.f>=3:!1}}instantiateLogger(t,i,s){const r=this.getTelemetryDetails(),n=new LD(i,s,t,this.j,this.h,this.getBuiltInCommonProperties(t),{isUsageEnabled:r.isUsageEnabled,isErrorsEnabled:r.isErrorsEnabled}),o=this.m.get(t.identifier.value)??[];return this.m.set(t.identifier.value,[...o,n]),n.apiTelemetryLogger}$initializeTelemetryLevel(t,i,s){this.f=t,this.c=s??{usage:!0,error:!0}}getBuiltInCommonProperties(t){const i=Object.create(null);switch(i["common.extname"]=`${t.publisher}.${t.name}`,i["common.extversion"]=t.version,i["common.vscodemachineid"]=this.n.telemetryInfo.machineId,i["common.vscodesessionid"]=this.n.telemetryInfo.sessionId,i["common.vscodecommithash"]=this.n.commit,i["common.sqmid"]=this.n.telemetryInfo.sqmId,i["common.devDeviceId"]=this.n.telemetryInfo.devDeviceId??this.n.telemetryInfo.machineId,i["common.vscodeversion"]=this.n.version,i["common.vscodereleasedate"]=this.n.date,i["common.isnewappinstall"]=RD(this.n.telemetryInfo.firstSessionDate),i["common.product"]=this.n.environment.appHost,this.n.uiKind){case Qh.Web:i["common.uikind"]="web";break;case Qh.Desktop:i["common.uikind"]="desktop";break;default:i["common.uikind"]="unknown"}return i["common.remotename"]=y0(FW(this.n.remote.authority)),i}$onDidChangeTelemetryLevel(t){this.g=this.getTelemetryConfiguration(),this.f=t;const i=this.getTelemetryDetails();this.m.forEach((s,r)=>{const n=s.filter(o=>!o.isDisposed);n.length===0?this.m.delete(r):this.m.set(r,n)}),this.m.forEach(s=>{for(const r of s)r.updateTelemetryEnablements(i.isUsageEnabled,i.isErrorsEnabled)}),this.g!==this.getTelemetryConfiguration()&&this.a.fire(this.getTelemetryConfiguration()),this.b.fire(this.getTelemetryDetails())}onExtensionError(t,i){const r=this.m.get(t.value)?.filter(o=>!o.isDisposed);if(!r)return this.m.delete(t.value),!1;let n=!1;for(const o of r)o.ignoreUnhandledExtHostErrors||(o.logError(i),n=!0);return n}};mA=__decorate([__param(1,jt),__param(2,Jn)],mA);var LD=class{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,s,r,n,o){this.g=i,this.h=s,this.i=r,this.j=n,this.a=new I,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this.b=t?.ignoreBuiltInCommonProperties??!1,this.c=t?.additionalCommonProperties,this.f=e,this.d={isUsageEnabled:o.isUsageEnabled,isErrorsEnabled:o.isErrorsEnabled}}updateTelemetryEnablements(e,t){this.e&&(this.d={isUsageEnabled:e,isErrorsEnabled:t},this.a.fire(this.e))}mixInCommonPropsAndCleanData(e){let t=e.properties?e.properties??{}:e;return t=X6(t,[]),this.c&&(t=en(t,this.c)),this.b||(t=en(t,this.j)),e.properties?e.properties=t:e=t,e}k(e,t){this.f&&(this.g.publisher==="vscode"?e=this.g.name+"/"+e:e=this.g.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this.i||this.f?.sendEventData(e,t),this.h.trace(e,t))}logUsage(e,t){this.d.isUsageEnabled&&this.k(e,t)}logError(e,t){if(!(!this.d.isErrorsEnabled||!this.f))if(typeof e=="string")this.k(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},s=X6(i,[]),r=new Error(typeof s.message=="string"?s.message:void 0,{cause:s.cause});r.stack=typeof s.stack=="string"?s.stack:void 0,r.name=typeof s.name=="string"?s.name:"unknown",t=this.mixInCommonPropsAndCleanData(t||{}),this.i||this.f.sendErrorData(r,t),this.h.trace("exception",t)}}get apiTelemetryLogger(){if(!this.e){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e.d.isUsageEnabled},get isErrorsEnabled(){return e.d.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e.a.event.bind(e)};this.e=Object.freeze(t)}return this.e}get isDisposed(){return!this.f}dispose(){if(this.f?.flush){let e=this.f;this.f=void 0,Promise.resolve(e.flush()).then(e=void 0),this.e=void 0}else this.f=void 0}};function RD(e){const t=Date.now()-new Date(e).getTime();return isNaN(t)?!1:t<1e3*60*60*24}var Em=H("IExtHostTelemetry"),vA=class{#e;#t;#i;constructor(t,i,s){this.b=new Map,this.c=new Map,this.#e=t.getProxy(Y.MainThreadCommands),this.d=i,this.#i=s,this.#t=t.getProxy(Y.MainThreadTelemetry),this.converter=new R_(this,r=>{const n=this.c.get(r);return n?.result===be.Void?n:void 0},i),this.f=[{processArgument(r){return Zt(r)}},{processArgument(r){return mc(r,function(n){if(rt.isIRange(n))return U.to(n);if(ms.isIPosition(n))return Xe.to(n);if(rt.isIRange(n.range)&&y.isUri(n.uri))return Bi.to(n);if(n instanceof W)return n.buffer.buffer;if(!Array.isArray(n))return n})}}]}registerArgumentProcessor(t){this.f.push(t)}registerApiCommand(t){const i=this.registerCommand(!1,t.id,async(...s)=>{const r=t.args.map((o,a)=>{if(!o.validate(s[a]))throw new Error(`Invalid argument '${o.name}' when running '${t.id}', received: ${typeof s[a]=="object"?JSON.stringify(s[a],null,"	"):s[a]} `);return o.convert(s[a])}),n=await this.executeCommand(t.internalId,...r);return t.result.convert(n,s,this.converter)},void 0,{description:t.description,args:t.args,returns:t.result.description});return this.c.set(t.id,t),new Ce(()=>{i.dispose(),this.c.delete(t.id)})}registerCommand(t,i,s,r,n,o){if(this.d.trace("ExtHostCommands#registerCommand",i),!i.trim().length)throw new Error("invalid id");if(this.b.has(i))throw new Error(`command '${i}' already exists`);return this.b.set(i,{callback:s,thisArg:r,metadata:n,extension:o}),t&&this.#e.$registerCommand(i),new Ce(()=>{this.b.delete(i)&&t&&this.#e.$unregisterCommand(i)})}executeCommand(t,...i){return this.d.trace("ExtHostCommands#executeCommand",t),this.g(t,i,!0)}async g(t,i,s){if(this.b.has(t))return this.#e.$fireCommandActivationEvent(t),this.h(t,i,!1);{let r=!1;const n=mc(i,function(o){if(o instanceof Pe)return Xe.from(o);if(o instanceof xe)return U.from(o);if(o instanceof rs)return Bi.from(o);if(Ir.isNotebookRange(o))return Rr.from(o);if(o instanceof ArrayBuffer)return r=!0,W.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return r=!0,W.wrap(o);if(o instanceof W)return r=!0,o;if(!Array.isArray(o))return o});try{const o=await this.#e.$executeCommand(t,r?new pi(n):n,s);return Zt(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this.g(t,i,!1);throw o}}}async h(t,i,s){const r=this.b.get(t);if(!r)throw new Error("Unknown command");const{callback:n,thisArg:o,metadata:a}=r;if(a?.args)for(let l=0;l<a.args.length;l++)try{dE(i[l],a.args[l].constraint)}catch{throw new Error(`Running the contributed command: '${t}' failed. Illegal argument '${a.args[l].name}' - ${a.args[l].description}`)}const c=Qi.create();try{return await n.apply(o,i)}catch(l){if(t===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...i);u&&(t=u.command)}if(Mi(l)||this.d.error(l,t,r.extension?.identifier),!s)throw l;if(r.extension?.identifier){const u=this.#i.onExtensionError(r.extension.identifier,l);this.d.trace("forwarded error to extension?",u,r.extension?.identifier)}throw new class extends Error{constructor(){super(Sr(l)),this.id=t,this.source=r.extension?.displayName??r.extension?.name}}}finally{this.j(r,t,c.elapsed())}}j(t,i,s){t.extension&&(i.startsWith("code.copilot.logStructured")||this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:t.extension.identifier.value,id:new Rw(i),duration:s}))}$executeContributedCommand(t,...i){this.d.trace("ExtHostCommands#$executeContributedCommand",t);const s=this.b.get(t);return s?(i=i.map(r=>this.f.reduce((n,o)=>o.processArgument(n,s.extension),r)),this.h(t,i,!0)):Promise.reject(new Error(`Contributed command '${t}' does not exist.`))}getCommands(t=!1){return this.d.trace("ExtHostCommands#getCommands",t),this.#e.$getCommands().then(i=>(t&&(i=i.filter(s=>s[0]!=="_")),i))}$getContributedCommandMetadata(){const t=Object.create(null);for(const[i,s]of this.b){const{metadata:r}=s;r&&(t[i]=r)}return Promise.resolve(t)}};vA=__decorate([__param(0,ke),__param(1,Se),__param(2,Em)],vA);var cr=H("IExtHostCommands"),R_=class{constructor(e,t,i){this.d=e,this.f=t,this.g=i,this.delegatingCommandId=`__vsc${Nt()}`,this.b=new Map,this.c=0,this.d.registerCommand(!0,this.delegatingCommandId,this.h,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const s=this.f(e.command);if(s)i.id=s.internalId,i.arguments=s.args.map((r,n)=>r.convert(e.arguments&&e.arguments[n]));else if(nu(e.arguments)){const r=`${e.command} /${++this.c}`;this.b.set(r,e),t.add(te(()=>{this.b.delete(r),this.g.trace("CommandsConverter#DISPOSE",r)})),i.$ident=r,i.id=this.delegatingCommandId,i.arguments=[r],this.g.trace("CommandsConverter#CREATE",e.command,r)}return i}fromInternal(e){return typeof e.$ident=="string"?this.b.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this.b.get(e[0])}h(...e){const t=this.getActualCommand(...e);return this.g.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this.d.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}},_=class ls{static{this.Uri=new ls("uri","Uri of a text document",t=>y.isUri(t),t=>t)}static{this.Position=new ls("position","A position in a text document",t=>Pe.isPosition(t),Xe.from)}static{this.Range=new ls("range","A range in a text document",t=>xe.isRange(t),U.from)}static{this.Selection=new ls("selection","A selection in a text document",t=>Dr.isSelection(t),or.from)}static{this.Number=new ls("number","",t=>typeof t=="number",t=>t)}static{this.String=new ls("string","",t=>typeof t=="string",t=>t)}static Arr(t){return new ls(`${t.name}_array`,`Array of ${t.name}, ${t.description}`,i=>Array.isArray(i)&&i.every(s=>t.validate(s)),i=>i.map(s=>t.convert(s)))}static{this.CallHierarchyItem=new ls("item","A call hierarchy item",t=>t instanceof Gw,Ta.from)}static{this.TypeHierarchyItem=new ls("item","A type hierarchy item",t=>t instanceof Ib,Ma.from)}static{this.TestItem=new ls("testItem","A VS Code TestItem",t=>t instanceof Zh,bo.from)}static{this.TestProfile=new ls("testProfile","A VS Code test profile",t=>t instanceof E7,yy.from)}constructor(t,i,s,r){this.name=t,this.description=i,this.validate=s,this.convert=r}optional(){return new ls(this.name,`(optional) ${this.description}`,t=>t==null||this.validate(t),t=>t===void 0?void 0:t===null?null:this.convert(t))}with(t,i){return new ls(t??this.name,i??this.description,this.validate,this.convert)}},be=class MM{static{this.Void=new MM("no result",t=>t)}constructor(t,i){this.description=t,this.convert=i}},Ae=class{constructor(e,t,i,s,r){this.id=e,this.internalId=t,this.description=i,this.args=s,this.result=r}},mn=H("IExtHostTerminalService"),wA=class extends Z{constructor(e,t,i,s){super(),this.s=e,this._id=t,this.u=i,this.w=s,this.a=!1,this.m={isInteractedWith:!1,shell:void 0},this.isOpen=!1,this.q=this.D(new I),this.onWillDispose=this.q.event,this.u=Object.freeze(this.u),this.b=new Promise(n=>this.g=n);const r=this;this.value={get name(){return r.w||""},get processId(){return r.b},get creationOptions(){return r.u},get exitStatus(){return r.j},get state(){return r.m},get selection(){return r.n},get shellIntegration(){return r.shellIntegration},sendText(n,o=!0){r.z(),r.s.$sendText(r._id,n,o)},show(n){r.z(),r.s.$show(r._id,n)},hide(){r.z(),r.s.$hide(r._id)},dispose(){r.a||(r.a=!0,r.s.$dispose(r._id))},get dimensions(){if(!(r.f===void 0||r.h===void 0))return{columns:r.f,rows:r.h}}}}dispose(){this.q.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this.s.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:FD(e.iconPath)??void 0,color:Ac.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:t?.forceShellIntegration??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this.y(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0,shellIntegrationNonce:e.shellIntegrationNonce??void 0})}async createExtensionTerminal(e,t,i,s,r,n){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this.s.$createTerminal(this._id,{name:this.w,isExtensionCustomPtyTerminal:!0,icon:s,color:Ac.isThemeColor(r)?r.id:void 0,location:t?.location||this.y(e,i),isTransient:!0,shellIntegrationNonce:n??void 0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}y(e,t){return typeof e=="object"?Nn(e,{parentTerminal:!0})&&e.parentTerminal&&t?{parentTerminal:t}:Nn(e,{viewColumn:!0})?{viewColumn:Kt.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}z(){if(this.a)throw new Error("Terminal has already been disposed")}set name(e){this.w=e}setExitStatus(e,t){this.j=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this.f&&t===this.h||e===0||t===0?!1:(this.f=e,this.h=t,!0)}setInteractedWith(){return this.m.isInteractedWith?!1:(this.m={...this.m,isInteractedWith:!0},!0)}setShellType(e){return this.m.shell!==e?(this.m={...this.m,shell:e},!0):!1}setSelection(e){this.n=e}_setProcessId(e){this.g?(this.g(e),this.g=void 0):this.b.then(t=>{t!==e&&(this.b=Promise.resolve(e))})}},bA=class{get onProcessReady(){return this.b.event}constructor(e){this.g=e,this.id=0,this.shouldPersist=!1,this.a=new I,this.onProcessData=this.a.event,this.b=new I,this.d=new I,this.onDidChangeProperty=this.d.event,this.f=new I,this.onProcessExit=this.f.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this.g.close()}input(e){this.g.handleInput?.(e)}sendSignal(e){}resize(e,t){this.g.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this.g.onDidWrite(t=>this.a.fire(t)),this.g.onDidClose?.((t=void 0)=>{this.f.fire(t===void 0?void 0:t)}),this.g.onDidOverrideDimensions?.(t=>{t&&this.d.fire({type:"overrideDimensions",value:{cols:t.columns,rows:t.rows}})}),this.g.onDidChangeName?.(t=>{this.d.fire({type:"title",value:t})}),this.g.open(e||void 0),e&&this.g.setDimensions?.(e),this.b.fire({pid:-1,cwd:"",windowsPty:void 0})}},O_=1,xm=class extends Z{get activeTerminal(){return this.b?.value}get terminals(){return this.f.map(t=>t.value)}constructor(t,i,s){super(),this.R=i,this.f=[],this.g=new Map,this.h={},this.j={},this.m={},this.n=new Map,this.u=this.D(new Vs),this.y=new Set,this.z=new Map,this.C=new Map,this.F=new Map,this.G=new Map,this.H=new Map,this.I=new I,this.onDidCloseTerminal=this.I.event,this.J=new I,this.onDidOpenTerminal=this.J.event,this.L=new I,this.onDidChangeActiveTerminal=this.L.event,this.M=new I,this.onDidChangeTerminalDimensions=this.M.event,this.N=new I,this.onDidChangeTerminalState=this.N.event,this.O=new I,this.onDidChangeShell=this.O.event,this.P=new I({onWillAddFirstListener:()=>this.a.$startSendingDataEvents(),onDidRemoveLastListener:()=>this.a.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this.P.event,this.Q=new I({onWillAddFirstListener:()=>this.a.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this.a.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this.Q.event,this.a=s.getProxy(Y.MainThreadTerminalService),this.w=new P_(this.a.$sendProcessData),this.a.$registerProcessSupport(t),this.R.registerArgumentProcessor({processArgument:r=>{const n=o=>this.getTerminalById(o.instanceId)?.value;switch(r?.$mid){case 15:return n(r);default:{if(Array.isArray(r))for(let o=0;o<r.length&&r[o].$mid===15;o++)r[o]=n(r[o]);return r}}}}),this.D({dispose:()=>{for(const[r,n]of this.g)n.shutdown(!0)}})}getDefaultShell(t){return(t?this.s:this.q)?.path||""}getDefaultShellArgs(t){return(t?this.s:this.q)?.args||[]}createExtensionTerminal(t,i){const s=new wA(this.a,Nt(),t,t.name),r=new bA(t.pty);return s.createExtensionTerminal(t.location,i,this.S(t,i).resolvedExtHostIdentifier,FD(t.iconPath),U_(t.color),t.shellIntegrationNonce).then(n=>{const o=this.U(n,r);this.h[n]=o}),this.f.push(s),s.value}S(t,i){if(i=i||{},t.location&&typeof t.location=="object"&&Nn(t.location,{parentTerminal:!0})){const s=t.location.parentTerminal;if(s){const r=this.f.find(n=>n.value===s);r&&(i.resolvedExtHostIdentifier=r._id)}}else t.location&&typeof t.location!="object"?i.location=t.location:i.location&&typeof i.location=="object"&&Nn(i.location,{splitActiveTerminal:!0})&&(i.location={splitActiveTerminal:!0});return i}attachPtyToTerminal(t,i){if(!this.getTerminalById(t))throw new Error(`Cannot resolve terminal with id ${t} for virtual process`);const r=new bA(i),n=this.U(t,r);this.h[t]=n}async $acceptActiveTerminalChanged(t){const i=this.b;if(t===null){this.b=void 0,i!==this.b&&this.L.fire(this.b);return}const s=this.getTerminalById(t);s&&(this.b=s,i!==this.b&&this.L.fire(this.b.value))}async $acceptTerminalProcessData(t,i){const s=this.getTerminalById(t);s&&this.P.fire({terminal:s.value,data:i})}async $acceptTerminalDimensions(t,i,s){const r=this.getTerminalById(t);r&&r.setDimensions(i,s)&&this.M.fire({terminal:r.value,dimensions:r.value.dimensions})}async $acceptDidExecuteCommand(t,i){const s=this.getTerminalById(t);s&&this.Q.fire({terminal:s.value,...i})}async $acceptTerminalMaximumDimensions(t,i,s){this.g.get(t)?.resize(i,s)}async $acceptTerminalTitleChange(t,i){const s=this.getTerminalById(t);s&&(s.name=i)}async $acceptTerminalClosed(t,i,s){const r=this.Y(this.f,t);if(r!==null){const n=this.f.splice(r,1)[0];n.setExitStatus(i,s),this.I.fire(n.value)}}$acceptTerminalOpened(t,i,s,r){if(i){const a=this.Y(this.f,i);if(a!==null){this.f[a]._id=t,this.J.fire(this.terminals[a]),this.f[a].isOpen=!0;return}}const n={name:r.name,shellPath:r.executable,shellArgs:r.args,cwd:typeof r.cwd=="string"?r.cwd:y.revive(r.cwd),env:r.env,hideFromUser:r.hideFromUser},o=new wA(this.a,t,n,s);this.f.push(o),this.J.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(t,i){this.getTerminalById(t)?._setProcessId(i)}async $startExtensionTerminal(t,i){const s=this.getTerminalById(t);if(!s)return{message:d(3050,null,t)};s.isOpen||await new Promise(n=>{const o=this.onDidOpenTerminal(async a=>{a===s.value&&(o.dispose(),n())})});const r=this.g.get(t);r?r.startSendingEvents(i):this.j[t]={initialDimensions:i}}U(t,i){const s=new ie;s.add(i.onProcessReady(n=>this.a.$sendProcessReady(t,n.pid,n.cwd,n.windowsPty))),s.add(i.onDidChangeProperty(n=>this.a.$sendProcessProperty(t,n))),this.w.startBuffering(t,i.onProcessData),s.add(i.onProcessExit(n=>this.W(t,n))),this.g.set(t,i);const r=this.j[t];return r&&i instanceof bA&&(i.startSendingEvents(r.initialDimensions),delete this.j[t]),s}$acceptProcessAckDataEvent(t,i){this.g.get(t)?.acknowledgeDataEvent(i)}$acceptProcessInput(t,i){this.g.get(t)?.input(i)}$acceptTerminalInteraction(t){const i=this.getTerminalById(t);i?.setInteractedWith()&&this.N.fire(i.value)}$acceptTerminalSelection(t,i){this.getTerminalById(t)?.setSelection(i)}$acceptProcessResize(t,i,s){try{this.g.get(t)?.resize(i,s)}catch(r){if(r.code!=="EPIPE"&&r.code!=="ERR_IPC_CHANNEL_CLOSED")throw r}}$acceptProcessShutdown(t,i){this.g.get(t)?.shutdown(i)}$acceptProcessRequestInitialCwd(t){this.g.get(t)?.getInitialCwd().then(i=>this.a.$sendProcessProperty(t,{type:"initialCwd",value:i}))}$acceptProcessRequestCwd(t){this.g.get(t)?.getCwd().then(i=>this.a.$sendProcessProperty(t,{type:"cwd",value:i}))}$acceptProcessRequestLatency(t){return Promise.resolve(t)}registerProfileProvider(t,i,s){if(this.C.has(i))throw new Error(`Terminal profile provider "${i}" already registered`);return this.C.set(i,s),this.a.$registerProfileProvider(i,t.identifier.value),new Ce(()=>{this.C.delete(i),this.a.$unregisterProfileProvider(i)})}registerTerminalCompletionProvider(t,i,...s){if(this.z.has(t.identifier.value))throw new Error(`Terminal completion provider "${t.identifier.value}" already registered`);return this.z.set(t.identifier.value,i),this.a.$registerCompletionProvider(t.identifier.value,t.identifier.value,...s),new Ce(()=>{this.z.delete(t.identifier.value),this.a.$unregisterCompletionProvider(t.identifier.value)})}async $provideTerminalCompletions(t,i){const s=new Qe().token;if(s.isCancellationRequested||!this.activeTerminal)return;const r=this.z.get(t);if(!r)return;const n=await r.provideTerminalCompletions(this.activeTerminal,i,s);if(n==null)return;const o=!ze||this.activeTerminal.state?.shell==="gitbash"?"/":"\\";return My.from(n,o)}$acceptTerminalShellType(t,i){const s=this.getTerminalById(t);s?.setShellType(i)&&this.N.fire(s.value)}registerTerminalQuickFixProvider(t,i,s){if(this.F.has(t))throw new Error(`Terminal quick fix provider "${t}" is already registered`);return this.F.set(t,s),this.a.$registerQuickFixProvider(t,i),new Ce(()=>{this.F.delete(t),this.a.$unregisterQuickFixProvider(t)})}async $provideTerminalQuickFixes(t,i){const s=new Qe().token;if(s.isCancellationRequested)return;const r=this.F.get(t);if(!r)return;const n=await r.provideTerminalQuickFixes(i,s);if(n===null||Array.isArray(n)&&n.length===0)return;const o=new ie;if(this.u.value=o,!Array.isArray(n))return n?sm.from(n,this.R.converter,o):void 0;const a=[];for(const c of n){const l=sm.from(c,this.R.converter,o);l&&a.push(l)}return a}async $createContributedProfileTerminal(t,i){const s=new Qe().token;let r=await this.C.get(t)?.provideTerminalProfile(s);if(!s.isCancellationRequested){if(r&&!Nn(r,{options:!0})&&(r={options:r}),!r||!Nn(r,{options:!0}))throw new Error(`No terminal profile options provided for id "${t}"`);if(Nn(r.options,{pty:!0})){this.createExtensionTerminal(r.options,i);return}this.createTerminalFromOptions(r.options,i)}}registerLinkProvider(t){return this.y.add(t),this.y.size===1&&this.a.$startLinkProvider(),new Ce(()=>{this.y.delete(t),this.y.size===0&&this.a.$stopLinkProvider()})}async $provideLinks(t,i){const s=this.getTerminalById(t);if(!s)return[];this.G.delete(t),this.H.get(t)?.dispose(!0);const n=new Qe;this.H.set(t,n);const o=[],a={terminal:s.value,line:i},c=[];for(const h of this.y)c.push(Wn.withAsyncBody(async f=>{n.token.onCancellationRequested(()=>f({provider:h,links:[]}));const p=await h.provideTerminalLinks(a,n.token)||[];n.token.isCancellationRequested||f({provider:h,links:p})}));const l=await Promise.all(c);if(n.token.isCancellationRequested)return[];const u=new Map;for(const h of l)h&&h.links.length>0&&o.push(...h.links.map(f=>{const p={id:O_++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(p.id,{provider:h.provider,link:f}),p}));return this.G.set(t,u),o}$activateLink(t,i){const s=this.G.get(t)?.get(i);s&&s.provider.handleTerminalLink(s.link)}W(t,i){this.w.stopBuffering(t),this.g.delete(t),delete this.j[t];const s=this.h[t];s&&(s.dispose(),delete this.h[t]),this.a.$sendProcessExit(t,i)}getTerminalById(t){return this.X(this.f,t)}getTerminalIdByApiObject(t){const i=this.f.findIndex(s=>s.value===t);return i>=0?i:null}X(t,i){const s=this.Y(t,i);return s!==null?t[s]:null}Y(t,i){const s=t.findIndex(r=>r._id===i);return s>=0?s:null}getEnvironmentVariableCollection(t){let i=this.n.get(t.identifier.value);return i||(i=this.D(new OD),this.$(t.identifier.value,i)),i.getScopedEnvironmentVariableCollection(void 0)}Z(t,i){const s=I_(i.map),r=D_(i.descriptionMap);this.a.$setEnvironmentVariableCollection(t,i.persistent,s.length===0?void 0:s,r)}$initEnvironmentVariableCollections(t){t.forEach(i=>{const s=i[0],r=this.D(new OD(i[1]));this.$(s,r)})}$acceptDefaultProfile(t,i){const s=this.q;this.q=t,this.s=i,s?.path!==t.path&&this.O.fire(t.path)}$(t,i){this.n.set(t,i),this.D(i.onDidChangeCollection(()=>{this.Z(t,i)}))}};xm=__decorate([__param(1,cr),__param(2,ke)],xm);var OD=class extends Z{get persistent(){return this.b}set persistent(e){this.b=e,this.f.fire()}get onDidChangeCollection(){return this.f&&this.f.event}constructor(e){super(),this.map=new Map,this.a=new Map,this.descriptionMap=new Map,this.b=!0,this.f=new I,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.j(e);let i=this.a.get(t);return i||(i=new F_(this,e),this.a.set(t,i),this.D(i.onDidChangeCollection(()=>this.f.fire()))),i}replace(e,t,i,s){this.g(e,{value:t,type:Lc.Replace,options:i??{applyAtProcessCreation:!0},scope:s})}append(e,t,i,s){this.g(e,{value:t,type:Lc.Append,options:i??{applyAtProcessCreation:!0},scope:s})}prepend(e,t,i,s){this.g(e,{value:t,type:Lc.Prepend,options:i??{applyAtProcessCreation:!0},scope:s})}g(e,t){if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.h(e,t.scope),s=this.map.get(i),r=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!s||s.value!==t.value||s.type!==t.type||s.options?.applyAtProcessCreation!==r.applyAtProcessCreation||s.options?.applyAtShellIntegration!==r.applyAtShellIntegration||s.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){const n=this.h(e,t.scope),o={variable:e,...t,options:r};this.map.set(n,o),this.f.fire()}}get(e,t){const i=this.h(e,t),s=this.map.get(i);return s?UD(s):void 0}h(e,t){const i=this.j(t);return i.length?`${e}:::${i}`:e}j(e){return this.m(e?.workspaceFolder)??""}m(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,s]of this.map)this.j(s.scope)===this.j(e)&&t.set(s.variable,UD(s));return t}delete(e,t){const i=this.h(e,t);this.map.delete(i),this.f.fire()}clear(e){if(e?.workspaceFolder){for(const[t,i]of this.map)i.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.n(e)}else this.map.clear(),this.descriptionMap.clear();this.f.fire()}setDescription(e,t){const i=this.j(t),s=this.descriptionMap.get(i);if(!s||s.description!==e){let r;typeof e=="string"?r=e:r=e?.value.split(`

`)[0];const n={description:r,scope:t};this.descriptionMap.set(i,n),this.f.fire()}}getDescription(e){const t=this.j(e);return this.descriptionMap.get(t)?.description}n(e){const t=this.j(e);this.descriptionMap.delete(t)}},F_=class{get persistent(){return this.b.persistent}set persistent(e){this.b.persistent=e}get onDidChangeCollection(){return this.a&&this.a.event}constructor(e,t){this.b=e,this.d=t,this.a=new I}getScoped(e){return this.b.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.b.replace(e,t,i,this.d)}append(e,t,i){this.b.append(e,t,i,this.d)}prepend(e,t,i){this.b.prepend(e,t,i,this.d)}get(e){return this.b.get(e,this.d)}forEach(e,t){this.b.getVariableMap(this.d).forEach((i,s)=>e.call(t,s,i,this),this.d)}[Symbol.iterator](){return this.b.getVariableMap(this.d).entries()}delete(e){this.b.delete(e,this.d),this.a.fire(void 0)}clear(){this.b.clear(this.d)}set description(e){this.b.setDescription(e,this.d)}get description(){return this.b.getDescription(this.d)}},yA=class extends xm{constructor(t,i){super(!1,t,i)}createTerminal(t,i,s){throw new Sv}createTerminalFromOptions(t,i){throw new Sv}};yA=__decorate([__param(0,cr),__param(1,ke)],yA);function FD(e){if(!(!e||typeof e=="string"))return Nn(e,{id:!0})?{id:e.id,color:e.color}:e}function U_(e){return Ac.isThemeColor(e)?e:void 0}function UD(e){const t={...e};return delete t.scope,t.options=t.options??void 0,t}var j_=H("progressService"),jD;(function(e){e[e.Explorer=1]="Explorer",e[e.Scm=3]="Scm",e[e.Extensions=5]="Extensions",e[e.Window=10]="Window",e[e.Notification=15]="Notification",e[e.Dialog=20]="Dialog"})(jD||(jD={}));var mre=Object.freeze({total(){},worked(){},done(){}}),Cm=class{static{this.None=Object.freeze({report(){}})}get value(){return this.a}constructor(e){this.b=e}report(e){this.a=e,this.b(this.a)}},zD=class extends Z{constructor(t,i){super(),this.a=new Ri,i.withProgress(t,s=>(this.b=s,this.c&&s.report(this.c),this.a.p)),this.D(te(()=>this.a.complete()))}report(t){this.b?this.b.report(t):this.c=t}};zD=__decorate([__param(1,j_)],zD);var wre=H("editorProgressService"),z_={label:d(6537,null),order:Number.MAX_SAFE_INTEGER},HD="__";function H_(e){return typeof e=="object"&&e!==null&&"wwwAuthenticate"in e&&typeof e.wwwAuthenticate=="string"}var W_=H("IAuthenticationService"),B_=H("IAuthenticationExtensionsService"),AA="/.well-known",__=`${AA}/oauth-protected-resource`,V_=`${AA}/oauth-authorization-server`,SA=`${AA}/openid-configuration`,EA=" ",WD;(function(e){e.InvalidRequest="invalid_request",e.InvalidClient="invalid_client",e.InvalidGrant="invalid_grant",e.UnauthorizedClient="unauthorized_client",e.UnsupportedGrantType="unsupported_grant_type",e.InvalidScope="invalid_scope"})(WD||(WD={}));var BD;(function(e){e.AuthorizationPending="authorization_pending",e.SlowDown="slow_down",e.AccessDenied="access_denied",e.ExpiredToken="expired_token"})(BD||(BD={}));var _D;(function(e){e.InvalidRedirectUri="invalid_redirect_uri",e.InvalidClientMetadata="invalid_client_metadata",e.InvalidSoftwareStatement="invalid_software_statement",e.UnapprovedSoftwareStatement="unapproved_software_statement"})(_D||(_D={}));function q_(e){if(typeof e!="object"||e===null)return!1;const t=e;return!(!t.resource||t.scopes_supported!==void 0&&!Array.isArray(t.scopes_supported))}var G_=["issuer","authorization_endpoint","token_endpoint","registration_endpoint","jwks_uri"];function J_(e){if(typeof e!="object"||e===null)return!1;const t=e;if(!t.issuer)throw new Error("Authorization server metadata must have an issuer");for(const i of G_)if(t[i]){if(typeof t[i]!="string")throw new Error(`Authorization server metadata '${i}' must be a string`);if(!t[i].startsWith("https://")&&!t[i].startsWith("http://"))throw new Error(`Authorization server metadata '${i}' must start with http:// or https://`)}return!0}function Z_(e){return typeof e!="object"||e===null?!1:e.client_id!==void 0}function xA(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.access_token!==void 0&&t.token_type!==void 0}function Q_(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.device_code!==void 0&&t.user_code!==void 0&&t.verification_uri!==void 0&&t.expires_in!==void 0}function VD(e){return typeof e!="object"||e===null?!1:e.error!==void 0}function Y_(e){return typeof e!="object"||e===null?!1:e.error!==void 0}function X_(e){return{issuer:e.toString(),authorization_endpoint:new URL("/authorize",e).toString(),token_endpoint:new URL("/token",e).toString(),registration_endpoint:new URL("/register",e).toString(),response_types_supported:["code","id_token","id_token token"]}}var qD=["authorization_code","refresh_token","urn:ietf:params:oauth:grant-type:device_code"],GD=33418;async function JD(e,t,i){if(!e.registration_endpoint)throw new Error("Server does not support dynamic registration");const s={client_name:t,client_uri:"https://code.visualstudio.com",grant_types:e.grant_types_supported?e.grant_types_supported.filter(o=>qD.includes(o)):qD,response_types:["code"],redirect_uris:["https://insiders.vscode.dev/redirect","https://vscode.dev/redirect","http://127.0.0.1/",`http://127.0.0.1:${GD}/`],scope:i?.join(EA),token_endpoint_auth_method:"none",application_type:"native"},r=await fetch(e.registration_endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const o=await r.text();let a=o;try{const c=JSON.parse(o);Y_(c)&&(a=`${c.error}${c.error_description?`: ${c.error_description}`:""}`)}catch{}throw new Error(`Registration to ${e.registration_endpoint} failed: ${a}`)}const n=await r.json();if(Z_(n))return n;throw new Error(`Invalid authorization dynamic client registration response: ${JSON.stringify(n)}`)}function ZD(e){const t=[],i=[];let s="",r=!1;for(let o=0;o<e.length;o++){const a=e[o];a==='"'?(r=!r,s+=a):a===","&&!r?(s.trim()&&i.push(s.trim()),s=""):s+=a}s.trim()&&i.push(s.trim());let n;for(const o of i)if(!o.includes("="))n&&t.push(n),n={scheme:o.trim(),params:{}};else{const c=o.indexOf(" ");if(c>0){const l=o.substring(0,c),u=o.substring(c+1);if(!l.includes("=")&&u.includes("=")){n&&t.push(n),n={scheme:l.trim(),params:{}};const h=u.indexOf("=");if(h>0){const f=u.substring(0,h).trim(),p=u.substring(h+1).trim().replace(/^"|"$/g,"");f&&p!==void 0&&(n.params[f]=p)}continue}}if(n){const l=o.indexOf("=");if(l>0){const u=o.substring(0,l).trim(),h=o.substring(l+1).trim().replace(/^"|"$/g,"");u&&h!==void 0&&(n.params[u]=h)}}}return n&&t.push(n),t}function QD(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid JWT token format: token must have three parts separated by dots");const[i,s,r]=t;try{if(typeof JSON.parse(qo(i).toString())!="object")throw new Error("Invalid JWT token format: header is not a JSON object");const o=JSON.parse(qo(s).toString());if(typeof o!="object")throw new Error("Invalid JWT token format: payload is not a JSON object");return o}catch(n){throw n instanceof Error?new Error(`Failed to parse JWT token: ${n.message}`):new Error("Failed to parse JWT token")}}function K_(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;const i=[...e].sort(),s=[...t].sort();return i.every((r,n)=>r===s[n])}async function eV(e,t,i={}){const{sameOriginHeaders:s={},fetch:r=fetch}=i,n=new URL(e),o=async(u,h)=>{let f={Accept:"application/json"};new URL(u).origin===n.origin&&(f={...f,...s});const g=await r(u,{method:"GET",headers:f});if(g.status!==200){let b;try{b=await g.text()}catch{b=g.statusText}throw new Error(`Failed to fetch resource metadata from ${u}: ${g.status} ${b}`)}const v=await g.json();if(q_(v)){const b=new URL(v.resource).toString(),S=new URL(h).toString();if(b!==S)throw new Error(`Protected Resource Metadata 'resource' property value "${b}" does not match expected value "${S}" for URL ${u}. Per RFC 9728, these MUST match. See https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`);return v}else throw new Error(`Invalid resource metadata from ${u}. Expected to follow shape of https://datatracker.ietf.org/doc/html/rfc9728#name-protected-resource-metadata (Hints: is scopes_supported an array? Is resource a string?). Current payload: ${JSON.stringify(v)}`)},a=[];if(t)try{return{metadata:await o(t,e),errors:a}}catch(u){a.push(u instanceof Error?u:new Error(String(u)))}const c=n.pathname!=="/",l=`${n.origin}${__}`;if(c){const u=`${l}${n.pathname}`;try{return{metadata:await o(u,e),errors:a}}catch(h){a.push(h instanceof Error?h:new Error(String(h)))}}try{return{metadata:await o(l,n.origin),errors:a}}catch(u){a.push(u instanceof Error?u:new Error(String(u)))}throw a.length===1?a[0]:new AggregateError(a,"Failed to fetch resource metadata from all attempted URLs")}async function tV(e){if(e.status===200)try{const t=await e.json();if(J_(t))return t}catch{}}async function iV(e){try{return await e.text()}catch{return e.statusText}}async function sV(e,t={}){const{additionalHeaders:i={},fetch:s=fetch}=t,r=new URL(e),n=r.pathname==="/"?"":r.pathname,o=[],a=async f=>{try{const p=await s(f,{method:"GET",headers:{...i,Accept:"application/json"}}),g=await tV(p);if(g)return g;o.push(new Error(`Failed to fetch authorization server metadata from ${f}: ${p.status} ${await iV(p)}`));return}catch(p){o.push(p instanceof Error?p:new Error(String(p)));return}},c=new URL(V_,e).toString()+n;let l=await a(c);if(l)return l;const u=new URL(SA,e).toString()+n;if(l=await a(u),l)return l;const h=e.endsWith("/")?e+SA.substring(1):e+SA;if(l=await a(h),l)return l;throw o.length===1?o[0]:new AggregateError(o,"Failed to fetch authorization server metadata from all attempted URLs")}var CA,kA=class{static{CA=this}static{this.a={focused:!0,active:!0}}getState(){const t=this.f;return{get focused(){return t.focused},get active(){return t.active}}}constructor(t,i){this.c=new I,this.onDidChangeWindowState=this.c.event,this.f=CA.a,t.handle&&(this.d=qo(t.handle).buffer),this.b=i.getProxy(Y.MainThreadWindow),this.b.$getInitialState().then(({isFocused:s,isActive:r})=>{this.onDidChangeWindowProperty("focused",s),this.onDidChangeWindowProperty("active",r)})}get nativeHandle(){return this.d}$onDidChangeActiveNativeWindowHandle(t){this.d=t?qo(t).buffer:void 0}$onDidChangeWindowFocus(t){this.onDidChangeWindowProperty("focused",t)}$onDidChangeWindowActive(t){this.onDidChangeWindowProperty("active",t)}onDidChangeWindowProperty(t,i){i!==this.f[t]&&(this.f={...this.f,[t]:i},this.c.fire(this.f))}openUri(t,i){let s;if(typeof t=="string"){s=t;try{t=y.parse(t)}catch{return Promise.reject(`Invalid uri - '${t}'`)}}return fu(t.scheme)?Promise.reject("Invalid scheme - cannot be empty"):t.scheme===V.command?Promise.reject(`Invalid scheme '${t.scheme}'`):this.b.$openUri(t,s,i)}async asExternalUri(t,i){if(fu(t.scheme))return Promise.reject("Invalid scheme - cannot be empty");const s=await this.b.$asExternalUri(t,i);return y.from(s)}};kA=CA=__decorate([__param(0,jt),__param(1,ke)],kA);var km=H("IExtHostWindow"),$A,IA=class{static{$A=this}static{this.a=0}constructor(t){this.c=new Ko,this.d=new Map,this.b=t.getProxy(Y.MainThreadUrls)}registerUriHandler(t,i){const s=t.identifier;if(this.c.has(s))throw new Error(`Protocol handler already registered for extension ${s}`);const r=$A.a++;return this.c.add(s),this.d.set(r,i),this.b.$registerUriHandler(r,s,t.displayName||t.name),te(()=>{this.c.delete(s),this.d.delete(r),this.b.$unregisterUriHandler(r)})}$handleExternalUri(t,i){const s=this.d.get(t);if(!s)return Promise.resolve(void 0);try{s.handleUri(y.revive(i))}catch(r){lt(r)}return Promise.resolve(void 0)}async createAppUri(t){return y.revive(await this.b.$createAppUri(t))}};IA=$A=__decorate([__param(0,ke)],IA);var $m=H("IExtHostUrlsService"),Im=H("IExtHostProgress"),DA=class{constructor(t){this.b=0,this.c=new Map,this.a=t.getProxy(Y.MainThreadProgress)}async withProgress(t,i,s){const r=this.b++,{title:n,location:o,cancellable:a}=i,c={label:t.displayName||t.name,id:t.identifier.value};return this.a.$startProgress(r,{location:Ug.from(o),title:n,source:c,cancellable:a},t.isUnderDevelopment?void 0:t.identifier.value).catch(Qd),this.d(r,s,!!a)}async withProgressFromSource(t,i,s){const r=this.b++,{title:n,location:o,cancellable:a}=i;return this.a.$startProgress(r,{location:Ug.from(o),title:n,source:t,cancellable:a},void 0).catch(Qd),this.d(r,s,!!a)}d(t,i,s){let r;s&&(r=new Qe,this.c.set(t,r));const n=a=>{this.a.$progressEnd(a),this.c.delete(a),r?.dispose()};let o;try{o=i(new YD(this.a,t),s&&r?r.token:Fe.None)}catch(a){throw n(t),a}return o.then(a=>n(t),a=>n(t)),o}$acceptProgressCanceled(t){const i=this.c.get(t);i&&(i.cancel(),this.c.delete(t))}};DA=__decorate([__param(0,ke)],DA);function rV(e,t){return e.message=t.message,typeof t.increment=="number"&&(typeof e.increment=="number"?e.increment+=t.increment:e.increment=t.increment),e}var YD=class extends Cm{constructor(e,t){super(i=>this.throttledReport(i)),this.c=e,this.d=t}throttledReport(e){this.c.$progressReport(this.d,e)}};__decorate([iF(100,(e,t)=>rV(e,t),()=>Object.create(null))],YD.prototype,"throttledReport",null);var PA=H("IExtHostAuthentication"),TA=class{constructor(t,i,s,r,n,o,a){this.l=i,this.m=s,this.n=r,this.o=n,this.p=o,this.q=a,this.c=Dm,this.f=new Map,this.g=new vx,this.h=new I,this.j=new nV,this.k=new I,this.d=t.getProxy(Y.MainThreadAuthentication)}getExtensionScopedSessionsEvent(t){const i=t.toLowerCase();return Ie.chain(this.h.event,s=>s.filter(r=>!r.extensionIdFilter||r.extensionIdFilter.includes(i)).map(r=>({provider:r.provider})))}async getSession(t,i,s,r={}){const n=Ye.toKey(t.identifier),a=Object.keys(r).map(l=>{switch(l){case"account":return`${l}:${r.account?.id}`;case"createIfNone":case"forceNewSession":{const u=typeof r[l]=="boolean"?`${r[l]}`:`'${r[l]?.detail}/${r[l]?.learnMore?.toString()}'`;return`${l}:${u}`}case"authorizationServer":return`${l}:${r.authorizationServer?.toString(!0)}`;default:return`${l}:${!!r[l]}`}}).sort().join(", ");let c;if(H_(s)){const l=s,u=l.wwwAuthenticate,h=l.fallbackScopes?[...l.fallbackScopes].sort().join(" "):"";c=`${n} ${i} challenge:${u} ${h} ${a}`}else{const l=[...s].sort().join(" ");c=`${n} ${i} ${l} ${a}`}return await this.j.getOrCreate(c,async()=>{await this.d.$ensureProvider(i);const l=t.displayName||t.name;return this.d.$getSession(i,s,n,l,r)})}async getAccounts(t){return await this.d.$ensureProvider(t),await this.d.$getAccounts(t)}registerAuthenticationProvider(t,i,s,r){return this.g.queue(t,async()=>{if(this.f.get(t)){this.q.error(`An authentication provider with id '${t}' is already registered. The existing provider will not be replaced.`);return}const n=s.onDidChangeSessions(o=>this.d.$sendDidChangeSessions(t,o));this.f.set(t,{label:i,provider:s,disposable:n,options:r??{supportsMultipleAccounts:!1}}),await this.d.$registerAuthenticationProvider({id:t,label:i,supportsMultipleAccounts:r?.supportsMultipleAccounts??!1,supportedAuthorizationServers:r?.supportedAuthorizationServers,supportsChallenges:r?.supportsChallenges})}),new Ce(()=>{this.g.queue(t,async()=>{const n=this.f.get(t);n&&(n.disposable?.dispose(),this.f.delete(t),await this.d.$unregisterAuthenticationProvider(t))})})}$createSession(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r)return s.authorizationServer=y.revive(s.authorizationServer),await r.provider.createSession(i,s);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$removeSession(t,i){return this.g.queue(t,async()=>{const s=this.f.get(t);if(s)return await s.provider.removeSession(i);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$getSessions(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r)return s.authorizationServer=y.revive(s.authorizationServer),await r.provider.getSessions(i,s);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$getSessionsFromChallenges(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r){const n=r.provider;if(typeof n.getSessionsFromChallenges=="function")return s.authorizationServer=y.revive(s.authorizationServer),await n.getSessionsFromChallenges(i,s);throw new Error(`Authentication provider with handle: ${t} does not support getSessionsFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$createSessionFromChallenges(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r){const n=r.provider;if(typeof n.createSessionFromChallenges=="function")return s.authorizationServer=y.revive(s.authorizationServer),await n.createSessionFromChallenges(i,s);throw new Error(`Authentication provider with handle: ${t} does not support createSessionFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$onDidChangeAuthenticationSessions(t,i,s){return t.startsWith(HD)||this.h.fire({provider:{id:t,label:i},extensionIdFilter:s}),Promise.resolve()}$onDidUnregisterAuthenticationProvider(t){return this.g.queue(t,async()=>{const i=this.f.get(t);i&&(i.disposable?.dispose(),this.f.delete(t))})}async $registerDynamicAuthProvider(t,i,s,r,n,o){if(!r){const c=y.revive(t);if(i.registration_endpoint)try{const l=await JD(i,this.l.environment.appName,s?.scopes_supported);r=l.client_id,n=l.client_secret}catch(l){this.q.warn(`Dynamic registration failed for ${c.toString()}: ${l.message}. Prompting user for client ID and client secret...`)}if(!r){this.q.info(`Prompting user for client registration details for ${c.toString()}`);const l=await this.d.$promptForClientRegistration(c.toString());if(!l)throw new Error("User did not provide client details");r=l.clientId,n=l.clientSecret,this.q.info(`User provided client registration for ${c.toString()}`),n?this.q.trace(`User provided client secret for ${c.toString()}`):this.q.trace(`User did not provide client secret for ${c.toString()}`)}}const a=new this.c(this.m,this.n,this.l,this.o,this.p,this.d,y.revive(t),i,s,r,n,this.k,o||[]);return await this.g.queue(a.id,async()=>{this.f.set(a.id,{label:a.label,provider:a,disposable:Ce.from(a,a.onDidChangeSessions(c=>this.d.$sendDidChangeSessions(a.id,c)),a.onDidChangeClientId(()=>this.d.$sendDidChangeDynamicProviderInfo({providerId:a.id,clientId:a.clientId,clientSecret:a.clientSecret}))),options:{supportsMultipleAccounts:!0}}),await this.d.$registerDynamicAuthenticationProvider({id:a.id,label:a.label,supportsMultipleAccounts:!0,authorizationServer:t,resourceServer:s?y.parse(s.resource):void 0,clientId:a.clientId,clientSecret:a.clientSecret})}),a.id}async $onDidChangeDynamicAuthProviderTokens(t,i,s){this.k.fire({authProviderId:t,clientId:i,tokens:s})}};TA=__decorate([__param(0,ke),__param(1,jt),__param(2,km),__param(3,$m),__param(4,Im),__param(5,Jn),__param(6,Se)],TA);var nV=class{constructor(){this.c=new Map}getOrCreate(e,t){const i=this.c.get(e);if(i)return i;const s=t().finally(()=>this.c.delete(e));return this.c.set(e,s),s}},Dm=class{constructor(t,i,s,r,n,o,a,c,l,u,h,f,p){this.k=t,this.l=i,this.m=s,this.n=r,this.o=o,this.authorizationServer=a,this.p=c,this.q=l,this.r=u,this.s=h,this.c=new I,this.onDidChangeSessions=this.c.event,this.d=new I,this.onDidChangeClientId=this.d.event;const g=a.toString(!0);this.id=l?.resource?g+" "+l?.resource:g,this.label=l?.resource_name??this.authorizationServer.authority,this.h=n.createLogger(this.id,{name:`Auth: ${this.label}`}),this.j=new ie,this.j.add(this.c);const v=Ie.chain(f.event,b=>b.filter(S=>S.authProviderId===this.id&&S.clientId===u).map(S=>S.tokens));this.f=this.j.add(new oV({onDidChange:v,set:b=>o.$setSessionsForDynamicAuthProvider(this.id,this.clientId,b)},p,this.h)),this.j.add(this.f.onDidChangeSessions(b=>this.c.fire(b))),this.g=[],c.authorization_endpoint&&this.g.push({label:d(3031,null),handler:(b,S,E)=>this.u(b,S,E)})}get clientId(){return this.r}get clientSecret(){return this.s}async getSessions(t,i){if(this.h.info(`Getting sessions for scopes: ${t?.join(" ")??"all"}`),!t)return this.f.sessions;const s=[...t].sort(),r=t.join(" ");let n=this.f.sessions.filter(o=>Ci([...o.scopes].sort(),s));if(this.h.info(`Found ${n.length} sessions for scopes: ${r}`),n.length){const o=[],a=[],c=new Map(this.f.tokens.map(l=>[l.access_token,l]));for(const l of n){const u=c.get(l.accessToken);if(u&&u.expires_in){const h=Date.now(),f=u.expires_in*1e3;if(h>u.created_at+f-5*60*1e3){if(this.h.info(`Token for session ${l.id} is about to expire, refreshing...`),a.push(u),!u.refresh_token){this.h.warn(`No refresh token available for scopes ${l.scopes.join(" ")}. Throwing away token.`);continue}try{const p=await this.z(u.refresh_token);p.scope!==r&&(this.h.warn(`Token scopes '${p.scope}' do not match requested scopes '${r}'. Overwriting token with what was requested...`),p.scope=r),this.h.info(`Successfully created a new token for scopes ${l.scopes.join(" ")}.`),o.push(p)}catch(p){this.h.error(`Failed to refresh token: ${p}`)}}}}return(o.length||a.length)&&(this.f.update({added:o,removed:a}),n=this.f.sessions.filter(l=>Ci([...l.scopes].sort(),s))),this.h.info(`Found ${n.length} sessions for scopes: ${r}`),n}return[]}async createSession(t,i){this.h.info(`Creating session for scopes: ${t.join(" ")}`);let s;for(let n=0;n<this.g.length;n++){const{handler:o}=this.g[n];try{if(s=await this.n.withProgressFromSource({label:this.label,id:this.id},{location:fo.Notification,title:d(3032,null,this.label),cancellable:!0},(a,c)=>o(t,a,c)),s)break}catch(a){const c=this.g[n+1]?.label;if(!c)break;const l=Mi(a)?d(3033,null,this.label,c):d(3034,null,this.label,c);if(!await this.o.$showContinueNotification(l))throw new dt;this.h.error(`Failed to create token via flow '${c}': ${a}`)}}if(!s)throw new Error("Failed to create authentication token");s.scope!==t.join(" ")&&(this.h.warn(`Token scopes '${s.scope}' do not match requested scopes '${t.join(" ")}'. Overwriting token with what was requested...`),s.scope=t.join(" ")),this.f.update({added:[{...s,created_at:Date.now()}],removed:[]});const r=this.f.sessions.find(n=>n.accessToken===s.access_token);return this.h.info(`Created ${s.refresh_token?"refreshable":"non-refreshable"} session for scopes: ${s.scope}${s.expires_in?` that expires in ${s.expires_in} seconds`:""}`),r}async removeSession(t){this.h.info(`Removing session with id: ${t}`);const i=this.f.sessions.find(r=>r.id===t);if(!i){this.h.error(`Session with id ${t} not found`);return}const s=this.f.tokens.find(r=>r.access_token===i.accessToken);if(!s){this.h.error(`Failed to retrieve token for removed session: ${i.id}`);return}this.f.update({added:[],removed:[s]}),this.h.info(`Removed token for session: ${i.id} with scopes: ${i.scopes.join(" ")}`)}dispose(){this.j.dispose()}async u(t,i,s){if(!this.p.authorization_endpoint)throw new Error("Authorization Endpoint required");if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const r=this.v(64),n=await this.w(r),o=this.v(32),a=y.parse(`${this.m.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/authorize?nonce=${o}`);let c;try{c=await this.l.createAppUri(a)}catch(b){throw new Error(`Failed to create external URI: ${b}`)}const l=new URL(this.p.authorization_endpoint);l.searchParams.append("client_id",this.r),l.searchParams.append("response_type","code"),l.searchParams.append("state",c.toString()),l.searchParams.append("code_challenge",n),l.searchParams.append("code_challenge_method","S256");const u=t.join(" ");u&&l.searchParams.append("scope",u),this.q?.resource&&l.searchParams.append("resource",this.q.resource);const h="https://vscode.dev/redirect";l.searchParams.append("redirect_uri",h);const f=this.x(a);if(this.h.info(`Opening authorization URL for scopes: ${u}`),this.h.trace(`Authorization URL: ${l.toString()}`),!await this.k.openUri(l.toString(),{}))throw new dt;i.report({message:d(3035,null)});let g;try{g=(await vf(f,s)).code}catch(b){throw Mi(b)?(this.h.info("Authorization code request was cancelled by the user."),b):(this.h.error(`Failed to receive authorization code: ${b}`),new Error(`Failed to receive authorization code: ${b}`))}return this.h.info(`Authorization code received for scopes: ${u}`),await this.y(g,r,h)}v(t){const i=new Uint8Array(t);return crypto.getRandomValues(i),Array.from(i).map(s=>s.toString(16).padStart(2,"0")).join("").substring(0,t)}async w(t){const s=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",s);return fc(W.wrap(new Uint8Array(r)),!1,!1).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async x(t){const i=await this.o.$waitForUriHandler(t),s=/[?&]code=([^&]+)/.exec(i.query||"");if(!s||s.length<2)throw new Error("Authentication failed: No authorization code received");return{code:s[1]}}async y(t,i,s){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const r=new URLSearchParams;r.append("client_id",this.r),r.append("grant_type","authorization_code"),r.append("code",t),r.append("redirect_uri",s),r.append("code_verifier",i),this.q?.resource&&r.append("resource",this.q.resource),this.s&&r.append("client_secret",this.s),this.h.info("Exchanging authorization code for token..."),this.h.trace(`Url: ${this.p.token_endpoint}`),this.h.trace(`Token request body: ${r.toString()}`);let n;try{n=await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:r.toString()})}catch(a){throw this.h.error(`Failed to exchange authorization code for token: ${a}`),new Error(`Failed to exchange authorization code for token: ${a}`)}if(!n.ok){const a=await n.text();throw new Error(`Token exchange failed: ${n.status} ${n.statusText} - ${a}`)}const o=await n.json();if(xA(o))return this.h.info("Successfully exchanged authorization code for token."),o;throw VD(o)&&o.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Invalid authorization token response: ${JSON.stringify(o)}`)}async z(t){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const i=new URLSearchParams;i.append("client_id",this.r),i.append("grant_type","refresh_token"),i.append("refresh_token",t),this.q?.resource&&i.append("resource",this.q.resource),this.s&&i.append("client_secret",this.s);const r=await(await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:i.toString()})).json();if(xA(r))return{...r,created_at:Date.now()};throw VD(r)&&r.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Invalid authorization token response: ${JSON.stringify(r)}`)}async A(){try{const t=await JD(this.p,this.m.environment.appName,this.q?.scopes_supported);this.r=t.client_id,this.s=t.client_secret,this.d.fire()}catch(t){this.h.info(`Dynamic registration failed for ${this.authorizationServer.toString()}: ${t}. Prompting user for client ID and client secret.`);try{const i=await this.o.$promptForClientRegistration(this.authorizationServer.toString());if(!i)throw new Error("User did not provide client details");this.r=i.clientId,this.s=i.clientSecret,this.h.info(`User provided client ID for ${this.authorizationServer.toString()}`),i.clientSecret?this.h.info(`User provided client secret for ${this.authorizationServer.toString()}`):this.h.info(`User did not provide client secret for ${this.authorizationServer.toString()} (optional)`),this.d.fire()}catch{throw this.h.error(`Failed to fetch new client ID and user did not provide one: ${t}`),new Error(`Failed to fetch new client ID and user did not provide one: ${t}`)}}}};Dm=__decorate([__param(0,km),__param(1,$m),__param(2,jt),__param(3,Im),__param(4,Jn)],Dm);var oV=class{constructor(e,t,i){this.h=e,this.j=i,this.f=new I,this.onDidChangeSessions=this.f.event,this.g=new ie,this.c=ss("tokens",t),this.d=dI({equalsFn:(s,r)=>Ci(s,r,(n,o)=>n.accessToken===o.accessToken)},s=>this.c.read(s).map(r=>this.l(r))),this.g.add(this.k()),this.g.add(this.h.onDidChange(s=>this.c.set(s,void 0)))}get tokens(){return this.c.get()}get sessions(){return this.d.get()}dispose(){this.g.dispose()}update({added:e,removed:t}){this.j.trace(`Updating tokens: added ${e.length}, removed ${t.length}`);const i=[...this.c.get()];for(const s of t){const r=i.findIndex(n=>n.access_token===s.access_token);r!==-1&&i.splice(r,1)}for(const s of e){const r=i.findIndex(n=>n.access_token===s.access_token);r===-1?i.push(s):i[r]=s}(e.length||t.length)&&(this.c.set(i,void 0),this.h.set(i)),this.j.trace(`Tokens updated: ${i.length} tokens stored.`)}k(){let e=[];return Zf(t=>{this.j.trace("Checking for session changes...");const i=this.d.read(t);if(e===i){this.j.trace("No session changes detected.");return}if(!i||i.length===0){this.j.trace("All sessions removed."),e.length>0&&(this.f.fire({added:[],removed:e,changed:[]}),e=[]);return}const s=[],r=[];for(const n of i)e.some(a=>a.accessToken===n.accessToken)||s.push(n);for(const n of e)i.some(a=>a.accessToken===n.accessToken)||r.push(n);(s.length>0||r.length>0)&&(this.j.trace(`Sessions changed: added ${s.length}, removed ${r.length}`),this.f.fire({added:s,removed:r,changed:[]})),e=i})}l(e){let t;if(e.id_token)try{t=QD(e.id_token)}catch{}if(!t)try{t=QD(e.access_token)}catch{}const i=e.scope?e.scope.split(" "):t?.scope?t.scope.split(" "):[];return{id:E0(e.access_token,0).toString(),accessToken:e.access_token,account:{id:t?.sub||"unknown",label:t?.preferred_username||t?.name||t?.email||"MCP"},scopes:i,idToken:e.id_token}}},NA,MA=H("IExtHostLanguageModels"),aV=class{constructor(){this.a=new mO,this.b=!1;const e=this,[t,i]=$x.tee(e.a.asyncIterable);this.apiObject={get stream(){return t},get text(){return i.map(s=>{if(s instanceof zt)return s.value}).coalesce()}}}handleResponsePart(e){if(this.b)return;const t=[];for(const i of Bt.wrap(e)){let s;i.type==="text"?s=new zt(i.value,i.audience):i.type==="thinking"?s=new ol(i.value,i.id,i.metadata):i.type==="data"?s=new vi(i.data.buffer,i.mimeType,i.audience):s=new $a(i.toolCallId,i.name,i.parameters),t.push(s)}this.a.emitMany(t)}reject(e){this.b=!0,this.a.reject(e)}resolve(){this.b=!0,this.a.resolve()}},LA=class{static{NA=this}static{this.a=1}constructor(t,i,s){this.o=i,this.p=s,this.c=new I,this.d=new I,this.onDidChangeProviders=this.d.event,this.f=new I,this.onDidChangeModelProxyAvailability=this.f.event,this.g=new Map,this.h=new Map,this.j=new qn,this.k=new Map,this.l=new Map,this.x=new Set,this.b=t.getProxy(Y.MainThreadLanguageModels)}dispose(){this.c.dispose(),this.d.dispose(),this.f.dispose()}registerLanguageModelChatProvider(t,i,s){this.g.set(i,{extension:t,provider:s}),this.b.$registerLanguageModelProvider(i);let r;return s.onDidChangeLanguageModelChatInformation&&(r=s.onDidChangeLanguageModelChatInformation(()=>{this.b.$onLMProviderChange(i)})),te(()=>{this.g.delete(i),this.q(i),r?.dispose(),this.b.$unregisterProvider(i)})}q(t){this.h.forEach((i,s)=>{i.metadata.vendor===t&&this.h.delete(s)})}async $provideLanguageModelChatInfo(t,i,s){const r=this.g.get(t);if(!r)return[];const n=await r.provider.provideLanguageModelChatInformation(i,s)??[],o=n.map(a=>{let c;return a.requiresAuthorization&&et(r.extension,"chatProvider")&&(c={providerLabel:r.extension.displayName||r.extension.name,accountLabel:typeof a.requiresAuthorization=="object"?a.requiresAuthorization.label:void 0}),a.capabilities.editTools&&T(r.extension,"chatProvider"),{metadata:{extension:r.extension.identifier,id:a.id,vendor:t,name:a.name??"",family:a.family??"",detail:a.detail,tooltip:a.tooltip,version:a.version,maxInputTokens:a.maxInputTokens,maxOutputTokens:a.maxOutputTokens,auth:c,isDefault:a.isDefault,isUserSelectable:a.isUserSelectable,statusIcon:a.statusIcon,modelPickerCategory:a.category??z_,capabilities:a.capabilities?{vision:a.capabilities.imageInput,editTools:a.capabilities.editTools,toolCalling:!!a.capabilities.toolCalling,agentMode:!!a.capabilities.toolCalling}:void 0},identifier:`${t}/${a.id}`}});this.q(t);for(let a=0;a<o.length;a++)this.h.set(o[a].identifier,{metadata:o[a].metadata,info:n[a]});return o}async $startChatRequest(t,i,s,r,n,o){const a=this.h.get(t);if(!a)throw new Error("Model not found");const c=this.g.get(a.metadata.vendor);if(!c)throw new Error(`Language model provider for '${a.metadata.id}' not found.`);const l=[],u=()=>{l.length>0&&(this.b.$reportResponsePart(i,new pi(l)),l.length=0)},h=new br(u,30),f=v=>{l.push(v)>30?(u(),h.cancel()):h.schedule()},p=new Cm(async v=>{if(o.isCancellationRequested){this.o.warn(`[CHAT](${c.extension.identifier.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let b;if(v instanceof $a?b={type:"tool_use",name:v.name,parameters:v.input,toolCallId:v.callId}:v instanceof zt?b={type:"text",value:v.value,audience:v.audience}:v instanceof vi?b={type:"data",mimeType:v.mimeType,data:W.wrap(v.data),audience:v.audience}:v instanceof ol&&(b={type:"thinking",value:v.value,id:v.id,metadata:v.metadata}),!b){this.o.warn(`[CHAT](${c.extension.identifier.value}) UNKNOWN part ${JSON.stringify(v)}`);return}f(b)});let g;try{g=c.provider.provideLanguageModelChatResponse(a.info,r.value.map(Vg.to),{...n,modelOptions:n.modelOptions??{},requestInitiator:Ye.toKey(s),toolMode:n.toolMode??Eg.Auto},p,o)}catch(v){throw v}Promise.resolve(g).then(()=>{u(),this.b.$reportResponseDone(i,void 0)},v=>{u(),this.b.$reportResponseDone(i,ic(v))})}$provideTokenLength(t,i,s){const r=this.h.get(t);if(!r)return Promise.resolve(0);const n=this.g.get(r.metadata.vendor);return n?Promise.resolve(n.provider.provideTokenCount(r.info,i,s)):Promise.resolve(0)}async getDefaultLanguageModel(t,i){let s;i&&await this.selectLanguageModels(t,{});for(const[r,n]of this.h)if(n.metadata.isDefault){s=r;break}return!s&&!i?this.getDefaultLanguageModel(t,!0):this.getLanguageModelByIdentifier(t,s)}async getLanguageModelByIdentifier(t,i){if(!i)return;const s=this.h.get(i);if(!s)return(await this.selectLanguageModels(t,{id:i}))[0];this.u(t.identifier,s.metadata)&&await this.v(s.metadata);let r;if(!r){const n=this;r={id:s.info.id,vendor:s.metadata.vendor,family:s.info.family,version:s.info.version,name:s.info.name,capabilities:{supportsImageToText:s.metadata.capabilities?.vision??!1,supportsToolCalling:!!s.metadata.capabilities?.toolCalling,editToolsHint:s.metadata.capabilities?.editTools},maxInputTokens:s.metadata.maxInputTokens,countTokens(o,a){if(!n.h.has(i))throw hn.NotFound(i);return n.w(i,o,a??Fe.None)},sendRequest(o,a,c){if(!n.h.has(i))throw hn.NotFound(i);return n.r(t,i,o,a??{},c??Fe.None)}},Object.freeze(r)}return r}async selectLanguageModels(t,i){const s=await this.b.$selectChatModels({...i,extension:t.identifier}),r=[],n=s.map(a=>this.getLanguageModelByIdentifier(t,a)),o=await Promise.all(n);for(const a of o)a&&r.push(a);return r}async r(t,i,s,r,n){const o=this.s(t,s),a=t.identifier,c=this.h.get(i)?.metadata;if(!c||!this.h.has(i))throw hn.NotFound(`Language model '${i}' is unknown.`);if(this.u(a,c)&&(!await this.t(t,{identifier:c.extension,displayName:c.auth.providerLabel},r.justification,!1)||!this.j.get(a)?.has(c.extension)))throw hn.NoPermissions(`Language model '${i}' cannot be used by '${a.value}'.`);const l=Math.random()*1e6|0,u=new aV;this.k.set(l,{languageModelId:i,res:u});try{await this.b.$tryStartChatRequest(a,i,l,new pi(o),r,n)}catch(h){throw this.k.delete(l),hn.tryDeserialize(h)??h}return u.apiObject}s(t,i){const s=[];for(const r of i)r.role===ns.System&&T(t,"languageModelSystem"),s.push(Vg.from(r));return s}async $acceptResponsePart(t,i){const s=this.k.get(t);s&&s.res.handleResponsePart(i.value)}async $acceptResponseDone(t,i){const s=this.k.get(t);s&&(this.k.delete(t),i?s.res.reject(hn.tryDeserialize(i)??K5(i)):s.res.resolve())}async t(t,i,s,r){const n=HD+i.identifier.value;if(await this.p.getSession(t,n,[],{silent:!0}))return this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0;if(r)return!1;try{const a=s?d(3041,null,i.displayName,s):void 0;return await this.p.getSession(t,n,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0}catch{return!1}}u(t,i){return!!i.auth&&!Ye.equals(i.extension,t)}async v(t){if(t.auth)for(const i of this.x)try{await this.t(i,{identifier:t.extension,displayName:""},void 0,!0)}catch(s){this.o.error("Fake Auth request failed"),this.o.error(s)}}async w(t,i,s){const r=this.h.get(t);if(!r)throw hn.NotFound(`Language model '${t}' is unknown.`);return this.g.get(r.metadata.vendor)?.provider.provideTokenCount(r.info,i,s)??0}$updateModelAccesslist(t){const i=new Array;for(const{from:s,to:r,enabled:n}of t){const o=this.j.get(s)??new Ko;if(o.has(r)!==n){n?o.add(r):o.delete(r),this.j.set(s,o);const c={from:s,to:r};i.push(c),this.c.fire(c)}}}createLanguageModelAccessInformation(t){this.x.add(t);const i=Ie.signal(Ie.filter(this.c.event,r=>Ye.equals(r.from,t.identifier))),s=Ie.signal(this.d.event);return{get onDidChange(){return Ie.any(i,s)},canSendRequest(r){return!0}}}fileIsIgnored(t,i,s=Fe.None){return T(t,"chatParticipantAdditions"),this.b.$fileIsIgnored(i,s)}get isModelProxyAvailable(){return!!this.n}async getModelProxy(t){if(T(t,"languageModelProxy"),!this.n)throw this.o.trace("[LanguageModelProxy] No LanguageModelProxyProvider registered"),new Error("No language model proxy provider is registered.");const i=Ye.toKey(t.identifier);try{const s=await Promise.resolve(this.n.provideModelProxy(i,Fe.None));if(!s)throw this.o.warn(`[LanguageModelProxy] Provider returned no proxy for ${i}`),new Error("Language model proxy is not available.");return s}catch(s){throw this.o.error(`[LanguageModelProxy] Provider failed to return proxy for ${i}`,s),s}}async $isFileIgnored(t,i,s){const r=this.l.get(t);if(!r)throw new Error("Unknown LanguageModelIgnoredFileProvider");return await r.provideFileIgnored(y.revive(i),s)??!1}registerIgnoredFileProvider(t,i){T(t,"chatParticipantPrivate");const s=NA.a++;return this.b.$registerFileIgnoreProvider(s),this.l.set(s,i),te(()=>{this.b.$unregisterFileIgnoreProvider(s),this.l.delete(s)})}registerLanguageModelProxyProvider(t,i){return T(t,"chatParticipantPrivate"),this.n=i,this.f.fire(),te(()=>{this.n===i&&(this.n=void 0,this.f.fire())})}};LA=NA=__decorate([__param(0,ke),__param(1,Se),__param(2,PA)],LA);function Yh(e,t=ze){return Vv(e,t)?e.charAt(0).toUpperCase()+e.slice(1):e}function Pm(e,t){return e.replace(/^~($|\/|\\)/,`${t}$1`)}var XD="\u2026",Xh="\\\\",Kh="~";function cV(e,t=St){const i=new Array(e.length);let s=!1;for(let r=0;r<e.length;r++){const n=e[r];if(n===""){i[r]=`.${t}`;continue}if(!n){i[r]=n;continue}s=!0;let o="",a=n;a.indexOf(Xh)===0?(o=a.substr(0,a.indexOf(Xh)+Xh.length),a=a.substr(a.indexOf(Xh)+Xh.length)):a.indexOf(t)===0?(o=a.substr(0,a.indexOf(t)+t.length),a=a.substr(a.indexOf(t)+t.length)):a.indexOf(Kh)===0&&(o=a.substr(0,a.indexOf(Kh)+Kh.length),a=a.substr(a.indexOf(Kh)+Kh.length));const c=a.split(t);for(let l=1;s&&l<=c.length;l++)for(let u=c.length-l;s&&u>=0;u--){s=!1;let h=c.slice(u,u+l).join(t);for(let f=0;!s&&f<e.length;f++)if(f!==r&&e[f]&&e[f].indexOf(h)>-1){const p=u+l===c.length,g=u>0&&e[f].indexOf(t)>-1?t+h:h,v=e[f].endsWith(g);s=!p||v}if(!s){let f="";(c[0].endsWith(":")||o!=="")&&(u===1&&(u=0,l++,h=c[0]+t+h),u>0&&(f=c[0]+t),f=o+f),u>0&&(f=f+XD+t),f=f+h,u+l<c.length&&(f=f+t+XD),i[r]=f}}s&&(i[r]=n)}return i}var KD;(function(e){e[e.TEXT=0]="TEXT",e[e.VARIABLE=1]="VARIABLE",e[e.SEPARATOR=2]="SEPARATOR"})(KD||(KD={}));var lV=60,uV=lV*60,RA=uV*24,Cre=RA*7,kre=RA*30,$re=RA*365;function hV(e){return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var Tm={DateTimeFormat(e,t){return new Tt(()=>{try{return new Intl.DateTimeFormat(e,t)}catch{return new Intl.DateTimeFormat(void 0,t)}})},Collator(e,t){return new Tt(()=>{try{return new Intl.Collator(e,t)}catch{return new Intl.Collator(void 0,t)}})},Segmenter(e,t){return new Tt(()=>{try{return new Intl.Segmenter(e,t)}catch{return new Intl.Segmenter(void 0,t)}})},Locale(e,t){return new Tt(()=>{try{return new Intl.Locale(e,t)}catch{return new Intl.Locale(Ln,t)}})},NumberFormat(e,t){return new Tt(()=>{try{return new Intl.NumberFormat(e,t)}catch{return new Intl.NumberFormat(void 0,t)}})}},e9;(function(e){e[e.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",e[e.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",e[e.MAX_UINT_8=255]="MAX_UINT_8",e[e.MAX_UINT_16=65535]="MAX_UINT_16",e[e.MAX_UINT_32=4294967295]="MAX_UINT_32",e[e.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(e9||(e9={}));function t9(e){return e<0?0:e>255?255:e|0}function $l(e){return e<0?0:e>4294967295?4294967295:e|0}var i9=class LM{constructor(t){const i=t9(t);this.c=i,this.a=LM.d(i),this.b=new Map}static d(t){const i=new Uint8Array(256);return i.fill(t),i}set(t,i){const s=t9(i);t>=0&&t<256?this.a[t]=s:this.b.set(t,s)}get(t){return t>=0&&t<256?this.a[t]:this.b.get(t)||this.c}clear(){this.a.fill(this.c),this.b.clear()}},s9;(function(e){e[e.False=0]="False",e[e.True=1]="True"})(s9||(s9={}));var r9;(function(e){e[e.Regular=0]="Regular",e[e.Whitespace=1]="Whitespace",e[e.WordSeparator=2]="WordSeparator"})(r9||(r9={}));var dV=class extends i9{constructor(e,t){super(0),this.e=null,this.f=null,this.g=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this.e=Tm.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this.e=null;for(let i=0,s=e.length;i<s;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const s of this.h(e)){if(s.index>t)break;i=s}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this.h(e))if(!(i.index<t))return i;return null}h(e){return this.e?this.f===e?this.g:(this.f=e,this.g=this.j(this.e.value.segment(e)),this.g):[]}j(e){const t=[];for(const i of e)this.k(i)&&t.push(i);return t}k(e){return!!e.isWordLike}},n9=new sc(10);function fV(e,t){const i=`${e}/${t.join(",")}`;let s=n9.get(i);return s||(s=new dV(e,t),n9.set(i,s)),s}var OA;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"})(OA||(OA={}));var o9;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(o9||(o9={}));var a9;(function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"})(a9||(a9={}));var c9;(function(e){e[e.Normal=1]="Normal",e[e.Underlined=2]="Underlined"})(c9||(c9={}));var l9;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(l9||(l9={}));var u9;(function(e){e[e.Both=0]="Both",e[e.Right=1]="Right",e[e.Left=2]="Left",e[e.None=3]="None"})(u9||(u9={}));var h9;(function(e){e[e.TextDefined=0]="TextDefined",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(h9||(h9={}));var d9;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(d9||(d9={}));var f9;(function(e){e[e.LF=0]="LF",e[e.CRLF=1]="CRLF"})(f9||(f9={}));var FA=class{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}},p9;(function(e){e[e.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",e[e.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",e[e.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",e[e.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(p9||(p9={}));var g9;(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.None=2]="None",e[e.LeftOfInjectedText=3]="LeftOfInjectedText",e[e.RightOfInjectedText=4]="RightOfInjectedText"})(g9||(g9={}));var m9;(function(e){e[e.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(m9||(m9={}));var pV=class{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}},gV=class{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}},v9=class{constructor(e,t,i,s){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=s}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=w9(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=jE(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new pV(t,this.wordSeparators?fV(this.wordSeparators,[]):null,i?this.searchString:null)}};function w9(e){if(!e||e.length===0)return!1;for(let t=0,i=e.length;t<i;t++){const s=e.charCodeAt(t);if(s===10)return!0;if(s===92){if(t++,t>=i)break;const r=e.charCodeAt(t);if(r===110||r===114||r===87)return!0}}return!1}function b9(e,t,i){if(!i)return new FA(e,null);const s=[];for(let r=0,n=t.length;r<n;r++)s[r]=t[r];return new FA(e,s)}function mV(e,t,i,s,r){if(s===0)return!0;const n=t.charCodeAt(s-1);if(e.get(n)!==0||n===13||n===10)return!0;if(r>0){const o=t.charCodeAt(s);if(e.get(o)!==0)return!0}return!1}function vV(e,t,i,s,r){if(s+r===i)return!0;const n=t.charCodeAt(s+r);if(e.get(n)!==0||n===13||n===10)return!0;if(r>0){const o=t.charCodeAt(s+r-1);if(e.get(o)!==0)return!0}return!1}function y9(e,t,i,s,r){return mV(e,t,i,s,r)&&vV(e,t,i,s,r)}var wV=class{constructor(e,t){this._wordSeparators=e,this.a=t,this.b=-1,this.c=0}reset(e){this.a.lastIndex=e,this.b=-1,this.c=0}next(e){const t=e.length;let i;do{if(this.b+this.c===t||(i=this.a.exec(e),!i))return null;const s=i.index,r=i[0].length;if(s===this.b&&r===this.c){if(r===0){_E(e,t,this.a.lastIndex)>65535?this.a.lastIndex+=2:this.a.lastIndex+=1;continue}return null}if(this.b=s,this.c=r,!this._wordSeparators||y9(this._wordSeparators,e,t,s,r))return i}while(i);return null}},A9=H("IUriIdentityService");function S9(e){return e.scheme!==V.file&&e.scheme!==V.vscodeRemote}function bV(e){if(e.folders.length)return e.folders.every(t=>S9(t.uri))?e.folders[0].uri:void 0;if(e.configuration&&S9(e.configuration))return e.configuration}function yV(e){return bV(e)?.scheme}var UA=H("environmentService"),AV=UA,jA=UA,E9=H("remoteAgentService"),Ire=new class{constructor(){this.maxSampleCount=5,this.sampleDelay=2e3,this.initial=[],this.maxInitialCount=3,this.average=[],this.maxAverageCount=100,this.highLatencyMultiple=2,this.highLatencyMinThreshold=500,this.highLatencyMaxThreshold=1500,this.lastMeasurement=void 0}get latency(){return this.lastMeasurement}async measure(e){let t=1/0;for(let s=0;s<this.maxSampleCount;s++){const r=await e.getRoundTripTime();if(r===void 0)return;t=Math.min(t,r/2),await ri(this.sampleDelay)}this.average.push(t),this.average.length>this.maxAverageCount&&this.average.shift();let i;return this.initial.length<this.maxInitialCount?this.initial.push(t):i=this.initial.reduce((s,r)=>s+r,0)/this.initial.length,this.lastMeasurement={initial:i,current:t,average:this.average.reduce((s,r)=>s+r,0)/this.average.length,high:typeof i>"u"?!1:t>this.highLatencyMaxThreshold||t>this.highLatencyMinThreshold&&t>i*this.highLatencyMultiple},this.lastMeasurement}},zA,SV=H("pathService"),x9=zA=class{constructor(t,i,s,r){this.d=t,this.e=i,this.f=s,this.g=r,this.a=(async()=>(await this.e.getEnvironment())?.os||zo)(),this.b=(async()=>{const n=await this.e.getEnvironment();return this.c=n?.userHome??t})()}hasValidBasename(t,i,s){return typeof i=="string"||typeof i>"u"?this.a.then(r=>this.h(t,r,i)):this.h(t,i,s)}h(t,i,s){return t.scheme===V.file||t.scheme===V.vscodeRemote?R2(s??Li(t),i===1):!0}get defaultUriScheme(){return zA.findDefaultUriScheme(this.f,this.g)}static findDefaultUriScheme(t,i){if(t.remoteAuthority)return V.vscodeRemote;const s=yV(i.getWorkspace());if(s)return s;const r=i.getWorkspace().folders[0];if(r)return r.uri.scheme;const n=i.getWorkspace().configuration;return n?n.scheme:V.file}userHome(t){return t?.preferLocal?this.d:this.b}get resolvedUserHome(){return this.c}get path(){return this.a.then(t=>t===1?Jt:Be)}async fileURI(t){let i="";if(await this.a===1&&(t=t.replace(/\\/g,"/")),t[0]==="/"&&t[1]==="/"){const r=t.indexOf("/",2);r===-1?(i=t.substring(2),t="/"):(i=t.substring(2,r),t=t.substring(r)||"/")}return y.from({scheme:V.file,authority:i,path:t,query:"",fragment:""})}};x9=zA=__decorate([__param(1,E9),__param(2,jA),__param(3,$u)],x9);function EV(e){return typeof e=="object"&&"uri"in e&&"pattern"in e}var C9=class{constructor(t,i,s,r,n,o){this.a=t,this.b=i,this.c=s,this.d=r,this.f=n,this.g=o}aiText(t,i,s={}){return{...this.j(i?.map(U0),s),type:3,contentPattern:t}}text(t,i,s={}){t=this.h(t,s);const r=this.a.getValue(),n=i&&i.some(a=>!this.a.getValue({resource:a}).search.useRipgrep);return{...this.j(i?.map(U0),s),type:2,contentPattern:t,previewOptions:s.previewOptions,maxFileSize:s.maxFileSize,usePCRE2:r.search.usePCRE2||n||!1,surroundingContext:s.surroundingContext,userDisabledExcludesAndIgnoreFiles:s.disregardExcludeSettings&&s.disregardIgnoreFiles}}h(t,i){const s=this.a.getValue();t.isRegExp&&(t.pattern=t.pattern.replace(/\r?\n/g,"\\n"));const r={...t,wordSeparators:s.editor.wordSeparators};return this.l(t,i)&&(r.isCaseSensitive=!0),this.m(t)&&(r.isMultiline=!0),i.notebookSearchConfig?.includeMarkupInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownInput=i.notebookSearchConfig.includeMarkupInput),i.notebookSearchConfig?.includeMarkupPreview&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownPreview=i.notebookSearchConfig.includeMarkupPreview),i.notebookSearchConfig?.includeCodeInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellInput=i.notebookSearchConfig.includeCodeInput),i.notebookSearchConfig?.includeOutput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellOutput=i.notebookSearchConfig.includeOutput),r}file(t,i={}){return{...this.j(t,i),type:1,filePattern:i.filePattern?i.filePattern.trim():i.filePattern,exists:i.exists,sortByScore:i.sortByScore,cacheKey:i.cacheKey,shouldGlobMatchFilePattern:i.shouldGlobSearch}}i(t,i){if(!t)return{};if(Array.isArray(t)){if(t=t.filter(s=>s.length>0).map(Nm),!t.length)return{}}else t=Nm(t);return i?this.parseSearchPaths(t):{pattern:HA(...Array.isArray(t)?t:[t])}}j(t=[],i={}){let s=Array.isArray(i.excludePattern)?i.excludePattern.map(u=>u.pattern).flat():i.excludePattern;s=s?.length===1?s[0]:s;const r=this.i(i.includePattern,i.expandPatterns),n=this.i(s,i.expandPatterns),o=t.length>1,a=(r.searchPaths&&r.searchPaths.length?r.searchPaths.map(u=>this.t(u,i,n)):t.map(u=>this.u(u,i,n,o))).filter(u=>!!u),c={_reason:i._reason,folderQueries:a,usingSearchPaths:!!(r.searchPaths&&r.searchPaths.length),extraFileResources:i.extraFileResources,excludePattern:n.pattern,includePattern:r.pattern,onlyOpenEditors:i.onlyOpenEditors,maxResults:i.maxResults,onlyFileScheme:i.onlyFileScheme};if(i.onlyOpenEditors){const u=gt(this.c.groups.flatMap(p=>p.editors.map(g=>g.resource)));this.d.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const h=u.filter(p=>nD(c,p.fsPath)),f=this.k(h);return this.d.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(f)),{...c,...f}}const l=i.extraFileResources&&i.extraFileResources.filter(u=>nD(c,u.fsPath));return c.extraFileResources=l&&l.length?l:void 0,c}k(t){const i=[],s=new kt,r={};let n=!1;return t.forEach(o=>{if(o.scheme===V.walkThrough)return;if(iO(o)){const c=this.b.getWorkspaceFolder(o)?.uri??this.g.extUri.dirname(o);let l=s.get(c);l||(n=!0,l={folder:c,includePattern:{}},i.push(l),s.set(c,l));const u=ac(c.fsPath,o.fsPath);rc(l.includePattern)[k9(u.replace(/\\/g,"/"))]=!0}else o.fsPath&&(n=!0,r[k9(o.fsPath)]=!0)}),{folderQueries:i,includePattern:r,usingSearchPaths:!0,excludePattern:n?void 0:{"**/*":!0}}}l(t,i){if(i.isSmartCase){if(t.isRegExp){if(JE(t.pattern,!0))return!0}else if(JE(t.pattern))return!0}return!!t.isCaseSensitive}m(t){return t.isMultiline||t.isRegExp&&w9(t.pattern)||t.pattern.indexOf(`
`)>=0?!0:!!t.isMultiline}parseSearchPaths(t){const i=h=>ks(h)||/^\.\.?([\/\\]|$)/.test(h),r=(Array.isArray(t)?t:CV(t)).map(h=>{const f=this.f.resolvedUserHome;return f?Pm(h,f.scheme===V.file?f.fsPath:f.path):h}),n=wv(r,h=>i(h)?"searchPaths":"exprSegments"),o=(n.exprSegments||[]).map(h=>jn(h,"/")).map(h=>jn(h,"\\")).map(h=>(h[0]==="."&&(h="*"+h),kV(h))),a={},c=this.o(n.searchPaths||[]);c&&c.length&&(a.searchPaths=c);const l=o.flat(),u=HA(...l);return u&&(a.pattern=u),a}n(t,i){return i.disregardExcludeSettings?void 0:NB(t,!i.disregardSearchExcludeSettings)}o(t){if(!t||!t.length)return[];const i=t.flatMap(r=>{let{pathPortion:n,globPortion:o}=xV(r);return o&&(o=WA(o)),this.q(n).flatMap(c=>this.r(c,o))}),s=new Map;return i.forEach(r=>{const n=r.searchPath.toString(),o=s.get(n);o?r.pattern&&(o.pattern=o.pattern||{},o.pattern[r.pattern]=!0):s.set(n,{searchPath:r.searchPath,pattern:r.pattern?HA(r.pattern):void 0})}),Array.from(s.values())}q(t){if(ks(t)){const i=this.b.getWorkspace().folders;return i[0]&&i[0].uri.scheme!==V.file?[{searchPath:i[0].uri.with({path:t})}]:[{searchPath:y.file(Xr(t))}]}if(this.b.getWorkbenchState()===2){const i=this.b.getWorkspace().folders[0].uri;if(t=Nm(t),t.startsWith("../")||t===".."){const r=Be.resolve(i.path,t);return[{searchPath:i.with({path:r})}]}const s=WA(t);return[{searchPath:i,pattern:s}]}else{if(t==="./"||t===".\\")return[];{const i=t.replace(/^\.[\/\\]/,""),r=this.b.getWorkspace().folders.map(n=>{const o=i.match(new RegExp(`^${Un(n.name)}(?:/(.*)|$)`));return o?{match:o,folder:n}:null}).filter(fs);if(r.length)return r.map(n=>{const o=n.match[1];return{searchPath:n.folder.uri,pattern:o&&WA(o)}});{const n=t.match(/\.[\/\\](.+)[\/\\]?/),o=n?n[1]:t,a=d(15811,null,o);throw new Error(a)}}}}r(t,i){const s=t.pattern&&i?`${t.pattern}/${i}`:t.pattern||i,r=[{searchPath:t.searchPath,pattern:s}];return s&&!s.endsWith("**")&&r.push({searchPath:t.searchPath,pattern:s+"/**"}),r}t(t,i,s){const r=this.u(U0(t.searchPath),i,s,!1);return r?{...r,includePattern:t.pattern}:null}u(t,i,s,r){let n;const o=y.isUri(t)?t:t.uri;let a=i.excludePattern?.map(p=>{const g=i.excludePattern&&EV(p)?p.uri:void 0;return!g||!(y.isUri(t)&&this.g.extUri.isEqual(t,g))?g:void 0});if(a?.length||(a=[void 0]),s.searchPaths){const p=s.searchPaths.filter(g=>hc(g.searchPath,o))[0];if(p&&!p.pattern)return null;p&&(n=p.pattern)}const c=this.a.getValue({resource:o}),u={...this.n(c,i)||{},...n||{}},h=y.isUri(t)?Li(t):t.name,f=a.map(p=>Object.keys(u).length>0?{folder:p,pattern:u}:void 0).filter(p=>p);return{folder:o,folderName:r?h:void 0,excludePattern:f,fileEncoding:c.files&&c.files.encoding,disregardIgnoreFiles:typeof i.disregardIgnoreFiles=="boolean"?i.disregardIgnoreFiles:!c.search.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof i.disregardGlobalIgnoreFiles=="boolean"?i.disregardGlobalIgnoreFiles:!c.search.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof i.disregardParentIgnoreFiles=="boolean"?i.disregardParentIgnoreFiles:!c.search.useParentIgnoreFiles,ignoreSymlinks:typeof i.ignoreSymlinks=="boolean"?i.ignoreSymlinks:!c.search.followSymlinks}}};C9=__decorate([__param(0,gi),__param(1,$u),__param(2,bW),__param(3,Se),__param(4,SV),__param(5,A9)],C9);function xV(e){const t=e.match(/[\*\{\}\(\)\[\]\?]/);if(t){const i=t.index,s=e.substr(0,i).match(/[/|\\][^/\\]*$/);if(s){let r=e.substr(0,s.index);return r.match(/[/\\]/)||(r+="/"),{pathPortion:r,globPortion:e.substr((s.index||0)+1)}}}return{pathPortion:e}}function HA(...e){return e.length?e.reduce((t,i)=>(t[i]=!0,t),Object.create(null)):void 0}function CV(e){return Dc(e,",").map(t=>t.trim()).filter(t=>!!t.length)}function kV(e){return[`**/${e}/**`,`**/${e}`].map(i=>i.replace(/\*\*\/\*\*/g,"**"))}function Nm(e){return e.replace(/\\/g,"/")}function WA(e){return Nm(e).replace(/^\.\//,"").replace(/\/+$/g,"")}function k9(e){return e.replace(/([?*[\]])/g,"[$1]")}var $V=7e3;function IV(e,t){const i=t.activationEvents;if(!i)return Promise.resolve(void 0);const s=[],r=[];for(const u of i)if(/^workspaceContains:/.test(u)){const h=u.substr(18);h.indexOf("*")>=0||h.indexOf("?")>=0||e.forceUsingSearch?r.push(h):s.push(h)}if(s.length===0&&r.length===0)return Promise.resolve(void 0);const{promise:n,resolve:o}=mx(),a=u=>o({activationEvent:u}),c=Promise.all(s.map(u=>DV(e,u,a))).then(()=>{}),l=PV(e,t.identifier,r,a);return Promise.all([c,l]).then(()=>{o(void 0)}),n}async function DV(e,t,i){for(const s of e.folders)if(await e.exists(It(y.revive(s),t))){i(`workspaceContains:${t}`);return}}async function PV(e,t,i,s){if(i.length===0)return Promise.resolve(void 0);const r=new Qe,n=e.checkExists(e.folders,i,r.token),o=setTimeout(async()=>{r.cancel(),e.logService.info(`Not activating extension '${t.value}': Timed out while searching for 'workspaceContains' pattern ${i.join(",")}`)},$V);let a=!1;try{a=await n}catch(c){Mi(c)||lt(c)}r.dispose(),clearTimeout(o),a&&s(`workspaceContains:${i.join(",")}`)}var $9=class{constructor(e){this.b=new I,this.onDidChangePassword=this.b.event,this.a=e.getProxy(Y.MainThreadSecretState)}async $onDidChangePassword(e){this.b.fire(e)}get(e,t){return this.a.$getPassword(e,t)}store(e,t,i){return this.a.$setPassword(e,t,i)}delete(e,t){return this.a.$deletePassword(e,t)}keys(e){return this.a.$getKeys(e)}},BA=H("IExtHostSecretState"),TV=class{#e;constructor(e,t){this.disposables=new ie,this.a=Ye.toKey(e.identifier),this.#e=t,this.onDidChange=Ie.map(Ie.filter(this.#e.onDidChangePassword,i=>i.extensionId===this.a),i=>({key:i.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#e.get(this.a,e)}store(e,t){return this.#e.store(this.a,e,t)}delete(e){return this.#e.delete(this.a,e)}keys(){return this.#e.keys(this.a)||[]}},_A=class{constructor(t,i,s){this.f=s,this.d=new Map,this.a=i.getProxy(Y.MainThreadLocalization),this.b=t.environment.appLanguage,this.c=this.b===Ln}getMessage(t,i){const{message:s,args:r,comment:n}=i;if(this.c)return UE(s,r??{});let o=s;n&&n.length>0&&(o+=`/${Array.isArray(n)?n.join(""):n}`);const a=this.d.get(t)?.contents[o];return a||this.f.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),UE(a??s,r??{})}getBundle(t){return this.d.get(t)?.contents}getBundleUri(t){return this.d.get(t)?.uri}async initializeLocalizedMessages(t){if(this.c||!t.l10n&&!t.isBuiltin||this.d.has(t.identifier.value))return;let i;const s=await this.g(t);if(!s){this.f.error(`No bundle location found for extension ${t.identifier.value}`);return}try{const r=await this.a.$fetchBundleContents(s),n=JSON.parse(r);i=t.isBuiltin?n.contents?.bundle:n}catch(r){this.f.error(`Failed to load translations for ${t.identifier.value} from ${s}: ${r.message}`);return}i&&this.d.set(t.identifier.value,{contents:i,uri:s})}async g(t){if(t.isBuiltin){const i=await this.a.$fetchBuiltInBundleUri(t.identifier.value,this.b);return y.revive(i)}return t.l10n?y.joinPath(t.extensionLocation,t.l10n,`bundle.l10n.${this.b}.json`):void 0}};_A=__decorate([__param(0,jt),__param(1,ke),__param(2,Se)],_A);var VA=H("IExtHostLocalizationService"),qA=H("IExtHostManagedSockets"),GA=class{constructor(t){this.b=0,this.c=null,this.d=new Map,this.a=t.getProxy(Y.MainThreadManagedSockets)}setFactory(t,i){for(const s of this.d.values())s.dispose();this.c&&this.a.$unregisterSocketFactory(this.c.socketFactoryId),this.c=new NV(t,i),this.a.$registerSocketFactory(this.c.socketFactoryId)}async $openRemoteSocket(t){if(!this.c||this.c.socketFactoryId!==t)throw new Error(`No socket factory with id ${t}`);const i=++this.b,s=await this.c.makeConnection(),r=new ie;return this.d.set(i,new MV(i,s,r)),r.add(te(()=>this.d.delete(i))),r.add(s.onDidEnd(()=>{this.a.$onDidManagedSocketEnd(i),r.dispose()})),r.add(s.onDidClose(n=>{this.a.$onDidManagedSocketClose(i,n?.stack??n?.message),r.dispose()})),r.add(s.onDidReceiveMessage(n=>this.a.$onDidManagedSocketHaveData(i,W.wrap(n)))),i}$remoteSocketWrite(t,i){this.d.get(t)?.actual.send(i.buffer)}$remoteSocketEnd(t){const i=this.d.get(t);i&&(i.actual.end(),i.dispose())}async $remoteSocketDrain(t){await this.d.get(t)?.actual.drain?.()}};GA=__decorate([__param(0,ke)],GA);var NV=class{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}},MV=class extends Z{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this.D(i)}},JA,I9=H("IHostUtils"),ZA=JA=class extends Z{constructor(t,i,s,r,n,o,a,c,l,u,h,f,p){super(),this.Y=f,this.Z=p,this.a=this.D(new I),this.onDidChangeRemoteConnectionData=this.a.event,this.R=new Map,this.W=!1,this.c=i,this.g=s,this.f=a,this.j=r,this.m=n,this.q=o,this.s=l,this.t=u,this.u=h,this.w=this.g.getProxy(Y.MainThreadWorkspace),this.y=this.g.getProxy(Y.MainThreadTelemetry),this.z=this.g.getProxy(Y.MainThreadExtensionService),this.C=new ps,this.F=new ps,this.G=new ps,this.H=new ps,this.I=new RV(this.f.extensions.activationEvents),this.L=new qh(this.I,this.f.extensions.allExtensions);const g=new Ko(this.f.extensions.myExtensions);this.J=new qh(this.I,T9(this.L,g)),jo&&(this.q.info(`Creating extension host with the following global extensions: ${Il(this.L)}`),this.q.info(`Creating extension host with the following local extensions: ${Il(this.J)}`)),this.M=new $D(this.g,this.q),this.N=new $9(this.g),this.O=c,this.h=this.B.add(t.createChild(new R0([lA,this.M],[BA,this.N]))),this.P=this.D(new aA(this.J,this.L,{onExtensionActivationError:(v,b,S)=>{this.z.$onExtensionActivationError(v,ic(b),S)},actualActivateExtension:async(v,b)=>{if(qh.isHostExtension(v,this.J,this.L))return await this.z.$activateExtension(v,b),new y_;const S=this.J.getExtensionDescription(v);return this.fb(S,b)}},this.q)),this.Q=null,this.S=Object.create(null),this.U=!1,this.X=this.f.remote.connectionData}getRemoteConnectionData(){return this.X}async initialize(){try{await this.wb(),this.C.open(),await this.j.waitForInitializeCall(),Ut("code/extHost/ready"),this.F.open(),this.f.autoStart&&this.tb()}catch(t){lt(t)}}async $(){this.O.onWillDeactivateAll();let t=[];try{t=this.J.getAllExtensionDescriptions().map(n=>n.identifier).filter(n=>this.isActivated(n)).map(n=>this.eb(n))}catch{}await Promise.all(t)}terminate(t,i=0){if(this.W)return;this.W=!0,this.q.info(`Extension host terminating: ${t}`),this.q.flush(),this.t.dispose(),this.P.dispose(),bv(r=>{this.q.error(r)}),this.g.dispose();const s=this.$();Promise.race([ri(5e3),s]).finally(()=>{this.c.pid?this.q.info(`Extension host with pid ${this.c.pid} exiting with code ${i}`):this.q.info(`Extension host exiting with code ${i}`),this.q.flush(),this.q.dispose(),this.c.exit(i)})}isActivated(t){return this.G.isOpen()?this.P.isActivated(t):!1}async getExtension(t){const i=await this.z.$getExtension(t);return i&&{...i,identifier:new Ye(i.identifier.value),extensionLocation:y.revive(i.extensionLocation)}}ab(t,i){return this.P.activateByEvent(t,i)}bb(t,i){return this.P.activateById(t,i)}activateByIdWithErrors(t,i){return this.bb(t,i).then(()=>{const s=this.P.getActivatedExtension(t);if(s.activationFailed)return Promise.reject(s.activationFailedError)})}getExtensionRegistry(){return this.G.wait().then(t=>this.J)}getExtensionExports(t){if(this.G.isOpen())return this.P.getActivatedExtension(t).exports;try{return this.P.getActivatedExtension(t).exports}catch{return null}}async cb(t){if(t.scheme===V.file&&this.c.fsRealpath){const i=t.fsPath;this.R.has(i)||this.R.set(i,this.c.fsRealpath(i));const s=await this.R.get(i);return y.file(s)}return t}async getExtensionPathIndex(){return this.Q||(this.Q=this.db(this.J.getAllExtensionDescriptions()).then(t=>new LV(t))),this.Q}async db(t){const i=Zn.forUris(s=>Jv.ignorePathCasing(s));return await Promise.all(t.map(async s=>{if(this.xb(s)){const r=await this.cb(s.extensionLocation);i.set(r,s)}})),i}eb(t){let i=Promise.resolve(void 0);if(!this.G.isOpen()||!this.P.isActivated(t))return i;const s=this.P.getActivatedExtension(t);if(!s)return i;try{typeof s.module.deactivate=="function"&&(i=Promise.resolve(s.module.deactivate()).then(void 0,r=>(this.q.error(r),Promise.resolve(void 0))))}catch(r){this.q.error(`An error occurred when deactivating the extension '${t.value}':`),this.q.error(r)}try{s.disposable.dispose()}catch(r){this.q.error(`An error occurred when disposing the subscriptions for extension '${t.value}':`),this.q.error(r)}return i}async fb(t,i){return this.f.remote.isRemote?this.z.$onWillActivateExtension(t.identifier):await this.z.$onWillActivateExtension(t.identifier),this.hb(t,i).then(s=>{const r=s.activationTimes;return this.z.$onDidActivateExtension(t.identifier,r.codeLoadingTime,r.activateCallTime,r.activateResolvedTime,i),this.gb(t,i,"success",r),s},s=>{throw this.gb(t,i,"failure"),s})}gb(t,i,s,r){const n=P9(t,i);this.y.$publicLog2("extensionActivationTimes",{...n,...r||{},outcome:s})}hb(t,i){const s=P9(t,i);this.y.$publicLog2("activatePlugin",s);const r=this.xb(t);if(!r)return Promise.resolve(new b_(vm.NONE));this.q.info(`ExtensionService#_doActivateExtension ${t.identifier.value}, startup: ${i.startup}, activationEvent: '${i.activationEvent}'${t.identifier.value!==i.extensionId.value?`, root cause: ${i.extensionId.value}`:""}`),this.q.flush();const n=this.vb(t),o=new ie,a=new oA(i.startup);return Promise.all([n?this.zb(t,It(t.extensionLocation,r),a):this.yb(t,It(t.extensionLocation,r),a),this.ib(t,o)]).then(c=>(Ut(`code/extHost/willActivateExtension/${t.identifier.value}`),JA.jb(this.q,t.identifier,c[0],c[1],o,a))).then(c=>(Ut(`code/extHost/didActivateExtension/${t.identifier.value}`),c))}ib(t,i){const s=this.Z.createLanguageModelAccessInformation(t),r=i.add(new A_(t,this.M)),n=i.add(new ID(t.identifier.value,!1,this.M)),o=i.add(new TV(t,this.N)),a=t.isUnderDevelopment?this.f.environment.extensionTestsLocationURI?il.Test:il.Development:il.Production,c=this.f.remote.isRemote?Ca.Workspace:Ca.UI;return this.q.trace(`ExtensionService#loadExtensionContext ${t.identifier.value}`),Promise.all([r.whenReady,n.whenReady,this.O.whenReady]).then(()=>{const l=this;let u,h;const f=et(t,"ipc")?this.f.messagePorts?.get(Ye.toKey(t.identifier)):void 0;return Object.freeze({globalState:r,workspaceState:n,secrets:o,subscriptions:[],get languageModelAccessInformation(){return s},get extensionUri(){return t.extensionLocation},get extensionPath(){return t.extensionLocation.fsPath},asAbsolutePath(p){return _e(t.extensionLocation.fsPath,p)},get storagePath(){return l.O.workspaceValue(t)?.fsPath},get globalStoragePath(){return l.O.globalValue(t).fsPath},get logPath(){return _e(l.f.logsLocation.fsPath,t.identifier.value)},get logUri(){return y.joinPath(l.f.logsLocation,t.identifier.value)},get storageUri(){return l.O.workspaceValue(t)},get globalStorageUri(){return l.O.globalValue(t)},get extensionMode(){return a},get extension(){return u===void 0&&(u=new ed(l,t.identifier,t,c,!1)),u},get extensionRuntime(){return T(t,"extensionRuntime"),l.extensionRuntime},get environmentVariableCollection(){return l.t.getEnvironmentVariableCollection(t)},get messagePassingProtocol(){if(!h){if(!f)return;const p=Ie.buffer(Ie.fromDOMEventEmitter(f,"message",g=>g.data));f.start(),h={onDidReceiveMessage:p,postMessage:f.postMessage.bind(f)}}return h}})})}static jb(t,i,s,r,n,o){return s=s||{activate:void 0,deactivate:void 0},this.kb(t,i,s,r,o).then(a=>new wm(!1,null,o.build(),s,a,te(()=>{n.dispose(),Zi(r.subscriptions)})))}static kb(t,i,s,r,n){if(typeof s.activate=="function")try{n.activateCallStart(),t.trace(`ExtensionService#_callActivateOptional ${i.value}`);const o=s.activate.apply(globalThis,[r]);return n.activateCallStop(),n.activateResolveStart(),Promise.resolve(o).then(a=>(n.activateResolveStop(),a))}catch(o){return Promise.reject(o)}else return Promise.resolve(s)}lb(t,i){this.bb(t.identifier,{startup:!1,extensionId:t.identifier,activationEvent:i}).then(void 0,s=>{this.q.error(s)})}mb(t,i=0){const r=Date.now();DE(()=>{for(let n=i;n<t.length;n+=1){const o=t[n];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-r>50){this.mb(t,n);break}else this.lb(o,a)}})}nb(){this.z.$setPerformanceMarks(FO()),this.m.getConfigProvider().then(t=>{const i=t.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),s=this.J.getAllExtensionDescriptions();if(i)this.mb(s);else for(const r of s)if(r.activationEvents)for(const n of r.activationEvents)n==="onStartupFinished"&&this.lb(r,n)})}ob(){const t=this.ab("*",!0).then(void 0,o=>{this.q.error(o)});this.D(this.j.onDidChangeWorkspace(o=>this.pb(o.added)));const i=this.j.workspace?this.j.workspace.folders:[],s=this.pb(i),r=this.rb(),n=Promise.all([r,t,s]).then(()=>{});return Promise.race([n,ri(1e4)]).then(()=>{this.nb()}),n}pb(t){return t.length===0?Promise.resolve(void 0):Promise.all(this.J.getAllExtensionDescriptions().map(i=>this.qb(t,i))).then(()=>{})}async qb(t,i){if(this.isActivated(i.identifier))return;const s=!this.f.remote.isRemote&&!!this.f.remote.authority,r={logService:this.q,folders:t.map(o=>o.uri),forceUsingSearch:s||!this.c.fsExists,exists:o=>this.c.fsExists(o.fsPath),checkExists:(o,a,c)=>this.w.$checkExists(o,a,c)},n=await IV(r,i);if(n)return this.bb(i.identifier,{startup:!0,extensionId:i.identifier,activationEvent:n.activationEvent}).then(void 0,o=>this.q.error(o))}async rb(){if(this.f.remote.authority)return this.ab(`onResolveRemoteAuthority:${this.f.remote.authority}`,!1)}async $extensionTestsExecute(){await this.H.wait();try{return await this.sb()}catch(t){throw console.error(t),t}}async sb(){const{extensionDevelopmentLocationURI:t,extensionTestsLocationURI:i}=this.f.environment;if(!t||!i)throw new Error(d(3037,null));const s=(await this.getExtensionPathIndex()).findSubstr(i),n=await(this.vb(s,i.path)?this.zb(null,i,new oA(!1)):this.yb(null,i,new oA(!1)));if(!n||typeof n.run!="function")throw new Error(d(3038,null,i.toString()));return new Promise((o,a)=>{const c=(h,f)=>{h?(jo&&this.q.error("Test runner called back with error",h),a(h)):(jo&&(f?this.q.info(`Test runner called back with ${f} failures.`):this.q.info("Test runner called back with successful outcome.")),o(typeof f=="number"&&f>0?1:0))},l=Gs(i),u=n.run(l,c);u&&u.then&&u.then(()=>{jo&&this.q.info("Test runner finished successfully."),o(0)}).catch(h=>{jo&&this.q.error("Test runner finished with error",h),a(h instanceof Error&&h.stack?h.stack:String(h))})})}tb(){if(this.U)throw new Error("Extension host is already started!");return this.U=!0,this.F.wait().then(()=>this.G.open()).then(()=>Promise.race([this.P.waitForActivatingExtensions(),ri(1e3)])).then(()=>this.ob()).then(()=>{this.H.open(),this.q.info("Eager extensions activated")})}registerRemoteAuthorityResolver(t,i){return this.S[t]=i,te(()=>{delete this.S[t]})}async getRemoteExecServer(t){const{resolver:i}=await this.ub(t);return i?.resolveExecServer?.(t,{resolveAttempt:0})}async ub(t){const i=t.indexOf("+");if(i===-1)throw new Mc("Not an authority that can be resolved!",zi.InvalidAuthority);const s=t.substr(0,i);return await this.C.wait(),await this.ab(`onResolveRemoteAuthority:${s}`,!1),{authorityPrefix:s,resolver:this.S[s]}}async $resolveAuthority(t,i){const s=Qi.create(!1),r=()=>`[resolveAuthority(${a7(t)},${i})][${s.elapsed()}ms] `,n=E=>this.q.info(`${r()}${E}`),o=E=>this.q.warn(`${r()}${E}`),a=(E,k=void 0)=>this.q.error(`${r()}${E}`,k),c=E=>{if(E instanceof Mc)return{type:"error",error:{code:E._code,message:E._message,detail:E._detail}};throw E},l=async E=>{n(`activating resolver for ${E}...`);const{resolver:k,authorityPrefix:j}=await this.ub(E);if(!k)throw a(`no resolver for ${j}`),new Mc(`No remote extension installed to resolve ${j}.`,zi.NoResolverFound);return{resolver:k,authorityPrefix:j,remoteAuthority:E}},u=t.split(/@|%40/g).reverse();n(`activating remote resolvers ${u.join(" -> ")}`);let h;try{h=await Promise.all(u.map(l)).catch(async E=>{if(!(E instanceof Mc)||E._code!==zi.InvalidAuthority)throw E;return o(`resolving nested authorities failed: ${E.message}`),[await l(t)]})}catch(E){return c(E)}const f=new Ax;f.cancelAndSet(()=>n("waiting..."),1e3);let p,g;for(const[E,{authorityPrefix:k,resolver:j,remoteAuthority:O}]of h.entries())try{if(E===h.length-1)n("invoking final resolve()..."),Ut(`code/extHost/willResolveAuthority/${k}`),p=await j.resolve(O,{resolveAttempt:i,execServer:g}),Ut(`code/extHost/didResolveAuthorityOK/${k}`),n("setting tunnel factory..."),this.D(await this.s.setTunnelFactory(j,Pp.isManagedResolvedAuthority(p)?p:void 0));else{if(n(`invoking resolveExecServer() for ${O}`),Ut(`code/extHost/willResolveExecServer/${k}`),g=await j.resolveExecServer?.(O,{resolveAttempt:i,execServer:g}),!g)throw new Mc(`Exec server was not available for ${O}`,zi.NoResolverFound);Ut(`code/extHost/didResolveExecServerOK/${k}`)}}catch(Q){return Ut(`code/extHost/didResolveAuthorityError/${k}`),a("returned an error",Q),f.dispose(),c(Q)}f.dispose();const v={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?!0:p.tunnelFeatures.protocol}:void 0},b={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};n(`returned ${Pp.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let S;if(Pp.isManagedResolvedAuthority(p)){const E=i;this.Y.setFactory(E,p.makeConnection),S={authority:t,connectTo:new o7(E),connectionToken:p.connectionToken}}else S={authority:t,connectTo:new KW(p.host,p.port),connectionToken:p.connectionToken};return{type:"ok",value:{authority:S,options:b,tunnelInformation:v}}}async $getCanonicalURI(t,i){this.q.info(`$getCanonicalURI invoked for authority (${a7(t)})`);const{resolver:s}=await this.ub(t);if(!s)return null;const r=y.revive(i);if(typeof s.getCanonicalURI>"u")return r;const n=await fi(()=>s.getCanonicalURI(r));return n||r}async $startExtensionHost(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:s}=D9(this.I,this.L,this.J,t),r=await this.db(s);return(await this.getExtensionPathIndex()).setSearchTree(r),this.L.set(i.getAllExtensionDescriptions()),this.J.set(s),jo&&(this.q.info(`$startExtensionHost: global extensions: ${Il(this.L)}`),this.q.info(`$startExtensionHost: local extensions: ${Il(this.J)}`)),this.tb()}$activateByEvent(t,i){return i===1?this.C.wait().then(s=>this.ab(t,!1)):this.G.wait().then(s=>this.ab(t,!1))}async $activate(t,i){return await this.G.wait(),this.J.getExtensionDescription(t)?(await this.bb(t,i),!0):!1}async $deltaExtensions(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:s}=D9(this.I,this.L,this.J,t),r=await this.db(s);return(await this.getExtensionPathIndex()).setSearchTree(r),this.L.set(i.getAllExtensionDescriptions()),this.J.set(s),jo&&(this.q.info(`$deltaExtensions: global extensions: ${Il(this.L)}`),this.q.info(`$deltaExtensions: local extensions: ${Il(this.J)}`)),Promise.resolve(void 0)}async $test_latency(t){return t}async $test_up(t){return t.byteLength}async $test_down(t){const i=W.alloc(t),s=Math.random()%256;for(let r=0;r<t;r++)i.writeUInt8(s,r);return i}async $updateRemoteConnectionData(t){this.X=t,this.a.fire()}vb(t,i){return i??=t?this.xb(t):i,i?.endsWith(".mjs")||t?.type==="module"&&!i?.endsWith(".cjs")}};ZA=JA=__decorate([__param(0,Xo),__param(1,I9),__param(2,ke),__param(3,Rs),__param(4,ws),__param(5,Se),__param(6,jt),__param(7,hA),__param(8,Am),__param(9,mn),__param(10,VA),__param(11,qA),__param(12,MA)],ZA);function D9(e,t,i,s){e.addActivationEvents(s.addActivationEvents);const r=new qh(e,t.getAllExtensionDescriptions());r.deltaExtensions(s.toAdd,s.toRemove);const n=new Ko(i.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of s.myToRemove)n.delete(a);for(const a of s.myToAdd)n.add(a);const o=T9(r,n);return{globalRegistry:r,myExtensions:o}}function P9(e,t){return{id:e.identifier.value,name:e.name,extensionVersion:e.version,publisherDisplayName:e.publisher,activationEvents:e.activationEvents?e.activationEvents.join(","):null,isBuiltin:e.isBuiltin,reason:t.activationEvent,reasonId:t.extensionId.value}}function Il(e){return e.getAllExtensionDescriptions().map(t=>t.identifier.value).join(",")}var vn=H("IExtHostExtensionService"),ed=class{#e;#t;#i;constructor(e,t,i,s,r){this.#e=e,this.#t=t,this.#i=i.identifier,this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=Xr(Gs(i.extensionLocation)),this.packageJSON=i,this.extensionKind=s,this.isFromDifferentExtensionHost=r}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await this.#e.activateByIdWithErrors(this.#i,{startup:!1,extensionId:this.#t,activationEvent:"api"}),this.exports}};function T9(e,t){return e.getAllExtensionDescriptions().filter(i=>t.has(i.identifier))}var LV=class{constructor(e){this.a=e}setSearchTree(e){this.a=e}findSubstr(e){return this.a.findSubstr(e)}forEach(e){return this.a.forEach(e)}},RV=class{constructor(e){this.a=new qn,this.addActivationEvents(e)}readActivationEvents(e){return this.a.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this.a.set(t,e[t])}},Dl=H("IExtHostApiDeprecationService"),QA=class{constructor(t,i){this.c=i,this.a=new Set,this.b=t.getProxy(Y.MainThreadTelemetry)}report(t,i,s){const r=this.d(t,i);this.a.has(r)||(this.a.add(r),i.isUnderDevelopment&&this.c.warn(`[Deprecation Warning] '${t}' is deprecated. ${s}`),this.b.$publicLog2("extHostDeprecatedApiUsage",{extensionId:i.identifier.value,apiId:t}))}d(t,i){return`${t}-${i.identifier.value}`}};QA=__decorate([__param(0,ke),__param(1,Se)],QA);var Rre=Object.freeze(new class{report(e,t,i){}}),N9=class{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(Se),s=e.get(ke).getProxy(Y.MainThreadErrors);bv(r=>{t.error(r);const n=ic(r);s.$onUnexpectedError(n)})}static async installFullHandler(e){const t=e.get(Se),i=e.get(ke),s=e.get(vn),r=e.get(Em),n=e.get(Dl),o=i.getProxy(Y.MainThreadExtensionService),a=i.getProxy(Y.MainThreadErrors),c=await s.getExtensionRegistry(),l=await s.getExtensionPathIndex(),u=new WeakMap;function h(g,v){if(u.has(g))return u.get(g).stack;let b="",S,E;for(const j of v)b+=`
	at ${j.toString()}`,E=j.getFileName(),!S&&E&&(S=l.findSubstr(y.file(E)));const k=`${g.name||"Error"}: ${g.message||""}${b}`;return u.set(g,{extensionIdentifier:S?.identifier,stack:k}),k}const f=Symbol("prepareStackTrace wrapped");let p=h;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return p},set(g){if(g===h||!g||g[f]){p=g||h;return}p=function(v,b){return h(v,b),g.call(Error,v,b)},Object.assign(p,{[f]:!0})}}),bv(g=>{yv.is(g)||t.error(g);const v=ic(g);let b;if(g instanceof tk?b=g.extension:b=u.get(g)?.extensionIdentifier,!!b)if(yv.is(g)){const S=c.getExtensionDescription(b);S&&n.report(g.name,S,`${g.message}
 FROM: ${g.stack}`)}else{o.$onExtensionRuntimeError(b,v);const S=r.onExtensionError(b,g);t.trace("forwarded error to extension?",S,b)}}),iu.addListener(g=>{a.$onUnexpectedError(g)})}},OV=class RM{constructor(t,i,s,r,n){this.a=s,this.b=new jU(t,null,r),i=RM.e(i,this.b);const o=new R0(...lj());o.set(jt,{_serviceBrand:void 0,...i,messagePorts:n}),o.set(ke,new fj(this.b)),o.set(Cu,new pj(r)),o.set(I9,s);const a=new dj(o,!0);a.invokeFunction(N9.installEarlyHandler),this.d=a.invokeFunction(c=>c.get(Se)),Ut("code/extHost/didCreateServices"),this.a.pid?this.d.info(`Extension host with pid ${this.a.pid} started`):this.d.info("Extension host started"),this.d.trace("initData",i),this.c=a.invokeFunction(c=>c.get(vn)),this.c.initialize(),a.invokeFunction(N9.installFullHandler)}async asBrowserUri(t){const i=this.b.getProxy(Y.MainThreadExtensionService);return y.revive(await i.$asBrowserUri(t))}terminate(t){this.c.terminate(t)}static e(t,i){t.extensions.allExtensions.forEach(r=>{r.extensionLocation=y.revive(i.transformIncomingURIs(r.extensionLocation))}),t.environment.appRoot=y.revive(i.transformIncomingURIs(t.environment.appRoot));const s=t.environment.extensionDevelopmentLocationURI;return s&&(t.environment.extensionDevelopmentLocationURI=s.map(r=>y.revive(i.transformIncomingURIs(r)))),t.environment.extensionTestsLocationURI=y.revive(i.transformIncomingURIs(t.environment.extensionTestsLocationURI)),t.environment.globalStorageHome=y.revive(i.transformIncomingURIs(t.environment.globalStorageHome)),t.environment.workspaceStorageHome=y.revive(i.transformIncomingURIs(t.environment.workspaceStorageHome)),t.nlsBaseUrl=y.revive(i.transformIncomingURIs(t.nlsBaseUrl)),t.logsLocation=y.revive(i.transformIncomingURIs(t.logsLocation)),t.workspace=i.transformIncomingURIs(t.workspace),t}};function FV(e){return{transformIncoming:t=>t.scheme==="vscode-remote"?{scheme:"file",path:t.path,query:t.query,fragment:t.fragment}:t.scheme==="file"?{scheme:"vscode-local",path:t.path,query:t.query,fragment:t.fragment}:t,transformOutgoing:t=>t.scheme==="file"?{scheme:"vscode-remote",authority:e,path:t.path,query:t.query,fragment:t.fragment}:t.scheme==="vscode-local"?{scheme:"file",path:t.path,query:t.query,fragment:t.fragment}:t,transformOutgoingScheme:t=>t==="file"?"vscode-remote":t==="vscode-local"?"file":t}}function UV(e){return new NU(FV(e))}var M9;(function(e){e[e.IPC=1]="IPC",e[e.Socket=2]="Socket",e[e.MessagePort=3]="MessagePort"})(M9||(M9={}));var Mm=class OM{static{this.ENV_KEY="VSCODE_EXTHOST_IPC_HOOK"}constructor(t){this.pipeName=t,this.type=1}serialize(t){t[OM.ENV_KEY]=this.pipeName}},YA=class FM{constructor(){this.type=2}static{this.ENV_KEY="VSCODE_EXTHOST_WILL_SEND_SOCKET"}serialize(t){t[FM.ENV_KEY]="1"}},XA=class UM{constructor(){this.type=3}static{this.ENV_KEY="VSCODE_WILL_SEND_MESSAGE_PORT"}serialize(t){t[UM.ENV_KEY]="1"}};function jV(e){delete e[Mm.ENV_KEY],delete e[YA.ENV_KEY],delete e[XA.ENV_KEY]}function zV(e){if(e[Mm.ENV_KEY])return KA(e,new Mm(e[Mm.ENV_KEY]));if(e[YA.ENV_KEY])return KA(e,new YA);if(e[XA.ENV_KEY])return KA(e,new XA);throw new Error("No connection information defined in environment!")}function KA(e,t){return jV(e),t}var Ore=new C("inOutput",!1),Fre=new C("activeLogOutput",!1),Ure=new C("activeLogOutput.isLog",!1),jre=new C("activeLogOutput.levelSettable",!1),zre=new C("activeLogOutput.level",""),Hre=new C("activeLogOutput.levelIsDefault",!1),Wre=new C("outputView.scrollLock",!1),Bre=new C("activeOutputChannel",""),_re=new C("output.filter.trace",!0),Vre=new C("output.filter.debug",!0),qre=new C("output.filter.info",!0),Gre=new C("output.filter.warning",!0),Jre=new C("output.filter.error",!0),Zre=new C("outputFilterFocus",!1),Qre=new C("output.filter.categories",""),Yre=H("outputService"),td;(function(e){e[e.Append=1]="Append",e[e.Replace=2]="Replace",e[e.Clear=3]="Clear"})(td||(td={}));var HV={OutputChannels:"workbench.contributions.outputChannels"};function WV(e){return Array.isArray(e.source)}var BV=class extends Z{constructor(){super(...arguments),this.a=new Map,this.b=this.D(new I),this.onDidRegisterChannel=this.b.event,this.c=this.D(new I),this.onDidRemoveChannel=this.c.event,this.f=this.D(new I),this.onDidUpdateChannelSources=this.f.event}registerChannel(e){this.a.has(e.id)||(this.a.set(e.id,e),this.b.fire(e.id))}getChannels(){const e=[];return this.a.forEach(t=>e.push(t)),e}getChannel(e){return this.a.get(e)}updateChannelSources(e,t){const i=this.a.get(e);i&&WV(i)&&(i.source=t,this.f.fire(i))}removeChannel(e){const t=this.a.get(e);t&&(this.a.delete(e),this.c.fire(t))}};Qt.add(HV.OutputChannels,new BV);var L9=class extends L0{constructor(e,t,i,s,r){super(),this.id=e,this.name=t,this.q=i,this.r=s,this.extension=r,this.n=0,this.visible=!1,this.setLevel(i.getLevel()),this.D(i.onDidChangeLogLevel(n=>this.setLevel(n))),this.D(te(()=>this.r.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.n;this.q.flush(),this.r.$update(this.id,td.Clear,e)}replace(e){const t=this.n;this.info(e),this.r.$update(this.id,td.Replace,t),this.visible&&this.q.flush()}show(e,t){this.q.flush(),this.r.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.r.$close(this.id)}m(e,t){this.n+=W.fromString(t).byteLength,nj(this.q,e,t),this.visible&&(this.q.flush(),this.r.$update(this.id,td.Append))}},_V=class extends L9{appendLine(e){this.append(e)}},e4=class{constructor(t,i,s,r,n,o){this.j=i,this.k=s,this.l=r,this.m=n,this.n=o,this.d=new kt,this.f=new kt,this.g=1,this.h=new Map,this.i=null,this.a=t.getProxy(Y.MainThreadOutputService),this.b=this.l.extUri.joinPath(i.logsLocation,`output_logging_${hV(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(t){this.i=t;for(const[i,s]of this.h)s.visible=i===this.i}createOutputChannel(t,i,s){if(t=t.trim(),!t)throw new Error("illegal argument `name`. must not be falsy");const r=typeof i=="object"&&i.log,n=Oe(i)?i:void 0;if(Oe(n)&&!n.trim())throw new Error("illegal argument `languageId`. must not be empty");const o=new ie;let a,c=this.j.environment.extensionLogLevel?.find(([u])=>Ye.equals(s.identifier,u))?.[1],l;if(r){const u=this.l.extUri.joinPath(this.j.logsLocation,s.identifier.value);l=this.l.extUri.joinPath(u,`${t.replace(/[\\/:\*\?"<>\|]/g,"")}.log`);const h=this.f.get(l);if(h)return h;c=this.m.getLogLevel(l)??c,a=this.p(t,l,c,s,o)}else a=this.o(t,n,s,o);if(a.then(u=>{this.h.set(u.id,u),u.visible=u.id===this.i,o.add(te(()=>{this.h.delete(u.id),l&&this.f.delete(l)}))}),l){const u=this.s(t,c??this.n.getLevel(),a,o);return this.f.set(l,u),u}return this.r(t,a,o)}async o(t,i,s,r){this.c||(this.c=this.k.value.createDirectory(this.b).then(()=>this.b));const n=await this.c,o=this.l.extUri.joinPath(n,`${this.g++}-${t.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),a=r.add(this.m.createLogger(o,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0})),c=await this.a.$register(t,o,i,s.identifier.value);return r.add(te(()=>this.m.deregisterLogger(o))),new L9(c,t,a,this.a,s)}async p(t,i,s,r,n){await this.q(i);const o=`${r.identifier.value}.${this.l.extUri.basename(i)}`,a=n.add(this.m.createLogger(i,{id:o,name:t,logLevel:s,extensionId:r.identifier.value}));return n.add(te(()=>this.m.deregisterLogger(i))),new _V(o,t,a,this.a,r)}q(t){const i=this.l.extUri.dirname(t);let s=this.d.get(i);return s||this.d.set(i,s=(async()=>{try{await this.k.value.createDirectory(i)}catch(r){if(_f(r)!==he.FileExists)throw r}})()),s}r(t,i,s){const r=()=>{if(s.isDisposed)throw new Error("Channel has been closed")};return i.then(n=>s.add(n)),{get name(){return t},append(n){r(),i.then(o=>o.append(n))},appendLine(n){r(),i.then(o=>o.appendLine(n))},clear(){r(),i.then(n=>n.clear())},replace(n){r(),i.then(o=>o.replace(n))},show(n,o){r(),i.then(a=>a.show(n,o))},hide(){r(),i.then(n=>n.hide())},dispose(){s.dispose()}}}s(t,i,s,r){const n=()=>{if(r.isDisposed)throw new Error("Channel has been closed")},o=r.add(new I);function a(c){i=c,o.fire(c)}return s.then(c=>{c.logLevel!==i&&a(c.logLevel),r.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.r(t,s,r),get logLevel(){return i},onDidChangeLogLevel:o.event,trace(c,...l){n(),s.then(u=>u.trace(c,...l))},debug(c,...l){n(),s.then(u=>u.debug(c,...l))},info(c,...l){n(),s.then(u=>u.info(c,...l))},warn(c,...l){n(),s.then(u=>u.warn(c,...l))},error(c,...l){n(),s.then(u=>u.error(c,...l))}}}};e4=__decorate([__param(0,ke),__param(1,jt),__param(2,Gh),__param(3,yc),__param(4,Jn),__param(5,Se)],e4);var R9=H("IExtHostOutputService"),id,t4=class{static{id=this}static{this.c=0}static{this.d=250}constructor(t,i){this.h=i,this.f=new Map,this.g=t.getProxy(Y.MainThreadDecorations)}registerFileDecorationProvider(t,i){const s=id.c++;this.f.set(s,{provider:t,extensionDescription:i}),this.g.$registerDecorationProvider(s,i.identifier.value);const r=t.onDidChangeFileDecorations&&t.onDidChangeFileDecorations(n=>{if(!n){this.g.$onDidChange(s,null);return}const o=xs(n);if(o.length<=id.d){this.g.$onDidChange(s,o);return}this.h.warn("[Decorations] CAPPING events from decorations provider",i.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:u2(u.path,"/")})),c=XL(a,(u,h)=>u.rank-h.rank||_o(u.uri.path,h.uri.path)),l=[];e:for(const u of c){let h;for(const f of u){const p=$i(f.uri.path);if(h!==p&&(h=p,l.push(f.uri)>=id.d))break e}}this.g.$onDidChange(s,l)});return new Ce(()=>{r?.dispose(),this.g.$unregisterDecorationProvider(s),this.f.delete(s)})}async $provideDecorations(t,i,s){if(!this.f.has(t))return Object.create(null);const r=Object.create(null),{provider:n,extensionDescription:o}=this.f.get(t);return await Promise.all(i.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(n.provideFileDecoration(y.revive(c),s));if(!u)return;try{yb.validate(u),u.badge&&typeof u.badge!="string"&&T(o,"codiconDecoration"),r[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(h){this.h.warn(`INVALID decoration from extension '${o.identifier.value}': ${h}`)}}catch(c){this.h.error(c)}})),r}};t4=id=__decorate([__param(0,ke),__param(1,Se)],t4);var O9=H("IExtHostDecorations"),VV=class{constructor(e){this.a=e,this.b=new Uint32Array(e.length),this.c=new Int32Array(1),this.c[0]=-1}getCount(){return this.a.length}insertValues(e,t){e=$l(e);const i=this.a,s=this.b,r=t.length;return r===0?!1:(this.a=new Uint32Array(i.length+r),this.a.set(i.subarray(0,e),0),this.a.set(i.subarray(e),e+r),this.a.set(t,e),e-1<this.c[0]&&(this.c[0]=e-1),this.b=new Uint32Array(this.a.length),this.c[0]>=0&&this.b.set(s.subarray(0,this.c[0]+1)),!0)}setValue(e,t){return e=$l(e),t=$l(t),this.a[e]===t?!1:(this.a[e]=t,e-1<this.c[0]&&(this.c[0]=e-1),!0)}removeValues(e,t){e=$l(e),t=$l(t);const i=this.a,s=this.b;if(e>=i.length)return!1;const r=i.length-e;return t>=r&&(t=r),t===0?!1:(this.a=new Uint32Array(i.length-t),this.a.set(i.subarray(0,e),0),this.a.set(i.subarray(e+t),e),this.b=new Uint32Array(this.a.length),e-1<this.c[0]&&(this.c[0]=e-1),this.c[0]>=0&&this.b.set(s.subarray(0,this.c[0]+1)),!0)}getTotalSum(){return this.a.length===0?0:this.d(this.a.length-1)}getPrefixSum(e){return e<0?0:(e=$l(e),this.d(e))}d(e){if(e<=this.c[0])return this.b[e];let t=this.c[0]+1;t===0&&(this.b[0]=this.a[0],t++),e>=this.a.length&&(e=this.a.length-1);for(let i=t;i<=e;i++)this.b[i]=this.b[i-1]+this.a[i];return this.c[0]=Math.max(this.c[0],e),this.b[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.a.length-1,s=0,r=0,n=0;for(;t<=i;)if(s=t+(i-t)/2|0,r=this.b[s],n=r-this.a[s],e<n)i=s-1;else if(e>=r)t=s+1;else break;return new qV(s,e-n)}},qV=class{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}},GV=class{constructor(e,t,i,s){this.a=e,this.b=t,this.c=i,this.d=s,this.f=null,this.g=null}dispose(){this.b.length=0}get version(){return this.d}getText(){return this.g===null&&(this.g=this.b.join(this.c)),this.g}onEvents(e){e.eol&&e.eol!==this.c&&(this.c=e.eol,this.f=null);const t=e.changes;for(const i of t)this.k(i.range),this.l(new ms(i.range.startLineNumber,i.range.startColumn),i.text);this.d=e.versionId,this.g=null}h(){if(!this.f){const e=this.c.length,t=this.b.length,i=new Uint32Array(t);for(let s=0;s<t;s++)i[s]=this.b[s].length+e;this.f=new VV(i)}}j(e,t){this.b[e]=t,this.f&&this.f.setValue(e,this.b[e].length+this.c.length)}k(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this.j(e.startLineNumber-1,this.b[e.startLineNumber-1].substring(0,e.startColumn-1)+this.b[e.startLineNumber-1].substring(e.endColumn-1));return}this.j(e.startLineNumber-1,this.b[e.startLineNumber-1].substring(0,e.startColumn-1)+this.b[e.endLineNumber-1].substring(e.endColumn-1)),this.b.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this.f&&this.f.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}l(e,t){if(t.length===0)return;const i=HE(t);if(i.length===1){this.j(e.lineNumber-1,this.b[e.lineNumber-1].substring(0,e.column-1)+i[0]+this.b[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this.b[e.lineNumber-1].substring(e.column-1),this.j(e.lineNumber-1,this.b[e.lineNumber-1].substring(0,e.column-1)+i[0]);const s=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this.b.splice(e.lineNumber+r-1,0,i[r]),s[r-1]=i[r].length+this.c.length;this.f&&this.f.insertValues(e.lineNumber,s)}},i4=new Map;function JV(e,t){t?i4.set(e,t):i4.delete(e)}function ZV(e){return i4.get(e)}var QV=class extends GV{constructor(e,t,i,s,r,n,o,a,c=!0){super(t,i,s,r),this.o=e,this.p=n,this.q=o,this.r=a,this.s=c,this.n=!1}dispose(){ki(!this.n),this.n=!0,this.q=!1}equalLines(e){return Ci(this.b,e)}get document(){if(!this.m){const e=this;this.m={get uri(){return e.a},get fileName(){return e.a.fsPath},get isUntitled(){return e.a.scheme===V.untitled},get languageId(){return e.p},get version(){return e.d},get isClosed(){return e.n},get isDirty(){return e.q},get encoding(){return e.r},save(){return e.t()},getText(t){return t?e.u(t):e.getText()},get eol(){return e.c===`
`?sr.LF:sr.CRLF},get lineCount(){return e.b.length},lineAt(t){return e.v(t)},offsetAt(t){return e.w(t)},positionAt(t){return e.x(t)},validateRange(t){return e.y(t)},validatePosition(t){return e.z(t)},getWordRangeAtPosition(t,i){return e.A(t,i)},[Symbol.for("debug.description")](){return`TextDocument(${e.a.toString()})`}}}return Object.freeze(this.m)}_acceptLanguageId(e){ki(!this.n),this.p=e}_acceptIsDirty(e){ki(!this.n),this.q=e}_acceptEncoding(e){ki(!this.n),this.r=e}t(){return this.n?Promise.reject(new Error("Document has been closed")):this.o.$trySaveDocument(this.a)}u(e){const t=this.y(e);if(t.isEmpty)return"";if(t.isSingleLine)return this.b[t.start.line].substring(t.start.character,t.end.character);const i=this.c,s=t.start.line,r=t.end.line,n=[];n.push(this.b[s].substring(t.start.character));for(let o=s+1;o<r;o++)n.push(this.b[o]);return n.push(this.b[r].substring(0,t.end.character)),n.join(i)}v(e){let t;if(e instanceof Pe?t=e.line:typeof e=="number"?t=e:!this.s&&Pe.isPosition(e)&&(t=e.line),typeof t!="number"||t<0||t>=this.b.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new YV(t,this.b[t],t===this.b.length-1)}w(e){return e=this.z(e),this.h(),this.f.getPrefixSum(e.line-1)+e.character}x(e){e=Math.floor(e),e=Math.max(0,e),this.h();const t=this.f.getIndexOf(e),i=this.b[t.index].length;return new Pe(t.index,Math.min(t.remainder,i))}y(e){if(this.s){if(!(e instanceof xe))throw new Error("Invalid argument")}else if(!xe.isRange(e))throw new Error("Invalid argument");const t=this.z(e.start),i=this.z(e.end);return t===e.start&&i===e.end?e:new xe(t.line,t.character,i.line,i.character)}z(e){if(this.s){if(!(e instanceof Pe))throw new Error("Invalid argument")}else if(!Pe.isPosition(e))throw new Error("Invalid argument");if(this.b.length===0)return e.with(0,0);let{line:t,character:i}=e,s=!1;if(t<0)t=0,i=0,s=!0;else if(t>=this.b.length)t=this.b.length-1,i=this.b[t].length,s=!0;else{const r=this.b[t].length;i<0?(i=0,s=!0):i>r&&(i=r,s=!0)}return s?new Pe(t,i):e}A(e,t){const i=this.z(e);if(!t)t=ZV(this.p);else if(zE(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const s=bC(i.character+1,vC(t),this.b[i.line],0);if(s)return new xe(i.line,s.startColumn-1,i.line,s.endColumn-1)}},YV=class{constructor(e,t,i){this.a=e,this.b=t,this.c=i}get lineNumber(){return this.a}get text(){return this.b}get range(){return new xe(this.a,0,this.a,this.b.length)}get rangeIncludingLineBreak(){return this.c?this.range:new xe(this.a,0,this.a+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this.b)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this.b.length}},Lm=class{constructor(e){this.a=e,this.b=0}nextId(){return this.a+ ++this.b}},ene=new Lm("id#"),XV=class jM{static{this.c=new Lm("TextEditorDecorationType")}constructor(t,i,s){const r=jM.c.nextId();t.$registerTextEditorDecorationType(i.identifier,r,sy.from(s)),this.value=Object.freeze({key:r,dispose(){t.$removeTextEditorDecorationType(r)}})}},KV=class{constructor(e,t){this.g=[],this.h=void 0,this.j=!1,this.c=e,this.d=e.version,this.e=t.undoStopBefore,this.f=t.undoStopAfter}finalize(){return this.j=!0,{documentVersionId:this.d,edits:this.g,setEndOfLine:this.h,undoStopBefore:this.e,undoStopAfter:this.f}}k(){if(this.j)throw new Error("Edit is only valid while callback runs")}replace(e,t){this.k();let i=null;if(e instanceof Pe)i=new xe(e,e);else if(e instanceof xe)i=e;else throw new Error("Unrecognized location");this.l(i,t,!1)}insert(e,t){this.k(),this.l(new xe(e,e),t,!0)}delete(e){this.k();let t=null;if(e instanceof xe)t=e;else throw new Error("Unrecognized location");this.l(t,null,!0)}l(e,t,i){const s=this.c.validateRange(e);this.g.push({range:s,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this.k(),e!==sr.LF&&e!==sr.CRLF)throw $e("endOfLine");this.h=e}},eq=class{constructor(e,t,i,s){this.c=e,this.d=t,this._accept(i),this.e=s;const r=this;this.value={get tabSize(){return r.f},set tabSize(n){r.n(n)},get indentSize(){return r.g},set indentSize(n){r.p(n)},get insertSpaces(){return r.j},set insertSpaces(n){r.s(n)},get cursorStyle(){return r.k},set cursorStyle(n){r.t(n)},get lineNumbers(){return r.l},set lineNumbers(n){r.u(n)}}}_accept(e){this.f=e.tabSize,this.g=e.indentSize,this.h=e.originalIndentSize,this.j=e.insertSpaces,this.k=e.cursorStyle,this.l=ul.to(e.lineNumbers)}m(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}n(e){const t=this.m(e);if(t!==null){if(typeof t=="number"){if(this.f===t)return;this.f=t}this.v("setTabSize",this.c.$trySetOptions(this.d,{tabSize:t}))}}o(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}p(e){const t=this.o(e);if(t!==null){if(typeof t=="number"){if(this.h===t)return;this.g=t,this.h=t}this.v("setIndentSize",this.c.$trySetOptions(this.d,{indentSize:t}))}}q(e){return e==="auto"?"auto":e==="false"?!1:!!e}s(e){const t=this.q(e);if(typeof t=="boolean"){if(this.j===t)return;this.j=t}this.v("setInsertSpaces",this.c.$trySetOptions(this.d,{insertSpaces:t}))}t(e){this.k!==e&&(this.k=e,this.v("setCursorStyle",this.c.$trySetOptions(this.d,{cursorStyle:e})))}u(e){this.l!==e&&(this.l=e,this.v("setLineNumbers",this.c.$trySetOptions(this.d,{lineNumbers:ul.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const s=this.m(e.tabSize);s==="auto"?(i=!0,t.tabSize=s):typeof s=="number"&&this.f!==s&&(this.f=s,i=!0,t.tabSize=s)}if(typeof e.indentSize<"u"){const s=this.o(e.indentSize);s==="tabSize"?(i=!0,t.indentSize=s):typeof s=="number"&&this.h!==s&&(this.g=s,this.h=s,i=!0,t.indentSize=s)}if(typeof e.insertSpaces<"u"){const s=this.q(e.insertSpaces);s==="auto"?(i=!0,t.insertSpaces=s):this.j!==s&&(this.j=s,i=!0,t.insertSpaces=s)}typeof e.cursorStyle<"u"&&this.k!==e.cursorStyle&&(this.k=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this.l!==e.lineNumbers&&(this.l=e.lineNumbers,i=!0,t.lineNumbers=ul.from(e.lineNumbers)),i&&this.v("setOptions",this.c.$trySetOptions(this.d,t))}v(e,t){t.catch(i=>{this.e.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this.e.warn(i)})}},tq=class{constructor(e,t,i,s,r,n,o,a){this.id=e,this.k=t,this.l=i,this.g=!1,this.h=new Set,this.c=r,this.d=new eq(this.k,this.id,n,i),this.e=o,this.f=a;const c=this;this.value=Object.freeze({get document(){return s.value},set document(l){throw new Lo("document")},get selection(){return c.c&&c.c[0]},set selection(l){if(!(l instanceof Dr))throw $e("selection");c.c=[l],c.m()},get selections(){return c.c},set selections(l){if(!Array.isArray(l)||l.some(u=>!(u instanceof Dr)))throw $e("selections");l.length===0&&(l=[new Dr(0,0,0,0)]),c.c=l,c.m()},get visibleRanges(){return c.e},set visibleRanges(l){throw new Lo("visibleRanges")},get diffInformation(){return c.j},get options(){return c.d.value},set options(l){c.g||c.d.assign(l)},get viewColumn(){return c.f},set viewColumn(l){throw new Lo("viewColumn")},edit(l,u={undoStopBefore:!0,undoStopAfter:!0}){if(c.g)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const h=new KV(s.value,u);return l(h),c.n(h)},insertSnippet(l,u,h={undoStopBefore:!0,undoStopAfter:!0}){if(c.g)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let f;if(!u||Array.isArray(u)&&u.length===0)f=c.c.map(p=>U.from(p));else if(u instanceof Pe){const{lineNumber:p,column:g}=Xe.from(u);f=[{startLineNumber:p,startColumn:g,endLineNumber:p,endColumn:g}]}else if(u instanceof xe)f=[U.from(u)];else{f=[];for(const p of u)if(p instanceof xe)f.push(U.from(p));else{const{lineNumber:g,column:v}=Xe.from(p);f.push({startLineNumber:g,startColumn:v,endLineNumber:g,endColumn:v})}}return h.keepWhitespace===void 0&&(h.keepWhitespace=!1),t.$tryInsertSnippet(e,s.value.version,l.value,f,h)},setDecorations(l,u){const h=u.length===0;h&&!c.h.has(l.key)||(h?c.h.delete(l.key):c.h.add(l.key),c.o(()=>{if(_7(u))return t.$trySetDecorations(e,l.key,IB(u));{const f=new Array(4*u.length);for(let p=0,g=u.length;p<g;p++){const v=u[p];f[4*p]=v.start.line+1,f[4*p+1]=v.start.character+1,f[4*p+2]=v.end.line+1,f[4*p+3]=v.end.character+1}return t.$trySetDecorationsFast(e,l.key,f)}}))},revealRange(l,u){c.o(()=>t.$tryRevealRange(e,U.from(l),u||jp.Default))},show(l){t.$tryShowEditor(e,Kt.from(l))},hide(){t.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){ki(!this.g),this.g=!0}_acceptOptions(e){ki(!this.g),this.d._accept(e)}_acceptVisibleRanges(e){ki(!this.g),this.e=e}_acceptViewColumn(e){ki(!this.g),this.f=e}_acceptSelections(e){ki(!this.g),this.c=e}_acceptDiffInformation(e){ki(!this.g),this.j=e}async m(){const e=this.c.map(or.from);return await this.o(()=>this.k.$trySetSelections(this.id,e)),this.value}n(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(r=>r.range);i.sort((r,n)=>r.end.line===n.end.line?r.end.character===n.end.character?r.start.line===n.start.line?r.start.character-n.start.character:r.start.line-n.start.line:r.end.character-n.end.character:r.end.line-n.end.line);for(let r=0,n=i.length-1;r<n;r++){const o=i[r].end;if(i[r+1].start.isBefore(o))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const s=t.edits.map(r=>({range:U.from(r.range),text:r.text,forceMoveMarkers:r.forceMoveMarkers}));return this.k.$tryApplyEdits(this.id,t.documentVersionId,s,{setEndOfLine:typeof t.setEndOfLine=="number"?hl.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}o(e){return this.g?(this.l.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this.l.warn(t),null))}},iq=class{constructor(e){this.value=e,this.a=0}ref(){this.a++}unref(){return--this.a===0}},s4=class{constructor(t,i){this.h=t,this.i=i,this.a=null,this.b=new Map,this.c=new kt,this.d=new I,this.e=new I,this.f=new I,this.g=new I,this.onDidAddDocuments=this.d.event,this.onDidRemoveDocuments=this.e.event,this.onDidChangeVisibleTextEditors=this.f.event,this.onDidChangeActiveTextEditor=this.g.event}$acceptDocumentsAndEditorsDelta(t){this.acceptDocumentsAndEditorsDelta(t)}acceptDocumentsAndEditorsDelta(t){const i=[],s=[],r=[];if(t.removedDocuments)for(const n of t.removedDocuments){const o=y.revive(n),a=this.c.get(o);a?.unref()&&(this.c.delete(o),i.push(a.value))}if(t.addedDocuments)for(const n of t.addedDocuments){const o=y.revive(n.uri);let a=this.c.get(o);if(a&&o.scheme!==V.vscodeNotebookCell&&o.scheme!==V.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new iq(new QV(this.h.getProxy(Y.MainThreadDocuments),o,n.lines,n.EOL,n.versionId,n.languageId,n.isDirty,n.encoding)),this.c.set(o,a),s.push(a.value)),a.ref()}if(t.removedEditors)for(const n of t.removedEditors){const o=this.b.get(n);this.b.delete(n),o&&r.push(o)}if(t.addedEditors)for(const n of t.addedEditors){const o=y.revive(n.documentUri);ki(this.c.has(o),`document '${o}' does not exist`),ki(!this.b.has(n.id),`editor '${n.id}' already exists!`);const a=this.c.get(o).value,c=new tq(n.id,this.h.getProxy(Y.MainThreadTextEditors),this.i,new Tt(()=>a.document),n.selections.map(or.to),n.options,n.visibleRanges.map(l=>U.to(l)),typeof n.editorPosition=="number"?Kt.to(n.editorPosition):void 0);this.b.set(n.id,c)}t.newActiveEditor!==void 0&&(ki(t.newActiveEditor===null||this.b.has(t.newActiveEditor),`active editor '${t.newActiveEditor}' does not exist`),this.a=t.newActiveEditor),Zi(i),Zi(r),t.removedDocuments&&this.e.fire(i),t.addedDocuments&&this.d.fire(s),(t.removedEditors||t.addedEditors)&&this.f.fire(this.allEditors().map(n=>n.value)),t.newActiveEditor!==void 0&&this.g.fire(this.activeEditor())}getDocument(t){return this.c.get(t)?.value}allDocuments(){return Bt.map(this.c.values(),t=>t.value)}getEditor(t){return this.b.get(t)}activeEditor(t){if(!this.a)return;const i=this.b.get(this.a);return t?i:i?.value}allEditors(){return[...this.b.values()]}};s4=__decorate([__param(0,ke),__param(1,Se)],s4);var Ha=H("IExtHostDocumentsAndEditors"),sd=H("productService"),sq="vscode://schemas/vscode-product",rq={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiSettingsSearch:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authIssuers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authIssuers.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authProviderSpecific:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authProviderSpecific.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},authenticationChallenges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authenticationChallenges.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatContextProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatContextProvider.d.ts"},chatEditing:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatEditing.d.ts"},chatOutputRenderer:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatOutputRenderer.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:11},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts",version:4},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatSessionsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatSessionsProvider.d.ts",version:3},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribLanguageModelToolSets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLanguageModelToolSets.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlArtifactGroupMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactGroupMenu.d.ts"},contribSourceControlArtifactMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},dataChannels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.dataChannels.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:4},devDeviceId:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.devDeviceId.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelProxy:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelProxy.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageModelThinkingPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelThinkingPart.d.ts",version:1},languageModelToolResultAudience:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolResultAudience.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},markdownAlertSyntax:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.markdownAlertSyntax.d.ts"},mcpToolDefinitions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpToolDefinitions.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},remoteCodingAgents:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.remoteCodingAgents.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmArtifactProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmArtifactProvider.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmProviderOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmProviderOptions.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskExecutionTerminal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskExecutionTerminal.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textDocumentChangeReason:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textDocumentChangeReason.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},toolProgress:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts"},treeItemMarkdownLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeItemMarkdownLabel.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},Rm=Object.freeze(rq),r4=Qt.as(pp.JSONContribution),nq=class cv{static a(t){const i=new Ko;for(let s=0,r=t.length;s<r;s++)i.add(t[s].description.identifier);return i}static compute(t,i){if(!t||!t.length)return new cv(i,[]);if(!i||!i.length)return new cv([],t);const s=this.a(t),r=this.a(i),n=i.filter(a=>!s.has(a.description.identifier)),o=t.filter(a=>!r.has(a.description.identifier));return new cv(n,o)}constructor(t,i){this.added=t,this.removed=i}},oq=class{constructor(e,t,i){this.name=e,this.defaultExtensionKind=t,this.canHandleResolver=i,this.a=null,this.b=null,this.c=null}setHandler(e){if(this.a!==null)throw new Error("Handler already set!");return this.a=e,this.d(),{dispose:()=>{this.a=null}}}acceptUsers(e){this.c=nq.compute(this.b,e),this.b=e,this.d()}d(){if(!(this.a===null||this.b===null||this.c===null))try{this.a(this.b,this.c)}catch(e){lt(e)}}},aq={type:"string",enum:["ui","workspace"],enumDescriptions:[d(15504,null),d(15505,null)]},F9="vscode://schemas/vscode-extensions",n4={properties:{engines:{type:"object",description:d(15506,null),properties:{vscode:{type:"string",description:d(15507,null),default:"^1.22.0"}}},publisher:{description:d(15508,null),type:"string"},displayName:{description:d(15509,null),type:"string"},categories:{description:d(15510,null),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:XC},{type:"string",const:"Languages",deprecationMessage:d(15511,null)}]}},galleryBanner:{type:"object",description:d(15512,null),properties:{color:{description:d(15513,null),type:"string"},theme:{description:d(15514,null),type:"string",enum:["dark","light"]}}},contributes:{description:d(15515,null),type:"object",properties:{},default:{}},preview:{type:"boolean",description:d(15516,null)},enableProposedApi:{type:"boolean",deprecationMessage:d(15517,null)},enabledApiProposals:{markdownDescription:d(15518,null),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Rm).map(e=>e),markdownEnumDescriptions:Object.values(Rm).map(e=>e.proposal)}},api:{markdownDescription:d(15519,null),type:"string",enum:["none"],enumDescriptions:[d(15520,null)]},activationEvents:{description:d(15521,null),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:d(15522,null),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:d(15523,null),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:d(15524,null),body:"onCommand:${2:commandId}"},{label:"onDebug",description:d(15525,null),body:"onDebug"},{label:"onDebugInitialConfigurations",description:d(15526,null),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:d(15527,null),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:d(15528,null),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:d(15529,null),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:d(15530,null),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:d(15531,null),body:"onStartupFinished"},{label:"onTaskType",description:d(15532,null),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:d(15533,null),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:d(15534,null),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:d(15535,null),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:d(15536,null)},{label:"onUri",body:"onUri",description:d(15537,null)},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:d(15538,null)},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:d(15539,null)},{label:"onNotebook",body:"onNotebook:${1:type}",description:d(15540,null)},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:d(15541,null)},{label:"onRenderer",description:d(15542,null),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:d(15543,null)},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:d(15544,null)},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:d(15545,null)},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:d(15546,null)},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:d(15547,null)},{label:"onLanguageModelChatProvider",body:"onLanguageModelChatProvider:${1:vendor}",description:d(15548,null)},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:d(15549,null)},{label:"onTerminal",body:"onTerminal:{1:shellType}",description:d(15550,null)},{label:"onTerminalShellIntegration",body:"onTerminalShellIntegration:${1:shellType}",description:d(15551,null)},{label:"onMcpCollection",description:d(15552,null),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:d(15553,null),body:"*"}]}},badges:{type:"array",description:d(15554,null),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:d(15555,null)},href:{type:"string",description:d(15556,null)},description:{type:"string",description:d(15557,null)}}}},markdown:{type:"string",description:d(15558,null),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:d(15559,null),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:d(15560,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:Lw}},extensionPack:{description:d(15561,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:Lw}},extensionKind:{description:d(15562,null),type:"array",items:aq,default:["workspace"],defaultSnippets:[{body:["ui"],description:d(15563,null)},{body:["workspace"],description:d(15564,null)},{body:["ui","workspace"],description:d(15565,null)},{body:["workspace","ui"],description:d(15566,null)},{body:[],description:d(15567,null)}]},capabilities:{description:d(15568,null),type:"object",properties:{virtualWorkspaces:{description:d(15569,null),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:d(15570,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[d(15571,null),d(15572,null),d(15573,null)]},description:{type:"string",markdownDescription:d(15574,null)}}},untrustedWorkspaces:{description:d(15575,null),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:d(15576,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[d(15577,null),d(15578,null),d(15579,null)]},restrictedConfigurations:{description:d(15580,null),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:d(15581,null)}}}}},sponsor:{description:d(15582,null),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:d(15583,null),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:d(15584,null),type:"string"},"vscode:uninstall":{description:d(15585,null),type:"string"}}},icon:{type:"string",description:d(15586,null)},l10n:{type:"string",description:d(15587,null)},pricing:{type:"string",markdownDescription:d(15588,null),enum:["Free","Trial"],default:"Free"}}},cq=class{constructor(){this.a=new Map}registerExtensionPoint(e){if(this.a.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new oq(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);return this.a.set(e.extensionPoint,t),e.activationEventsGenerator&&WW.register(e.extensionPoint,e.activationEventsGenerator),n4.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,r4.registerSchema(F9,n4),t}getExtensionPoints(){return Array.from(this.a.values())}},U9={ExtensionsRegistry:"ExtensionsRegistry"};Qt.add(U9.ExtensionsRegistry,new cq);var j9=Qt.as(U9.ExtensionsRegistry);r4.registerSchema(F9,n4),r4.registerSchema(sq,{properties:{extensionEnabledApiProposals:{description:d(15589,null),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Rm),markdownEnumDescriptions:Object.values(Rm).map(e=>e.proposal)}}]}}}});var lq={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:d(12626,null)},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:d(12627,null),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:d(12628,null),default:""}}},o4;(function(e){function t(i,s,r){if(!i)return;const n=Oe(i.type)?i.type:void 0;if(!n||n.length===0){r.error(d(12629,null));return}const o=[];if(Array.isArray(i.required))for(const a of i.required)Oe(a)&&o.push(a);return{extensionId:s.value,taskType:n,required:o,properties:i.properties?ot(i.properties):{},when:i.when?Mt.deserialize(i.when):void 0}}e.from=t})(o4||(o4={}));var uq=j9.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:function*(e){for(const t of e)t.type&&(yield`onTaskType:${t.type}`)},jsonSchema:{description:d(12630,null),type:"array",items:lq}}),hq=class{constructor(){this.d=new I,this.onDefinitionsChanged=this.d.event,this.a=Object.create(null),this.b=new Promise((e,t)=>{uq.setHandler((i,s)=>{this.c=void 0;try{for(const r of s.removed){const n=r.value;for(const o of n)this.a&&o.type&&this.a[o.type]&&delete this.a[o.type]}for(const r of s.added){const n=r.value;for(const o of n){const a=o4.from(o,r.description.identifier,r.collector);a&&(this.a[a.taskType]=a)}}(s.removed.length>0||s.added.length>0)&&this.d.fire()}catch{}e(void 0)})})}onReady(){return this.b}get(e){return this.a[e]}all(){return Object.keys(this.a).map(e=>this.a[e])}getJsonSchema(){if(this.c===void 0){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),t.properties!==void 0?i.properties=ot(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this.c={oneOf:e}}return this.c}},dq=new hq,fq={IconContribution:"base.contributions.icons"},z9;(function(e){function t(i,s){let r=i.defaults;for(;Dt.isThemeIcon(r);){const n=Pl.getIcon(r.id);if(!n)return;r=n.defaults}return r}e.getDefinition=t})(z9||(z9={}));var H9;(function(e){function t(s){return{weight:s.weight,style:s.style,src:s.src.map(r=>({format:r.format,location:r.location.toString()}))}}e.toJSONObject=t;function i(s){const r=n=>Oe(n)?n:void 0;if(s&&Array.isArray(s.src)&&s.src.every(n=>Oe(n.format)&&Oe(n.location)))return{weight:r(s.weight),style:r(s.style),src:s.src.map(n=>({format:n.format,location:y.parse(n.location)}))}}e.fromJSONObject=i})(H9||(H9={}));var pq=/^([\w_-]+)$/,gq=d(2634,null),mq=class extends Z{constructor(){super(),this.a=this.D(new I),this.onDidChange=this.a.event,this.f={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:d(2635,null),pattern:pq.source,patternErrorMessage:gq},fontCharacter:{type:"string",description:d(2636,null)}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.g={type:"string",pattern:`^${Dt.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.b={},this.h={}}registerIcon(e,t,i,s){const r=this.b[e];if(r){if(i&&!r.description){r.description=i,this.f.properties[e].markdownDescription=`${i} $(${e})`;const a=this.g.enum.indexOf(e);a!==-1&&(this.g.enumDescriptions[a]=i),this.a.fire()}return r}const n={id:e,description:i,defaults:t,deprecationMessage:s};this.b[e]=n;const o={$ref:"#/definitions/icons"};return s&&(o.deprecationMessage=s),i&&(o.markdownDescription=`${i}: $(${e})`),this.f.properties[e]=o,this.g.enum.push(e),this.g.enumDescriptions.push(i||""),this.a.fire(),{id:e}}deregisterIcon(e){delete this.b[e],delete this.f.properties[e];const t=this.g.enum.indexOf(e);t!==-1&&(this.g.enum.splice(t,1),this.g.enumDescriptions.splice(t,1)),this.a.fire()}getIcons(){return Object.keys(this.b).map(e=>this.b[e])}getIcon(e){return this.b[e]}getIconSchema(){return this.f}getIconReferenceSchema(){return this.g}registerIconFont(e,t){const i=this.h[e];return i||(this.h[e]=t,this.a.fire(),t)}deregisterIconFont(e){delete this.h[e]}getIconFont(e){return this.h[e]}toString(){const e=(r,n)=>r.id.localeCompare(n.id),t=r=>{for(;Dt.isThemeIcon(r.defaults);)r=this.b[r.defaults.id];return`codicon codicon-${r?r.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const s=Object.keys(this.b).map(r=>this.b[r]);for(const r of s.filter(n=>!!n.description).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|${Dt.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const r of s.filter(n=>!Dt.isThemeIcon(n.defaults)).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|`);return i.join(`
`)}},Pl=new mq;Qt.add(fq.IconContribution,Pl);function rd(e,t,i,s){return Pl.registerIcon(e,t,i,s)}function vq(){const e=Rj();for(const t in e){const i="\\"+e[t].toString(16);Pl.registerIcon(t,{fontCharacter:i})}}vq();var W9="vscode://schemas/icons",B9=Qt.as(pp.JSONContribution);B9.registerSchema(W9,Pl.getIconSchema());var _9=new br(()=>B9.notifySchemaChanged(W9),200);Pl.onDidChange(()=>{_9.isScheduled()||_9.schedule()});var ine=rd("widget-close",oe.close,d(2637,null)),sne=rd("goto-previous-location",oe.arrowUp,d(2638,null)),rne=rd("goto-next-location",oe.arrowDown,d(2639,null)),nne=Dt.modify(oe.sync,"spin"),one=Dt.modify(oe.loading,"spin"),wq="settings",ane=new C("taskRunning",!1,d(12631,null)),cne=new C("taskTerminalActive",!1,d(12632,null)),lne=sf(12635,"Tasks"),Om;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(Om||(Om={})),function(e){function t(i){if(!i)return e.Strong;switch(i.toLowerCase()){case"escape":return e.Escape;case"strong":return e.Strong;case"weak":return e.Weak;default:return e.Strong}}e.from=t}(Om||(Om={}));var V9;(function(e){e.defaults={cwd:"${workspaceFolder}"}})(V9||(V9={}));var nd;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(nd||(nd={})),function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"silent":return e.Silent;case"never":return e.Never;default:return e.Always}}e.fromString=t}(nd||(nd={}));var od;(function(e){e[e.Never=1]="Never",e[e.OnProblem=2]="OnProblem",e[e.Always=3]="Always"})(od||(od={})),function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"never":return e.Never;case"onproblem":return e.OnProblem;default:return e.OnProblem}}e.fromString=t}(od||(od={}));var ad;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(ad||(ad={})),function(e){function t(i){switch(i.toLowerCase()){case"shared":return e.Shared;case"dedicated":return e.Dedicated;case"new":return e.New;default:return e.Shared}}e.fromString=t}(ad||(ad={}));var q9;(function(e){e.defaults={echo:!0,reveal:nd.Always,revealProblems:od.Never,focus:!1,panel:ad.Shared,showReuseMessage:!0,clear:!1,preserveTerminalName:!1}})(q9||(q9={}));var Fm;(function(e){e[e.Shell=1]="Shell",e[e.Process=2]="Process",e[e.CustomExecution=3]="CustomExecution"})(Fm||(Fm={})),function(e){function t(s){switch(s.toLowerCase()){case"shell":return e.Shell;case"process":return e.Process;case"customExecution":return e.CustomExecution;default:return e.Process}}e.fromString=t;function i(s){switch(s){case e.Shell:return"shell";case e.Process:return"process";case e.CustomExecution:return"customExecution";default:return"process"}}e.toString=i}(Fm||(Fm={}));var G9;(function(e){function t(i){return Oe(i)?i:i.value}e.value=t})(G9||(G9={}));var J9;(function(e){e.Clean={_id:"clean",isDefault:!1},e.Build={_id:"build",isDefault:!1},e.Rebuild={_id:"rebuild",isDefault:!1},e.Test={_id:"test",isDefault:!1};function t(s){return s===e.Clean._id||s===e.Build._id||s===e.Rebuild._id||s===e.Test._id}e.is=t;function i(s){if(s!==void 0)return Oe(s)?t(s)?{_id:s,isDefault:!1}:void 0:s}e.from=i})(J9||(J9={}));var Z9;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.Folder=3]="Folder"})(Z9||(Z9={}));var Q9;(function(e){e.Workspace="workspace",e.Extension="extension",e.InMemory="inMemory",e.WorkspaceFile="workspaceFile",e.User="user";function t(i){switch(i){case e.User:return 2;case e.WorkspaceFile:return 5;default:return 6}}e.toConfigurationTarget=t})(Q9||(Q9={}));var Y9;(function(e){e.parallel="parallel",e.sequence="sequence"})(Y9||(Y9={}));var a4;(function(e){e[e.default=1]="default",e[e.folderOpen=2]="folderOpen"})(a4||(a4={}));var X9;(function(e){e.terminateNewest="terminateNewest",e.terminateOldest="terminateOldest",e.prompt="prompt",e.warn="warn",e.silent="silent"})(X9||(X9={}));var K9;(function(e){e.defaults={reevaluateOnRerun:!0,runOn:a4.default,instanceLimit:1,instancePolicy:"prompt"}})(K9||(K9={}));var Um;(function(e){e[e.Process=1]="Process",e[e.Terminal=2]="Terminal"})(Um||(Um={})),function(e){e._default=e.Terminal}(Um||(Um={}));var e8;(function(e){e[e.V0_1_0=1]="V0_1_0",e[e.V2_0_0=2]="V2_0_0"})(e8||(e8={}));var t8;(function(e){e.SingleRun="singleRun",e.Background="background"})(t8||(t8={}));var wn;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(wn||(wn={}));var i8;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.FolderOpen=2]="FolderOpen",e[e.ConfigurationChange=3]="ConfigurationChange",e[e.Reconnect=4]="Reconnect",e[e.ChatAgent=5]="ChatAgent"})(i8||(i8={}));var s8;(function(e){function t(u){return{taskId:u._id,taskName:u.configurationProperties.name,runType:u.configurationProperties.isBackground?"background":"singleRun",group:u.configurationProperties.group,__task:u}}function i(u,h,f){return{...t(u),kind:wn.Start,terminalId:h,resolvedVariables:f}}e.start=i;function s(u,h,f){return{...t(u),kind:wn.ProcessStarted,terminalId:h,processId:f}}e.processStarted=s;function r(u,h,f,p){return{...t(u),kind:wn.ProcessEnded,terminalId:h,exitCode:f,durationMs:p}}e.processEnded=r;function n(u,h,f){return{...t(u),kind:wn.Inactive,terminalId:h,durationMs:f}}e.inactive=n;function o(u,h,f){return{...t(u),kind:wn.Terminated,exitReason:f,terminalId:h}}e.terminated=o;function a(u,h,f){return{...t(h),kind:u,terminalId:f}}e.general=a;function c(u,h,f){return{...t(u),kind:wn.ProblemMatcherEnded,hasErrors:h}}e.problemMatcherEnded=c;function l(){return{kind:wn.Changed}}e.changed=l})(s8||(s8={}));var jm;(function(e){function t(s){const r=Object.keys(s).sort();let n="";for(const o of r){let a=s[o];a instanceof Object?a=t(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),n+=o+","+a+","}return n}function i(s){const n={_key:t(s),type:s.taskType};return Object.assign(n,s),n}e.create=i})(jm||(jm={}));var r8;(function(e){e.AutoDetect="task.autoDetect",e.SaveBeforeRun="task.saveBeforeRun",e.ShowDecorations="task.showDecorations",e.ProblemMatchersNeverPrompt="task.problemMatchers.neverPrompt",e.SlowProviderWarning="task.slowProviderWarning",e.QuickOpenHistory="task.quickOpen.history",e.QuickOpenDetail="task.quickOpen.detail",e.QuickOpenSkip="task.quickOpen.skip",e.QuickOpenShowAll="task.quickOpen.showAll",e.AllowAutomaticTasks="task.allowAutomaticTasks",e.Reconnection="task.reconnection",e.VerboseLogging="task.verboseLogging",e.NotifyWindowOnTaskCompletion="task.notifyWindowOnTaskCompletion"})(r8||(r8={}));var n8;(function(e){e.Tasks="tasks",e.SuppressTaskName="tasks.suppressTaskName",e.Windows="tasks.windows",e.Osx="tasks.osx",e.Linux="tasks.linux",e.ShowOutput="tasks.showOutput",e.IsShellCommand="tasks.isShellCommand",e.ServiceTestSetting="tasks.service.testSetting"})(n8||(n8={}));var o8;(function(e){function t(i,s){const r=dq.get(i.type);if(r===void 0){const c=ot(i);return delete c._key,jm.create(c)}const n=Object.create(null);n.type=r.taskType;const o=new Set;r.required.forEach(c=>o.add(c));const a=r.properties;for(const c of Object.keys(a)){const l=i[c];if(l!=null)n[c]=l;else if(o.has(c)){const u=a[c];if(u.default!==void 0)n[c]=ot(u.default);else switch(u.type){case"boolean":n[c]=!1;break;case"number":case"integer":n[c]=0;break;case"string":n[c]="";break;default:s.error(d(12633,null,JSON.stringify(i,void 0,0),c));return}}}return jm.create(n)}e.createTaskIdentifier=t})(o8||(o8={}));var une=rd("rerun-task",oe.refresh,d(12634,null)),zm;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(zm||(zm={}));var Hm;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(Hm||(Hm={}));var c4;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(c4||(c4={}));var cd;(function(e){function t(r){if(r){const n=r;return n&&!!n.process}else return!1}e.is=t;function i(r){if(r==null)return;const n={process:r.process,args:r.args};return r.options&&(n.options=c4.from(r.options)),n}e.from=i;function s(r){if(r!=null)return new qc(r.process,r.args,r.options)}e.to=s})(cd||(cd={}));var l4;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(l4||(l4={}));var ld;(function(e){function t(r){if(r){const n=r;return n&&(!!n.commandLine||!!n.command)}else return!1}e.is=t;function i(r){if(r==null)return;const n={};return r.commandLine!==void 0?n.commandLine=r.commandLine:(n.command=r.command,n.args=r.args),r.options&&(n.options=l4.from(r.options)),n}e.from=i;function s(r){if(!(r==null||r.command===void 0&&r.commandLine===void 0))return r.commandLine?new Aa(r.commandLine,r.options):new Aa(r.command,r.args?r.args:[],r.options)}e.to=s})(ld||(ld={}));var lr;(function(e){function t(r){if(r){const n=r;return n&&n.customExecution==="customExecution"}else return!1}e.is=t;function i(r){return{customExecution:"customExecution"}}e.from=i;function s(r,n){return n.get(r)}e.to=s})(lr||(lr={}));var u4;(function(e){function t(i,s){let r;return i.scope!==void 0&&typeof i.scope!="number"?r=i.scope.uri:i.scope!==void 0&&typeof i.scope=="number"&&(i.scope===ho.Workspace&&s&&s.workspaceFile?r=s.workspaceFile:r=wq),{id:i._id,workspaceFolder:r}}e.from=t})(u4||(u4={}));var h4;(function(e){function t(i){if(i!=null)return{_id:i.id,isDefault:i.isDefault}}e.from=t})(h4||(h4={}));var Ur;(function(e){function t(r,n){if(r==null)return[];const o=[];for(const a of r){const c=i(a,n);c&&o.push(c)}return o}e.fromMany=t;function i(r,n){if(r==null)return;let o;r.execution instanceof qc?o=cd.from(r.execution):r.execution instanceof Aa?o=ld.from(r.execution):r.execution&&r.execution instanceof lb&&(o=lr.from(r.execution));const a=zm.from(r.definition);let c;return r.scope?typeof r.scope=="number"?c=r.scope:c=r.scope.uri:c=ho.Workspace,!a||!c?void 0:{_id:r._id,definition:a,name:r.name,source:{extensionId:n.identifier.value,label:r.source,scope:c},execution:o,isBackground:r.isBackground,group:h4.from(r.group),presentationOptions:Hm.from(r.presentationOptions),problemMatchers:xs(r.problemMatchers),hasDefinedMatchers:r.hasDefinedMatchers,runOptions:r.runOptions?r.runOptions:{reevaluateOnRerun:!0},detail:r.detail}}e.from=i;async function s(r,n,o){if(r==null)return;let a;cd.is(r.execution)?a=cd.to(r.execution):ld.is(r.execution)?a=ld.to(r.execution):lr.is(r.execution)&&(a=lr.to(r._id,o));const c=zm.to(r.definition);let l;if(r.source&&(r.source.scope!==void 0?typeof r.source.scope=="number"?l=r.source.scope:l=await n.resolveWorkspaceFolder(y.revive(r.source.scope)):l=ho.Workspace),!c||!l)return;const u=new Bp(c,l,r.name,r.source.label,a,r.problemMatchers);return r.isBackground!==void 0&&(u.isBackground=r.isBackground),r.group!==void 0&&(u.group=ah.from(r.group._id),u.group&&r.group.isDefault&&(u.group=new ah(u.group.id,u.group.label),r.group.isDefault===!0&&(u.group.isDefault=r.group.isDefault))),r.presentationOptions&&(u.presentationOptions=Hm.to(r.presentationOptions)),r._id&&(u._id=r._id),r.detail&&(u.detail=r.detail),u}e.to=s})(Ur||(Ur={}));var d4;(function(e){function t(s){return s}e.from=t;function i(s){if(s)return Object.assign(Object.create(null),s)}e.to=i})(d4||(d4={}));var f4=class{#e;constructor(e,t,i){this._id=t,this.b=i,this.#e=e}get task(){return this.b}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}get terminal(){return this.a}set terminal(e){this.a=e}},Wm=class{constructor(t,i,s,r,n,o,a,c){this.q=new I,this.r=new I,this.s=new I,this.u=new I,this.v=new I,this.w=new I,this.a=t.getProxy(Y.MainThreadTask),this.b=s,this.c=r,this.d=n,this.e=o,this.h=0,this.j=new Map,this.k=new Map,this.l=new Map,this.m=new Map,this.n=new Set,this.o=new Map,this.f=a,this.g=c,this.a.$registerSupportedExecutions(!0)}registerTaskProvider(t,i,s){if(!s)return new Ce(()=>{});const r=this.z();return this.j.set(r,{type:i,provider:s,extension:t}),this.a.$registerTaskProvider(r,i),new Ce(()=>{this.j.delete(r),this.a.$unregisterTaskProvider(r)})}registerTaskSystem(t,i){this.a.$registerTaskSystem(t,i)}fetchTasks(t){return this.a.$fetchTasks(d4.from(t)).then(async i=>{const s=[];for(const r of i){const n=await Ur.to(r,this.b,this.m);n&&s.push(n)}return s})}get taskExecutions(){const t=[];return this.k.forEach(i=>t.push(i)),t}terminateTask(t){if(!(t instanceof f4))throw new Error("No valid task execution provided");return this.a.$terminateTask(t._id)}get onDidStartTask(){return this.q.event}async $onDidStartTask(t,i,s){const r=this.m.get(t.id);r&&(this.o.set(t.id,r),this.e.attachPtyToTerminal(i,await r.callback(s))),this.p=t.id;const n=await this.B(t),o=this.e.getTerminalById(i)?.value;n&&(n.terminal=o),this.q.fire({execution:n})}get onDidEndTask(){return this.r.event}async $OnDidEndTask(t){if(!this.l.has(t.id))return;const i=await this.B(t);this.l.delete(t.id),this.k.delete(t.id),this.D(t),this.r.fire({execution:i})}get onDidStartTaskProcess(){return this.s.event}async $onDidStartTaskProcess(t){const i=await this.B(t.id);this.s.fire({execution:i,processId:t.processId})}get onDidEndTaskProcess(){return this.u.event}async $onDidEndTaskProcess(t){const i=await this.B(t.id);this.u.fire({execution:i,exitCode:t.exitCode})}get onDidStartTaskProblemMatchers(){return this.v.event}async $onDidStartTaskProblemMatchers(t){let i;try{i=await this.B(t.execution.id)}catch{return}this.v.fire({execution:i})}get onDidEndTaskProblemMatchers(){return this.w.event}async $onDidEndTaskProblemMatchers(t){let i;try{i=await this.B(t.execution.id)}catch{return}this.w.fire({execution:i,hasErrors:t.hasErrors})}$provideTasks(t,i){const s=this.j.get(t);if(!s)return Promise.reject(new Error("no handler found"));const r=[],n=fi(()=>s.provider.provideTasks(Fe.None)).then(o=>this.x(i,r,s,o));return new Promise(o=>{n.then(a=>{Promise.all(r).then(()=>{o(a)})})})}async $resolveTask(t,i){const s=this.j.get(t);if(!s)return Promise.reject(new Error("no handler found"));if(i.definition.type!==s.type)throw new Error(`Unexpected: Task of type [${i.definition.type}] cannot be resolved by provider of type [${s.type}].`);const r=await Ur.to(i,this.b,this.m);if(!r)throw new Error("Unexpected: Task cannot be resolved.");const n=await s.provider.resolveTask(r,Fe.None);if(!n)return;this.C(n,s);const o=Ur.from(n,s.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(n.definition!==r.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return lr.is(o.execution)&&await this.A(o,n,!0),await this.y(o)}z(){return this.h++}async A(t,i,s){const r=await this.a.$createTaskId(t);!s&&!this.m.has(r)&&(this.n.add(r),this.o.set(r,i.execution)),this.m.set(r,i.execution)}async B(t,i){if(typeof t=="string"){const n=this.l.get(t);if(!n)throw new _s("Unexpected: The specified task is missing an execution");return n}const s=this.l.get(t.id);if(s)return s;let r;return i?r=Promise.resolve(new f4(this,t.id,i)):r=Ur.to(t.task,this.b,this.m).then(n=>{if(!n)throw new _s("Unexpected: Task does not exist.");return new f4(this,t.id,n)}),this.l.set(t.id,r),r.then(n=>(this.k.set(t.id,n),n))}C(t,i){t._deprecated&&this.g.report("Task.constructor",i.extension,"Use the Task constructor that takes a `scope` instead.")}D(t){this.o.get(t.id)&&this.o.delete(t.id),this.n.has(t.id)&&this.p!==t.id&&(this.m.delete(t.id),this.n.delete(t.id));const s=this.n.values();let r=s.next();for(;!r.done;)!this.o.has(r.value)&&this.p!==r.value&&(this.m.delete(r.value),this.n.delete(r.value)),r=s.next()}};Wm=__decorate([__param(0,ke),__param(1,jt),__param(2,Rs),__param(3,Ha),__param(4,ws),__param(5,mn),__param(6,Se),__param(7,Dl)],Wm);var p4=class extends Wm{constructor(t,i,s,r,n,o,a,c){super(t,i,s,r,n,o,a,c),this.registerTaskSystem(V.vscodeRemote,{scheme:V.vscodeRemote,authority:"",platform:WR(0)})}async executeTask(t,i){if(!i.execution)throw new Error("Tasks to execute must include an execution");const s=Ur.from(i,t);if(s===void 0)throw new Error("Task is not valid");if(lr.is(s.execution))await this.A(s,i,!1);else throw new Sv;const r=await this.B(await this.a.$getTaskExecution(s),i);return this.a.$executeTask(s).catch(n=>{throw new Error(n)}),r}x(t,i,s,r){const n=[];if(r)for(const o of r){if(this.C(o,s),!o.definition||!t[o.definition.type]){const c=o.source?o.source:"No task source";this.f.warn(`The task [${c}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Ur.from(o,s.extension);a&&lr.is(a.execution)?(n.push(a),i.push(this.A(a,o,!0))):this.f.warn("Only custom execution tasks supported.")}return{tasks:n,extension:s.extension}}async y(t){if(lr.is(t.execution))return t;this.f.warn("Only custom execution tasks supported.")}async $resolveVariables(t,i){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(t,i,s){}};p4=__decorate([__param(0,ke),__param(1,jt),__param(2,Rs),__param(3,Ha),__param(4,ws),__param(5,mn),__param(6,Se),__param(7,Dl)],p4);var g4=H("IExtHostTask"),a8=class{constructor(){this.f=new Map,this.m=[],this.n=new I,this.o=new I,this.d=1}get onError(){return this.n.event}get onExit(){return this.o.event}onMessage(e){this.k&&this.n.fire(new Error("attempt to set more than one 'Message' callback")),this.k=e}onEvent(e){this.j&&this.n.fire(new Error("attempt to set more than one 'Event' callback")),this.j=e}onRequest(e){this.g&&this.n.fire(new Error("attempt to set more than one 'Request' callback")),this.g=e}sendResponse(e){e.seq>0?this.n.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.u("response",e)}sendRequest(e,t,i,s){const r={command:e};if(t&&Object.keys(t).length>0&&(r.arguments=t),this.u("request",r),typeof s=="number"){const n=setTimeout(()=>{clearTimeout(n);const o=this.f.get(r.seq);if(o){this.f.delete(r.seq);const a={type:"response",seq:0,request_seq:r.seq,success:!1,command:e,message:d(7737,null,s,e)};o(a)}},s)}return i&&this.f.set(r.seq,i),r.seq}acceptMessage(e){this.k?this.k(e):(this.m.push(e),this.m.length===1&&this.s())}q(e,t){return e.type!=="event"||t.type!=="event"}async s(){let e;for(;this.m.length;){if((!e||this.q(this.m[0],e))&&await ri(0),e=this.m.shift(),!e)return;switch(e.type){case"event":this.j?.(e);break;case"request":this.g?.(e);break;case"response":{const t=e,i=this.f.get(t.request_seq);i&&(this.f.delete(t.request_seq),i(t));break}}}}u(e,t){t.type=e,t.seq=this.d++,this.sendMessage(t)}async w(){if(this.f.size===0)return Promise.resolve();const e=new Map;this.f.forEach((t,i)=>e.set(i,t)),await ri(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.f.delete(i)})}getPendingRequestIds(){return Array.from(this.f.keys())}dispose(){this.m=[]}};function bq(e){return e.type&&(e.label||e.program||e.runtime)}var yq=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function Aq(e){return!!(e&&e.match(yq))}function c8(e){if(typeof e.path=="string"&&!(typeof e.sourceReference=="number"&&e.sourceReference>0)){if(Aq(e.path))return y.parse(e.path);if(ks(e.path))return y.file(e.path)}return e.path}function l8(e){if(typeof e.path=="object"){const t=y.revive(e.path);if(t)return t.scheme===V.file?t.fsPath:t.toString()}return e.path}function Sq(e,t){const i=t?c8:l8,s=ot(e);return u8(s,(r,n)=>{r&&n&&(n.path=i(n))}),s}function Eq(e,t){const i=t?c8:l8,s=ot(e);return u8(s,(r,n)=>{!r&&n&&(n.path=i(n))}),s}function u8(e,t){switch(e.type){case"event":{const i=e;switch(i.event){case"output":t(!1,i.body.source);break;case"loadedSource":t(!1,i.body.source);break;case"breakpoint":t(!1,i.body.breakpoint.source);break;default:break}break}case"request":{const i=e;switch(i.command){case"setBreakpoints":t(!0,i.arguments.source);break;case"breakpointLocations":t(!0,i.arguments.source);break;case"source":t(!0,i.arguments.source);break;case"gotoTargets":t(!0,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(s=>t(!1,s));break;default:break}break}case"response":{const i=e;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(s=>t(!1,s.source));break;case"loadedSources":i.body.sources.forEach(s=>t(!1,s));break;case"scopes":i.body.scopes.forEach(s=>t(!1,s.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(s=>t(!1,s.source));break;case"setBreakpoints":i.body.breakpoints.forEach(s=>t(!1,s.source));break;case"disassemble":i.body?.instructions.forEach(r=>t(!1,r.location));break;case"locations":t(!1,i.body?.source);break;default:break}break}}}var Tl=H("IExtHostEditorTabs"),h8=class{constructor(e,t,i){this.e=i,this.d=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this.a){const e=this,t={get isActive(){return e.b.id===e.e()},get label(){return e.b.label},get input(){return e.c},get isDirty(){return e.b.isDirty},get isPinned(){return e.b.isPinned},get isPreview(){return e.b.isPreview},get group(){return e.d.apiObject}};this.a=Object.freeze(t)}return this.a}get tabId(){return this.b.id}acceptDtoUpdate(e){this.b=e,this.c=this.f()}f(){switch(this.b.input.kind){case 1:return new Db(y.revive(this.b.input.uri));case 2:return new ug(y.revive(this.b.input.original),y.revive(this.b.input.modified));case 3:return new $7(y.revive(this.b.input.base),y.revive(this.b.input.input1),y.revive(this.b.input.input2),y.revive(this.b.input.result));case 6:return new Pb(y.revive(this.b.input.uri),this.b.input.viewType);case 7:return new I7(this.b.input.viewType);case 4:return new Tb(y.revive(this.b.input.uri),this.b.input.notebookType);case 5:return new Nb(y.revive(this.b.input.original),y.revive(this.b.input.modified),this.b.input.notebookType);case 8:return new D7;case 9:return new P7(y.revive(this.b.input.uri),y.revive(this.b.input.inputBoxUri));case 10:return new T7;case 11:return new N7(this.b.input.diffEditors.map(e=>new ug(y.revive(e.original),y.revive(e.modified))));default:return}}},xq=class{constructor(e,t){this.c=[],this.d="",this.b=e,this.e=t;for(const i of e.tabs)i.isActive&&(this.d=i.id),this.c.push(new h8(i,this,()=>this.activeTabId()))}get apiObject(){if(!this.a){const e=this,t={get isActive(){return e.b.groupId===e.e()},get viewColumn(){return Kt.to(e.b.viewColumn)},get activeTab(){return e.c.find(i=>i.tabId===e.d)?.apiObject},get tabs(){return Object.freeze(e.c.map(i=>i.apiObject))}};this.a=Object.freeze(t)}return this.a}get groupId(){return this.b.groupId}get tabs(){return this.c}acceptGroupDtoUpdate(e){this.b=e}acceptTabOperation(e){if(e.kind===0){const i=new h8(e.tabDto,this,()=>this.activeTabId());return this.c.splice(e.index,0,i),e.tabDto.isActive&&(this.d=i.tabId),i}else if(e.kind===1){const i=this.c.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this.d&&(this.d=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this.c.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this.c.splice(e.index,0,i),i}const t=this.c.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this.d=e.tabDto.id:this.d===e.tabDto.id&&!e.tabDto.isActive&&(this.d=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this.d}},m4=class{constructor(t){this.b=new I,this.c=new I,this.e=[],this.a=t.getProxy(Y.MainThreadEditorTabs)}get tabGroups(){if(!this.f){const t=this,i={onDidChangeTabGroups:t.c.event,onDidChangeTabs:t.b.event,get all(){return Object.freeze(t.e.map(s=>s.apiObject))},get activeTabGroup(){const s=t.d;return rc(t.e.find(n=>n.groupId===s)?.apiObject)},close:async(s,r)=>{const n=Array.isArray(s)?s:[s];return n.length?Cq(n[0])?this.j(n,r):this.i(n,r):!0}};this.f=Object.freeze(i)}return this.f}$acceptEditorTabModel(t){const i=new Set(this.e.map(l=>l.groupId)),s=new Set(t.map(l=>l.groupId)),r=_L(i,s),n=this.e.filter(l=>r.removed.includes(l.groupId)).map(l=>l.apiObject),o=[],a=[];this.e=t.map(l=>{const u=new xq(l,()=>this.d);return r.added.includes(u.groupId)?o.push(u.apiObject):a.push(u.apiObject),u});const c=rc(t.find(l=>l.isActive===!0)?.groupId);c!==void 0&&this.d!==c&&(this.d=c),this.c.fire(Object.freeze({opened:o,closed:n,changed:a}))}$acceptTabGroupUpdate(t){const i=this.e.find(s=>s.groupId===t.groupId);if(!i)throw new Error("Update Group IPC call received before group creation.");i.acceptGroupDtoUpdate(t),t.isActive&&(this.d=t.groupId),this.c.fire(Object.freeze({changed:[i.apiObject],opened:[],closed:[]}))}$acceptTabOperation(t){const i=this.e.find(r=>r.groupId===t.groupId);if(!i)throw new Error("Update Tabs IPC call received before group creation.");const s=i.acceptTabOperation(t);switch(t.kind){case 0:this.b.fire(Object.freeze({opened:[s.apiObject],closed:[],changed:[]}));return;case 1:this.b.fire(Object.freeze({opened:[],closed:[s.apiObject],changed:[]}));return;case 3:case 2:this.b.fire(Object.freeze({opened:[],closed:[],changed:[s.apiObject]}));return}}g(t){for(const i of this.e)for(const s of i.tabs)if(s.apiObject===t)return s}h(t){return this.e.find(i=>i.apiObject===t)}async i(t,i){const s=[];for(const r of t){const n=this.g(r);if(!n)throw new Error("Tab close: Invalid tab not found!");s.push(n.tabId)}return this.a.$closeTab(s,i)}async j(t,i){const s=[];for(const r of t){const n=this.h(r);if(!n)throw new Error("Group close: Invalid group not found!");s.push(n.groupId)}return this.a.$closeGroup(s,i)}};m4=__decorate([__param(0,ke)],m4);function Cq(e){return e.tabs!==void 0}var kq=0,d8=new WeakMap,ud=H("IExtHostTesting"),v4=class extends Z{constructor(t,i,s,r){super(),this.z=i,this.C=s,this.F=r,this.f=this.D(new I),this.g=new Map,this.q=this.D(new I),this.w=new Set,this.y=new Map,this.onResultsChanged=this.f.event,this.results=[],this.h=t.getProxy(Y.MainThreadTesting),this.m=new Nq(this.h),this.j=new Dq(this.h,i),s.registerArgumentProcessor({processArgument:n=>{switch(n?.$mid){case 16:{const o=n,a=o.tests[o.tests.length-1].item.extId;return this.g.get(Ve.root(a))?.collection.tree.get(a)?.actual??DD(n)}case 18:{const{test:o,message:a}=n,c=o.item.extId;return{test:this.g.get(Ve.root(c))?.collection.tree.get(c)?.actual??DD({$mid:16,tests:[o]}),message:gl.to(a)}}default:return n}}}),s.registerCommand(!1,"testing.getExplorerSelection",async()=>{const n=await s.executeCommand("_testing.getExplorerSelection"),o=a=>{const c=this.g.get(Ve.root(a));if(c)return Ve.isRoot(a)?c.controller:c.collection.tree.get(a)?.actual};return{include:n?.include.map(o).filter(fs)||[],exclude:n?.exclude.map(o).filter(fs)||[]}})}createTestController(t,i,s,r){if(this.g.has(i))throw new Error(`Attempt to insert a duplicate controller with ID "${i}"`);const n=new ie,o=n.add(new M_(i,s,this.F));o.root.label=s;const a=new Map,c=new Set,l=this.h,u=()=>{let p=0;r&&(p|=2);const g=f.relatedCodeProvider;return g&&(g?.provideRelatedTests&&(p|=8),g?.provideRelatedCode&&(p|=4)),p},h={items:o.root.children,get label(){return s},set label(p){s=p,o.root.label=p,l.$updateController(i,{label:s})},get refreshHandler(){return r},set refreshHandler(p){r=p,l.$updateController(i,{capabilities:u()})},get id(){return i},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){T(t,"testRelatedCode"),f.relatedCodeProvider=p,l.$updateController(i,{capabilities:u()})},createRunProfile:(p,g,v,b,S,E)=>{let k=sn(p);for(;a.has(k);)k++;return new m8(this.h,a,c,this.q.event,i,k,p,g,v,b,S,E)},createTestItem(p,g,v){return new Zh(i,p,g,v)},createTestRun:(p,g,v=!0)=>this.j.createTestRun(t,i,o,p,g,v),invalidateTestResults:p=>{if(p===void 0)this.h.$markTestRetired(void 0);else{const g=p instanceof Array?p:[p];this.h.$markTestRetired(g.map(v=>Ve.fromExtHostTestItem(v,i).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{n.dispose()}},f={controller:h,collection:o,profiles:a,extension:t,activeProfiles:c};return l.$registerTestController(i,s,u()),n.add(te(()=>l.$unregisterTestController(i))),this.g.set(i,f),n.add(te(()=>this.g.delete(i))),n.add(o.onDidGenerateDiff(p=>l.$publishDiff(i,p.map(dp.serialize)))),h}createTestObserver(){return this.m.checkout()}async runTests(t,i=Fe.None){const s=p8(t);if(!s)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const r=this.g.get(s.controllerId);if(!r)throw new Error("Controller not found");await this.h.$runTests({preserveFocus:t.preserveFocus??!0,group:ml.from(s.kind),targets:[{testIds:t.include?.map(n=>Ve.fromExtHostTestItem(n,r.collection.root.id).toString())??[r.collection.root.id],profileId:s.profileId,controllerId:s.controllerId}],exclude:t.exclude?.map(n=>n.id)},i)}registerTestFollowupProvider(t){return this.w.add(t),{dispose:()=>{this.w.delete(t)}}}async $getTestsRelatedToCode(t,i,s){const r=this.F.getDocument(y.revive(t));if(!r)return[];const n=Xe.to(i),o=[];return await Promise.all([...this.g.values()].map(async a=>{let c;try{c=await a.relatedCodeProvider?.provideRelatedTests?.(r.document,n,s)}catch(l){s.isCancellationRequested||this.z.warn(`Error thrown while providing related tests for ${a.controller.label}`,l)}if(c){for(const l of c)o.push(Ve.fromExtHostTestItem(l,a.controller.id).toString());a.collection.flushDiff()}})),o}async $getCodeRelatedToTest(t,i){const s=this.g.get(Ve.root(t));if(!s)return[];const r=s.collection.tree.get(t);return r?(await s.relatedCodeProvider?.provideRelatedCode?.(r.actual,i))?.map(Bi.from)??[]:[]}$syncTests(){for(const{collection:t}of this.g.values())t.flushDiff();return Promise.resolve()}async $getCoverageDetails(t,i,s){return(await this.j.getCoverageDetails(t,i,s))?.map(Mh.fromDetails)}async $disposeRun(t){this.j.disposeTestRun(t)}$configureRunProfile(t,i){this.g.get(t)?.profiles.get(i)?.configureHandler?.()}$setDefaultRunProfiles(t){const i=new Map;for(const[s,r]of Object.entries(t)){const n=this.g.get(s);if(!n)continue;const o=new Map,a=r.filter(l=>!n.activeProfiles.has(l)),c=[...n.activeProfiles].filter(l=>!r.includes(l));for(const l of a)o.set(l,!0),n.activeProfiles.add(l);for(const l of c)o.set(l,!1),n.activeProfiles.delete(l);o.size&&i.set(s,o)}this.q.fire(i)}async $refreshTests(t,i){await this.g.get(t)?.controller.refreshHandler?.(i)}$publishTestResults(t){this.results=Object.freeze(t.map(i=>{const s=Ay.to(i),r=i.tasks.findIndex(n=>n.hasCoverage);return r!==-1&&(s.getDetailedCoverage=(n,o=Fe.None)=>this.h.$getCoverageDetails(i.id,r,n,o).then(a=>a.map(Mh.to))),d8.set(s,i.id),s}).concat(this.results).sort((i,s)=>s.completedAt-i.completedAt).slice(0,32)),this.f.fire()}async $expandTest(t,i){const s=this.g.get(Ve.fromString(t).controllerId)?.collection;s&&(await s.expand(t,i<0?1/0:i),s.flushDiff())}$acceptDiff(t){this.m.applyDiff(t.map(i=>dp.deserialize({asCanonicalUri:s=>s},i)))}async $runControllerTests(t,i){return Promise.all(t.map(s=>this.G(s,!1,i)))}async $startContinuousRun(t,i){const s=new Qe(i),r=await Promise.all(t.map(n=>this.G(n,!0,s.token)));return!i.isCancellationRequested&&!r.some(n=>n.error)&&await new Promise(n=>i.onCancellationRequested(n)),s.dispose(!0),r}async $provideTestFollowups(t,i){const s=this.results.find(o=>d8.get(o)===t.resultId),r=s&&Mq(Ve.fromString(t.extId),s?.results);if(!r)return[];let n=[];return await Promise.all([...this.w].map(async o=>{try{const a=await o.provideFollowup(s,r,t.taskIndex,t.messageIndex,i);a&&(n=n.concat(a))}catch(a){this.z.error("Error thrown while providing followup for test message",a)}})),i.isCancellationRequested?[]:n.map(o=>{const a=kq++;return this.y.set(a,o),{title:o.title,id:a}})}$disposeTestFollowups(t){for(const i of t)this.y.delete(i)}$executeTestFollowup(t){const i=this.y.get(t);return i?this.C.executeCommand(i.command,...i.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(t,i){t===void 0?this.j.cancelAllRuns():this.j.cancelRunById(t,i)}getMetadataForRun(t){for(const i of this.j.trackers){const s=i.getTaskIdForRun(t);if(s)return{taskId:s,runId:i.id}}}async G(t,i,s){const r=this.g.get(t.controllerId);if(!r)return{};const{collection:n,profiles:o,extension:a}=r,c=o.get(t.profileId);if(!c)return{};const l=t.testIds.map(p=>n.tree.get(p)).filter(fs),u=t.excludeExtIds.map(p=>r.collection.tree.get(p)).filter(fs).filter(p=>l.some(g=>g.fullId.compare(p.fullId)===2));if(!l.length)return{};const h=new ng(l.some(p=>p.actual instanceof gA)?void 0:l.map(p=>p.actual),u.map(p=>p.actual),c,i),f=vW(t)&&this.j.prepareForMainThreadTestRun(a,h,g8.fromInternal(t,r.collection),c,s);try{return await c.runHandler(h,s),{}}catch(p){return{error:String(p)}}finally{f&&f.hasRunningTasks&&!s.isCancellationRequested&&await Ie.toPromise(f.onEnd)}}};v4=__decorate([__param(0,ke),__param(1,Se),__param(2,cr),__param(3,Ha)],v4);var $q=1e4,f8;(function(e){e[e.Running=0]="Running",e[e.Cancelling=1]="Cancelling",e[e.Ended=2]="Ended"})(f8||(f8={}));var Iq=class extends Z{get hasRunningTasks(){return this.g>0}get id(){return this.z.id}constructor(e,t,i,s,r,n){super(),this.z=e,this.C=t,this.F=i,this.G=s,this.H=r,this.f=0,this.g=0,this.h=new Map,this.j=new Set,this.q=this.D(new I),this.y=new Map,this.onEnd=this.q.event,this.m=this.D(new Qe(n));const o=this.D(new br(()=>this.I(),$q));this.D(this.m.token.onCancellationRequested(()=>o.schedule()));const a=new I;this.w=a.event,this.D(te(()=>{a.fire(),a.dispose()}))}getTaskIdForRun(e){for(const[t,{run:i}]of this.h)if(i===e)return t}cancel(e){e?this.h.get(e)?.cts.cancel():this.f===0?(this.m.cancel(),this.f=1):this.f===1&&this.I()}async getCoverageDetails(e,t,i){const[,s]=Ve.fromString(e).path,r=this.y.get(e);if(!r)return[];const{report:n,extIds:o}=r,a=this.h.get(s);if(!a)throw new Error("unreachable: run task was not found");let c;if(t&&n instanceof lg){const u=o.indexOf(t);if(u===-1)return[];c=n.includesTests[u]}return await(c?this.G?.loadDetailedCoverageForTest?.(a.run,n,c,i):this.G?.loadDetailedCoverage?.(a.run,n,i))??[]}createRun(e){const t=this.z.id,i=this.z.controllerId,s=Nt(),r=l=>(u,...h)=>{if(o){this.F.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.L(u),l(u,...h)},n=(l,u)=>{const h=u instanceof Array?u.map(gl.from):[gl.from(u)];if(l.uri&&l.range){const f={range:U.from(l.range),uri:l.uri};for(const p of h)p.location=p.location||f}this.C.$appendTestMessagesInRun(t,s,Ve.fromExtHostTestItem(l,i).toString(),h)};let o=!1;const a=this.D(new Qe(this.m.token)),c={isPersisted:this.z.isPersisted,token:a.token,name:e,onDidDispose:this.w,addCoverage:l=>{if(o)return;const u=l instanceof lg?l.includesTests:[];if(u.length)for(const p of u)this.L(p);const h=l.uri.toString(),f=new Ve([t,s,h]).toString();this.y.set(f,{report:l,extIds:u.map(p=>Ve.fromExtHostTestItem(p,i).toString())}),this.C.$appendCoverage(t,s,Mh.fromFile(i,f,l))},enqueued:r(l=>{this.C.$updateTestStateInRun(t,s,Ve.fromExtHostTestItem(l,i).toString(),1)}),skipped:r(l=>{this.C.$updateTestStateInRun(t,s,Ve.fromExtHostTestItem(l,i).toString(),5)}),started:r(l=>{this.C.$updateTestStateInRun(t,s,Ve.fromExtHostTestItem(l,i).toString(),2)}),errored:r((l,u,h)=>{n(l,u),this.C.$updateTestStateInRun(t,s,Ve.fromExtHostTestItem(l,i).toString(),6,h)}),failed:r((l,u,h)=>{n(l,u),this.C.$updateTestStateInRun(t,s,Ve.fromExtHostTestItem(l,i).toString(),4,h)}),passed:r((l,u)=>{this.C.$updateTestStateInRun(t,s,Ve.fromExtHostTestItem(l,this.z.controllerId).toString(),3,u)}),appendOutput:(l,u,h)=>{o||(h&&this.L(h),this.C.$appendOutputToRun(t,s,W.fromString(l),u&&Bi.from(u),h&&Ve.fromExtHostTestItem(h,i).toString()))},end:()=>{o||(o=!0,this.C.$finishedTestRunTask(t,s),--this.g||this.J())}};return this.g++,this.h.set(s,{run:c,cts:a}),this.C.$startedTestRunTask(t,{id:s,ctrlId:this.z.controllerId,name:e||this.H.displayName||this.H.identifier.value,running:!0}),c}I(){for(const{run:e}of this.h.values())e.end()}J(){this.f!==2&&(this.f=2,this.q.fire())}L(e){if(!(e instanceof Zh))throw new Ep(e.id);if(this.j.has(Ve.fromExtHostTestItem(e,this.z.controllerId).toString()))return;const t=[],i=this.z.colllection.root;for(;;){const s=bo.from(e);if(t.unshift(s),this.j.has(s.extId)||(this.j.add(s.extId),e===i))break;e=e.parent||i}this.C.$addTestsToRun(this.z.controllerId,this.z.id,t)}dispose(){this.J(),super.dispose()}},Dq=class{get trackers(){return this.f.values()}constructor(e,t){this.h=e,this.j=t,this.f=new Map,this.g=new Map}getCoverageDetails(e,t,i){const s=Ve.root(e);return this.g.get(s)?.getCoverageDetails(e,t,i)||[]}disposeTestRun(e){this.g.get(e)?.dispose(),this.g.delete(e);for(const[t,{id:i}]of this.f)i===e&&this.f.delete(t)}prepareForMainThreadTestRun(e,t,i,s,r){return this.k(t,i,s,e,r)}cancelRunById(e,t){this.g.get(e)?.cancel(t)}cancelAllRuns(){for(const e of this.f.values())e.cancel()}createTestRun(e,t,i,s,r,n){const o=this.f.get(s);if(o)return o.createRun(r);const a=g8.fromPublic(t,i,s,n),c=p8(s);this.h.$startedExtensionTestRun({controllerId:t,continuous:!!s.continuous,profile:c&&{group:ml.from(c.kind),id:c.profileId},exclude:s.exclude?.map(u=>Ve.fromExtHostTestItem(u,i.root.id).toString())??[],id:a.id,include:s.include?.map(u=>Ve.fromExtHostTestItem(u,i.root.id).toString())??[i.root.id],preserveFocus:s.preserveFocus??!0,persist:n});const l=this.k(s,a,s.profile,e);return Ie.once(l.onEnd)(()=>{this.h.$finishedExtensionTestRun(a.id)}),l.createRun(r)}k(e,t,i,s,r){const n=new Iq(t,this.h,this.j,i,s,r);return this.f.set(e,n),this.g.set(n.id,n),n}},p8=e=>{if(e.profile){if(!(e.profile instanceof m8))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return e.profile}},g8=class j5{static fromPublic(t,i,s,r){return new j5(t,Nt(),r,i)}static fromInternal(t,i){return new j5(t.controllerId,t.runId,!0,i)}constructor(t,i,s,r){this.controllerId=t,this.id=i,this.isPersisted=s,this.colllection=r}},Pq=class{get isEmpty(){return this.f.size===0&&this.h.size===0&&this.g.size===0}constructor(e){this.k=e,this.f=new Set,this.g=new Set,this.h=new Set,this.j=new Set}add(e){this.f.add(e)}update(e){Object.assign(e.revived,bo.toPlain(e.item)),this.f.has(e)||this.g.add(e)}remove(e){if(this.f.delete(e))return;this.g.delete(e);const t=Ve.parentId(e.item.extId);if(t&&this.j.has(t.toString())){this.j.add(e.item.extId);return}this.h.add(e)}getChangeEvent(){const{f:e,g:t,h:i}=this;return{get added(){return[...e].map(s=>s.revived)},get updated(){return[...t].map(s=>s.revived)},get removed(){return[...i].map(s=>s.revived)}}}complete(){this.isEmpty||this.k.fire(this.getChangeEvent())}},Tq=class extends wW{constructor(){super(...arguments),this.z=new I,this.onDidChangeTests=this.z.event}get rootTests(){return this.h}getMirroredTestDataById(e){return this.g.get(e)}getMirroredTestDataByReference(e){return this.g.get(e.id)}y(e,t){return{...e,revived:bo.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}x(){return new Pq(this.z)}},Nq=class{constructor(e){this.g=e}checkout(){this.f||(this.f=this.h());const e=this.f;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:Ev(()=>{--e.observers===0&&(this.g.$unsubscribeFromDiffs(),this.f=void 0)})}}getMirroredTestDataByReference(e){return this.f?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.f?.tests.apply(e)}h(){const e=new Tq({asCanonicalUri:t=>t});return this.g.$subscribeToDiffs(),{observers:0,tests:e}}},hd=(e,t,i,s)=>{i?Object.assign(i,s):t.$updateTestRunConfig(e.controllerId,e.profileId,s)},m8=class extends E7{#e;#t;#i;#s;#n;get label(){return this.g}set label(e){e!==this.g&&(this.g=e,hd(this,this.#e,this.#s,{label:e}))}get supportsContinuousRun(){return this.j}set supportsContinuousRun(e){e!==this.j&&(this.j=e,hd(this,this.#e,this.#s,{supportsContinuousRun:e}))}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#t.add(this.profileId):this.#t.delete(this.profileId),hd(this,this.#e,this.#s,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,hd(this,this.#e,this.#s,{tag:e?ar.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this.f}set configureHandler(e){e!==this.f&&(this.f=e,hd(this,this.#e,this.#s,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return Ie.chain(this.#i,e=>e.map(t=>t.get(this.controllerId)?.get(this.profileId)).filter(fs))}constructor(e,t,i,s,r,n,o,a,c,l=!1,u=void 0,h=!1){super(r,n,a),this.g=o,this.runHandler=c,this._tag=u,this.j=h,this.#e=e,this.#n=t,this.#t=i,this.#i=s,t.set(n,this);const f=ml.from(a);l&&i.add(n),this.#s={profileId:n,controllerId:r,tag:u?ar.namespace(this.controllerId,u.id):null,label:o,group:f,isDefault:l,hasConfigurationHandler:!1,supportsContinuousRun:h},queueMicrotask(()=>{this.#s&&(this.#e.$publishTestRunProfile(this.#s),this.#s=void 0)})}dispose(){this.#n?.delete(this.profileId)&&(this.#n=void 0,this.#e.$removeTestProfile(this.controllerId,this.profileId)),this.#s=void 0}};function Mq(e,t){for(let i=0;i<e.path.length;i++){const s=t.find(r=>r.id===e.path[i]);if(!s)return;if(i===e.path.length-1)return s;t=s.children}}var gne=H("configurationResolverService"),ht;(function(e){e.Unknown="unknown",e.Env="env",e.Config="config",e.Command="command",e.Input="input",e.ExtensionInstallFolder="extensionInstallFolder",e.WorkspaceFolder="workspaceFolder",e.Cwd="cwd",e.WorkspaceFolderBasename="workspaceFolderBasename",e.UserHome="userHome",e.LineNumber="lineNumber",e.ColumnNumber="columnNumber",e.SelectedText="selectedText",e.File="file",e.FileWorkspaceFolder="fileWorkspaceFolder",e.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",e.RelativeFile="relativeFile",e.RelativeFileDirname="relativeFileDirname",e.FileDirname="fileDirname",e.FileExtname="fileExtname",e.FileBasename="fileBasename",e.FileBasenameNoExtension="fileBasenameNoExtension",e.FileDirnameBasename="fileDirnameBasename",e.ExecPath="execPath",e.ExecInstallFolder="execInstallFolder",e.PathSeparator="pathSeparator",e.PathSeparatorAlias="/"})(ht||(ht={}));var Lq=Object.values(ht).filter(e=>typeof e=="string"),Vi=class extends _s{constructor(e,t){super(t),this.variable=e}},v8=class z5{static{this.VARIABLE_LHS="${"}constructor(t){this.a=new Map,this.d=new Set,typeof t=="string"?(this.c=!0,this.b={value:t}):(this.c=!1,this.b=structuredClone(t))}static parse(t){if(t instanceof z5)return t;const i=new z5(t);return i.e(),i.g(i.b),i}e(){const t=this.b,i=ze?"windows":Pt?"osx":$t?"linux":void 0;i&&t&&typeof t=="object"&&t.hasOwnProperty(i)&&Object.keys(t[i]).forEach(s=>t[s]=t[i][s]),delete t.windows,delete t.osx,delete t.linux}f(t,i){if(t[i]!=="$"||t[i+1]!=="{")return;let s=i+2,r=1;for(;s<t.length;){if(t[s]==="{")r++;else if(t[s]==="}"&&(r--,r===0))break;s++}if(r!==0)return;const n=t.slice(i,s+1),o=t.substring(i+2,s),a=o.indexOf(":");return a===-1?{replacement:{id:n,name:o,inner:o},end:s}:{replacement:{id:n,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:s}}g(t){if(!(typeof t!="object"||t===null)){if(Array.isArray(t)){for(let i=0;i<t.length;i++){const s=t[i];typeof s=="string"?this.h(t,i,s):this.g(s)}return}for(const[i,s]of Object.entries(t))this.h(t,i,i,!0),typeof s=="string"?this.h(t,i,s):this.g(s)}}h(t,i,s,r,n){let o=0;for(;o<s.length;){const a=s.indexOf("${",o);if(a===-1)break;const c=this.f(s,a);if(c){if(o=c.end+1,n?.includes(c.replacement.id))continue;const l=this.a.get(c.replacement.id)||{locations:[],replacement:c.replacement},u={object:t,propertyName:i,replaceKeyName:r};l.locations.push(u),this.a.set(c.replacement.id,l),l.resolved?this.j(c.replacement,u,l.resolved,n):this.d.forEach(h=>h(c.replacement))}else o=a+2}}*unresolved(){const t=new Map,i=s=>{t.set(s.id,s)};for(const s of this.a.values())s.resolved===void 0&&t.set(s.replacement.id,s.replacement);for(this.d.add(i);;){const s=Bt.first(t);if(!s)break;const[r,n]=s;yield n,t.delete(r)}this.d.delete(i)}resolved(){return Bt.map(Bt.filter(this.a.values(),t=>!!t.resolved),t=>[t.replacement,t.resolved])}resolve(t,i){typeof i!="object"&&(i={value:String(i)});const s=this.a.get(t.id);if(s&&(s.resolved=i,i.value!==void 0))for(const r of s.locations||Bt.empty())this.j(t,r,i)}j(t,{replaceKeyName:i,propertyName:s,object:r},n,o=[]){if(n.value!==void 0){if(o.push(t.id),i&&typeof s=="string"){const a=r[s],c=s.replaceAll(t.id,n.value);delete r[s],r[c]=a,this.m(r,s,c),this.h(r,c,n.value,!0,o)}else r[s]=r[s].replaceAll(t.id,n.value),this.h(r,s,n.value,!1,o);o.pop()}}m(t,i,s){for(const r of this.a.values())for(const n of r.locations)n.object===t&&n.propertyName===i&&(n.propertyName=s)}toObject(){return this.c?this.b.value:this.b}},Rq=class{constructor(e,t,i,s){this.h=new Map,this.resolvableVariables=new Set(Lq),this.a=e,this.b=t,this.g=i,s&&(this.c=s.then(r=>this.i(r)))}i(e){if(ze){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}async resolveWithEnvironment(e,t,i){const s=v8.parse(i);for(const r of s.unresolved()){const n=await this.l(r,t?.uri,e);n!==void 0&&s.resolve(r,String(n))}return s.toObject()}async resolveAsync(e,t){const i=v8.parse(t);for(const s of i.unresolved()){const r=await this.l(s,e?.uri);r!==void 0&&i.resolve(s,String(r))}return i.toObject()}resolveWithInteractionReplace(e,t){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this.h.has(e))throw new Error("Variable "+e+" is contributed twice.");this.resolvableVariables.add(e),this.h.set(e,t)}j(e){return this.b?this.b.getUriLabel(e,{noPrefix:!0}):e.fsPath}async l(e,t,i,s){const r={env:i!==void 0?this.i(i):await this.c,userHome:i!==void 0?void 0:await this.g},{name:n,arg:o}=e,a=u=>{const h=this.a.getFilePath();if(h)return Yh(h);throw new Vi(u,d(15299,null,e.id))},c=u=>{const h=a(u);if(this.a.getWorkspaceFolderPathForFile){const f=this.a.getWorkspaceFolderPathForFile();if(f)return Yh(f)}throw new Vi(u,d(15300,null,e.id,vt(h)))},l=u=>{if(o){const h=this.a.getFolderUri(o);if(h)return h;throw new Vi(u,d(15301,null,u,o))}if(t)return t;throw this.a.getWorkspaceFolderCount()>1?new Vi(u,d(15302,null,u)):new Vi(u,d(15303,null,u))};switch(n){case"env":if(o){if(r.env){const u=r.env[ze?o.toLowerCase():o];if(Oe(u))return u}return""}throw new Vi(ht.Env,d(15304,null,e.id));case"config":if(o){const u=this.a.getConfigurationValue(t,o);if(Wt(u))throw new Vi(ht.Config,d(15305,null,e.id,o));if(At(u))throw new Vi(ht.Config,d(15306,null,e.id,o));return u}throw new Vi(ht.Config,d(15307,null,e.id));case"command":return this.m(ht.Command,e.id,o,s,"command");case"input":return this.m(ht.Input,e.id,o,s,"input");case"extensionInstallFolder":if(o){const u=await this.a.getExtension(o);if(!u)throw new Vi(ht.ExtensionInstallFolder,d(15308,null,e.id,o));return this.j(u.extensionLocation)}throw new Vi(ht.ExtensionInstallFolder,d(15309,null,e.id));default:switch(n){case"workspaceRoot":case"workspaceFolder":{const u=l(ht.WorkspaceFolder);return u?Yh(this.j(u)):void 0}case"cwd":{if(!t&&!o)return Wo();const u=l(ht.Cwd);return u?Yh(this.j(u)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const u=l(ht.WorkspaceFolderBasename);return u?Yh(vt(this.j(u))):void 0}case"userHome":if(r.userHome)return r.userHome;throw new Vi(ht.UserHome,d(15310,null,e.id));case"lineNumber":{const u=this.a.getLineNumber();if(u)return u;throw new Vi(ht.LineNumber,d(15311,null,e.id))}case"columnNumber":{const u=this.a.getColumnNumber();if(u)return u;throw new Error(d(15312,null,e.id))}case"selectedText":{const u=this.a.getSelectedText();if(u)return u;throw new Vi(ht.SelectedText,d(15313,null,e.id))}case"file":return a(ht.File);case"fileWorkspaceFolder":return c(ht.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return vt(c(ht.FileWorkspaceFolderBasename));case"relativeFile":return t||o?ac(this.j(l(ht.RelativeFile)),a(ht.RelativeFile)):a(ht.RelativeFile);case"relativeFileDirname":{const u=$i(a(ht.RelativeFileDirname));if(t||o){const h=ac(this.j(l(ht.RelativeFileDirname)),u);return h.length===0?".":h}return u}case"fileDirname":return $i(a(ht.FileDirname));case"fileExtname":return cf(a(ht.FileExtname));case"fileBasename":return vt(a(ht.FileBasename));case"fileBasenameNoExtension":{const u=vt(a(ht.FileBasenameNoExtension));return u.slice(0,u.length-cf(u).length)}case"fileDirnameBasename":return vt($i(a(ht.FileDirnameBasename)));case"execPath":{const u=this.a.getExecPath();return u||e.id}case"execInstallFolder":{const u=this.a.getAppRoot();return u||e.id}case"pathSeparator":case"/":return St;default:try{return this.m(ht.Unknown,e.id,o,s,void 0)}catch{return e.id}}}}m(e,t,i,s,r){if(i&&s){const n=r===void 0?s[i]:s[r+":"+i];if(typeof n=="string")return n;throw new Vi(e,d(15314,null,t))}return t}},Wa=H("IExtHostVariableResolverProvider"),Oq=class extends Rq{constructor(e,t,i,s,r,n,o){function a(){if(i){const c=i.activeEditor();if(c)return c.document.uri;const l=s.tabGroups.all.find(u=>u.isActive)?.activeTab;if(l!==void 0){if(l.input instanceof ug||l.input instanceof Nb)return l.input.modified;if(l.input instanceof Db||l.input instanceof Tb||l.input instanceof Pb)return l.input.uri}}}super({getFolderUri:c=>{const l=n.folders.filter(u=>u.name===c);if(l&&l.length>0)return l[0].uri},getWorkspaceFolderCount:()=>n.folders.length,getConfigurationValue:(c,l)=>r.getConfiguration(void 0,c).get(l),getAppRoot:()=>Wo(),getExecPath:()=>On.VSCODE_EXEC_PATH,getFilePath:()=>{const c=a();if(c)return Xr(c.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const c=a();if(c){const l=t.getWorkspaceFolder(c);if(l)return Xr(l.uri.fsPath)}}},getSelectedText:()=>{if(i){const c=i.activeEditor();if(c&&!c.selection.isEmpty)return c.document.getText(c.selection)}},getLineNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.line+1)}},getColumnNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.character+1)}},getExtension:c=>e.getExtension(c)},void 0,o?Promise.resolve(o):void 0,Promise.resolve(On))}},Bm=class extends Z{constructor(t,i,s,r,n){super(),this.b=t,this.c=i,this.g=s,this.h=r,this.j=n,this.a=new Tt(async()=>{const o=await this.h.getConfigProvider(),c={folders:await this.c.getWorkspaceFolders2()||[]};return this.D(this.c.onDidChangeWorkspace(async l=>{c.folders=await this.c.getWorkspaceFolders2()||[]})),new Oq(this.b,this.c,this.g,this.j,o,c,this.m())})}getResolver(){return this.a.value}m(){}};Bm=__decorate([__param(0,vn),__param(1,Rs),__param(2,Ha),__param(3,ws),__param(4,Tl)],Bm);var w4=H("IExtHostDebugService"),_m=class extends Z{get onDidStartDebugSession(){return this.w.event}get onDidTerminateDebugSession(){return this.y.event}get onDidChangeActiveDebugSession(){return this.z.event}get activeDebugSession(){return this.C?.api}get onDidReceiveDebugSessionCustomEvent(){return this.F.event}get activeDebugConsole(){return this.G.value}constructor(t,i,s,r,n,o,a,c){super(),this.Z=i,this.$=s,this.ab=r,this.bb=n,this.cb=o,this.db=a,this.eb=c,this.u=new Map,this.O=0,this.P=new Map,this.Q=new Map,this.R=new WeakMap,this.S=new Map,this.W=new Map,this.X=0,this.f=0,this.g=[],this.h=0,this.j=[],this.m=0,this.n=[],this.M=new Map,this.N=new Map,this.w=this.D(new I),this.y=this.D(new I),this.z=this.D(new I),this.F=this.D(new I),this.q=t.getProxy(Y.MainThreadDebugService),this.I=this.D(new I),this.L=this.D(new I),this.G=new Uq(this.q),this.H=new Map,this.$.getExtensionRegistry().then(l=>{this.D(l.onDidChange(u=>{this.gb(l)})),this.gb(l)}),this.Y=t.getProxy(Y.MainThreadTelemetry)}async $getVisualizerTreeItem(t,i){const s=this.hb(i);if(!s)return;const r=await this.Q.get(t)?.getTreeItem?.(s);return r?this.fb(t,r):void 0}registerDebugVisualizationTree(t,i,s){const r=Ye.toKey(t.identifier),n=this.zb(r,i);if(this.P.has(n))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this.Q.set(n,s),this.q.$registerDebugVisualizerTree(n,!!s.editItem),te(()=>{this.q.$unregisterDebugVisualizerTree(n),this.Q.delete(i)})}async $getVisualizerTreeItemChildren(t,i){const s=this.S.get(i)?.item;return s?(await this.Q.get(t)?.getChildren?.(s))?.map(n=>this.fb(t,n))||[]:[]}async $editVisualizerTreeItem(t,i){const s=this.S.get(t);if(!s)return;const r=await this.Q.get(s.provider)?.editItem?.(s.item,i);return this.fb(s.provider,r||s.item)}$disposeVisualizedTree(t){const i=this.S.get(t);if(!i)return;const s=[i.children];for(const r of s)if(r)for(const n of r)s.push(this.S.get(n)?.children),this.S.delete(n)}fb(t,i){let s=this.R.get(i);return s||(s=this.O++,this.R.set(i,s),this.S.set(s,{provider:t,item:i})),jy.from(i,s)}asDebugSourceUri(t,i){const s=t;if(typeof s.sourceReference=="number"&&s.sourceReference>0){let r=`debug:${encodeURIComponent(s.path||"")}`,n="?";return i&&(r+=`${n}session=${encodeURIComponent(i.id)}`,n="&"),r+=`${n}ref=${s.sourceReference}`,y.parse(r)}else{if(s.path)return y.file(s.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}gb(t){const i=[];for(const s of t.getAllExtensionDescriptions())if(s.contributes){const r=s.contributes.debuggers;if(r&&r.length>0)for(const n of r)bq(n)&&i.push(n.type)}this.q.$registerDebugTypes(i)}get activeStackItem(){return this.J}get onDidChangeActiveStackItem(){return this.L.event}get onDidChangeBreakpoints(){return this.I.event}get breakpoints(){const t=[];return this.H.forEach(i=>t.push(i)),t}async $resolveDebugVisualizer(t,i){const s=this.W.get(t);if(!s)throw new Error(`No debug visualizer found with id '${t}'`);let{v:r,provider:n,extensionId:o}=s;if(r.visualization||(r=await n.resolveDebugVisualization?.(r,i)||r,s.v=r),!r.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${n}'`);return this.Ab(o,r.visualization)}async $executeDebugVisualizerCommand(t){const i=this.W.get(t);if(!i)throw new Error(`No debug visualizer found with id '${t}'`);const s=i.v.visualization;s&&"command"in s&&this.db.executeCommand(s.command,...s.arguments||[])}hb(t){const i=this.u.get(t.sessionId);return i&&{session:i.api,variable:t.variable,containerId:t.containerId,frameId:t.frameId,threadId:t.threadId}}async $provideDebugVisualizers(t,i,s,r){const n=this.hb(s),o=this.zb(t,i),a=this.P.get(o);if(!n||!a)return[];const c=await a.provideDebugVisualization(n,r);return c?c.map(l=>{const u=++this.X;this.W.set(u,{v:l,provider:a,extensionId:t});const h=l.iconPath?this.Bb(l.iconPath):void 0;return{id:u,name:l.name,iconClass:h?.iconClass,iconPath:h?.iconPath,visualization:this.Ab(t,l.visualization)}}):[]}$disposeDebugVisualizers(t){for(const i of t)this.W.delete(i)}registerDebugVisualizationProvider(t,i,s){if(!t.contributes?.debugVisualizers?.some(o=>o.id===i))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${i})`);const r=Ye.toKey(t.identifier),n=this.zb(r,i);if(this.P.has(n))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this.P.set(n,s),this.q.$registerDebugVisualizer(r,i),te(()=>{this.q.$unregisterDebugVisualizer(r,i),this.P.delete(i)})}addBreakpoints(t){const i=t.filter(n=>{const o=n.id;return this.H.has(o)?!1:(this.H.set(o,n),!0)});this.wb(i,[],[]);const s=[],r=new Map;for(const n of i)if(n instanceof Ea){let o=r.get(n.location.uri.toString());o||(o={type:"sourceMulti",uri:n.location.uri,lines:[]},r.set(n.location.uri.toString(),o),s.push(o)),o.lines.push({id:n.id,enabled:n.enabled,condition:n.condition,hitCondition:n.hitCondition,logMessage:n.logMessage,line:n.location.range.start.line,character:n.location.range.start.character,mode:n.mode})}else n instanceof xa&&s.push({type:"function",id:n.id,enabled:n.enabled,hitCondition:n.hitCondition,logMessage:n.logMessage,condition:n.condition,functionName:n.functionName,mode:n.mode});return this.q.$registerBreakpoints(s)}removeBreakpoints(t){const i=t.filter(o=>this.H.delete(o.id));this.wb([],i,[]);const s=i.filter(o=>o instanceof Ea).map(o=>o.id),r=i.filter(o=>o instanceof xa).map(o=>o.id),n=i.filter(o=>o instanceof Gp).map(o=>o.id);return this.q.$unregisterBreakpoints(s,r,n)}startDebugging(t,i,s){const r=s.testRun&&this.eb.getMetadataForRun(s.testRun);return this.q.$startDebugging(t?t.uri:void 0,i,{parentSessionID:s.parentSession?s.parentSession.id:void 0,lifecycleManagedByParent:s.lifecycleManagedByParent,repl:s.consoleMode===Kp.MergeWithParent?"mergeWithParent":"separate",noDebug:s.noDebug,compact:s.compact,suppressSaveBeforeStart:s.suppressSaveBeforeStart,testRun:r&&{runId:r.runId,taskId:r.taskId},suppressDebugStatusbar:s.suppressDebugStatusbar??s.debugUI?.simple,suppressDebugToolbar:s.suppressDebugToolbar??s.debugUI?.simple,suppressDebugView:s.suppressDebugView??s.debugUI?.simple})}stopDebugging(t){return this.q.$stopDebugging(t?t.id:void 0)}registerDebugConfigurationProvider(t,i,s){if(!i)return new Ce(()=>{});const r=this.f++;return this.g.push({type:t,handle:r,provider:i}),this.q.$registerDebugConfigurationProvider(t,s,!!i.provideDebugConfigurations,!!i.resolveDebugConfiguration,!!i.resolveDebugConfigurationWithSubstitutedVariables,r),new Ce(()=>{this.g=this.g.filter(n=>n.provider!==i),this.q.$unregisterDebugConfigurationProvider(r)})}registerDebugAdapterDescriptorFactory(t,i,s){if(!s)return new Ce(()=>{});if(!this.sb(t,i))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${i}' debugger.`);if(this.pb(i))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const r=this.h++;return this.j.push({type:i,handle:r,factory:s}),this.q.$registerDebugAdapterDescriptorFactory(i,r),new Ce(()=>{this.j=this.j.filter(n=>n.factory!==s),this.q.$unregisterDebugAdapterDescriptorFactory(r)})}registerDebugAdapterTrackerFactory(t,i){if(!i)return new Ce(()=>{});const s=this.m++;return this.n.push({type:t,handle:s,factory:i}),new Ce(()=>{this.n=this.n.filter(r=>r.factory!==i)})}async $runInTerminal(t,i){return Promise.resolve(void 0)}async $substituteVariables(t,i){let s;const r=await this.yb(t);return r&&(s={uri:r.uri,name:r.name,index:r.index}),(await this.cb.getResolver()).resolveAsync(s,i)}ib(t,i){if(t instanceof uh)return new zq(t.implementation)}jb(){}async $startDASession(t,i){const s=this,r=await this.xb(i);return this.ub(this.pb(r.type),r).then(n=>{if(!n)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}' (extension might have failed to activate)`);const o=this.ib(n,r);if(!o)throw new Error(`Couldn't create a debug adapter for type '${r.type}'.`);const a=o;return this.M.set(t,a),this.tb(r).then(c=>(c&&this.N.set(t,c),a.onMessage(async l=>{if(l.type==="request"&&l.command==="handshake"){const u=l,h={type:"response",seq:0,command:u.command,request_seq:u.seq,success:!0};this.U||(this.U=this.jb());try{if(this.U){const f=await this.U.sign(u.arguments.value);h.body={signature:f},a.sendResponse(h)}else throw new Error("no signer")}catch(f){h.success=!1,h.message=f.message,a.sendResponse(h)}}else{c&&c.onDidSendMessage&&c.onDidSendMessage(l);try{l=Eq(l,!0)}catch(u){const h=l.type+"_"+(l.command??l.event??"");throw this.Y.$publicLog2("debugProtocolMessageError",{type:h,from:r.type}),u}s.q.$acceptDAMessage(t,l)}}),a.onError(l=>{c&&c.onError&&c.onError(l),this.q.$acceptDAError(t,l.name,l.message,l.stack)}),a.onExit(l=>{c&&c.onExit&&c.onExit(l??void 0,void 0),this.q.$acceptDAExit(t,l??void 0,void 0)}),c&&c.onWillStartSession&&c.onWillStartSession(),a.startSession()))})}$sendDAMessage(t,i){i=Sq(i,!1);const s=this.N.get(t);s&&s.onWillReceiveMessage&&s.onWillReceiveMessage(i),this.M.get(t)?.sendMessage(i)}$stopDASession(t){const i=this.N.get(t);this.N.delete(t),i&&i.onWillStopSession&&i.onWillStopSession();const s=this.M.get(t);return this.M.delete(t),s?s.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(t){const i=[],s=[],r=[];if(t.added)for(const n of t.added){const o=n.id;if(o&&!this.H.has(o)){let a;if(n.type==="function")a=new xa(n.functionName,n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode);else if(n.type==="data")a=new Gp(n.label,n.dataId,n.canPersist,n.enabled,n.hitCondition,n.condition,n.logMessage,n.mode);else{const c=y.revive(n.uri);a=new Ea(new rs(c,new Pe(n.line,n.character)),n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode)}dB(a,o),this.H.set(o,a),i.push(a)}}if(t.removed)for(const n of t.removed){const o=this.H.get(n);o&&(this.H.delete(n),s.push(o))}if(t.changed){for(const n of t.changed)if(n.id){const o=this.H.get(n.id);if(o){if(o instanceof xa&&n.type==="function"){const a=o;a.enabled=n.enabled,a.condition=n.condition,a.hitCondition=n.hitCondition,a.logMessage=n.logMessage,a.functionName=n.functionName}else if(o instanceof Ea&&n.type==="source"){const a=o;a.enabled=n.enabled,a.condition=n.condition,a.hitCondition=n.hitCondition,a.logMessage=n.logMessage,a.location=new rs(y.revive(n.uri),new Pe(n.line,n.character))}r.push(o)}}}this.wb(i,s,r)}async $acceptStackFrameFocus(t){let i;if(t){const s=await this.xb(t.sessionId);t.kind==="thread"?i=new y7(s.api,t.threadId):i=new b7(s.api,t.threadId,t.frameId)}this.J=i,this.L.fire(this.J)}$provideDebugConfigurations(t,i,s){return fi(async()=>{const r=this.rb(t);if(!r)throw new Error("no DebugConfigurationProvider found");if(!r.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const n=await this.yb(i);return r.provideDebugConfigurations(n,s)}).then(r=>{if(!r)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return r})}$resolveDebugConfiguration(t,i,s,r){return fi(async()=>{const n=this.rb(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.yb(i);return n.resolveDebugConfiguration(o,s,r)})}$resolveDebugConfigurationWithSubstitutedVariables(t,i,s,r){return fi(async()=>{const n=this.rb(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.yb(i);return n.resolveDebugConfigurationWithSubstitutedVariables(o,s,r)})}async $provideDebugAdapter(t,i){const s=this.qb(t);if(!s)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const r=await this.xb(i);return this.ub(s,r).then(n=>{if(!n)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}'`);return this.kb(n)})}async $acceptDebugSessionStarted(t){const i=await this.xb(t);this.w.fire(i.api)}async $acceptDebugSessionTerminated(t){const i=await this.xb(t);i&&(this.y.fire(i.api),this.u.delete(i.id))}async $acceptDebugSessionActiveChanged(t){this.C=t?await this.xb(t):void 0,this.z.fire(this.C?.api)}async $acceptDebugSessionNameChanged(t,i){(await this.xb(t))?._acceptNameChanged(i)}async $acceptDebugSessionCustomEvent(t,i){const r={session:(await this.xb(t)).api,event:i.event,body:i.body};this.F.fire(r)}kb(t){if(t instanceof Yc)return this.lb(t);if(t instanceof Xc)return this.mb(t);if(t instanceof lh)return this.nb(t);if(t instanceof uh)return this.ob(t);throw new Error("convertToDto unexpected type")}lb(t){return{type:"executable",command:t.command,args:t.args,options:t.options}}mb(t){return{type:"server",port:t.port,host:t.host}}nb(t){return{type:"pipeServer",path:t.path}}ob(t){return{type:"implementation"}}pb(t){const i=this.j.filter(s=>s.type===t);if(i.length>0)return i[0].factory}qb(t){const i=this.j.filter(s=>s.handle===t);if(i.length>0)return i[0].factory}rb(t){const i=this.g.filter(s=>s.handle===t);if(i.length>0)return i[0].provider}sb(t,i){if(t.contributes){const s=t.contributes.debuggers;if(s&&s.length>0){for(const r of s)if(r.label&&r.type&&r.type===i)return!0}}return!1}tb(t){const s=t.configuration.type,r=this.n.filter(n=>n.type===s||n.type==="*").map(n=>fi(()=>n.factory.createDebugAdapterTracker(t.api)).then(o=>o,o=>null));return Promise.race([Promise.all(r).then(n=>{const o=gt(n);if(o.length>0)return new jq(o)}),new Promise(n=>setTimeout(()=>n(void 0),1e3))]).catch(n=>{})}async ub(t,i){const s=i.configuration.debugServer;if(typeof s=="number")return Promise.resolve(new Xc(s));if(t){const n=await this.$.getExtensionRegistry();return fi(()=>t.createDebugAdapterDescriptor(i.api,this.vb(i,n))).then(o=>{if(o)return o})}const r=await this.$.getExtensionRegistry();return Promise.resolve(this.vb(i,r))}vb(t,i){}wb(t,i,s){(t.length>0||i.length>0||s.length>0)&&this.I.fire(Object.freeze({added:t,removed:i,changed:s}))}async xb(t){if(t)if(typeof t=="string"){const i=this.u.get(t);if(i)return i}else{let i=this.u.get(t.id);if(!i){const s=await this.yb(t.folderUri),r=t.parent?this.u.get(t.parent):void 0;i=new Fq(this.q,t.id,t.type,t.name,s,t.configuration,r?.api),this.u.set(i.id,i),this.q.$sessionCached(i.id)}return i}throw new Error("cannot find session")}yb(t){if(t){const i=y.revive(t);return this.Z.resolveWorkspaceFolder(i)}return Promise.resolve(void 0)}zb(t,i){return`${t}\0${i}`}Ab(t,i){if(i){if("title"in i&&"command"in i)return{type:0};if("treeId"in i)return{type:1,id:`${t}\0${i.treeId}`};throw new Error("Unsupported debug visualization type")}}Bb(t){const i=this.Cb(t);let s,r;return"id"in i?r=Dt.asClassName(i):s=i,{iconPath:s,iconClass:r}}Cb(t){if(t instanceof Ti)return{id:t.id};const i=typeof t=="object"&&"dark"in t?t.dark:t,s=typeof t=="object"&&"light"in t?t.light:t;return{dark:typeof i=="string"?y.file(i):i,light:typeof s=="string"?y.file(s):s}}};_m=__decorate([__param(0,ke),__param(1,Rs),__param(2,vn),__param(3,ws),__param(4,Tl),__param(5,Wa),__param(6,cr),__param(7,ud)],_m);var Fq=class{constructor(e,t,i,s,r,n,o){this.f=e,this.g=t,this.h=i,this.j=s,this.k=r,this.l=n,this.m=o}get api(){const e=this;return this.d??=Object.freeze({id:e.g,type:e.h,get name(){return e.j},set name(t){e.j=t,e.f.$setDebugSessionName(e.g,t)},parentSession:e.m,workspaceFolder:e.k,configuration:e.l,customRequest(t,i){return e.f.$customDebugAdapterRequest(e.g,t,i)},getDebugProtocolBreakpoint(t){return e.f.$getDebugProtocolBreakpoint(e.g,t.id)}})}get id(){return this.g}get type(){return this.h}_acceptNameChanged(e){this.j=e}get configuration(){return this.l}},Uq=class{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}},jq=class{constructor(e){this.d=e}onWillStartSession(){this.d.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.d.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.d.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.d.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.d.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.d.forEach(i=>i.onExit?i.onExit(e,t):void 0)}},zq=class extends a8{constructor(e){super(),this.h=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.h.handleMessage(e)}stopSession(){return this.h.dispose(),Promise.resolve(void 0)}},b4=class extends _m{constructor(t,i,s,r,n,o,a,c){super(t,i,s,r,n,o,a,c)}};b4=__decorate([__param(0,ke),__param(1,Rs),__param(2,vn),__param(3,ws),__param(4,Tl),__param(5,Wa),__param(6,cr),__param(7,ud)],b4);function Hq(e){return"uri"in e&&"ranges"in e&&"preview"in e}function Wq(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,session:e.session}))}var w8=class{constructor(e){this.a=e}provideFileSearchResults(e,t,i){return(async()=>{const r=Wq(t);return Promise.all(r.map(n=>this.a.provideFileSearchResults({pattern:e},n,i)))})().then(r=>gt(r).flat())}};function Bq(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,previewOptions:b8(e.previewOptions),maxFileSize:e.maxFileSize,encoding:t.encoding,afterContext:e.surroundingContext,beforeContext:e.surroundingContext}))}function b8(e){return{matchLines:e?.matchLines??Jy.matchLines,charsPerLine:e?.charsPerLine??Jy.charsPerLine}}function _q(e){if(Hq(e)){const t=xs(e.ranges).map((i,s)=>{const n=xs(e.preview.matches)[s];return{sourceRange:i,previewRange:n}});return new fn(e.uri,t,e.preview.text)}else return new om(e.uri,e.text,e.lineNumber)}var Vq=class{constructor(e){this.a=e}provideTextSearchResults(e,t,i,s){const r=a=>{qq(a)&&i.report(_q(a))};return(async()=>gt(await Promise.all(Bq(t).map(a=>this.a.provideTextSearchResults(e,a,{report:c=>r(c)},s)))).reduce((a,c)=>({limitHit:a.limitHit||c.limitHit}),{limitHit:!1}))().then(a=>({limitHit:a.limitHit,message:gt(xs(a.message))}))}};function qq(e){if(Gq(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}function Gq(e){return!!e.preview}var y8=class extends Zn{constructor(e,t,i=()=>!1){const s=new Ek(i,()=>!1);super(s);const r=new kt;e.forEach((n,o)=>{const a=n.folder.with({query:"",fragment:""});r.has(a)?r.get(a).push({fq:n,i:o}):r.set(a,[{fq:n,i:o}])}),r.forEach((n,o)=>{const a=new Map;for(const c of n){const l=t(c.fq,c.i);a.set(this.m(c.fq.folder),l)}super.set(o,a)})}findQueryFragmentAwareSubstr(e){const t=super.findSubstr(e.with({query:"",fragment:""}));if(!t)return;const i=this.m(e);return t.get(i)}forEachFolderQueryInfo(e){return this.forEach(t=>t.forEach(i=>e(i)))}m(e){let t="";return e.query&&(t+=e.query),e.fragment&&(t+="#"+e.fragment),t}},Jq=class{constructor(e,t,i){this.l=e,this.o=t,this.p=i,this.f=!1,this.g=0,this.h=!1,this.a=e.filePattern,this.b=e.includePattern&&tr(e.includePattern),this.c=e.maxResults||void 0,this.d=e.exists,this.j=new Set,this.k=e.excludePattern&&tr(e.excludePattern)}cancel(){this.h=!0,this.j.forEach(e=>e.cancel()),this.j=new Set}search(e){const t=this.l.folderQueries||[];return new Promise((i,s)=>{const r=n=>{this.g++,e(n)};if(this.h)return i({limitHit:this.f});this.l.extraFileResources&&this.l.extraFileResources.forEach(n=>{const o=n.toString(),a=vt(o);this.k&&this.k(o,a)||this.w(r,{base:n,basename:a})}),this.q(t,r).then(n=>{i({limitHit:this.f,stats:n||void 0})},n=>{s(new Error(Sr(n)))})})}async q(e,t){const i=new Qe,s=e.map(l=>this.r(l)),r=this.o instanceof w8?this.p?.tokenSource.token:this.p?.obj,n={folderOptions:s,maxResults:this.l.maxResults??cm,session:r},o=l=>{const u=new aD(this.l,l),h=!u.hasSiblingExcludeClauses();return{queryTester:u,noSiblingsClauses:h,folder:l.folder,tree:this.s()}},a=new y8(e,o);let c;try{this.j.add(i),c=Qi.create();const l=await this.o.provideFileSearchResults(this.l.filePattern||"",n,i.token),u=c.elapsed(),h=Qi.create();return this.h&&!this.f||(l&&l.forEach(f=>{const p=a.findQueryFragmentAwareSubstr(f),g=Be.relative(p.folder.path,f.path);if(p.noSiblingsClauses){const v=vt(f.path);this.w(t,{base:p.folder,relativePath:g,basename:v});return}this.u(p.tree,p.folder,g,t)}),this.h&&!this.f)?null:(a.forEachFolderQueryInfo(f=>{this.v(f.tree,f.queryTester,t)}),{providerTime:u,postProcessTime:h.elapsed()})}finally{i.dispose(),this.j.delete(i)}}r(e){const t=Sl(this.l.includePattern,e.includePattern);let i=e.excludePattern?.map(r=>({folder:r.folder,patterns:Sl(this.l.excludePattern,r.pattern)}));i?.length||(i=[{folder:void 0,patterns:Sl(this.l.excludePattern,void 0)}]);const s=lD(i);return{folder:e.folder,excludes:s,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}s(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}u({pathToEntries:e},t,i,s){if(i===this.a){const n=vt(this.a);this.w(s,{base:t,relativePath:this.a,basename:n})}function r(n){const o=vt(n),a=$i(n);let c=e[a];c||(c=e[a]=[],r(a)),c.push({base:t,relativePath:n,basename:o})}r(i)}v({rootEntries:e,pathToEntries:t},i,s){const r=this,n=this.a;function o(a){const c=Gy(()=>a.map(l=>l.basename));for(let l=0,u=a.length;l<u;l++){const h=a[l],{relativePath:f,basename:p}=h;if(i.matchesExcludesSync(f,p,n!==p?c:void 0))continue;const g=t[f];if(g)o(g);else{if(f===n)continue;r.w(s,h)}if(r.f)break}}o(e)}w(e,t){(!this.b||t.relativePath&&this.b(t.relativePath,t.basename))&&((this.d||this.c&&this.g>=this.c)&&(this.f=!0,this.cancel()),this.f||e(t))}},Zq=class{constructor(){this.a=new Object,this.tokenSource=new Qe}get obj(){if(this.a)return this.a;throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel(),this.a=void 0}},Qq=class zM{constructor(){this.b=new Map}static{this.a=512}fileSearch(t,i,s,r){const n=this.c(t.cacheKey),o=new Jq(t,i,n);let a=0;const c=l=>{a+=l.length,s(l.map(u=>this.d(u)))};return this.f(o,zM.a,c,r).then(l=>({limitHit:l.limitHit,stats:l.stats?{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}:void 0,messages:[]}))}clearCache(t){this.b.get(t)?.cancel(),this.b.delete(t)}c(t){if(t)return this.b.has(t)||this.b.set(t,new Zq),this.b.get(t)}d(t){return t.relativePath?{resource:It(t.base,t.relativePath)}:{resource:t.base}}f(t,i,s,r){const n=r.onCancellationRequested(()=>{t.cancel()}),o=c=>{c&&(a.push(c),i>0&&a.length>=i&&(s(a),a=[]))};let a=[];return t.search(o).then(c=>(a.length&&s(a),n.dispose(),c),c=>(a.length&&s(a),n.dispose(),Promise.reject(c)))}},y4=class{constructor(e,t,i){this.f=e,this.g=t,this.h=i,this.b=null,this.c=!1,this.d=0}get j(){return this.f.query}search(e,t,i){const s=this.j.folderQueries||[],r=new Qe(t);return new Promise((n,o)=>{this.b=new Xq(e);let a=!1;const c=(l,u)=>{if(!(l instanceof By)&&!a&&!this.c){const h=this.l(l);l instanceof fn&&typeof this.j.maxResults=="number"&&this.d+h>this.j.maxResults&&(this.c=!0,a=!0,r.cancel(),l=this.m(l,this.j.maxResults-this.d));const f=this.l(l);this.d+=f;const p=l instanceof fn;(f>0||!p)&&this.b.add(l,u)}};this.n(s,c,r.token,i).then(l=>{r.dispose(),this.b.flush(),n({limitHit:this.c||l?.limitHit,messages:this.k(l),stats:{type:this.h}})},l=>{r.dispose();const u=Sr(l);o(new Error(u))})})}k(e){return e?.message?Array.isArray(e.message)?e.message:[e.message]:[]}l(e){return e instanceof fn?Array.isArray(e.ranges)?e.ranges.length:1:0}m(e,t){return new fn(e.uri,e.ranges.slice(0,t),e.previewText)}async n(e,t,i,s){const r=new y8(e,(u,h)=>({queryTester:new aD(this.j,u),folder:u.folder,folderIdx:h}),()=>!0),n=[],o={report:u=>{if(u instanceof By)s?.(u);else{if(u.uri===void 0)throw Error("Text search result URI is undefined. Please check provider implementation.");const h=r.findQueryFragmentAwareSubstr(u.uri),f=h.folder.scheme===V.file?RB(()=>this.g.readdir(dc(u.uri))):void 0,p=dx(h.folder,u.uri);if(p){const g=h.queryTester.includedInQuery(p,vt(p),f);Hn(g)?n.push(g.then(v=>{v&&t(u,h.folderIdx)})):g&&t(u,h.folderIdx)}}}},c={folderOptions:e.map(u=>this.o(u)),maxFileSize:this.j.maxFileSize,maxResults:this.j.maxResults??cm,previewOptions:this.j.previewOptions??Jy,surroundingContext:this.j.surroundingContext??0};"usePCRE2"in this.j&&(c.usePCRE2=this.j.usePCRE2);let l;return this.f.query.type===3?l=await this.f.provider.provideAITextSearchResults(this.f.query.contentPattern,c,o,i):l=await this.f.provider.provideTextSearchResults(Yq(this.f.query.contentPattern),c,o,i),n.length&&await Promise.all(n),l}o(e){const t=Sl(this.j.includePattern,e.includePattern);let i=e.excludePattern?.map(n=>({folder:n.folder,patterns:Sl(this.j.excludePattern,n.pattern)}));(!i||i.length===0)&&(i=[{folder:void 0,patterns:Sl(this.j.excludePattern,void 0)}]);const s=lD(i);return{folder:y.from(e.folder),excludes:s,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.g.toCanonicalName(e.fileEncoding))??""}}};function Yq(e){return{isCaseSensitive:e.isCaseSensitive||!1,isRegExp:e.isRegExp||!1,isWordMatch:e.isWordMatch||!1,isMultiline:e.isMultiline||!1,pattern:e.pattern}}var Xq=class{constructor(e){this.g=e,this.c=-1,this.f=null,this.b=new eG(512,t=>this.j(t))}add(e,t){this.f&&(this.c!==t||!hc(this.d,e.uri))&&(this.h(),this.f=null),this.f||(this.c=t,this.f={resource:e.uri,results:[]}),this.f.results.push(Kq(e))}h(){const e=this.f&&this.f.results?this.f.results.length:0;this.b.addItem(this.f,e)}flush(){this.h(),this.b.flush()}j(e){this.g(e)}};function Kq(e){return e instanceof fn?{previewText:e.previewText,rangeLocations:e.ranges.map(t=>({preview:{startLineNumber:t.previewRange.start.line,startColumn:t.previewRange.start.character,endLineNumber:t.previewRange.end.line,endColumn:t.previewRange.end.character},source:{startLineNumber:t.sourceRange.start.line,startColumn:t.sourceRange.start.character,endLineNumber:t.sourceRange.end.line,endColumn:t.sourceRange.end.character}}))}:{text:e.text,lineNumber:e.lineNumber}}var eG=class H5{static{this.b=4e3}static{this.c=50}constructor(t,i){this.j=t,this.k=i,this.d=0,this.f=[],this.g=0}addItem(t,i){t&&this.l(t,i)}addItems(t,i){t&&this.m(t,i)}l(t,i){this.f.push(t),this.g+=i,this.n()}m(t,i){this.f=this.f.concat(t),this.g+=i,this.n()}n(){this.d<H5.c?this.flush():this.g>=this.j?this.flush():this.h||(this.h=setTimeout(()=>{this.flush()},H5.b))}flush(){this.g&&(this.d+=this.g,this.k(this.f),this.f=[],this.g=0,this.h&&(clearTimeout(this.h),this.h=void 0))}},A4=H("IExtHostSearch"),Vm=class{constructor(t,i,s){this.o=t,this.q=i,this.s=s,this.c=this.o.getProxy(Y.MainThreadSearch),this.e=0,this.g=new Map,this.h=new Set,this.i=new Map,this.j=new Set,this.k=new Map,this.l=new Set,this.n=new Qq}t(t){return this.q.transformOutgoingScheme(t)}registerTextSearchProviderOld(t,i){if(this.h.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this.h.add(t);const s=this.e++;return this.g.set(s,new Vq(i)),this.c.$registerTextSearchProvider(s,this.t(t)),te(()=>{this.h.delete(t),this.g.delete(s),this.c.$unregisterProvider(s)})}registerTextSearchProvider(t,i){if(this.h.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this.h.add(t);const s=this.e++;return this.g.set(s,i),this.c.$registerTextSearchProvider(s,this.t(t)),te(()=>{this.h.delete(t),this.g.delete(s),this.c.$unregisterProvider(s)})}registerAITextSearchProvider(t,i){if(this.j.has(t))throw new Error(`an AI text search provider for the scheme '${t}'is already registered`);this.j.add(t);const s=this.e++;return this.i.set(s,i),this.c.$registerAITextSearchProvider(s,this.t(t)),te(()=>{this.j.delete(t),this.i.delete(s),this.c.$unregisterProvider(s)})}registerFileSearchProviderOld(t,i){if(this.l.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this.l.add(t);const s=this.e++;return this.k.set(s,new w8(i)),this.c.$registerFileSearchProvider(s,this.t(t)),te(()=>{this.l.delete(t),this.k.delete(s),this.c.$unregisterProvider(s)})}registerFileSearchProvider(t,i){if(this.l.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this.l.add(t);const s=this.e++;return this.k.set(s,i),this.c.$registerFileSearchProvider(s,this.t(t)),te(()=>{this.l.delete(t),this.k.delete(s),this.c.$unregisterProvider(s)})}$provideFileSearchResults(t,i,s,r){const n=qm(s),o=this.k.get(t);if(o)return this.n.fileSearch(n,o,a=>{this.c.$handleFileMatch(t,i,a.map(c=>c.resource))},r);throw new Error("unknown provider: "+t)}async doInternalFileSearchWithCustomCallback(t,i,s){return{messages:[]}}$clearCache(t){return this.n.clearCache(t),Promise.resolve(void 0)}$provideTextSearchResults(t,i,s,r){const n=this.g.get(t);if(!n||!n.provideTextSearchResults)throw new Error(`Unknown Text Search Provider ${t}`);const o=qm(s);return this.v(o,n).search(c=>this.c.$handleTextMatch(t,i,c),r)}$provideAITextSearchResults(t,i,s,r){const n=this.i.get(t);if(!n||!n.provideAITextSearchResults)throw new Error(`Unknown AI Text Search Provider ${t}`);const o=qm(s);return this.w(o,n).search(c=>this.c.$handleTextMatch(t,i,c),r,c=>this.c.$handleKeywordResult(t,i,c))}$enableExtensionHostSearch(){}async $getAIName(t){const i=this.i.get(t);if(!(!i||!i.provideAITextSearchResults))return i.name??"AI"}v(t,i){return new y4({query:t,provider:i},{readdir:s=>Promise.resolve([]),toCanonicalName:s=>s},"textSearchProvider")}w(t,i){return new y4({query:t,provider:i},{readdir:s=>Promise.resolve([]),toCanonicalName:s=>s},"aiTextSearchProvider")}};Vm=__decorate([__param(0,ke),__param(1,Cu),__param(2,Se)],Vm);function qm(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(tG),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function tG(e){return Zt(e)}var Gm=class extends aj{constructor(t,i){super(i.logLevel,i.logsLocation,i.loggers.map(s=>Zt(s))),this.c=t.getProxy(Y.MainThreadLogger)}$setLogLevel(t,i){i?this.setLogLevel(y.revive(i),t):this.setLogLevel(t)}setVisibility(t,i){super.setVisibility(t,i),this.c.$setVisibility(t,i)}s(t,i,s){return new iG(this.c,t,i,s)}};Gm=__decorate([__param(0,ke),__param(1,jt)],Gm);var iG=class extends L0{constructor(e,t,i,s){super(s?.logLevel==="always"),this.r=e,this.s=t,this.n=!1,this.q=[],this.setLevel(i),this.r.$createLogger(t,s).then(()=>{this.u(this.q),this.n=!0})}m(e,t){const i=[[e,t]];this.n?this.u(i):this.q.push(...i)}u(e){this.r.$log(this.s,e)}flush(){this.r.$flush(this.s)}},S4=H("IExtHostTerminalShellIntegration"),E4=class extends Z{constructor(t,i){super(),this.h=i,this.b=new Map,this.c=new I,this.onDidChangeTerminalShellIntegration=this.c.event,this.f=new I,this.onDidStartTerminalShellExecution=this.f.event,this.g=new I,this.onDidEndTerminalShellExecution=this.g.event,this.a=t.getProxy(Y.MainThreadTerminalShellIntegration),this.D(te(()=>{for(const[s,r]of this.b)r.dispose();this.b.clear()}))}$shellIntegrationChange(t,i){const s=this.h.getTerminalById(t);if(!s)return;const r=s.value;let n=this.b.get(t);n||(n=new sG(s.value,i,this.f),this.b.set(t,n),n.store.add(s.onWillDispose(()=>this.b.get(t)?.dispose())),n.store.add(n.onDidRequestShellExecution(o=>this.a.$executeCommand(t,o))),n.store.add(n.onDidRequestEndExecution(o=>this.g.fire(o))),n.store.add(n.onDidRequestChangeShellIntegration(o=>this.c.fire(o))),s.shellIntegration=n.value),this.c.fire({terminal:r,shellIntegration:n.value})}$shellExecutionStart(t,i,s,r,n,o){this.b.has(t)||this.$shellIntegrationChange(t,i);const a={value:s,confidence:r,isTrusted:n};this.b.get(t)?.startShellExecution(a,this.j(o))}$shellExecutionEnd(t,i,s,r,n){const o={value:i,confidence:s,isTrusted:r};this.b.get(t)?.endShellExecution(o,n)}$shellExecutionData(t,i){this.b.get(t)?.emitData(i)}$shellEnvChange(t,i,s,r){this.b.get(t)?.setEnv(i,s,r)}$cwdChange(t,i){this.b.get(t)?.setCwd(this.j(i))}$closeTerminal(t){this.b.get(t)?.dispose(),this.b.delete(t)}j(t){return t?y.file(t):void 0}};E4=__decorate([__param(0,ke),__param(1,mn)],E4);var sG=class extends Z{get currentExecution(){return this.f}constructor(e,t,i){super(),this.r=e,this.s=i,this.a=[],this.store=this.D(new ie),this.j=this.D(new I),this.onDidRequestChangeShellIntegration=this.j.event,this.m=this.D(new I),this.onDidRequestShellExecution=this.m.event,this.n=this.D(new I),this.onDidRequestEndExecution=this.n.event,this.q=this.D(new I),this.onDidRequestNewExecution=this.q.event;const s=this;this.value={get cwd(){return s.h},get env(){if(s.g)return Object.freeze({isTrusted:s.g.isTrusted,value:Object.freeze({...s.g.value})})},executeCommand(r,n){if(!t)throw new Error("This terminal does not support the executeCommand API.");let o=r;if(n)for(const l of n)!l.match(/["'`]/)&&l.match(/\s/)?o+=` "${l}"`:o+=` ${l}`;s.m.fire(o);const a={value:o,confidence:oh.High,isTrusted:!0};return s.requestNewShellExecution(a,s.h).value}}}requestNewShellExecution(e,t){const i=new A8(e,t??this.h);return Jm(e.value).length>1&&(this.c={isMultiLine:!0,unresolvedCommandLines:Jm(e.value)}),this.a.push(i),this.q.fire(e.value),i}startShellExecution(e,t){if(this.b&&(this.n.fire({terminal:this.r,shellIntegration:this.value,execution:this.b.value,exitCode:void 0}),this.b=void 0),this.f){if(this.c?.isMultiLine&&this.c.unresolvedCommandLines){const s=S8(this.c.unresolvedCommandLines,e);if(s){this.c.unresolvedCommandLines=s.unresolvedCommandLines;return}}this.f.endExecution(void 0),this.f.flush(),this.n.fire({terminal:this.r,shellIntegration:this.value,execution:this.f.value,exitCode:void 0})}let i;if(e.confidence===oh.High)for(const[s,r]of this.a.entries())if(r.value.commandLine.value===e.value){i=r,this.c={isMultiLine:!1,unresolvedCommandLines:void 0},i=r,this.a.splice(s,1);break}else{const n=S8(Jm(r.value.commandLine.value),e);if(n){this.c={isMultiLine:!0,unresolvedCommandLines:n.unresolvedCommandLines},i=r,this.a.splice(s,1);break}}else i=this.a.shift();i||(i=new A8(e,t??this.h)),this.f=i,this.s.fire({terminal:this.r,shellIntegration:this.value,execution:this.f.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,t){if(!(this.c?.isMultiLine&&this.c.unresolvedCommandLines&&this.c.unresolvedCommandLines.length>0)&&this.f){const i=this.c?.isMultiLine?this.f.value.commandLine:e;this.f.endExecution(i);const s=this.f;this.b=s,this.f=void 0,s.flush().then(()=>{this.b===s&&(this.n.fire({terminal:this.r,shellIntegration:this.value,execution:s.value,exitCode:t}),this.b=void 0)})}}setEnv(e,t,i){const s={};for(let r=0;r<e.length;r++)s[e[r]]=t[r];this.g={value:s,isTrusted:i},this.t()}setCwd(e){let t=!1;y.isUri(this.h)?t=!y.isUri(e)||this.h.toString()!==e.toString():this.h!==e&&(t=!0),t&&(this.h=e,this.t())}t(){this.j.fire({terminal:this.r,shellIntegration:this.value})}},A8=class{constructor(e,t){this.c=e,this.cwd=t,this.b=!1;const i=this;this.value={get commandLine(){return i.c},get cwd(){return i.cwd},read(){return i.d()}}}d(){if(!this.a){if(this.b)return Yv.EMPTY;this.a=new rG}return this.a.createIterable()}emitData(e){this.b||this.a?.emitData(e)}endExecution(e){e&&(this.c=e),this.a?.endExecution(),this.b=!0}async flush(){this.a&&(await this.a.flush(),this.a.dispose(),this.a=void 0)}},rG=class extends Z{constructor(){super(...arguments),this.b=[],this.c=[]}createIterable(){this.a||(this.a=new ps);const e=this.a,t=new Yv(async i=>{this.c.push(i),await e.wait()});return this.b.push(t),t}emitData(e){for(const t of this.c)t.emitOne(e)}endExecution(){this.a?.open()}async flush(){await Promise.all(this.b.map(e=>e.toPromise()))}};function Jm(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0)}function S8(e,t){if(e.length===0)return!1;const i=[...e],s=Jm(t.value);if(i&&i.length>0){for(;i.length>0&&i[0]===s[0];)i.shift(),s.shift();if(s.length===0)return{unresolvedCommandLines:i}}return!1}var E8;(function(e){e[e.CR=13]="CR",e[e.LF=10]="LF",e[e.COLON=58]="COLON",e[e.SPACE=32]="SPACE"})(E8||(E8={}));var x4=class{constructor(e){this.a="",this.b="",this.f=[],this.g=!1,this.h=e,this.i=new TextDecoder("utf-8")}getLastEventId(){return this.d}getReconnectionTime(){return this.e}feed(e){if(e.length===0)return;let t=0;for(this.g&&e[0]===10&&t++,this.g=!1;t<e.length;){const i=e.indexOf(13,t),s=e.indexOf(10,t),r=i===-1?s:s===-1?i:Math.min(i,s);if(r===-1)break;let n="";for(const o of this.f)n+=this.i.decode(o,{stream:!0});n+=this.i.decode(e.subarray(t,r)),this.j(n),this.f.length=0,t=r+(e[r]===13&&e[r+1]===10?2:1)}t<e.length?this.f.push(e.subarray(t)):this.g=e[e.length-1]===13}j(e){if(!e.length){this.l();return}if(e.startsWith(":"))return;let t,i;const s=e.indexOf(":");s===-1?(t=e,i=""):(t=e.substring(0,s),i=e.substring(s+1),i.startsWith(" ")&&(i=i.substring(1))),this.k(t,i)}k(e,t){switch(e){case"event":this.b=t;break;case"data":this.a+=t,this.a+=`
`;break;case"id":t.includes("\0")?this.c=void 0:this.c=this.d=t;break;case"retry":/^\d+$/.test(t)&&(this.e=parseInt(t,10));break}}l(){if(this.a===""){this.a="",this.b="";return}this.a.endsWith(`
`)&&(this.a=this.a.substring(0,this.a.length-1));const e={type:this.b||"message",data:this.a};this.c!==void 0&&(e.id=this.c),this.e!==void 0&&(e.retry=this.e),this.h(e),this.reset()}reset(){this.a="",this.b="",this.c=void 0}},C4=class{validateOrThrow(e){const t=this.validate(e);if(t.error)throw new Error(t.error.message);return t.content}},Zm=class extends C4{constructor(e){super(),this.a=e}validate(e){return typeof e!==this.a?{content:void 0,error:{message:`Expected ${this.a}, but got ${typeof e}`}}:{content:e,error:void 0}}getJSONSchema(){return{type:this.a}}},nG=new Zm("string");function Qm(){return nG}var oG=new Zm("number");function aG(){return oG}var Sne=new Zm("boolean"),cG=new Zm("object");function k4(){return cG}var $4=class{constructor(e){this.validator=e}};function Nl(e){return new $4(e)}var lG=class extends C4{constructor(e){super(),this.a=e}validate(e){if(typeof e!="object"||e===null)return{content:void 0,error:{message:"Expected object"}};const t={};for(const i in this.a){const s=this.a[i],r=e[i],n=s instanceof $4,o=n?s.validator:s;if(n&&r===void 0)continue;const{content:a,error:c}=o.validate(r);if(c)return{content:void 0,error:{message:`Error in property '${i}': ${c.message}`}};t[i]=a}return{content:t,error:void 0}}getJSONSchema(){const e=[],t={};for(const[s,r]of Object.entries(this.a)){const n=r instanceof $4,o=n?r.validator:r;t[s]=o.getJSONSchema(),n||e.push(s)}return{type:"object",properties:t,...e.length>0?{required:e}:{}}}};function Ym(e){return new lG(e)}var uG=class extends C4{constructor(e){super(),this.a=e}validate(e){if(!Array.isArray(e))return{content:void 0,error:{message:"Expected array"}};const t=[];for(let i=0;i<e.length;i++){const{content:s,error:r}=this.a.validate(e[i]);if(r)return{content:void 0,error:{message:`Error in element ${i}: ${r.message}`}};t.push(s)}return{content:t,error:void 0}}getJSONSchema(){return{type:"array",items:this.a.getJSONSchema()}}};function x8(e){return new uG(e)}var Xm=H("IExtHostMpcService"),hG=Ym({label:Qm(),version:Nl(Qm()),metadata:Nl(Ym({capabilities:Nl(k4()),serverInfo:Nl(k4()),tools:Nl(x8(Ym({availability:aG(),definition:k4()})))})),authentication:Nl(Ym({providerId:Qm(),scopes:x8(Qm())}))}),Km=class extends Z{constructor(t,i,s,r,n){super(),this.h=i,this.j=s,this.n=r,this.q=n,this.c=new Set,this.f=this.D(new Fo),this.g=new Map,this.b=t.getProxy(Y.MainThreadMcp)}$startMcp(t,i){this.r(t,Hu.fromSerialized(i.launch),i.defaultCwd&&y.revive(i.defaultCwd),i.errorOnUserInteraction)}r(t,i,s,r){if(i.type===2){this.f.set(t,new k8(t,i,this.b,this.h,r));return}throw new Error("not implemented")}async $substituteVariables(t,i){const s=y.revive(t),r=s&&await this.n.resolveWorkspaceFolder(s);return(await this.q.getResolver()).resolveAsync(r&&{uri:r.uri,name:r.name,index:r.index},i)}$stopMcp(t){this.f.get(t)?.close().then(()=>this.u(t))}u(t){this.f.deleteAndDispose(t)}$sendMessage(t,i){this.f.get(t)?.send(i)}async $waitForInitialCollectionProviders(){await Promise.all(this.c)}async $resolveMcpLaunch(t,i){const s=this.g.get(t);if(!s)return;const r=s.servers.find(o=>o.label===i);if(!r)return;if(!s.provider.resolveMcpServerDefinition)return Wh.from(r);const n=await s.provider.resolveMcpServerDefinition(r,Fe.None);return n?Wh.from(n):void 0}registerMcpConfigurationProvider(t,i,s){const r=new ie,n=t.contributes?.mcpServerDefinitionProviders?.find(l=>l.id===i);if(!n)throw new Error(`MCP configuration providers must be registered in the contributes.mcpServerDefinitionProviders array within your package.json, but "${i}" was not`);const o={id:zH(t.identifier,i),isTrustedByDefault:!0,label:n?.label??t.displayName??t.name,scope:1,canResolveLaunch:typeof s.resolveMcpServerDefinition=="function",extensionId:t.identifier.value,configTarget:this.j.remote.isRemote?4:2},a=async()=>{const l=await s.provideMcpServerDefinitions(Fe.None);this.g.set(o.id,{servers:l??[],provider:s});const u=[];for(const h of l??[]){let f=Ye.toKey(t.identifier)+"/"+h.label;if(u.some(v=>v.id===f)){let v=2;for(;u.some(b=>b.id===f+v);)v++;f=f+v}hG.validateOrThrow(h),h.authentication&&T(t,"mcpToolDefinitions");let p;const g=h;et(t,"mcpToolDefinitions")&&g.metadata&&(p={capabilities:g.metadata.capabilities,instructions:g.metadata.instructions,serverInfo:g.metadata.serverInfo,tools:g.metadata.tools?.map(v=>({availability:v.availability===xg.Dynamic?1:0,definition:v.definition}))}),u.push({id:f,label:h.label,cacheNonce:h.version||"$$NONE",staticMetadata:p,launch:Wh.from(h)})}this.b.$upsertMcpCollection(o,u)};r.add(te(()=>{this.g.delete(o.id),this.b.$deleteMcpCollection(o.id)})),s.onDidChangeMcpServerDefinitions&&r.add(s.onDidChangeMcpServerDefinitions(a)),s.onDidChangeServerDefinitions&&r.add(s.onDidChangeServerDefinitions(a)),s.onDidChange&&r.add(s.onDidChange(a));const c=new Promise(l=>{setTimeout(()=>a().finally(()=>{this.c.delete(c),l()}),0)});return this.c.add(c),r}};Km=__decorate([__param(0,ke),__param(1,Se),__param(2,jt),__param(3,Rs),__param(4,Wa)],Km);var C8;(function(e){e[e.Unknown=0]="Unknown",e[e.Http=1]="Http",e[e.SSE=2]="SSE"})(C8||(C8={}));var dG=5,fG=[301,302,303,307,308],k8=class extends Z{constructor(e,t,i,s,r){super(),this.q=e,this.r=t,this.u=i,this.w=s,this.y=r,this.b=new oO,this.c=new Ri,this.f={value:0},this.g=new Qe,this.h=new AbortController,this.n=!1,this.D(te(()=>{this.h.abort(),this.g.dispose(!0)})),this.u.$onDidChangeState(this.q,{state:2})}async send(e){try{this.f.value===0?await this.b.queue(()=>this.C(e)):await this.C(e)}catch(t){const i=`Error sending message to ${this.r.uri}: ${String(t)}`;this.u.$onDidChangeState(this.q,{state:3,message:i})}}async close(){if(this.f.value===1&&this.f.sessionId&&!this.n){this.n=!0;try{await this.z(this.f.sessionId)}catch{}}this.u.$onDidChangeState(this.q,{state:0})}async z(e){const t={...Object.fromEntries(this.r.headers),"Mcp-Session-Id":e};await this.N(t),await this.R(this.r.uri.toString(!0),{method:"DELETE",headers:t})}C(e){return this.f.value===2?this.L(this.f.endpoint,e):this.F(e,this.f.value===1?this.f.sessionId:void 0)}async F(e,t){const i=new TextEncoder().encode(e),s={...Object.fromEntries(this.r.headers),"Content-Type":"application/json","Content-Length":String(i.length),Accept:"text/event-stream, application/json"};t&&(s["Mcp-Session-Id"]=t),await this.N(s);const r=await this.Q(this.r.uri.toString(!0),{method:"POST",headers:s,body:i},s),n=this.f.value===0,o=r.headers.get("Mcp-Session-Id");if(o&&(this.f={value:1,sessionId:o}),this.f.value===0&&r.status>=400&&r.status<500&&!I4(r.status)){this.O(X.Info,`${r.status} status sending message to ${this.r.uri}, will attempt to fall back to legacy SSE`),this.G(e);return}if(r.status>=300){const a=this.f.value===1&&!!this.f.sessionId&&(r.status===400||r.status===404);this.u.$onDidChangeState(this.q,{state:3,message:`${r.status} status sending message to ${this.r.uri}: ${await this.P(r)}`+(a?"; will retry with new session ID":""),shouldRetry:a});return}this.f.value===0&&(this.f={value:1,sessionId:void 0}),n&&this.I(),await this.H(r,e)}async G(e){const t=await this.J();t&&(this.f={value:2,endpoint:t},await this.L(t,e))}async H(e,t){if(e.status===202)return;const i=e.headers.get("Content-Type")?.toLowerCase()||"";if(i.startsWith("text/event-stream")){const s=new x4(r=>{if(r.type==="message")this.u.$onDidReceiveMessage(this.q,r.data);else if(r.type==="endpoint")throw this.O(X.Warning,`Received SSE endpoint from a POST to ${this.r.uri}, will fall back to legacy SSE`),this.G(t),new dt});try{await this.M(s,e)}catch(r){this.O(X.Warning,`Error reading SSE stream: ${String(r)}`)}}else if(i.startsWith("application/json"))this.u.$onDidReceiveMessage(this.q,await e.text());else{const s=await e.text();pG(s)?this.u.$onDidReceiveMessage(this.q,s):this.O(X.Warning,`Unexpected ${e.status} response for request: ${s}`)}}async I(){let e,t;for(let i=0;!this.B.isDisposed;i++){t!==void 0?(await ri(Math.max(0,t-Date.now()),this.g.token),t=void 0):await ri(Math.min(i*1e3,3e4),this.g.token);let s;try{const n={...Object.fromEntries(this.r.headers),Accept:"text/event-stream"};await this.N(n),this.f.value===1&&this.f.sessionId!==void 0&&(n["Mcp-Session-Id"]=this.f.sessionId),e&&(n["Last-Event-ID"]=e),s=await this.Q(this.r.uri.toString(!0),{method:"GET",headers:n},n)}catch{this.O(X.Info,`Error connecting to ${this.r.uri} for async notifications, will retry`);continue}if(s.status>=400){this.O(X.Debug,`${s.status} status connecting to ${this.r.uri} for async notifications; they will be disabled: ${await this.P(s)}`);return}s.headers.get("content-type")?.toLowerCase().includes("text/event-stream")&&(i=0);const r=new x4(n=>{n.retry&&(t=Date.now()+n.retry),n.type==="message"&&n.data&&this.u.$onDidReceiveMessage(this.q,n.data),n.id&&(e=n.id)});try{await this.M(r,s)}catch(n){this.O(X.Info,`Error reading from async stream, we will reconnect: ${n}`)}}}async J(){const e=new Ri,t={...Object.fromEntries(this.r.headers),Accept:"text/event-stream"};await this.N(t);let i;try{if(i=await this.Q(this.r.uri.toString(!0),{method:"GET",headers:t},t),i.status>=300){this.u.$onDidChangeState(this.q,{state:3,message:`${i.status} status connecting to ${this.r.uri} as SSE: ${await this.P(i)}`});return}}catch(r){this.u.$onDidChangeState(this.q,{state:3,message:`Error connecting to ${this.r.uri} as SSE: ${r}`});return}const s=new x4(r=>{r.type==="message"?this.u.$onDidReceiveMessage(this.q,r.data):r.type==="endpoint"&&e.complete(new URL(r.data,this.r.uri.toString(!0)).toString())});return this.D(te(()=>e.cancel())),this.M(s,i).catch(r=>{this.u.$onDidChangeState(this.q,{state:3,message:`Error reading SSE stream: ${String(r)}`})}),e.p}async L(e,t){const i=new TextEncoder().encode(t),s={...Object.fromEntries(this.r.headers),"Content-Type":"application/json","Content-Length":String(i.length)};await this.N(s);const r=await this.R(e,{method:"POST",headers:s,body:i});r.status>=300&&this.O(X.Warning,`${r.status} status sending message to ${this.c}: ${await this.P(r)}`)}async M(e,t){if(!t.body)return;const i=t.body.getReader();let s;do{try{s=await vf(i.read(),this.g.token)}catch(r){if(i.cancel(),this.B.isDisposed)return;throw r}s.value&&e.feed(s.value)}while(!s.done)}async N(e,t){if(this.j)try{const i={authorizationServer:this.j.authorizationServer.toJSON(),authorizationServerMetadata:this.j.serverMetadata,resourceMetadata:this.j.resourceMetadata,scopes:this.j.scopes},s=await this.u.$getTokenFromServerMetadata(this.q,i,{errorOnUserInteraction:this.y,forceNewRegistration:t});s&&(e.Authorization=`Bearer ${s}`)}catch(i){if(TI.is(i))throw this.u.$onDidChangeState(this.q,{state:0,reason:"needs-user-interaction"}),new dt;this.O(X.Warning,`Error getting token from server metadata: ${String(i)}`)}if(this.r.authentication)try{this.O(X.Debug,`Using provided authentication config: providerId=${this.r.authentication.providerId}, scopes=${this.r.authentication.scopes.join(", ")}`);const i=await this.u.$getTokenForProviderId(this.q,this.r.authentication.providerId,this.r.authentication.scopes,{errorOnUserInteraction:this.y,forceNewRegistration:t});i&&(e.Authorization=`Bearer ${i}`,this.O(X.Info,"Successfully obtained token from provided authentication config"))}catch(i){if(TI.is(i))throw this.u.$onDidChangeState(this.q,{state:0,reason:"needs-user-interaction"}),new dt;this.O(X.Warning,`Error getting token from provided authentication config: ${String(i)}`)}return e}O(e,t){this.B.isDisposed||this.u.$onDidPublishLog(this.q,e,t)}async P(e){try{return await e.text()}catch{return e.statusText}}async Q(e,t,i){const s=()=>this.R(e,t);let r=await s();if(I4(r.status)&&(this.j?this.j.update(r)&&(await this.N(i),i.Authorization&&(t.headers=i,r=await s())):(this.j=await gG(e,r,{launchHeaders:this.r.headers,fetch:(n,o)=>this.R(n,o),log:(n,o)=>this.O(n,o)}),await this.N(i),i.Authorization&&(t.headers=i,r=await s()))),i.Authorization&&I4(r.status)){const n=await this.P(r);this.O(X.Debug,`Received ${r.status} status with Authorization header, retrying with new auth registration. Error details: ${n||"no additional details"}`),await this.N(i,!0),r=await s()}return r}async R(e,t){if(t.headers["user-agent"]=`${yi.nameLong}/${yi.version}`,M0(this.w.getLevel(),X.Trace)){const r={...t,headers:{...t.headers}};r.body&&(r.body=new TextDecoder().decode(r.body)),r.headers?.Authorization&&(r.headers.Authorization="***"),this.O(X.Trace,`Fetching ${e} with options: ${JSON.stringify(r)}`)}let i=e,s;for(let r=0;r<dG&&(s=await this.S(i,{...t,signal:this.h.signal,redirect:"manual"}),!!fG.includes(s.status));r++){const n=s.headers.get("location");if(!n)break;const o=new URL(n,i).toString();this.O(X.Trace,`Redirect (${s.status}) from ${i} to ${o}`),i=o,(s.status===303||(s.status===301||s.status===302)&&t.method==="POST")&&(t.method="GET",delete t.body)}if(M0(this.w.getLevel(),X.Trace)){const r={};s.headers.forEach((n,o)=>{r[o]=n}),this.O(X.Trace,`Fetched ${i}: ${JSON.stringify({status:s.status,headers:r})}`)}return s}S(e,t){return fetch(e,t)}};function pG(e){try{return JSON.parse(e),!0}catch{return!1}}function I4(e){return e===401||e===403}var $8=class{constructor(e,t,i,s,r){this.authorizationServer=e,this.serverMetadata=t,this.resourceMetadata=i,this.b=r,this.a=s}get scopes(){return this.a}update(e){const t=this.c(e);return K_(t,this.a)?!1:(this.b(X.Debug,`Scopes changed from ${JSON.stringify(this.a)} to ${JSON.stringify(t)}, updating`),this.a=t,!0)}c(e){if(!e.headers.has("WWW-Authenticate"))return;const t=e.headers.get("WWW-Authenticate"),i=ZD(t);for(const s of i)if(s.scheme==="Bearer"&&s.params.scope){const r=s.params.scope.split(EA).filter(n=>n.trim().length);if(r.length)return this.b(X.Debug,`Found scope challenge in WWW-Authenticate header: ${s.params.scope}`),r}}};async function gG(e,t,i){const{launchHeaders:s,fetch:r,log:n}=i,{resourceMetadataChallenge:o,scopesChallenge:a}=mG(t,n);let c,l,u=a;try{const{metadata:g,errors:v}=await eV(e,o,{sameOriginHeaders:{...Object.fromEntries(s),"MCP-Protocol-Version":Kf.LATEST_PROTOCOL_VERSION},fetch:(b,S)=>r(b,S)});for(const b of v)n(X.Warning,`Error fetching resource metadata: ${b}`);c=g.authorization_servers?.[0],n(X.Debug,`Using auth server metadata url: ${c}`),u??=g.scopes_supported,l=g}catch(g){n(X.Warning,`Could not fetch resource metadata: ${String(g)}`)}const h=new URL(t.url).origin;let f={};c||(c=h,f={...Object.fromEntries(s),"MCP-Protocol-Version":Kf.LATEST_PROTOCOL_VERSION});try{n(X.Debug,`Fetching auth server metadata for: ${c} ...`);const g=await sV(c,{additionalHeaders:f,fetch:(v,b)=>r(v,b)});return n(X.Info,"Populated auth metadata"),new $8(y.parse(c),g,l,u,n)}catch(g){n(X.Warning,`Error populating auth server metadata for ${c}: ${String(g)}`)}const p=X_(new URL(h));return n(X.Info,"Using default auth metadata"),new $8(y.parse(h),p,l,u,n)}function mG(e,t){let i,s;if(e.headers.has("WWW-Authenticate")){const r=e.headers.get("WWW-Authenticate"),n=ZD(r);for(const o of n)if(o.scheme==="Bearer"){if(!i&&o.params.resource_metadata&&(i=o.params.resource_metadata,t(X.Debug,`Found resource_metadata challenge in WWW-Authenticate header: ${i}`)),!s&&o.params.scope){const a=o.params.scope.split(EA).filter(c=>c.trim().length);a.length&&(t(X.Debug,`Found scope challenge in WWW-Authenticate header: ${o.params.scope}`),s=a)}if(i&&s)break}}return{resourceMetadataChallenge:i,scopesChallenge:s}}var I8=H("IExtHostDataChannels"),vG=class{constructor(){this.a=new Map}createDataChannel(e,t){T(e,"dataChannels");let i=this.a.get(t);return i||(i=new wG(t),this.a.set(t,i)),i}$onDidReceiveData(e,t){const i=this.a.get(e);i&&i._fireDidReceiveData(t)}},wG=class extends Z{constructor(e){super(),this.b=e,this.a=new I,this.onDidReceiveData=this.a.event,this.D(this.a)}_fireDidReceiveData(e){this.a.fire({data:e})}toString(){return`DataChannel(${this.b})`}};De(VA,_A,1),De(Jn,Gm,1),De(Dl,QA,1),De(cr,vA,0),De(Im,DA,0),De(MA,LA,0),De(ws,nA,0),De(Gh,uA,0),De(ud,v4,0),De(w4,b4,0),De(O9,t4,0),De(Ha,s4,0),De(qA,GA,0),De(yc,kj,0),De(R9,e4,1),De(A4,Vm,0),De(lA,$D,0),De(g4,p4,0),De(mn,yA,0),De(S4,E4,0),De(Am,Sm,0),De(km,kA,0),De($m,IA,0),De(Rs,tA,0),De(BA,$9,0),De(Tl,m4,0),De(Wa,Bm,0),De(Xm,Km,0),De(I8,vG,0);var D4=class extends xm{constructor(t,i){super(!0,t,i)}createTerminal(t,i,s){return this.createTerminalFromOptions({name:t,shellPath:i,shellArgs:s})}createTerminalFromOptions(t,i){const s=new wA(this.a,Nt(),t,t.name);return this.f.push(s),s.create(t,this.S(t,i)),s.value}};D4=__decorate([__param(0,cr),__param(1,ke)],D4);import*as D8 from"child_process";import{promises as P8}from"fs";var T8;(function(e){e[e.stdout=0]="stdout",e[e.stderr=1]="stderr"})(T8||(T8={}));var N8;(function(e){e[e.Success=0]="Success",e[e.Unknown=1]="Unknown",e[e.AccessDenied=2]="AccessDenied",e[e.ProcessNotFound=3]="ProcessNotFound"})(N8||(N8={}));function bG(e,...t){const i=t.reduce((n,o)=>(n[o]=!0,n),{}),s=[/^ELECTRON_.+$/,/^VSCODE_(?!(PORTABLE|SHELL_LOGIN|ENV_REPLACE|ENV_APPEND|ENV_PREPEND)).+$/,/^SNAP(|_.*)$/,/^GDK_PIXBUF_.+$/];Object.keys(e).filter(n=>!i[n]).forEach(n=>{for(let o=0;o<s.length;o++)if(n.search(s[o])!==-1){delete e[n];break}})}function yG(e){e&&(delete e.DEBUG,$t&&delete e.LD_PRELOAD)}function M8(e=On){return e.comspec||"cmd.exe"}function AG(e){let t=[],i=!1;const s=function(r){if(i){t.push(r);return}(!e.send(r,o=>{if(o&&console.error(o),i=!1,t.length>0){const a=t.slice(0);t=[],a.forEach(c=>s(c))}})||ze)&&(i=!0)};return{send:s}}async function SG(e){if(await nt.exists(e)){let t;try{t=await P8.stat(e)}catch(i){i.message.startsWith("EACCES")&&(t=await P8.lstat(e))}return t?!t.isDirectory():!1}return!1}async function e1(e,t,i,s=On,r=SG){if(ks(e))return await r(e)?e:void 0;if(t===void 0&&(t=Wo()),$i(e)!=="."){const c=_e(t,e);return await r(c)?c:void 0}const o=hC(s,"PATH");if(i===void 0&&Oe(o)&&(i=o.split(FE)),i===void 0||i.length===0){const c=_e(t,e);return await r(c)?c:void 0}for(const c of i){let l;if(ks(c)?l=_e(c,e):l=_e(t,c,e),ze){const h=(hC(s,"PATHEXT")||".COM;.EXE;.BAT;.CMD").split(";").map(async f=>{const p=l+f;return await r(p)?p:void 0});for(const f of h){const p=await f;if(p)return p}}if(await r(l))return l}const a=_e(t,e);return await r(a)?a:void 0}async function P4(e,t=!1){let i;if(ze){const s=process.env.WINDIR||"C:\\Windows",r=_e(s,"System32","taskkill.exe"),n=["/T"];t&&n.push("/F"),n.push("/PID",String(e)),i=D8.spawn(r,n,{stdio:["ignore","pipe","pipe"]})}else{const s=mf.asFileUri("vs/base/node/terminateProcess.sh").fsPath;i=D8.spawn("/bin/sh",[s,String(e),t?"9":"15"],{stdio:["ignore","pipe","pipe"]})}return new Promise((s,r)=>{const n=[];i.stdout.on("data",o=>n.push(o)),i.stderr.on("data",o=>n.push(o)),i.on("error",r),i.on("exit",o=>{o===0?s():r(new Error(`taskkill exited with code ${o}: ${Buffer.concat(n).toString()}`))})})}import{homedir as EG}from"os";var T4=class extends Wm{constructor(t,i,s,r,n,o,a,c,l){super(t,i,s,r,n,o,a,c),this.E=s,this.F=l,i.remote.isRemote&&i.remote.authority?this.registerTaskSystem(V.vscodeRemote,{scheme:V.vscodeRemote,authority:i.remote.authority,platform:process.platform}):this.registerTaskSystem(V.file,{scheme:V.file,authority:"",platform:process.platform}),this.a.$registerSupportedExecutions(!0,!0,!0)}async executeTask(t,i){const s=i;if(!i.execution&&s._id===void 0)throw new Error("Tasks to execute must include an execution");if(s._id!==void 0){const r=u4.from(s,this.E),n=await this.a.$getTaskExecution(r);if(n.task===void 0)throw new Error("Task from execution DTO is undefined");const o=await this.B(n,i);return this.a.$executeTask(r).catch(()=>{}),o}else{const r=Ur.from(i,t);if(r===void 0)return Promise.reject(new Error("Task is not valid"));lr.is(r.execution)&&await this.A(r,i,!1);const n=await this.B(await this.a.$getTaskExecution(r),i);return this.a.$executeTask(r).catch(()=>{}),n}}x(t,i,s,r){const n=[];if(r)for(const o of r){this.C(o,s),(!o.definition||!t[o.definition.type])&&this.f.warn(`The task [${o.source}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`);const a=Ur.from(o,s.extension);a&&(n.push(a),lr.is(a.execution)&&i.push(this.A(a,o,!0)))}return{tasks:n,extension:s.extension}}async y(t){return t}async I(t){let i=t&&t.length>0?t[0]:void 0;if(!i){const s=y.file(EG());i=new F0({uri:s,name:Li(s),index:0})}return{uri:i.uri,name:i.name,index:i.index,toResource:()=>{throw new Error("Not implemented")}}}async $resolveVariables(t,i){const s=y.revive(t),r={process:void 0,variables:Object.create(null)},n=await this.b.resolveWorkspaceFolder(s),o=await this.b.getWorkspaceFolders2()??[],a=await this.F.getResolver(),c=n?{uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}:await this.I(o);for(const l of i.variables)r.variables[l]=await a.resolveAsync(c,l);if(i.process!==void 0){let l;if(i.process.path!==void 0){l=i.process.path.split(FE);for(let p=0;p<l.length;p++)l[p]=await a.resolveAsync(c,l[p])}const u=await a.resolveAsync(c,i.process.name),h=i.process.cwd!==void 0?await a.resolveAsync(c,i.process.cwd):void 0,f=await e1(u,h,l);f?r.process=f:ks(u)?r.process=u:r.process=_e(h??"",u)}return r}async $jsonTasksSupported(){return!0}async $findExecutable(t,i,s){return e1(t,i,s)}};T4=__decorate([__param(0,ke),__param(1,jt),__param(2,Rs),__param(3,Ha),__param(4,ws),__param(5,mn),__param(6,Se),__param(7,Dl),__param(8,Wa)],T4);import*as Ml from"child_process";var Ine=H("externalTerminal"),t1="Terminal.app",L8=d(2075,null),N4=class{async getDefaultTerminalForPlatforms(){return{windows:M4.getDefaultTerminalWindows(),linux:await R8.getDefaultTerminalLinuxReady(),osx:"xterm"}}},M4=class $n extends N4{static{this.b="cmd.exe"}openTerminal(t,i){return this.spawnTerminal(Ml,t,M8(),i)}spawnTerminal(t,i,s,r){const n=i.windowsExec||$n.getDefaultTerminalWindows();r&&r[1]===":"&&(r=r[0].toUpperCase()+r.substr(1));const o=vt(n,".exe").toLowerCase();if(o==="cmder")return t.spawn(n,r?[r]:void 0),Promise.resolve(void 0);const a=["/c","start","/wait"];return n.indexOf(" ")>=0&&a.push(n),a.push(n),o==="wt"&&a.push("-d ."),new Promise((c,l)=>{const u=Ll(process),h=t.spawn(s,a,{cwd:r,env:u,detached:!0});h.on("error",l),h.on("exit",()=>c())})}async runInTerminal(t,i,s,r,n){const o=n.windowsExec||$n.getDefaultTerminalWindows(),a=await $n.f();return new Promise((c,l)=>{const u=`"${i} - ${L8}"`,h=`"${s.join('" "')}" & pause`,f=Object.assign({},Ll(process),r);Object.keys(f).filter(S=>f[S]===null).forEach(S=>delete f[S]);const p={cwd:i,env:f,windowsVerbatimArguments:!0};let g,v;vt(o,".exe")==="wt"?(g=o,v=["-d",".",$n.b,"/c",h]):a?(g=a,v=["-d",".",o,"/c",h]):(g=$n.b,v=["/c","start",u,"/wait",o,"/c",`"${h}"`]),Ml.spawn(g,v,p).on("error",S=>{l(L4(S))}),c(void 0)})}static getDefaultTerminalWindows(){if(!$n.d){const t=!!process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432");$n.d=`${process.env.windir?process.env.windir:"C:\\Windows"}\\${t?"Sysnative":"System32"}\\cmd.exe`}return $n.d}static async f(){try{return await e1("wt")}catch{return}}};__decorate([Vx],M4,"f",null);var xG=class HM extends N4{static{this.b="/usr/bin/osascript"}openTerminal(t,i){return this.spawnTerminal(Ml,t,i)}runInTerminal(t,i,s,r,n){const o=n.osxExec||t1;return new Promise((a,c)=>{if(o===t1||o==="iTerm.app"){const l=o===t1?"TerminalHelper":"iTermHelper",h=[mf.asFileUri(`vs/workbench/contrib/externalTerminal/node/${l}.scpt`).fsPath,"-t",t||L8,"-w",i];for(const g of s)h.push("-a"),h.push(g);if(r){const g=Object.assign({},Ll(process),r);for(const v in g){const b=g[v];b===null?(h.push("-u"),h.push(v)):(h.push("-e"),h.push(`${v}=${b}`))}}let f="";const p=Ml.spawn(HM.b,h);p.on("error",g=>{c(L4(g))}),p.stderr.on("data",g=>{f+=g.toString()}),p.on("exit",g=>{if(g===0)a(void 0);else if(f){const v=f.split(`
`,1);c(new Error(v[0]))}else c(new Error(d(2076,null,l,g)))})}else c(new Error(d(2077,null,o)))})}spawnTerminal(t,i,s){const r=i.osxExec||t1;return new Promise((n,o)=>{const a=["-a",r];s&&a.push(s);const c=Ll(process),l=t.spawn("/usr/bin/open",a,{cwd:s,env:c});l.on("error",o),l.on("exit",()=>n())})}},R8=class No extends N4{static{this.b=d(2078,null)}openTerminal(t,i){return this.spawnTerminal(Ml,t,i)}runInTerminal(t,i,s,r,n){const o=n.linuxExec?Promise.resolve(n.linuxExec):No.getDefaultTerminalLinuxReady();return new Promise((a,c)=>{const l=[];o.then(u=>{u.indexOf("gnome-terminal")>=0?l.push("-x"):l.push("-e"),l.push("bash"),l.push("-c");const h=`${CG(s)}; echo; read -p "${No.b}" -n1;`;l.push(`''${h}''`);const f=Object.assign({},Ll(process),r);Object.keys(f).filter(b=>f[b]===null).forEach(b=>delete f[b]);const p={cwd:i,env:f};let g="";const v=Ml.spawn(u,l,p);v.on("error",b=>{c(L4(b))}),v.stderr.on("data",b=>{g+=b.toString()}),v.on("exit",b=>{if(b===0)a(void 0);else if(g){const S=g.split(`
`,1);c(new Error(S[0]))}else c(new Error(d(2079,null,u,b)))})})})}static async getDefaultTerminalLinuxReady(){if(!No.d)if(!$t)No.d=Promise.resolve("xterm");else{const t=await nt.exists("/etc/debian_version");No.d=new Promise(i=>{t?i("x-terminal-emulator"):process.env.DESKTOP_SESSION==="gnome"||process.env.DESKTOP_SESSION==="gnome-classic"?i("gnome-terminal"):process.env.DESKTOP_SESSION==="kde-plasma"?i("konsole"):process.env.COLORTERM?i(process.env.COLORTERM):process.env.TERM?i(process.env.TERM):i("xterm")})}return No.d}spawnTerminal(t,i,s){const r=i.linuxExec?Promise.resolve(i.linuxExec):No.getDefaultTerminalLinuxReady();return new Promise((n,o)=>{r.then(a=>{const c=Ll(process),l=t.spawn(a,[],{cwd:s,env:c});l.on("error",o),l.on("exit",()=>n())})})}};function Ll(e){const t={...e.env};return bG(t),t}function L4(e){return e.errno==="ENOENT"&&e.path?new Error(d(2080,null,e.path)):e}function CG(e){let t="";for(const i of e)i.indexOf(" ")>=0?t+='"'+i+'"':t+=i,t+=" ";return t}var kG=class WM{constructor(){this.b=new Map}static{this.a=1}async createNewMessage(t){try{const i=await this.c();if(i){const s=String(WM.a++);return this.b.set(s,i),{id:s,data:i.createNewMessage(t)}}}catch{}return{id:"",data:t}}async validate(t,i){if(!t.id)return!0;const s=this.b.get(t.id);if(!s)return!1;this.b.delete(t.id);try{return s.validate(i)==="ok"}catch{return!1}finally{s.dispose?.()}}async sign(t){try{return await this.d(t)}catch{}return t}},O8=class extends kG{c(){return this.h().then(e=>new e.validator)}d(e){return this.h().then(t=>new t.signer().sign(e))}async h(){const e="vsda",{default:t}=await import(e);return t}};import*as F8 from"child_process";import*as U8 from"net";var j8=class Zl extends a8{static{this.b=`\r
\r
`}static{this.c=/\r?\n/}static{this.i=/: */}constructor(){super(),this.p=Buffer.allocUnsafe(0),this.r=-1}t(t,i){this.l=i,this.p=Buffer.allocUnsafe(0),this.r=-1,t.on("data",s=>this.v(s))}sendMessage(t){if(this.l){const i=JSON.stringify(t);this.l.write(`Content-Length: ${Buffer.byteLength(i,"utf8")}${Zl.b}${i}`,"utf8")}}v(t){for(this.p=Buffer.concat([this.p,t]);;){if(this.r>=0){if(this.p.length>=this.r){const i=this.p.toString("utf8",0,this.r);if(this.p=this.p.slice(this.r),this.r=-1,i.length>0)try{this.acceptMessage(JSON.parse(i))}catch(s){this.n.fire(new Error((s.message||s)+`
`+i))}continue}}else{const i=this.p.indexOf(Zl.b);if(i!==-1){const r=this.p.toString("utf8",0,i).split(Zl.c);for(const n of r){const o=n.split(Zl.i);o[0]==="Content-Length"&&(this.r=Number(o[1]))}this.p=this.p.slice(i+Zl.b.length);continue}}break}}},z8=class extends j8{startSession(){return new Promise((e,t)=>{let i=!1;this.x=this.y(()=>{this.t(this.x,this.x),e(),i=!0}),this.x.on("close",()=>{i?this.n.fire(new Error("connection closed")):t(new Error("connection closed"))}),this.x.on("error",s=>{s instanceof AggregateError&&(s=s.errors[0]),i?this.n.fire(s):t(s)})})}async stopSession(){await this.w(),this.x&&(this.x.end(),this.x=void 0)}},$G=class extends z8{constructor(e){super(),this.z=e}y(e){return U8.createConnection(this.z.port,this.z.host||"127.0.0.1",e)}},IG=class extends z8{constructor(e){super(),this.z=e}y(e){return U8.createConnection(this.z.path,e)}},H8=class Xa extends j8{constructor(t,i){super(),this.y=t,this.z=i}async startSession(){const t=this.y.command,i=this.y.args,s=this.y.options||{};try{if(t)if(ks(t)){if(!await nt.exists(t))throw new Error(d(7876,null,t))}else t.indexOf("/")<0&&t.indexOf("\\")<0;else throw new Error(d(7877,null,this.z));let r=process.env;if(s.env&&Object.keys(s.env).length>0&&(r=en(ot(process.env),s.env)),t==="node")if(Array.isArray(i)&&i.length>0){const n=!!process.env.ELECTRON_RUN_AS_NODE||!!process.versions.electron,o={env:r,execArgv:n?["-e","delete process.env.ELECTRON_RUN_AS_NODE;require(process.argv[1])"]:[],silent:!0};s.cwd&&(o.cwd=s.cwd);const a=F8.fork(i[0],i.slice(1),o);if(!a.pid)throw new Error(d(7878,null,i[0]));this.x=a}else throw new Error(d(7879,null));else{let n=t,o=i;const a={env:r};s.cwd&&(a.cwd=s.cwd),ze&&(t.endsWith(".bat")||t.endsWith(".cmd"))&&(a.shell=!0,n=`"${t}"`,o=i.map(c=>(c=c.replace(/"/g,'\\"'),`"${c}"`))),this.x=F8.spawn(n,o,a)}this.x.on("error",n=>{this.n.fire(n)}),this.x.on("exit",(n,o)=>{this.o.fire(n)}),this.x.stdout.on("close",()=>{this.n.fire(new Error("read error"))}),this.x.stdout.on("error",n=>{this.n.fire(n)}),this.x.stdin.on("error",n=>{this.n.fire(n)}),this.x.stderr.resume(),this.t(this.x.stdout,this.x.stdin)}catch(r){this.n.fire(r)}}async stopSession(){return this.x?(await this.w(),ze?P4(this.x.pid,!0).catch(()=>{this.x?.kill()}):(this.x.kill("SIGTERM"),Promise.resolve(void 0))):Promise.resolve(void 0)}static A(t,i){if(!t)return;const s=Object.create(null);t.runtime&&(t.runtime.indexOf("./")===0?s.runtime=_e(i,t.runtime):s.runtime=t.runtime),t.runtimeArgs&&(s.runtimeArgs=t.runtimeArgs),t.program&&(ks(t.program)?s.program=t.program:s.program=_e(i,t.program)),t.args&&(s.args=t.args);const r=t;return r.win&&(s.win=Xa.A(r.win,i)),r.winx86&&(s.winx86=Xa.A(r.winx86,i)),r.windows&&(s.windows=Xa.A(r.windows,i)),r.osx&&(s.osx=Xa.A(r.osx,i)),r.linux&&(s.linux=Xa.A(r.linux,i)),s}static platformAdapterExecutable(t,i){let s=Object.create(null);i=i.toLowerCase();for(const l of t)if(l.contributes){const u=l.contributes.debuggers;u&&u.length>0&&u.filter(h=>typeof h.type=="string"&&$s(h.type,i)).forEach(h=>{const f=Xa.A(h,l.extensionLocation.fsPath);s=en(s,f,l.isBuiltin)})}let r;ze&&!process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?r=s.winx86||s.win||s.windows:ze?r=s.win||s.windows:Pt?r=s.osx:$t&&(r=s.linux),r=r||s;const n=r.program||s.program,o=r.args||s.args,a=r.runtime||s.runtime,c=r.runtimeArgs||s.runtimeArgs;if(a)return{type:"executable",command:a,args:(c||[]).concat(typeof n=="string"?[n]:[]).concat(o||[])};if(n)return{type:"executable",command:n,args:o||[]}}};import*as DG from"child_process";function PG(e,t){return new Promise((i,s)=>{let r="";const n=DG.spawn(e,t);n.pid&&n.stdout.on("data",o=>{r+=o.toString()}),n.on("error",o=>{s(o)}),n.on("close",o=>{i(r)})})}async function TG(e){if(e)if(ze){const t=await import("@vscode/windows-process-tree");return new Promise(i=>{t.getProcessTree(e,s=>{i(!!s&&s.children.length>0)})})}else return PG("/usr/bin/pgrep",["-lP",String(e)]).then(t=>{const i=t.trim();return!(i.length===0||i.indexOf(" tmux")>=0)},t=>!0);return Promise.resolve(!0)}var W8;(function(e){e[e.cmd=0]="cmd",e[e.powershell=1]="powershell",e[e.bash=2]="bash"})(W8||(W8={}));function NG(e,t,i,s,r){e=e.trim().toLowerCase();let n;e.indexOf("powershell")>=0||e.indexOf("pwsh")>=0?n=1:e.indexOf("cmd.exe")>=0?n=0:e.indexOf("bash")>=0?n=2:ze?n=0:n=2;let o,a=" ";switch(n){case 1:if(o=c=>(c=c.replace(/\'/g,"''"),c.length>0&&c.charAt(c.length-1)==="\\"?`'${c}\\'`:`'${c}'`),s){const c=ix(s);c&&(a+=`${c}:; `),a+=`cd ${o(s)}; `}if(r)for(const c in r){const l=r[c];l===null?a+=`Remove-Item env:${c}; `:a+=`\${env:${c}}='${l}'; `}if(t.length>0){const c=t.shift(),l=i?c:o(c);a+=l[0]==="'"?`& ${l} `:`${l} `;for(const u of t)a+=u==="<"||u===">"||i?u:o(u),a+=" "}break;case 0:if(o=c=>(c=c.replace(/\"/g,'""'),c=c.replace(/([><!^&|])/g,"^$1"),' "'.split("").some(l=>c.includes(l))||c.length===0?`"${c}"`:c),s){const c=ix(s);c&&(a+=`${c}: && `),a+=`cd ${o(s)} && `}if(r){a+='cmd /C "';for(const c in r){let l=r[c];l===null?a+=`set "${c}=" && `:(l=l.replace(/[&^|<>]/g,u=>`^${u}`),a+=`set "${c}=${l}" && `)}}for(const c of t)a+=c==="<"||c===">"||i?c:o(c),a+=" ";r&&(a+='"');break;case 2:{o=l=>(l=l.replace(/(["'\\\$!><#()\[\]*&^| ;{}?`])/g,"\\$1"),l.length===0?'""':l);const c=l=>/[^\w@%\/+=,.:^-]/.test(l)?`'${l.replace(/'/g,"'\\''")}'`:l;if(s&&(a+=`cd ${o(s)} ; `),r){a+="/usr/bin/env";for(const l in r){const u=r[l];u===null?a+=` -u ${c(l)}`:a+=` ${c(`${l}=${u}`)}`}a+=" "}for(const l of t)a+=l==="<"||l===">"||i?l:o(l),a+=" ";break}}return a}var R4=class extends _m{constructor(t,i,s,r,n,o,a,c,l,u){super(t,i,s,r,a,c,l,u),this.Fb=n,this.Gb=o,this.Db=new LG}ib(t,i){return t instanceof Yc?new H8(this.lb(t),i.type):t instanceof Xc?new $G(this.mb(t)):t instanceof lh?new IG(this.nb(t)):super.ib(t,i)}vb(t,i){const s=H8.platformAdapterExecutable(i.getAllExtensionDescriptions(),t.type);if(s)return new Yc(s.command,s.args,s.options)}jb(){return new O8}async $runInTerminal(t,i){if(t.kind==="integrated"){this.Eb||(this.Eb=this.D(this.Fb.onDidCloseTerminal(g=>{this.Db.onTerminalClosed(g)})));const s=await this.ab.getConfigProvider(),r=this.Fb.getDefaultShell(!0),n=this.Fb.getDefaultShellArgs(!0),o=t.title||d(3071,null),a=JSON.stringify({shell:r,shellArgs:n});let c=await this.Db.checkout(a,o),l,u=!1;if(c)l=t.cwd;else{const g={shellPath:r,shellArgs:n,cwd:t.cwd,name:o,iconPath:new Ti("debug")};u=!0,c=this.Fb.createTerminalFromOptions(g,{isFeatureTerminal:!0,forceShellIntegration:!0,useShellEnvironment:!0}),this.Db.insert(c,a)}c.show(!0);const h=await c.processId;if(u){let g;(function(b){b[b.DataDebounce=500]="DataDebounce",b[b.MaxDelay=5e3]="MaxDelay"})(g||(g={}));const v=new ie;await new Promise(b=>{const S=v.add(new br(b,500));v.add(this.Fb.onDidWriteTerminalData(E=>{E.terminal===c&&S.schedule()})),v.add(this.Gb.onDidChangeTerminalShellIntegration(E=>{E.terminal===c&&b()})),v.add(Qv(b,5e3))}),v.dispose()}else if(c.state.isInteractedWith&&!c.shellIntegration&&(c.sendText(""),await ri(200)),s.getConfiguration("debug.terminal").get("clearBeforeReusing")){let g;if(r.indexOf("powershell")>=0||r.indexOf("pwsh")>=0||r.indexOf("cmd.exe")>=0?g="cls":r.indexOf("bash")>=0?g="clear":ze?g="cls":g="clear",c.shellIntegration){const v=new ie,b=c.shellIntegration.executeCommand(g);await new Promise(S=>{v.add(this.Gb.onDidEndTerminalShellExecution(E=>{E.execution===b&&S()})),v.add(Qv(S,500))}),v.dispose()}else c.sendText(g),await ri(200)}const f=NG(r,t.args,!!t.argsCanBeInterpretedByShell,l,t.env);c.shellIntegration?c.shellIntegration.executeCommand(f):c.sendText(f);const p=this.onDidTerminateDebugSession(g=>{g.id===i&&(this.Db.free(c),p.dispose())});return h}else if(t.kind==="external")return MG(t,await this.ab.getConfigProvider());return super.$runInTerminal(t,i)}};R4=__decorate([__param(0,ke),__param(1,Rs),__param(2,vn),__param(3,ws),__param(4,mn),__param(5,S4),__param(6,Tl),__param(7,Wa),__param(8,cr),__param(9,ud)],R4);var dd=void 0;function MG(e,t){if(!dd)if(ze)dd=new M4;else if(Pt)dd=new xG;else if($t)dd=new R8;else throw new Error("external terminals not supported on this platform");const i=t.getConfiguration("terminal");return dd.runInTerminal(e.title,e.cwd,e.args,e.env||{},i.external||{})}var LG=class BM{constructor(){this.b=new Map}static{this.a=1e3}async checkout(t,i,s=!1){const n=[...this.b.entries()].map(([o,a])=>Kr(async c=>{if(o.name!==i||a.lastUsedAt!==-1&&await TG(await o.processId))return null;const l=Date.now();return a.lastUsedAt+BM.a>l||c.isCancellationRequested?null:a.config!==t?(s&&o.dispose(),null):(a.lastUsedAt=l,o)}));return await lO(n,o=>!!o)}insert(t,i){this.b.set(t,{lastUsedAt:Date.now(),config:i})}free(t){const i=this.b.get(t);i&&(i.lastUsedAt=-1)}onTerminalClosed(t){this.b.delete(t)}},B8=new Tt(()=>{const e=Tm.Collator(void 0,{numeric:!0,sensitivity:"base"}).value;return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}}),Pne=new Tt(()=>({collator:Tm.Collator(void 0,{numeric:!0}).value})),Tne=new Tt(()=>({collator:Tm.Collator(void 0,{numeric:!0,sensitivity:"accent"}).value}));function _8(e,t,i=!1){const s=e||"",r=t||"",n=B8.value.collator.compare(s,r);return B8.value.collatorIsNumeric&&n===0&&s!==r?s<r?-1:1:n}function RG(e,t,i=!1){return i||(e=e&&e.toLowerCase(),t=t&&t.toLowerCase()),e===t?0:e<t?-1:1}function i1(e,t,i=!1){const s=e.split(St),r=t.split(St),n=s.length-1,o=r.length-1;let a,c;for(let l=0;;l++){if(a=n===l,c=o===l,a&&c)return _8(s[l],r[l],i);if(a)return-1;if(c)return 1;const u=RG(s[l],r[l],i);if(u!==0)return u}}function O4(e,t,i){const s=e.toLowerCase(),r=t.toLowerCase(),n=OG(e,t,i);if(n)return n;const o=s.endsWith(i),a=r.endsWith(i);if(o!==a)return o?-1:1;const c=_8(s,r);return c!==0?c:s.localeCompare(r)}function OG(e,t,i){const s=e.toLowerCase(),r=t.toLowerCase(),n=s.startsWith(i),o=r.startsWith(i);if(n!==o)return n?-1:1;if(n&&o){if(s.length<r.length)return-1;if(s.length>r.length)return 1}return 0}var s1=0,V8=[s1,[]];function q8(e,t,i,s){if(!e||!t)return V8;const r=e.length,n=t.length;if(r<n)return V8;const o=e.toLowerCase();return FG(t,i,n,e,o,r,s)}function FG(e,t,i,s,r,n,o){const a=[],c=[];for(let f=0;f<i;f++){const p=f*n,g=p-n,v=f>0,b=e[f],S=t[f];for(let E=0;E<n;E++){const k=E>0,j=p+E,O=j-1,Q=g+E-1,F=k?a[O]:0,B=v&&k?a[Q]:0,z=v&&k?c[Q]:0;let ue;!B&&v?ue=0:ue=UG(b,S,s,r,E,z),ue&&B+ue>=F&&(o||v||r.startsWith(t,E))?(c[j]=z+1,a[j]=B+ue):(c[j]=s1,a[j]=F)}}const l=[];let u=i-1,h=n-1;for(;u>=0&&h>=0;){const f=u*n+h;c[f]===s1||(l.push(h),u--),h--}return[a[i*n-1],l.reverse()]}function UG(e,t,i,s,r,n){let o=0;if(!jG(t,s[r]))return o;if(o+=1,n>0&&(o+=Math.min(n,3)*6+Math.max(0,n-3)*3),e===i[r]&&(o+=1),r===0)o+=8;else{const a=zG(i.charCodeAt(r-1));a?o+=a:Iu(i.charCodeAt(r))&&n===0&&(o+=2)}return o}function jG(e,t){return e===t?!0:e==="/"||e==="\\"?t==="/"||t==="\\":!1}function zG(e){switch(e){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var r1=Object.freeze({score:0}),n1=1<<18,F4=1<<17,U4=65536;function HG(e,t,i,s){const r=s.values?s.values:[s];return sn({[s.normalized]:{values:r.map(o=>({value:o.normalized,expectContiguousMatch:o.expectContiguousMatch})),label:e,description:t,allowNonContiguousMatches:i}})}function G8(e,t,i,s,r){if(!e||!t.normalized)return r1;const n=s.getItemLabel(e);if(!n)return r1;const o=s.getItemDescription(e),a=HG(n,o,i,t),c=r[a];if(c)return c;const l=WG(n,o,s.getItemPath(e),t,i);return r[a]=l,l}function WG(e,t,i,s,r){const n=!i||!s.containsPathSeparator;return i&&($t?s.pathNormalized===i:$s(s.pathNormalized,i))?{score:n1,labelMatch:[{start:0,end:e.length}],descriptionMatch:t?[{start:0,end:t.length}]:void 0}:s.values&&s.values.length>1?BG(e,t,i,s.values,n,r):J8(e,t,i,s,n,r)}function BG(e,t,i,s,r,n){let o=0;const a=[],c=[];for(const l of s){const{score:u,labelMatch:h,descriptionMatch:f}=J8(e,t,i,l,r,n);if(u===s1)return r1;o+=u,h&&a.push(...h),f&&c.push(...f)}return{score:o,labelMatch:Q8(a),descriptionMatch:Q8(c)}}function J8(e,t,i,s,r,n){if(r||!t){const[o,a]=q8(e,s.normalized,s.normalizedLowercase,n&&!s.expectContiguousMatch);if(o){const c=z0(s.normalized,e);let l;if(c){l=F4;const u=Math.round(s.normalized.length/e.length*100);l+=u}else l=U4;return{score:l+o,labelMatch:c||Z8(a)}}}if(t){let o=t;i&&(o=`${t}${St}`);const a=o.length,c=`${o}${e}`,[l,u]=q8(c,s.normalized,s.normalizedLowercase,n&&!s.expectContiguousMatch);if(l){const h=Z8(u),f=[],p=[];return h.forEach(g=>{g.start<a&&g.end>a?(f.push({start:0,end:g.end-a}),p.push({start:g.start,end:a})):g.start>=a?f.push({start:g.start-a,end:g.end-a}):p.push(g)}),{score:l,labelMatch:f,descriptionMatch:p}}}return r1}function Z8(e){const t=[];if(!e)return t;let i;for(const s of e)i&&i.end===s?i.end+=1:(i={start:s,end:s+1},t.push(i));return t}function Q8(e){const t=e.sort((r,n)=>r.start-n.start),i=[];let s;for(const r of t)!s||!_G(s,r)?(s=r,i.push(r)):(s.start=Math.min(s.start,r.start),s.end=Math.max(s.end,r.end));return i}function _G(e,t){return!(e.end<t.start||t.end<e.start)}function VG(e,t,i,s,r,n){const o=G8(e,i,s,r,n),a=G8(t,i,s,r,n),c=o.score,l=a.score;if((c===n1||l===n1)&&c!==l)return c===n1?-1:1;if(c>U4||l>U4){if(c!==l)return c>l?-1:1;if(c<F4&&l<F4){const b=qG(o.labelMatch,a.labelMatch);if(b!==0)return b}const g=r.getItemLabel(e)||"",v=r.getItemLabel(t)||"";if(g.length!==v.length)return g.length-v.length}if(c!==l)return c>l?-1:1;const u=Array.isArray(o.labelMatch)&&o.labelMatch.length>0,h=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(u&&!h)return-1;if(h&&!u)return 1;const f=Y8(e,o,r),p=Y8(t,a,r);return f&&p&&f!==p?p>f?-1:1:GG(e,t,i,r)}function Y8(e,t,i){let s=-1,r=-1;if(t.descriptionMatch?.length?s=t.descriptionMatch[0].start:t.labelMatch?.length&&(s=t.labelMatch[0].start),t.labelMatch?.length){if(r=t.labelMatch[t.labelMatch.length-1].end,t.descriptionMatch?.length){const n=i.getItemDescription(e);n&&(r+=n.length)}}else t.descriptionMatch?.length&&(r=t.descriptionMatch[t.descriptionMatch.length-1].end);return r-s}function qG(e,t){if(!e&&!t||!e?.length&&!t?.length)return 0;if(!t?.length)return-1;if(!e?.length)return 1;const i=e[0].start,r=e[e.length-1].end-i,n=t[0].start,a=t[t.length-1].end-n;return r===a?0:a<r?1:-1}function GG(e,t,i,s){const r=s.getItemLabel(e)||"",n=s.getItemLabel(t)||"",o=s.getItemDescription(e),a=s.getItemDescription(t),c=r.length+(o?o.length:0),l=n.length+(a?a.length:0);if(c!==l)return c-l;const u=s.getItemPath(e),h=s.getItemPath(t);return u&&h&&u.length!==h.length?u.length-h.length:r!==n?O4(r,n,i.normalized):o&&a&&o!==a?O4(o,a,i.normalized):u&&h&&u!==h?O4(u,h,i.normalized):0}function X8(e){return e.startsWith('"')&&e.endsWith('"')}var JG=" ";function j4(e){typeof e!="string"&&(e="");const t=e.toLowerCase(),{pathNormalized:i,normalized:s,normalizedLowercase:r}=K8(e),n=i.indexOf(St)>=0,o=X8(e);let a;const c=e.split(JG);if(c.length>1)for(const l of c){const u=X8(l),{pathNormalized:h,normalized:f,normalizedLowercase:p}=K8(l);f&&(a||(a=[]),a.push({original:l,originalLowercase:l.toLowerCase(),pathNormalized:h,normalized:f,normalizedLowercase:p,expectContiguousMatch:u}))}return{original:e,originalLowercase:t,pathNormalized:i,normalized:s,normalizedLowercase:r,values:a,containsPathSeparator:n,expectContiguousMatch:o}}function K8(e){let t;ze?t=e.replace(/\//g,St):t=e.replace(/\\/g,St);const i=t.replace(/[\*\u2026\s"]/g,"").replace(/(?<=.)#$/,"");return{pathNormalized:t,normalized:i,normalizedLowercase:i.toLowerCase()}}import*as ZG from"child_process";import*as z4 from"fs";import{StringDecoder as eP}from"string_decoder";import*as QG from"child_process";function o1(e){return e.startsWith("**")||e.startsWith("/")?e:`/${e}`}function YG(e){return new Vy(e.start.line,e.start.character,e.end.line,e.end.character)}function tP(e){return new Z7(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}var a1=class{constructor(t,i){this.a=t,this.b=i}appendLine(t){this.b.debug(`${this.a}#search`,t)}};a1=__decorate([__param(1,Se)],a1);import{rgPath as XG}from"@vscode/ripgrep";var iP=XG.replace(/\bnode_modules\.asar\b/,"node_modules.asar.unpacked");function KG(e,t,i,s,r){const n=eJ(e,t,i,s,r),o=t.folder.fsPath;return{cmd:QG.spawn(iP,n.args,{cwd:o}),rgDiskPath:iP,siblingClauses:n.siblingClauses,rgArgs:n,cwd:o}}function eJ(e,t,i,s,r){const n=["--files","--hidden","--case-sensitive","--no-require-git"];iJ([t],i,!1).forEach(a=>{const c=o1(a);if(n.push("-g",c),Pt){const l=s0(c);l!==c&&n.push("-g",l)}});const o=tJ([t],s,void 0,!1);return o.globArgs.forEach(a=>{const c=`!${o1(a)}`;if(n.push("-g",c),Pt){const l=s0(c);l!==c&&n.push("-g",l)}}),t.disregardIgnoreFiles!==!1?n.push("--no-ignore"):t.disregardParentIgnoreFiles!==!1&&n.push("--no-ignore-parent"),t.ignoreSymlinks||n.push("--follow"),e.exists&&n.push("--quiet"),r&&n.push("--threads",`${r}`),n.push("--no-config"),t.disregardGlobalIgnoreFiles&&n.push("--no-ignore-global"),{args:n,siblingClauses:o.siblingClauses}}function tJ(e,t,i,s=!0){const r=[];let n={};return e.forEach(o=>{const a=Object.assign({},o.excludePattern||{},t||{}),c=sP(a,s?o.folder.fsPath:void 0,i);r.push(...c.globArgs),c.siblingClauses&&(n=Object.assign(n,c.siblingClauses))}),{globArgs:r,siblingClauses:n}}function iJ(e,t,i=!0){const s=[];return e.forEach(r=>{const n=Object.assign({},t||{},r.includePattern||{}),o=sP(n,i?r.folder.fsPath:void 0);s.push(...o.globArgs)}),s}function sP(e,t,i){const s=[],r={};return Object.keys(e).forEach(n=>{if(i&&i.has(n)||!n)return;const o=e[n];n=rJ(t?sJ(t,n):n),n.startsWith("\\\\")?n="\\\\"+n.substr(2).replace(/\\/g,"/"):n=n.replace(/\\/g,"/"),typeof o=="boolean"&&o?(n.startsWith("\\\\")&&(n+="**"),s.push(nJ(n))):o&&o.when&&(r[n]=o)}),{globArgs:s,siblingClauses:r}}function sJ(e,t){return ks(t)?t:_e(e,t)}function rJ(e){return e=jn(e,"\\"),jn(e,"/")}function nJ(e){return _v(e).toLowerCase()==="c:/"?e.replace(/^c:[/\\]/i,"/"):e}var c1=new Set;process.on("exit",()=>{c1.forEach(e=>e())});var oJ=class{constructor(e){this.c=null,this.h=null,this.l=!1,this.m=null,this.r=null,this.s=0,this.a=e,this.b=e.filePattern||"",this.d=e.includePattern&&tr(e.includePattern),this.f=e.maxResults||null,this.g=!!e.exists,this.v=Object.create(null),this.k=0,this.j=!1,this.o=0,this.p=0,this.q=[],this.b&&(this.c=e.shouldGlobMatchFilePattern?null:j4(this.b).normalizedLowercase),this.u=e.excludePattern&&tr(e.excludePattern),this.t=new Map,e.folderQueries.forEach(t=>{const i={};t.excludePattern?.forEach(r=>{Object.assign(i,r.pattern||{},this.a.excludePattern||{})}),t.excludePattern?.length||Object.assign(i,this.a.excludePattern||{});const s=t.folder.fsPath;e.folderQueries.map(r=>r.folder.fsPath).filter(r=>r!==s).forEach(r=>{Vo(r,s)&&(i[ac(s,r)]=!0)}),this.t.set(s,new aJ(i,s))})}cancel(){this.l=!0,c1.forEach(e=>e())}walk(e,t,i,s,r,n){if(this.m=Qi.create(!1),this.l)return n(null,this.j);t.forEach(o=>{const a=vt(o.fsPath);this.u&&this.u(o.fsPath,a)||this.J(s,{relativePath:o.fsPath,searchPath:void 0})}),this.r=Qi.create(!1),this.w(e,(o,a)=>{this.x(this.y,this,o,i,s,r,c=>{if(c){const l=Sr(c);console.error(l),this.q.push(l),a(c,void 0)}else a(null,void 0)})},(o,a)=>{this.m.stop();const c=o?gt(o)[0]:null;n(c,this.j)})}w(e,t,i){const s=new Array(e.length),r=new Array(e.length);let n=!1,o=0;if(e.length===0)return i(null,[]);e.forEach((a,c)=>{t(a,(l,u)=>{if(l?(n=!0,s[c]=null,r[c]=l):(s[c]=u,r[c]=null),++o===e.length)return i(n?r:null,s)})})}x(e,t,...i){try{e.apply(t,i)}catch(s){i[i.length-1](s)}}y(e,t,i,s,r){const n=e.folder.fsPath,o=Pt,a=()=>f&&f.kill();c1.add(a);let c=b=>{c1.delete(a),c=()=>{},r(b)},l="";const u=this.D(),h=KG(this.a,e,this.a.includePattern,this.t.get(e.folder.fsPath).expression,t),f=h.cmd,p=!Object.keys(h.siblingClauses).length,g=h.rgArgs.args.map(b=>b.match(/^-/)?b:`'${b}'`).join(" ");let v=`${h.rgDiskPath} ${g}
 - cwd: ${h.cwd}`;h.rgArgs.siblingClauses&&(v+=`
 - Sibling clauses: ${JSON.stringify(h.rgArgs.siblingClauses)}`),s({message:v}),this.s=0,this.z(f,"utf8",s,(b,S,E)=>{if(b){c(b);return}if(this.j){c();return}const j=(l+(o?Ef(S||""):S)).split(`
`);if(E){const O=j.length;j[O-1]=j[O-1].trim(),j[O-1]||j.pop()}else l=j.pop()||"";if(j.length&&j[0].indexOf(`
`)!==-1){c(new Error("Splitting up files failed"));return}if(this.s+=j.length,p){for(const O of j)if(this.J(i,{base:n,relativePath:O,searchPath:this.N(e,O)}),this.j){a();break}(E||this.j)&&c();return}this.G(e,u,n,j,i),E&&(this.H(u,n,i),c())})}spawnFindCmd(e){const t=this.t.get(e.folder.fsPath),i=t.getBasenameTerms(),s=t.getPathTerms(),r=["-L","."];if(i.length||s.length){r.push("-not","(","(");for(const n of i)r.push("-name",n),r.push("-o");for(const n of s)r.push("-path",n),r.push("-o");r.pop(),r.push(")","-prune",")")}return r.push("-type","f"),ZG.spawn("find",r,{cwd:e.folder.fsPath})}readStdout(e,t,i){let s="";this.z(e,t,()=>{},(r,n,o)=>{if(r){i(r);return}s+=n,o&&i(null,s)})}z(e,t,i,s){let r=(a,c,l)=>{(a||l)&&(r=()=>{},this.r?.stop()),s(a,c,l)},n=!1;e.stdout?(this.A(e.stdout,t,r),e.stdout.once("data",()=>n=!0)):i({message:"stdout is null"});let o;e.stderr?o=this.B(e.stderr):i({message:"stderr is null"}),e.on("error",a=>{r(a)}),e.on("close",a=>{let c;!n&&(c=this.C(o,t))&&cJ(c)?r(new Error(`command failed with error code ${a}: ${this.C(o,t)}`)):(this.g&&a===0&&(this.j=!0),r(null,"",!0))})}A(e,t,i){const s=new eP(t);return e.on("data",r=>{i(null,s.write(r))}),s}B(e){const t=[];return e.on("data",i=>{t.push(i)}),t}C(e,t){const i=new eP(t);return e.map(s=>i.write(s)).join("")}D(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}G(e,{pathToEntries:t},i,s,r){s.indexOf(this.b)!==-1&&this.J(r,{base:i,relativePath:this.b,searchPath:this.N(e,this.b)});const n=o=>{const a=vt(o),c=$i(o);let l=t[c];l||(l=t[c]=[],n(c)),l.push({base:i,relativePath:o,basename:a,searchPath:this.N(e,o)})};s.forEach(n)}H({rootEntries:e,pathToEntries:t},i,s){const r=this,n=this.t.get(i),o=this.b;function a(c){r.o++;const l=Gy(()=>c.map(u=>u.basename));for(let u=0,h=c.length;u<h;u++){const f=c[u],{relativePath:p,basename:g}=f;if(n.test(p,g,o!==g?l:void 0))continue;const v=t[p];if(v)a(v);else{if(r.p++,p===o)continue;r.J(s,f)}if(r.j)break}}a(e)}getStats(){return{cmdTime:this.r.elapsed(),fileWalkTime:this.m.elapsed(),directoriesWalked:this.o,filesWalked:this.p,cmdResultCount:this.s}}I(e,t,i,s,r){const n=e.folder,o=Gy(()=>i);this.w(i,(a,c)=>{if(this.l||this.j)return c(null);const l=t?[t,a].join(St):a;if(this.t.get(e.folder.fsPath).test(l,a,this.a.filePattern!==a?o:void 0))return c(null);const u=[n.fsPath,l].join(St);z4.lstat(u,(h,f)=>{if(h||this.l||this.j)return c(null);this.L(u,f,(p,g)=>p||this.l||this.j?c(null):g.isDirectory()?(this.o++,this.M(u,f,(v,b)=>v||this.l||this.j||(b=b||"",this.v[b])?c(null):(this.v[b]=!0,nt.readdir(u).then(S=>{if(this.l||this.j)return c(null);this.I(e,l,S,s,E=>c(E||null))},S=>{c(null)})))):(this.p++,l===this.b||this.h&&Cs(g.size)&&g.size>this.h||this.J(s,{base:n.fsPath,relativePath:l,searchPath:this.N(e,l)}),c(null,void 0)))})},a=>{const c=a&&gt(a);return r(c&&c.length>0?c[0]:void 0)})}J(e,t){this.K(t)&&(!this.d||this.d(t.relativePath,vt(t.relativePath)))&&(this.k++,(this.g||this.f&&this.k>this.f)&&(this.j=!0),this.j||e(t))}K(e){if(this.b){if(this.b==="*")return!0;if(this.c)return qy(e,this.c);if(this.b)return qy(e,this.b,!1)}return!0}L(e,t,i){return t.isSymbolicLink()?z4.stat(e,i):i(null,t)}M(e,t,i){return t.isSymbolicLink()?z4.realpath(e,(s,r)=>s?i(s):i(null,r)):i(null,e)}N(e,t){return e.folderName?_e(e.folderName,t):t}},rP=class{constructor(e,t){this.a=e.folderQueries,this.b=e.extraFileResources||[],this.d=t,this.c=new oJ(e)}search(e,t,i){this.c.walk(this.a,this.b,this.d,e,t,(s,r)=>{i(s,{limitHit:r,stats:this.c.getStats(),messages:[]})})}cancel(){this.c.cancel()}},aJ=class{constructor(e,t){this.expression=e,this.c=t,this.d(e)}d(e){let t,i;Object.keys(e).filter(s=>e[s]).forEach(s=>{ks(s)?(t=t||zI(),t[s]=e[s]):(i=i||zI(),i[s]=e[s])}),this.a=t&&tr(t,{trimForExclusions:!0}),this.b=i&&tr(i,{trimForExclusions:!0})}test(e,t,i){return this.b&&this.b(e,t,i)||this.a&&this.a(_e(this.c,e),t,i)}getBasenameTerms(){const e=[];return this.a&&e.push(...GI(this.a)),this.b&&e.push(...GI(this.b)),e}getPathTerms(){const e=[];return this.a&&e.push(...JI(this.a)),this.b&&e.push(...JI(this.b)),e}};function cJ(e){const t=e.trim().split(`
`),i=t[0].trim();if(i.startsWith("Error parsing regex"))return i;if(i.startsWith("regex parse error"))return I2(t[t.length-1].trim());if(i.startsWith("error parsing glob")||i.startsWith("unsupported encoding"))return i.charAt(0).toUpperCase()+i.substr(1);if(i==="Literal '\\n' not allowed.")return"Literal '\\n' currently not supported";if(i.startsWith("Literal "))return i}import*as lJ from"child_process";import{EventEmitter as uJ}from"events";import{StringDecoder as hJ}from"string_decoder";import{RegExpParser as dJ,RegExpVisitor as fJ}from"vscode-regexpp";import{rgPath as pJ}from"@vscode/ripgrep";var nP=pJ.replace(/\bnode_modules\.asar\b/,"node_modules.asar.unpacked"),oP=class{constructor(e,t){this.a=e,this.b=t}provideTextSearchResults(e,t,i,s){return Promise.all(t.folderOptions.map(r=>{const n={folderOptions:r,numThreads:this.b,maxResults:t.maxResults,previewOptions:t.previewOptions,maxFileSize:t.maxFileSize,surroundingContext:t.surroundingContext};return this.provideTextSearchResultsWithRgOptions(e,n,i,s)})).then(r=>({limitHit:r.some(o=>!!o&&o.limitHit)}))}provideTextSearchResultsWithRgOptions(e,t,i,s){return this.a.appendLine(`provideTextSearchResults ${e.pattern}, ${JSON.stringify({...t,folder:t.folderOptions.folder.toString()})}`),e.pattern?new Promise((r,n)=>{s.onCancellationRequested(()=>g());const o={...t,numThreads:this.b},a=wJ(e,o),c=t.folderOptions.folder.fsPath,l=a.map(k=>k.match(/^-/)?k:`'${k}'`).join(" ");this.a.appendLine(`${nP} ${l}
 - cwd: ${c}`);let u=lJ.spawn(nP,a,{cwd:c});u.on("error",k=>{console.error(k),this.a.appendLine("Error: "+(k&&k.message)),n(oD(new Fa(k&&k.message,Ao.rgProcessError)))});let h=!1;const f=new vJ(t.maxResults??cm,t.folderOptions.folder,b8(t.previewOptions));f.on("result",k=>{h=!0,b="",i.report(k)});let p=!1;const g=()=>{p=!0,u?.kill(),f?.cancel()};let v=!1;f.on("hitLimit",()=>{v=!0,g()});let b="";u.stdout.on("data",k=>{f.handleData(k),h||(b+=k)});let S=!1;u.stdout.once("data",()=>S=!0);let E="";u.stderr.on("data",k=>{const j=k.toString();this.a.appendLine(j),E.length+j.length<1e6&&(E+=j)}),u.on("close",()=>{if(this.a.appendLine(S?"Got data from stdout":"No data from stdout"),this.a.appendLine(h?"Got result from parser":"No result from parser"),b&&this.a.appendLine(`Got data without result: ${b}`),this.a.appendLine(""),p)r({limitHit:v});else{f.flush(),u=null;let k;E&&!S&&(k=gJ(E))?n(oD(new Fa(k.message,k.code))):r({limitHit:v})}})}):Promise.resolve({limitHit:!1})}};function gJ(e){const t=e.split(`
`),i=t[0].trim();if(t.some(r=>r.startsWith("regex parse error")))return new Fa(mJ(t),Ao.regexParseError);const s=i.match(/grep config error: unknown encoding: (.*)/);if(s)return new Fa(`Unknown encoding: ${s[1]}`,Ao.unknownEncoding);if(i.startsWith("error parsing glob"))return new Fa(i.charAt(0).toUpperCase()+i.substr(1),Ao.globParseError);if(i.startsWith("the literal"))return new Fa(i.charAt(0).toUpperCase()+i.substr(1),Ao.invalidLiteral);if(i.startsWith("PCRE2: error compiling pattern"))return new Fa(i,Ao.regexParseError)}function mJ(e){const t=["Regex parse error"],i=e.filter(s=>s.startsWith("PCRE2:"));if(i.length>=1){const s=i[0].replace("PCRE2:","");if(s.indexOf(":")!==-1&&s.split(":").length>=2){const r=s.split(":")[1];t.push(":"+r)}}return t.join("")}var vJ=class extends uJ{constructor(e,t,i){super(),this.g=e,this.h=t,this.j=i,this.a="",this.b=!1,this.c=!1,this.f=0,this.d=new hJ}cancel(){this.b=!0}flush(){this.k(this.d.end())}on(e,t){return super.on(e,t),this}handleData(e){if(this.b)return;const t=typeof e=="string"?e:this.d.write(e);this.k(t)}k(e){let t=e.indexOf(`
`);const i=this.a+e;if(t>=0)t+=this.a.length;else{this.a=i;return}let s=0;for(;t>=0;)this.m(i.substring(s,t).trim()),s=t+1,t=i.indexOf(`
`,s);this.a=i.substring(s)}m(e){if(this.b||!e)return;let t;try{t=JSON.parse(e)}catch{throw new Error(`malformed line from rg: ${e}`)}if(t.type==="match"){const i=fd(t.data.path),s=y.joinPath(this.h,i),r=this.n(t.data,s);this.p(r),this.c&&(this.cancel(),this.emit("hitLimit"))}else if(t.type==="context"){const i=fd(t.data.path),s=y.joinPath(this.h,i);this.o(t.data,s).forEach(n=>this.p(n))}}n(e,t){const i=e.line_number-1,s=fd(e.lines),r=Buffer.from(s);let n=0,o=0,a=i;e.submatches.length===0&&e.submatches.push(s.length?{start:0,end:1,match:{text:s[0]}}:{start:0,end:0,match:{text:""}});const c=gt(e.submatches.map((h,f)=>{if(this.c)return null;this.f++,this.f>=this.g&&(this.c=!0);const p=fd(h.match),g=r.slice(n,h.start).toString(),v=aP(g),b=v.numLines>0?v.lastLineLength:v.lastLineLength+o,S=aP(p),E=v.numLines+a,k=S.numLines+E,j=S.numLines>0?S.lastLineLength:S.lastLineLength+b;return n=h.end,o=j,a=k,new Z7(E,b,k,j)})),l=Xd(c,YG),u=new tD(s,l,this.j);return new fn(t,u.rangeLocations.map(h=>({sourceRange:tP(h.source),previewRange:tP(h.preview)})),u.previewText)}o(e,t){const i=fd(e.lines),s=e.line_number;return i.replace(/\r?\n$/,"").split(`
`).map((r,n)=>new om(t,r,s+n))}p(e){this.emit("result",e)}};function fd(e){return e.bytes?Buffer.from(e.bytes,"base64").toString():e.text}function aP(e){const t=/\n/g;let i=0,s=-1,r;for(;r=t.exec(e);)i++,s=r.index;const n=s>=0?e.length-s-1:e.length;return{numLines:i,lastLineLength:n}}function wJ(e,t){const i=["--hidden","--no-require-git"];i.push(e.isCaseSensitive?"--case-sensitive":"--ignore-case");const{doubleStarIncludes:s,otherIncludes:r}=wv(t.folderOptions.includes,o=>o.startsWith("**")?"doubleStarIncludes":"otherIncludes");if(r&&r.length){const o=new Set;r.forEach(a=>{o.add(a)}),i.push("-g","!*"),o.forEach(a=>{bJ(a).map(o1).forEach(c=>{i.push("-g",c)})})}s&&s.length&&s.forEach(o=>{i.push("-g",o)}),t.folderOptions.excludes.map(o=>typeof o=="string"?o:o.pattern).map(o1).forEach(o=>i.push("-g",`!${o}`)),t.maxFileSize&&i.push("--max-filesize",t.maxFileSize+""),t.folderOptions.useIgnoreFiles.local?t.folderOptions.useIgnoreFiles.parent||i.push("--no-ignore-parent"):i.push("--no-ignore"),t.folderOptions.followSymlinks&&i.push("--follow"),t.folderOptions.encoding&&t.folderOptions.encoding!=="utf8"&&i.push("--encoding",t.folderOptions.encoding),t.numThreads&&i.push("--threads",`${t.numThreads}`),e.pattern==="--"&&(e.isRegExp=!0,e.pattern="\\-\\-"),e.isMultiline&&!e.isRegExp&&(e.pattern=Un(e.pattern),e.isRegExp=!0),t.usePCRE2&&i.push("--pcre2"),i.push("--crlf"),e.isRegExp&&(e.pattern=yJ(e.pattern),i.push("--engine","auto"));let n;if(e.isWordMatch){const a=jE(e.pattern,!!e.isRegExp,{wholeWord:e.isWordMatch}).source.replace(/\\\//g,"/");i.push("--regexp",a)}else if(e.isRegExp){let o=AJ(e.pattern);o=SJ(o),i.push("--regexp",o)}else n=e.pattern,i.push("--fixed-strings");return i.push("--no-config"),t.folderOptions.useIgnoreFiles.global||i.push("--no-ignore-global"),i.push("--json"),e.isMultiline&&i.push("--multiline"),t.surroundingContext&&(i.push("--before-context",t.surroundingContext+""),i.push("--after-context",t.surroundingContext+"")),i.push("--"),n&&i.push(n),i.push("."),i}function bJ(e){return lP(e).flatMap(i=>{const s=Dc(i,"/");return s.map((r,n)=>s.slice(0,n+1).join("/"))})}function yJ(e){const t=/((?:[^\\]|^)(?:\\\\)*)\\u([a-z0-9]{4})/gi;for(;e.match(t);)e=e.replace(t,"$1\\x{$2}");const i=/((?:[^\\]|^)(?:\\\\)*)\\u\{([a-z0-9]{4})\}/gi;for(;e.match(i);)e=e.replace(i,"$1\\x{$2}");return e}var cP=e=>e.type==="Assertion"&&e.kind==="lookbehind";function AJ(e){let t;try{t=new dJ().parsePattern(e)}catch{return e}let i="",s=0;const r=(a,c,l)=>{i+=e.slice(s,a)+l,s=c},n=[];return new fJ({onCharacterEnter(a){if(a.raw!=="\\n")return;const c=n[0];if(!c)r(a.start,a.end,"\\r?\\n");else if(!n.some(cP))if(c.type==="CharacterClass")if(c.negate){const l=e.slice(c.start+2,a.start)+e.slice(a.end,c.end-1);c.parent?.type==="Quantifier"?r(c.start,c.end,l?`[^${l}]`:"."):r(c.start,c.end,"(?!\\r?\\n"+(l?`|[${l}]`:"")+")")}else{const l=e.slice(c.start+1,a.start)+e.slice(a.end,c.end-1);r(c.start,c.end,l===""?"\\r?\\n":`(?:[${l}]|\\r?\\n)`)}else c.type==="Quantifier"&&r(a.start,a.end,"(?:\\r?\\n)")},onQuantifierEnter(a){n.unshift(a)},onQuantifierLeave(){n.shift()},onCharacterClassRangeEnter(a){n.unshift(a)},onCharacterClassRangeLeave(){n.shift()},onCharacterClassEnter(a){n.unshift(a)},onCharacterClassLeave(){n.shift()},onAssertionEnter(a){cP(a)&&n.push(a)},onAssertionLeave(a){n[0]===a&&n.shift()}}).visit(t),i+=e.slice(s),i}function SJ(e){return e.replace(/\n/g,"\\r?\\n")}function EJ(e){let t=!1,i=!1,s="",r="";for(let n=0;n<e.length;n++){const o=e[n];switch(o){case"\\":i?(t?r+="\\"+o:s+="\\"+o,i=!1):i=!0;break;case"{":if(i)t?r+=o:s+=o,i=!1;else{if(t)return{strInBraces:s+"{"+r+"{"+e.substring(n+1)};t=!0}break;case"}":if(i)t?r+=o:s+=o,i=!1;else{if(t)return{fixedStart:s,strInBraces:r,fixedEnd:e.substring(n+1)};s+=o}break;default:t?r+=(i?"\\":"")+o:s+=(i?"\\":"")+o,i=!1;break}}return{strInBraces:s+(t?"{"+r:"")}}function lP(e){const{fixedStart:t,strInBraces:i,fixedEnd:s}=EJ(e);if(t===void 0||s===void 0)return[i];let r=Dc(i,",");r.length||(r=[""]);const n=lP(s);return r.flatMap(o=>{const a=t+o;return n.map(c=>a+c)})}var uP=class extends y4{constructor(e,t,i=Sf,s="searchProcess"){super({query:e,provider:t},{readdir:r=>i.Promises.readdir(r.fsPath),toCanonicalName:r=>e_(r)},s)}},xJ=class{constructor(e,t){this.a=e,this.b=t}search(e,t,i){if((!this.a.folderQueries||!this.a.folderQueries.length)&&(!this.a.extraFileResources||!this.a.extraFileResources.length))return Promise.resolve({type:"success",limitHit:!1,stats:{type:"searchProcess"},messages:[]});const s={appendLine(n){i({message:n})}},r=new uP(this.a,new oP(s,this.b),Sf);return new Promise((n,o)=>r.search(a=>{t(a.map(CJ))},e).then(a=>n({limitHit:a.limitHit??!1,type:"success",stats:a.stats,messages:[]}),o))}};function CJ(e){return{path:e.resource&&e.resource.fsPath,results:e.results,numMatches:(e.results||[]).reduce((t,i)=>_y(i)?t+i.rangeLocations.length:t+1,0)}}var kJ=class lv{static{this.a=512}constructor(t="searchProcess",i){this.d=t,this.f=i,this.b=Object.create(null)}fileSearch(t){let i;const s=hP(t),r=new I({onDidAddFirstListener:()=>{i=Kr(async n=>{const o=await this.f?.();return this.doFileSearchWithEngine(rP,s,a=>r.fire(a),n,lv.a,o)}),i.then(n=>r.fire(n),n=>r.fire({type:"error",error:{message:n.message,stack:n.stack}}))},onDidRemoveLastListener:()=>{i.cancel()}});return r.event}textSearch(t){let i;const s=hP(t),r=new I({onDidAddFirstListener:()=>{i=Kr(n=>this.g(s,o=>r.fire(o),n)),i.then(n=>r.fire(n),n=>r.fire({type:"error",error:{message:n.message,stack:n.stack}}))},onDidRemoveLastListener:()=>{i.cancel()}});return r.event}async g(t,i,s){t.maxFileSize=this.h().maxFileSize;const r=await this.f?.();return new xJ(t,r).search(s,i,i)}h(){return{maxFileSize:16*R$.GB}}doFileSearch(t,i,s,r){return this.doFileSearchWithEngine(rP,t,s,r,lv.a,i)}doFileSearchWithEngine(t,i,s,r,n=lv.a,o){let a=0;const c=u=>{Array.isArray(u)?(a+=u.length,s(u.map(h=>this.j(h)))):u.relativePath?(a++,s(this.j(u))):s(u)};if(i.sortByScore){let u=this.n(i,c,r);if(!u){const h=i.maxResults?Object.assign({},i,{maxResults:null}):i,f=new t(h,o);u=this.k(f,i,s,c,r)}return new Promise((h,f)=>{u.then(([p,g])=>{const v=g.map(b=>this.j(b));this.q(v,s,n),h(p)},f)})}const l=new t(i,o);return this.s(l,c,n,r).then(u=>({limitHit:u.limitHit,type:"success",stats:{detailStats:u.stats,type:this.d,fromCache:!1,resultCount:a,sortingTime:void 0},messages:[]}))}j(t){return{path:t.base?_e(t.base,t.relativePath):t.relativePath}}k(t,i,s,r,n){const o=new I;let a=Kr(l=>{let u=[];const h=f=>{Array.isArray(f)?u=f:(r(f),o.fire(f))};return this.s(t,h,-1,l).then(f=>[f,u])}),c;if(i.cacheKey){c=this.l(i.cacheKey);const l={promise:a,event:o.event,resolved:!1};c.resultsToSearchCache[i.filePattern||""]=l,a.then(()=>{l.resolved=!0},u=>{delete c.resultsToSearchCache[i.filePattern||""]}),a=this.t(a)}return a.then(([l,u])=>{const h=c?c.scorerCache:Object.create(null),f=(typeof i.maxResults!="number"||i.maxResults>0)&&Qi.create(!1);return this.o(i,u,h,n).then(p=>{const g=f?f.elapsed():-1;return[{type:"success",stats:{detailStats:l.stats,sortingTime:g,fromCache:!1,type:this.d,resultCount:p.length},messages:l.messages,limitHit:l.limitHit||typeof i.maxResults=="number"&&u.length>i.maxResults},p]})})}l(t){const i=this.b[t];return i||(this.b[t]=new $J)}n(t,i,s){const r=t.cacheKey&&this.b[t.cacheKey];if(!r)return;const n=this.r(r,t.filePattern||"",i,s);if(n)return n.then(([o,a,c])=>{const l=Qi.create(!1);return this.o(t,a,r.scorerCache,s).then(u=>{const h=l.elapsed(),f={fromCache:!0,detailStats:c,type:this.d,resultCount:a.length,sortingTime:h};return[{type:"success",limitHit:o.limitHit||typeof t.maxResults=="number"&&a.length>t.maxResults,stats:f,messages:[]},u]})})}o(t,i,s,r){const n=j4(t.filePattern||""),o=(c,l)=>VG(c,l,n,!0,IJ,s),a=typeof t.maxResults=="number"?t.maxResults:cm;return eR(i,o,a,1e4,r)}q(t,i,s){if(s&&s>0)for(let r=0;r<t.length;r+=s)i(t.slice(r,r+s));else i(t)}r(t,i,s,r){const n=Qi.create(!1),o=i.indexOf(St)>=0;let a;for(const h in t.resultsToSearchCache)if(i.startsWith(h)){if(o&&h.indexOf(St)<0&&h!=="")continue;const f=t.resultsToSearchCache[h];a={promise:this.t(f.promise),event:f.event,resolved:f.resolved};break}if(!a)return null;const c=n.elapsed(),l=Qi.create(!1),u=a.event(s);return r&&r.onCancellationRequested(()=>{u.dispose()}),a.promise.then(([h,f])=>{if(r&&r.isCancellationRequested)throw ru();const p=[],g=j4(i).normalizedLowercase;for(const v of f)qy(v,g)&&p.push(v);return[h,p,{cacheWasResolved:a.resolved,cacheLookupTime:c,cacheFilterTime:l.elapsed(),cacheEntryCount:f.length}]})}s(t,i,s,r){return new Promise((n,o)=>{let a=[];r?.onCancellationRequested(()=>t.cancel()),t.search(c=>{c&&(s?(a.push(c),s>0&&a.length>=s&&(i(a),a=[])):i(c))},c=>{i(c)},(c,l)=>{a.length&&i(a),c?(i({message:"Search finished. Error: "+c.message}),o(c)):(i({message:"Search finished. Stats: "+JSON.stringify(l.stats)}),n(l))})})}clearCache(t){return delete this.b[t],Promise.resolve(void 0)}t(t){return new class{get[Symbol.toStringTag](){return this.toString()}cancel(){}then(i,s){return t.then(i,s)}catch(i){return this.then(void 0,i)}finally(i){return t.finally(i)}}}},$J=class{constructor(){this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null)}},IJ=new class{getItemLabel(e){return vt(e.relativePath)}getItemDescription(e){return $i(e.relativePath)}getItemPath(e){return e.relativePath}};function hP(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(DJ),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function DJ(e){return Zt(e)}var dP=class{constructor(e,t){this.b=e,this.c=t,this.a=new Set,process.once("exit",()=>this.f())}async provideTextSearchResults(e,t,i,s){const r=await this.c(),n=new oP(this.b,r);return Promise.all(t.folderOptions.map(o=>{const a={folderOptions:o,numThreads:r,maxResults:t.maxResults,previewOptions:t.previewOptions,maxFileSize:t.maxFileSize,surroundingContext:t.surroundingContext};if(o.folder.scheme===V.vscodeUserData){const c={...a,folder:o.folder.with({scheme:V.file})},l=new Cm(u=>i.report({...u,uri:u.uri.with({scheme:o.folder.scheme})}));return this.d(s,u=>n.provideTextSearchResultsWithRgOptions(e,c,l,u))}else return this.d(s,c=>n.provideTextSearchResultsWithRgOptions(e,a,i,c))})).then(o=>({limitHit:o.some(c=>!!c&&c.limitHit)}))}async d(e,t){const i=PJ(e);this.a.add(i);const s=await t(i.token);return this.a.delete(i),s}f(){this.a.forEach(e=>e.cancel())}};function PJ(e){const t=new Qe;return e.onCancellationRequested(()=>t.cancel()),t}var H4=class extends Vm{constructor(t,i,s,r,n){super(t,s,n),this.E=r,this.x=Sf,this.y=-1,this.z=null,this.A=!1,this.C=new ie,this.D=!1,this.getNumThreads=this.getNumThreads.bind(this),this.getNumThreadsCached=this.getNumThreadsCached.bind(this),this.F=this.F.bind(this);const o=new a1("RipgrepSearchUD",this.s);this.C.add(this.registerTextSearchProvider(V.vscodeUserData,new dP(o,this.getNumThreadsCached))),i.remote.isRemote&&i.remote.authority&&this.G(),r.getConfigProvider().then(a=>{this.D||this.C.add(a.onDidChangeConfiguration(this.F))})}F(t){t.affectsConfiguration("search")&&(this.B=void 0)}async getNumThreads(){return(await this.E.getConfigProvider()).getConfiguration("search").get("ripgrep.maxThreads")}async getNumThreadsCached(){return this.B||(this.B=this.getNumThreads()),this.B}dispose(){this.D=!0,this.C.dispose()}$enableExtensionHostSearch(){this.G()}G(){if(this.A)return;this.A=!0;const t=new a1("RipgrepSearchEH",this.s);this.C.add(this.registerTextSearchProvider(V.file,new dP(t,this.getNumThreadsCached))),this.C.add(this.H(V.file,new kJ("fileSearchProvider",this.getNumThreadsCached)))}H(t,i){const s=this.e++;return this.z=i,this.y=s,this.c.$registerFileSearchProvider(s,this.t(t)),te(()=>{this.z=null,this.c.$unregisterProvider(s)})}$provideFileSearchResults(t,i,s,r){const n=qm(s);if(t===this.y){const o=Date.now();return this.I(t,i,n,r).then(a=>{const c=Date.now()-o;return this.s.debug(`Ext host file search time: ${c}ms`),a})}return super.$provideFileSearchResults(t,i,s,r)}async doInternalFileSearchWithCustomCallback(t,i,s){const r=o=>{if(MB(o)&&(o=[o]),Array.isArray(o)){s(o.map(a=>y.file(a.path)));return}o.message&&this.s.debug("ExtHostSearch",o.message)};if(!this.z)throw new Error("No internal file search handler");const n=await this.getNumThreadsCached();return this.z.doFileSearch(t,n,r,i)}async I(t,i,s,r){return this.doInternalFileSearchWithCustomCallback(s,r,n=>{this.c.$handleFileMatch(t,i,n)})}$clearCache(t){return this.z?.clearCache(t),super.$clearCache(t)}v(t,i){return new uP(t,i,void 0,"textSearchProvider")}};H4=__decorate([__param(0,ke),__param(1,jt),__param(2,Cu),__param(3,ws),__param(4,Se)],H4);function fP(e,t,i,s,r,n){if(Array.isArray(e)){let o=0;for(const a of e){const c=fP(a,t,i,s,r,n);if(c===10)return c;c>o&&(o=c)}return o}else{if(typeof e=="string")return s?e==="*"?5:e===i?10:0:0;if(e){const{language:o,pattern:a,scheme:c,hasAccessToAllModels:l,notebookType:u}=e;if(!s&&!l)return 0;u&&r&&(t=r);let h=0;if(c)if(c===t.scheme)h=10;else if(c==="*")h=5;else return 0;if(o)if(o===i)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(u)if(u===n)h=10;else if(u==="*"&&n!==void 0)h=Math.max(h,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:Xr(a.base)},f===t.fsPath||ua(f,t.fsPath))h=10;else return 0}return h}else return 0}}function pP(e){return typeof e=="string"?!1:Array.isArray(e)?e.some(pP):!!e.notebookType}var W4;(function(e){e[e.None=0]="None",e[e.Indent=1]="Indent",e[e.IndentOutdent=2]="IndentOutdent",e[e.Outdent=3]="Outdent"})(W4||(W4={}));var zne=H("editSessionIdentityService"),B4;(function(e){e[e.Complete=100]="Complete",e[e.Partial=50]="Partial",e[e.None=0]="None"})(B4||(B4={}));var Hne=new C("debugType",void 0,{type:"string",description:d(7738,null)}),Wne=new C("debugConfigurationType",void 0,{type:"string",description:d(7739,null)}),Bne=new C("debugState","inactive",{type:"string",description:d(7740,null)}),TJ="debugUx",_ne=new C(TJ,"default",{type:"string",description:d(7741,null)}),Vne=new C("hasDebugged",!1,{type:"boolean",description:d(7742,null)}),qne=new C("inDebugMode",!1,{type:"boolean",description:d(7743,null)}),Gne=new C("inDebugRepl",!1,{type:"boolean",description:d(7744,null)}),Jne=new C("breakpointWidgetVisible",!1,{type:"boolean",description:d(7745,null)}),Zne=new C("inBreakpointWidget",!1,{type:"boolean",description:d(7746,null)}),Qne=new C("breakpointsFocused",!0,{type:"boolean",description:d(7747,null)}),Yne=new C("watchExpressionsFocused",!0,{type:"boolean",description:d(7748,null)}),Xne=new C("watchExpressionsExist",!1,{type:"boolean",description:d(7749,null)}),Kne=new C("variablesFocused",!0,{type:"boolean",description:d(7750,null)}),eoe=new C("expressionSelected",!1,{type:"boolean",description:d(7751,null)}),toe=new C("breakpointInputFocused",!1,{type:"boolean",description:d(7752,null)}),ioe=new C("callStackItemType",void 0,{type:"string",description:d(7753,null)}),soe=new C("callStackSessionIsAttach",!1,{type:"boolean",description:d(7754,null)}),roe=new C("callStackItemStopped",!1,{type:"boolean",description:d(7755,null)}),noe=new C("callStackSessionHasOneThread",!1,{type:"boolean",description:d(7756,null)}),ooe=new C("callStackFocused",!0,{type:"boolean",description:d(7757,null)}),aoe=new C("watchItemType",void 0,{type:"string",description:d(7758,null)}),coe=new C("canViewMemory",void 0,{type:"boolean",description:d(7759,null)}),loe=new C("breakpointItemType",void 0,{type:"string",description:d(7760,null)}),uoe=new C("breakpointItemBytes",void 0,{type:"boolean",description:d(7761,null)}),hoe=new C("breakpointHasModes",!1,{type:"boolean",description:d(7762,null)}),doe=new C("breakpointSupportsCondition",!1,{type:"boolean",description:d(7763,null)}),foe=new C("loadedScriptsSupported",!1,{type:"boolean",description:d(7764,null)}),poe=new C("loadedScriptsItemType",void 0,{type:"string",description:d(7765,null)}),goe=new C("focusedSessionIsAttach",!1,{type:"boolean",description:d(7766,null)}),moe=new C("focusedSessionIsNoDebug",!1,{type:"boolean",description:d(7767,null)}),voe=new C("stepBackSupported",!1,{type:"boolean",description:d(7768,null)}),woe=new C("restartFrameSupported",!1,{type:"boolean",description:d(7769,null)}),boe=new C("stackFrameSupportsRestart",!1,{type:"boolean",description:d(7770,null)}),yoe=new C("jumpToCursorSupported",!1,{type:"boolean",description:d(7771,null)}),Aoe=new C("stepIntoTargetsSupported",!1,{type:"boolean",description:d(7772,null)}),Soe=new C("breakpointsExist",!1,{type:"boolean",description:d(7773,null)}),Eoe=new C("debuggersAvailable",!1,{type:"boolean",description:d(7774,null)}),xoe=new C("debugExtensionAvailable",!0,{type:"boolean",description:d(7775,null)}),Coe=new C("debugProtocolVariableMenuContext",void 0,{type:"string",description:d(7776,null)}),koe=new C("debugSetVariableSupported",!1,{type:"boolean",description:d(7777,null)}),$oe=new C("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:d(7778,null)}),Ioe=new C("debugSetExpressionSupported",!1,{type:"boolean",description:d(7779,null)}),Doe=new C("breakWhenValueChangesSupported",!1,{type:"boolean",description:d(7780,null)}),Poe=new C("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:d(7781,null)}),Toe=new C("breakWhenValueIsReadSupported",!1,{type:"boolean",description:d(7782,null)}),Noe=new C("terminateDebuggeeSupported",!1,{type:"boolean",description:d(7783,null)}),Moe=new C("suspendDebuggeeSupported",!1,{type:"boolean",description:d(7784,null)}),Loe=new C("terminateThreadsSupported",!1,{type:"boolean",description:d(7785,null)}),Roe=new C("variableEvaluateNamePresent",!1,{type:"boolean",description:d(7786,null)}),Ooe=new C("variableIsReadonly",!1,{type:"boolean",description:d(7787,null)}),Foe=new C("variableValue",!1,{type:"string",description:d(7788,null)}),Uoe=new C("variableType",!1,{type:"string",description:d(7789,null)}),joe=new C("variableInterfaces",!1,{type:"array",description:d(7790,null)}),zoe=new C("variableName",!1,{type:"string",description:d(7791,null)}),Hoe=new C("variableLanguage",!1,{type:"string",description:d(7792,null)}),Woe=new C("variableExtensionId",!1,{type:"string",description:d(7793,null)}),Boe=new C("exceptionWidgetVisible",!1,{type:"boolean",description:d(7794,null)}),_oe=new C("multiSessionRepl",!1,{type:"boolean",description:d(7795,null)}),Voe=new C("multiSessionDebug",!1,{type:"boolean",description:d(7796,null)}),qoe=new C("disassembleRequestSupported",!1,{type:"boolean",description:d(7797,null)}),Goe=new C("disassemblyViewFocus",!1,{type:"boolean",description:d(7798,null)}),Joe=new C("languageSupportsDisassembleRequest",!1,{type:"boolean",description:d(7799,null)}),Zoe=new C("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:d(7800,null)}),Qoe={enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart"],default:"openOnFirstSessionStart",description:d(7802,null)},gP;(function(e){e[e.Inactive=0]="Inactive",e[e.Initializing=1]="Initializing",e[e.Stopped=2]="Stopped",e[e.Running=3]="Running"})(gP||(gP={}));var mP;(function(e){e[e.Valid=0]="Valid",e[e.Unreadable=1]="Unreadable",e[e.Error=2]="Error"})(mP||(mP={}));var vP;(function(e){e[e.Variable=0]="Variable",e[e.Address=1]="Address"})(vP||(vP={}));var l1;(function(e){e[e.Initial=1]="Initial",e[e.Dynamic=2]="Dynamic"})(l1||(l1={}));var wP;(function(e){e.UnverifiedBreakpoints="unverifiedBreakpoints"})(wP||(wP={}));var Yoe=H("debugService"),bP;(function(e){e[e.CONDITION=0]="CONDITION",e[e.HIT_COUNT=1]="HIT_COUNT",e[e.LOG_MESSAGE=2]="LOG_MESSAGE",e[e.TRIGGER_POINT=3]="TRIGGER_POINT"})(bP||(bP={}));var yP;(function(e){e[e.Command=0]="Command",e[e.Tree=1]="Tree"})(yP||(yP={}));var AP;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(AP||(AP={}));var SP;(function(e){e.deserialize=t=>t,e.serialize=t=>t})(SP||(SP={}));var EP;(function(e){e.deserialize=t=>({id:t.id,name:t.name,iconPath:t.iconPath&&{light:y.revive(t.iconPath.light),dark:y.revive(t.iconPath.dark)},iconClass:t.iconClass,visualization:t.visualization}),e.serialize=t=>t})(EP||(EP={}));var NJ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(Y.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this.a.size===0)throw new Error("No related information providers registered");const s=this.a.get(e);if(!s)throw new Error("related information provider not found");return await s.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this.c.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const s=this.b;return this.b++,this.a.set(s,i),this.c.$registerAiRelatedInformationProvider(s,t),new Ce(()=>{this.c.$unregisterAiRelatedInformationProvider(s),this.a.delete(s)})}},MJ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(Y.MainThreadAiSettingsSearch)}async $startSearch(e,t,i,s){if(this.a.size===0)throw new Error("No related information providers registered");const r=this.a.get(e);if(!r)throw new Error("Settings search provider not found");const n=new Cm(o=>{this.c.$handleSearchResult(e,Hy.fromSettingsSearchResult(o))});return r.provideSettingsSearchResults(t,i,n,s)}registerSettingsSearchProvider(e,t){const i=this.b;return this.b++,this.a.set(i,t),this.c.$registerAiSettingsSearchProvider(i),new Ce(()=>{this.c.$unregisterAiSettingsSearchProvider(i),this.a.delete(i)})}},xP;(function(e){e[e.Full=1]="Full",e[e.Delta=2]="Delta"})(xP||(xP={}));function CP(e){for(let t=0,i=e.length;t<i;t+=4){const s=e[t+0],r=e[t+1],n=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=n,e[t+2]=r,e[t+3]=s}}function LJ(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.length*4);return ME()||CP(t),W.wrap(t)}function RJ(e){const t=e.buffer;if(ME()||CP(t),t.byteOffset%4===0)return new Uint32Array(t.buffer,t.byteOffset,t.length/4);{const i=new Uint8Array(t.byteLength);return i.set(t),new Uint32Array(i.buffer,i.byteOffset,i.length/4)}}function _4(e){const t=new Uint32Array(OJ(e));let i=0;if(t[i++]=e.id,e.type==="full")t[i++]=1,t[i++]=e.data.length,t.set(e.data,i),i+=e.data.length;else{t[i++]=2,t[i++]=e.deltas.length;for(const s of e.deltas)t[i++]=s.start,t[i++]=s.deleteCount,s.data?(t[i++]=s.data.length,t.set(s.data,i),i+=s.data.length):t[i++]=0}return LJ(t)}function OJ(e){let t=0;if(t+=2,e.type==="full")t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const i of e.deltas)i.data&&(t+=i.data.length)}return t}function kP(e){const t=RJ(e);let i=0;const s=t[i++];if(t[i++]===1){const a=t[i++],c=t.subarray(i,i+a);return i+=a,{id:s,type:"full",data:c}}const n=t[i++],o=[];for(let a=0;a<n;a++){const c=t[i++],l=t[i++],u=t[i++];let h;u>0&&(h=t.subarray(i,i+u),i+=u),o[a]={start:c,deleteCount:l,data:h}}return{id:s,type:"delta",deltas:o}}var FJ=[new Ae("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[_.Uri,_.Position],new be("A promise that resolves to an array of DocumentHighlight-instances.",ur(cl.to))),new Ae("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[_.Uri],new be("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(e,t)=>{if(xv(e))return;class i extends Yu{constructor(){super(...arguments),this.containerName=""}static to(r){const n=new i(r.name,Ls.to(r.kind),r.containerName||"",new rs(t[0],U.to(r.range)));return n.detail=r.detail,n.range=n.location.range,n.selectionRange=U.to(r.selectionRange),n.children=r.children?r.children.map(i.to):[],n}}return e.map(i.to)})),new Ae("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[_.Uri,new _("options","Formatting options",e=>!0,e=>e)],new be("A promise that resolves to an array of TextEdits.",ur(ei.to))),new Ae("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[_.Uri,_.Range,new _("options","Formatting options",e=>!0,e=>e)],new be("A promise that resolves to an array of TextEdits.",ur(ei.to))),new Ae("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[_.Uri,_.Position,new _("ch","Trigger character",e=>typeof e=="string",e=>e),new _("options","Formatting options",e=>!0,e=>e)],new be("A promise that resolves to an array of TextEdits.",ur(ei.to))),new Ae("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Ae("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location-instances.",ur(Bi.to))),new Ae("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Location-instances.",ur(Bi.to))),new Ae("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Hover-instances.",ur(Dh.to))),new Ae("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[_.Uri,_.Position],new be("A promise that resolves to an array of Hover-instances.",ur(Dh.to))),new Ae("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[_.Uri,new _("position","A position in a text document",e=>Array.isArray(e)&&e.every(t=>Pe.isPosition(t)),e=>e.map(Xe.from))],new be("A promise that resolves to an array of ranges.",e=>e.map(t=>{let i;for(const s of t.reverse())i=new ih(U.to(s),i);return i}))),new Ae("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[_.String.with("query","Search string")],new be("A promise that resolves to an array of SymbolInformation-instances.",e=>e.map(Pa.to))),new Ae("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[_.Uri,_.Position],new be("A promise that resolves to an array of CallHierarchyItem-instances",e=>e.map(Ta.to))),new Ae("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[_.CallHierarchyItem],new be("A promise that resolves to an array of CallHierarchyIncomingCall-instances",e=>e.map(ny.to))),new Ae("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[_.CallHierarchyItem],new be("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",e=>e.map(oy.to))),new Ae("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[_.Uri,_.Position],new be("A promise that resolves to a range and placeholder text.",e=>{if(e)return{range:U.to(e.range),placeholder:e.text}})),new Ae("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[_.Uri,_.Position,_.String.with("newName","The new symbol name")],new be("A promise that resolves to a WorkspaceEdit.",e=>{if(e){if(e.rejectReason)throw new Error(e.rejectReason);return os.to(e)}})),new Ae("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[_.Uri,_.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new be("A promise that resolves to an array of DocumentLink-instances.",e=>e.map(Na.to))),new Ae("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[_.Uri],new be("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new wb(e.tokenTypes,e.tokenModifiers)})),new Ae("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[_.Uri],new be("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=kP(e);if(t.type==="full")return new el(t.data,void 0)})),new Ae("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[_.Uri,_.Range.optional()],new be("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new wb(e.tokenTypes,e.tokenModifiers)})),new Ae("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[_.Uri,_.Range],new be("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=kP(e);if(t.type==="full")return new el(t.data,void 0)})),new Ae("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[_.Uri,_.Position,_.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),_.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new be("A promise that resolves to a CompletionList-instance.",(e,t,i)=>{if(!e)return new Fc([]);const s=e.suggestions.map(r=>dy.to(r,i));return new Fc(s,e.incomplete)})),new Ae("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[_.Uri,_.Position,_.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new be("A promise that resolves to SignatureHelp.",e=>{if(e)return Ph.to(e)})),new Ae("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[_.Uri,_.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new be("A promise that resolves to an array of CodeLens-instances.",(e,t,i)=>ur(s=>new Rp(U.to(s.range),s.command&&i.fromInternal(s.command)))(e))),new Ae("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[_.Uri,new _("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",e=>xe.isRange(e),e=>Dr.isSelection(e)?or.from(e):U.from(e)),_.String.with("kind","Code action kind to return code actions for").optional(),_.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new be("A promise that resolves to an array of Command-instances.",(e,t,i)=>ur(s=>{if(s._isSynthetic){if(!s.command)throw new Error("Synthetic code actions must have a command");return i.fromInternal(s.command)}else{const r=new th(s.title,s.kind?new xt(s.kind):void 0);return s.edit&&(r.edit=os.to(s.edit)),s.command&&(r.command=i.fromInternal(s.command)),r.isPreferred=s.isPreferred,r}})(e))),new Ae("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[_.Uri],new be("A promise that resolves to an array of ColorInformation objects.",e=>e?e.map(t=>new Hp(U.to(t.range),ll.to(t.color))):[])),new Ae("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new _("color","The color to show and insert",e=>e instanceof _c,ll.from),new _("context","Context object with uri and range",e=>!0,e=>({uri:e.uri,range:U.from(e.range)}))],new be("A promise that resolves to an array of ColorPresentation objects.",e=>e?e.map(Og.to):[])),new Ae("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[_.Uri,_.Range],new be("A promise that resolves to an array of Inlay objects",(e,t,i)=>e.map(fy.to.bind(void 0,i)))),new Ae("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[_.Uri],new be("A promise that resolves to an array of FoldingRange objects",(e,t)=>{if(e)return e.map(jg.to)})),new Ae("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new be("A promise that resolves to an array of NotebookContentProvider static info objects.",ur(e=>({viewType:e.viewType,displayName:e.displayName,options:{transientOutputs:e.options.transientOutputs,transientCellMetadata:e.options.transientCellMetadata,transientDocumentMetadata:e.options.transientDocumentMetadata},filenamePattern:e.filenamePattern.map(t=>Hg.to(t))})))),new Ae("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[_.Uri,_.Range,new _("context","An InlineValueContext",e=>e&&typeof e.frameId=="number"&&e.stoppedLocation instanceof xe,e=>Pg.from(e))],new be("A promise that resolves to an array of InlineValue objects",e=>e.map(Dg.to))),new Ae("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new _("uriOrString","Uri-instance or string (only http/https)",e=>y.isUri(e)||typeof e=="string"&&J2(e,V.http,V.https),e=>e),new _("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[Kt.from(e),void 0]:[Kt.from(e.viewColumn),Th.from(e)])).optional(),_.String.with("label","").optional()],be.Void),new Ae("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[_.Uri.with("resource","Resource to open"),_.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new _("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[Kt.from(e),void 0]:[Kt.from(e.viewColumn),Th.from(e)])).optional()],be.Void),new Ae("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[_.Uri.with("left","Left-hand side resource of the diff editor"),_.Uri.with("right","Right-hand side resource of the diff editor"),_.String.with("title","Human readable title for the diff editor").optional(),new _("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="object",e=>e&&[Kt.from(e.viewColumn),Th.from(e)]).optional()],be.Void),new Ae("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[_.String.with("title","Human readable title for the changes editor"),new _("resourceList","List of resources to compare",e=>{for(const t of e){if(t.length!==3)return!1;const[i,s,r]=t;if(!y.isUri(i)||!y.isUri(s)&&s!==void 0&&s!==null||!y.isUri(r)&&r!==void 0&&r!==null)return!1}return!0},e=>e)],be.Void),new Ae("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[_.Uri,_.Position],new be("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ma.to))),new Ae("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[_.TypeHierarchyItem],new be("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ma.to))),new Ae("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[_.TypeHierarchyItem],new be("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ma.to))),new Ae("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[_.TestItem],be.Void),new Ae("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[_.TestProfile,_.Arr(_.TestItem)],be.Void),new Ae("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[_.Arr(_.TestItem)],be.Void),new Ae("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[_.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],be.Void),new Ae("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[_.String.with("name","The context key name"),new _("value","The context key value",()=>!0,e=>e)],be.Void),new Ae("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new _("Run arguments","",e=>!0,e=>{if(e)return{initialRange:e.initialRange?U.from(e.initialRange):void 0,initialSelection:Dr.isSelection(e.initialSelection)?or.from(e.initialSelection):void 0,message:e.message,attachments:e.attachments,autoSend:e.autoSend,position:e.position?Xe.from(e.position):void 0,blockOnResponse:e.blockOnResponse}})],be.Void)],UJ=class{static register(e){FJ.forEach(e.registerApiCommand,e),this.a(e)}static a(e){e.registerCommand(!1,"_validateWhenClauses",ij)}};function ur(e){return t=>{if(Array.isArray(t))return t.map(e)}}function Co(e){if(!Array.isArray(e))return;const t=[];for(const i of e)kz(i)?t.push(Ih.to(i)):t.push(Bi.to(i));return t}var V4=class{constructor(t,i){this.a=t.getProxy(Y.MainThreadBulkEdits),this.b={getTextDocumentVersion:s=>i.getDocument(s)?.version,getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(t,i,s){const r=new pi(os.from(t,this.b));return this.a.$tryApplyWorkspaceEdit(r,void 0,s?.isRefactoring??!1)}};V4=__decorate([__param(0,ke)],V4);function jJ(e){return!!e&&y.isUri(e.sessionResource)&&e.$mid===19}var $P;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})($P||($P={}));var IP;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(IP||(IP={}));var DP;(function(e){e[e.NoReason=0]="NoReason",e[e.FilteredContentRetry=1]="FilteredContentRetry",e[e.CopyrightContentRetry=2]="CopyrightContentRetry"})(DP||(DP={}));var PP;(function(e){e.Pending="pending",e.Accepted="accepted",e.Rejected="rejected"})(PP||(PP={}));var TP;(function(e){e[e.Denied=0]="Denied",e[e.ConfirmationNotNeeded=1]="ConfirmationNotNeeded",e[e.Setting=2]="Setting",e[e.LmServicePerTool=3]="LmServicePerTool",e[e.UserAction=4]="UserAction",e[e.Skipped=5]="Skipped"})(TP||(TP={}));var NP;(function(e){let t;(function(l){l[l.WaitingForConfirmation=0]="WaitingForConfirmation",l[l.Executing=1]="Executing",l[l.WaitingForPostApproval=2]="WaitingForPostApproval",l[l.Completed=3]="Completed",l[l.Cancelled=4]="Cancelled"})(t=e.StateKind||(e.StateKind={}));function i(l,u){if(l.kind==="toolInvocationSerialized")return l.isConfirmed===void 0||typeof l.isConfirmed=="boolean"?{type:l.isConfirmed?4:0}:l.isConfirmed;const h=l.state.read(u);if(h.type!==0)return h.type===4?{type:h.reason}:h.confirmed}e.executionConfirmedOrDenied=i;function s(l,u){const h=i(l);if(h)return Promise.resolve(h);const f=new ie;return new Promise(p=>{u&&f.add(u.onCancellationRequested(()=>{p({type:0})})),f.add(Zf(g=>{const v=i(l,g);v&&(f.dispose(),p(v))}))}).finally(()=>{f.dispose()})}e.awaitConfirmation=s;function r(l,u){const h=l.state.read(u);if(h.type===3)return h.postConfirmed||{type:1};if(h.type===4)return{type:h.reason}}function n(l,u){const h=l?.state.get();return h?.type===0||h?.type===2?(h.confirm(u),!0):!1}e.confirmWith=n;function o(l,u){const h=r(l);if(h)return Promise.resolve(h);const f=new ie;return new Promise(p=>{u&&f.add(u.onCancellationRequested(()=>{p({type:0})})),f.add(Zf(g=>{const v=r(l,g);v&&(f.dispose(),p(v))}))}).finally(()=>{f.dispose()})}e.awaitPostConfirmation=o;function a(l,u){if(l.kind==="toolInvocationSerialized")return l.resultDetails;const h=l.state.read(u);if(h.type===3||h.type===2)return h.resultDetails}e.resultDetails=a;function c(l,u){if(l.kind==="toolInvocationSerialized")return!0;const h=l.state.read(u);return h.type===3||h.type===4}e.isComplete=c})(NP||(NP={}));var u1;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(u1||(u1={}));var MP;(function(e){e.IncorrectCode="incorrectCode",e.DidNotFollowInstructions="didNotFollowInstructions",e.IncompleteCode="incompleteCode",e.MissingContext="missingContext",e.PoorlyWrittenOrFormatted="poorlyWrittenOrFormatted",e.RefusedAValidRequest="refusedAValidRequest",e.OffensiveOrUnsafe="offensiveOrUnsafe",e.Other="other",e.WillReportIssue="willReportIssue"})(MP||(MP={}));var LP;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(LP||(LP={}));var RP;(function(e){e[e.Pending=0]="Pending",e[e.Complete=1]="Complete",e[e.Cancelled=2]="Cancelled",e[e.Failed=3]="Failed",e[e.NeedsInput=4]="NeedsInput"})(RP||(RP={}));var OP=H("IChatService"),q4=class{constructor(e,t,i,s,r){this.j=e,this.l=t,this.m=i,this.n=s,this.o=r,this.b=Qi.create(!1),this.c=!1}close(){this.c=!0}get timings(){return{firstProgress:this.d,totalElapsed:this.b.elapsed()}}get apiObject(){if(!this.g){let i=function(l){if(r.c){const u=new Error("Response stream has been closed");throw Error.captureStackTrace(u,l),u}},s=function(l,u){if(o.push(u!==void 0?[l,u]:l)===1&&queueMicrotask(()=>{const f=a;a=[],r.m.$handleProgressChunk(r.l.requestId,o).finally(()=>{f.forEach(p=>p())}),o.length=0}),u!==void 0)return new Promise(f=>{a.push(f)})};var e=i,t=s;const r=this;this.b.reset();let n=0;const o=[];let a=[];const c=(l,u)=>{if(typeof this.d>"u"&&(l.kind==="markdownContent"||l.kind==="markdownVuln"||l.kind==="prepareToolInvocation")&&(this.d=this.b.elapsed()),u){const h=n++,f=s(l,h),p={report:g=>{f.then(()=>{Hi.isMarkdownString(g.value)?s(Uh.from(g),h):s(Ra.from(g),h)})}};Promise.all([f,u(p)]).then(([g,v])=>{s(Iy.from(v),h)})}else s(l)};this.g=Object.freeze({clearToPreviousToolInvocation(l){return i(this.markdown),s({kind:"clearToPreviousToolInvocation",reason:l}),this},markdown(l){i(this.markdown);const u=new hg(l),h=Lh.from(u);return c(h),this},markdownWithVulnerabilities(l,u){i(this.markdown),u&&T(r.j,"chatParticipantAdditions");const h=new Sh(l,u),f=Gg.from(h);return c(f),this},codeblockUri(l,u){i(this.codeblockUri),T(r.j,"chatParticipantAdditions");const h=new mg(l,u),f=qg.from(h);return c(f),this},filetree(l,u){i(this.filetree);const h=new fg(l,u),f=Rh.from(h);return c(f),this},anchor(l,u){const h=new Eh(l,u);return this.push(h)},button(l){i(this.anchor);const u=new gg(l),h=zh.from(u,r.n,r.o);return c(h),this},progress(l,u){i(this.progress);const h=new pg(l,u),f=u?Zg.from(h):Oh.from(h);return c(f,u),this},thinkingProgress(l){i(this.thinkingProgress),T(r.j,"chatParticipantAdditions");const u=new rl(l.text??"",l.id,l.metadata),h=Fh.from(u);return c(h),this},warning(l){i(this.progress),T(r.j,"chatParticipantAdditions");const u=new xh(l),h=Uh.from(u);return c(h),this},reference(l,u){return this.reference2(l,u)},reference2(l,u,h){if(i(this.reference),typeof l=="object"&&"variableName"in l&&T(r.j,"chatParticipantAdditions"),typeof l=="object"&&"variableName"in l&&!l.value){const f=r.l.variables.variables.find(p=>p.name===l.variableName);if(f){let p;if(f.references?.length)p=f.references.map(g=>({kind:"reference",reference:{variableName:l.variableName,value:g.reference}}));else{const g=new ka(l,u,h);p=[Ra.from(g)]}return p.forEach(g=>c(g)),this}}else{const f=new ka(l,u,h),p=Ra.from(f);c(p)}return this},codeCitation(l,u,h){i(this.codeCitation),T(r.j,"chatParticipantAdditions");const f=new vg(l,u,h),p=Kg.from(f);c(p)},textEdit(l,u){i(this.textEdit),T(r.j,"chatParticipantAdditions");const h=new Ch(l,u);h.isDone=u===!0?!0:void 0;const f=Qg.from(h);return c(f),this},notebookEdit(l,u){i(this.notebookEdit),T(r.j,"chatParticipantAdditions");const h=new bg(l,u),f=Xg.from(h);return c(f),this},async externalEdit(l,u){i(this.externalEdit);const h=Array.isArray(l)?l:[l],f=n++,p=Nt();await s({kind:"externalEdits",start:!0,resources:h,undoStopId:p},f);try{return await u(),p}finally{await s({kind:"externalEdits",start:!1,resources:h,undoStopId:p},f)}},confirmation(l,u,h,f){i(this.confirmation),T(r.j,"chatParticipantAdditions");const p=new dg(l,u,h,f),g=Jg.from(p);return c(g),this},prepareToolInvocation(l){i(this.prepareToolInvocation),T(r.j,"chatParticipantAdditions");const u=new kh(l),h=jh.from(u);return c(h),this},push(l){if(i(this.push),(l instanceof Ch||l instanceof bg||l instanceof Sh||l instanceof xh||l instanceof dg||l instanceof vg||l instanceof wg||l instanceof Hb||l instanceof jb||l instanceof rl||l instanceof Wb||l instanceof pg)&&T(r.j,"chatParticipantAdditions"),l instanceof ka)this.reference2(l.value,l.iconPath,l.options);else if(l instanceof pg){const u=l.task?Zg.from(l):Oh.from(l);c(u,l.task)}else if(l instanceof rl){const u=Fh.from(l);c(u)}else if(l instanceof Eh){const u=bl.from(l);if(l.resolve){T(r.j,"chatParticipantAdditions"),u.resolveId=Nt();const h=new Qe;l.resolve(h.token).then(()=>{const f=bl.from(l);r.m.$handleAnchorResolve(r.l.requestId,u.resolveId,f)}).then(()=>h.dispose(),()=>h.dispose()),r.o.add(te(()=>h.dispose(!0)))}c(u)}else if(l instanceof kh){T(r.j,"chatParticipantAdditions");const u=jh.from(l);return c(u),this}else{if(l instanceof jb)return this.externalEdit(l.uris,l.callback).then(h=>l.didGetApplied(h)),this;{const u=Hh.from(l,r.n,r.o);c(u)}}return this}})}return this.g}},zJ=class Ql extends Z{static{this.b=0}static{this.j=0}static{this.n=0}static{this.s=0}constructor(t,i,s,r,n,o,a,c){super(),this.F=i,this.G=s,this.H=r,this.I=n,this.J=o,this.L=a,this.M=c,this.c=new Map,this.m=new Map,this.q=new Map,this.t=new Map,this.u=this.D(new ER),this.w=this.D(new Fo),this.y=new Set,this.z=this.D(new I),this.onDidChangeChatRequestTools=this.z.event,this.C=this.D(new I),this.onDidDisposeChatSession=this.C.event,this.g=t.getProxy(Y.MainThreadChatAgents2),s.registerArgumentProcessor({processArgument:l=>jJ(l)?null:l})}async transferActiveChat(t){await this.g.$transferActiveChatSession(t)}createChatAgent(t,i,s){const r=Ql.b++,n=new FP(t,i,this.g,r,s);return this.c.set(r,n),this.g.$registerAgent(r,t.identifier,i,{},void 0),n.apiAgent}createDynamicChatAgent(t,i,s,r){const n=Ql.b++,o=new FP(t,i,this.g,n,r);return this.c.set(n,o),this.g.$registerAgent(n,t.identifier,i,{isSticky:!0},s),o.apiAgent}registerChatParticipantDetectionProvider(t,i){const s=Ql.j++;return this.m.set(s,new HJ(t,i)),this.g.$registerChatParticipantDetectionProvider(s),te(()=>{this.m.delete(s),this.g.$unregisterChatParticipantDetectionProvider(s)})}registerRelatedFilesProvider(t,i,s){const r=Ql.n++;return this.q.set(r,new WJ(t,i)),this.g.$registerRelatedFilesProvider(r,s),te(()=>{this.q.delete(r),this.g.$unregisterRelatedFilesProvider(r)})}registerCustomAgentsProvider(t,i){const s=Ql.s++;this.t.set(s,{extension:t,provider:i}),this.g.$registerCustomAgentsProvider(s,t.identifier);const r=new ie;return i.onDidChangeCustomAgents&&r.add(i.onDidChangeCustomAgents(()=>{this.g.$onDidChangeCustomAgents(s)})),r.add(te(()=>{this.t.delete(s),this.g.$unregisterCustomAgentsProvider(s)})),r}async $provideRelatedFiles(t,i,s){const r=this.q.get(t);if(!r)return Promise.resolve([]);const n=Dy.to(i);return await r.provider.provideRelatedFiles(n,s)??void 0}async $provideCustomAgents(t,i,s){const r=this.t.get(t);return r?await r.provider.provideCustomAgents(i,s)??void 0:Promise.resolve(void 0)}async $detectChatParticipant(t,i,s,r,n){const o=this.m.get(t);if(!o)return;const{request:a,location:c,history:l}=await this.N(i,s,o.extension),u=await this.O(a,o.extension),h=yl.to(a,c,u,this.P(o.extension),this.Q(o.extension,a.userSelectedTools),o.extension,this.F);return o.provider.provideParticipantDetection(h,{history:l},{participants:r.participants,location:em.to(r.location)},n)}async N(t,i,s){const r=Zt(t),n=await this.R(s,r.agentId,i);let o;if(r.locationData?.type===ui.EditorInline){const a=this.H.getDocument(r.locationData.document),c=this.I.getEditor(r.locationData.id);o=new L7(c.value,a,or.to(r.locationData.selection),U.to(r.locationData.wholeRange))}else if(r.locationData?.type===ui.Notebook){const a=this.H.getDocument(r.locationData.sessionInputUri);o=new R7(a)}else r.locationData?.type,ui.Terminal;return{request:r,location:o,history:n}}async O(t,i){let s;if(t.userSelectedModelId&&(s=await this.J.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!s&&(s=await this.J.getDefaultLanguageModel(i),!s))throw new Error("Language model unavailable");return s}async $setRequestTools(t,i){const s=[...this.y].find(r=>r.requestId===t);if(s){s.extRequest.tools.clear();for(const[r,n]of this.Q(s.extension,i))s.extRequest.tools.set(r,n);this.z.fire(s.extRequest)}}async $invokeAgent(t,i,s,r){const n=this.c.get(t);if(!n)throw new Error(`[CHAT](${t}) CANNOT invoke agent because the agent is not registered`);let o,a;try{const{request:c,location:l,history:u}=await this.N(i,s,n.extension);let h=this.u.get(c.sessionResource);h||(h=new ie,this.u.set(c.sessionResource,h)),o=new q4(n.extension,c,this.g,this.G.converter,h);const f=await this.O(c,n.extension),p=yl.to(c,l,f,this.P(n.extension),this.Q(n.extension,c.userSelectedTools),n.extension,this.F);a={requestId:i.requestId,extRequest:p,extension:n.extension},this.y.add(a);let g;s.chatSessionContext&&(g={chatSessionItem:{resource:y.revive(s.chatSessionContext.chatSessionResource),label:s.chatSessionContext.isUntitled?"Untitled Session":"Session"},isUntitled:s.chatSessionContext.isUntitled});const v={history:u,chatSessionContext:g},b=n.invoke(p,v,o.apiObject,r);return await BJ(1e3,Promise.resolve(b).then(S=>{if(S?.metadata)try{JSON.stringify(S.metadata)}catch(k){const j=`result.metadata MUST be JSON.stringify-able. Got error: ${k.message}`;return this.F.error(`[${n.extension.identifier.value}] [@${n.id}] ${j}`,n.extension),{errorDetails:{message:j},timings:o?.timings,nextQuestion:S.nextQuestion}}let E;return S?.errorDetails&&(E={...S.errorDetails,responseIsIncomplete:!0}),(E?.responseIsRedacted||E?.isQuotaExceeded||E?.isRateLimited||E?.confirmationButtons||E?.code)&&T(n.extension,"chatParticipantPrivate"),{errorDetails:E,timings:o?.timings,metadata:S?.metadata,nextQuestion:S?.nextQuestion,details:S?.details}}),r)}catch(c){this.F.error(c,n.extension),c instanceof hn&&c.cause&&(c=c.cause);const l=c instanceof Error&&c.name==="ChatQuotaExceeded",u=c instanceof Error&&c.name==="ChatRateLimited";return{errorDetails:{message:Sr(c),responseIsIncomplete:!0,isQuotaExceeded:l,isRateLimited:u}}}finally{a&&this.y.delete(a),o?.close()}}P(t){return et(t,"chatReferenceDiagnostic")?this.L.getDiagnostics():[]}Q(t,i){if(!i)return new Map;const s=new Map;for(const r of this.M.getTools(t))typeof i[r.name]=="boolean"&&s.set(r.name,i[r.name]);return s}async R(t,i,s){const r=[];for(const n of s.history){const o=Al.to(n.result),a=i===n.request.agentId||UP(n.request.agentId)&&UP(i)?o:{...o,metadata:void 0},c=[],l=[];for(const p of n.request.variables.variables)if(p.kind==="tool")l.push(Oa.to(p));else if(p.kind==="toolset")l.push(...p.value.map(Oa.to));else{const g=tm.to(p,this.P(t),this.F);g&&c.push(g)}const u=et(t,"chatParticipantPrivate")?n.request.editedFileEvents:void 0,h=new yg(n.request.message,n.request.command,c,n.request.agentId,l,u,n.request.requestId);r.push(h);const f=gt(n.response.map(p=>Hh.toContent(p,this.G.converter)));r.push(new M7(f,a,n.request.agentId,n.request.command))}return r}$releaseSession(t){const i=y.revive(t);this.u.deleteAndDispose(i);const s=xr.parseLocalSessionId(i);s&&this.C.fire(s)}async $provideFollowups(t,i,s,r,n){const o=this.c.get(i);if(!o)return Promise.resolve([]);const a=Zt(t),c=await this.R(o.extension,o.id,r),l=Al.to(s);return(await o.provideFollowups(l,{history:c},n)).filter(u=>{const h=!u.participant||Bt.some(this.c.values(),f=>f.id===u.participant&&Ye.equals(f.extension.identifier,o.extension.identifier));return h||this.F.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`),h}).map(u=>_g.from(u,a))}$acceptFeedback(t,i,s){const r=this.c.get(t);if(!r)return;const n=Al.to(i);let o;switch(s.direction){case u1.Down:o=Ah.Unhelpful;break;case u1.Up:o=Ah.Helpful;break}const a={result:n,kind:o,unhelpfulReason:et(r.extension,"chatParticipantAdditions")?s.reason:void 0};r.acceptFeedback(Object.freeze(a))}$acceptAction(t,i,s){const r=this.c.get(t);if(!r||s.action.kind==="vote")return;const n=Ny.to(i,s,this.G.converter);n&&r.acceptAction(Object.freeze(n))}async $invokeCompletionProvider(t,i,s){const r=this.c.get(t);if(!r)return[];let n=this.w.get(t);return n?n.clear():(n=new ie,this.w.set(t,n)),(await r.invokeCompletionProvider(i,s)).map(a=>Ty.from(a,this.G.converter,n))}async $provideChatTitle(t,i,s){const r=this.c.get(t);if(!r)return;const n=await this.R(r.extension,r.id,{history:i});return await r.provideTitle({history:n},s)}async $provideChatSummary(t,i,s){const r=this.c.get(t);if(!r)return;const n=await this.R(r.extension,r.id,{history:i});return await r.provideSummary({history:n},s)}},HJ=class{constructor(e,t){this.extension=e,this.provider=t}},WJ=class{constructor(e,t){this.extension=e,this.provider=t}},FP=class{constructor(e,t,i,s,r){this.extension=e,this.id=t,this.u=i,this.w=s,this.x=r,this.j=new I,this.l=new I,this.t=new I}acceptFeedback(e){this.j.fire(e)}acceptAction(e){this.l.fire(e)}setChatRequestPauseState(e){this.t.fire(e)}async invokeCompletionProvider(e,t){return this.n?await this.n.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this.b)return[];const s=await this.b.provideFollowups(e,t,i);return s?s.filter(r=>!(r&&"commandId"in r)).filter(r=>!(r&&"message"in r)):[]}async provideTitle(e,t){if(this.q)return await this.q.provideChatTitle(e,t)??void 0}async provideSummary(e,t){if(this.s)return await this.s.provideChatSummary(e,t)??void 0}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this.u.$updateAgent(this.w,{icon:this.c?this.c instanceof y?this.c:"light"in this.c?this.c.light:void 0:void 0,iconDark:this.c&&"dark"in this.c?this.c.dark:void 0,themeIcon:this.c instanceof Ti?this.c:void 0,hasFollowups:this.b!==void 0,helpTextPrefix:!this.d||typeof this.d=="string"?this.d:pe.from(this.d),helpTextPostfix:!this.g||typeof this.g=="string"?this.g:pe.from(this.g),supportIssueReporting:this.m,additionalWelcomeMessage:!this.o||typeof this.o=="string"?this.o:pe.from(this.o)}),t=!1}))},s=this;return{get id(){return s.id},get iconPath(){return s.c},set iconPath(r){s.c=r,i()},get requestHandler(){return s.x},set requestHandler(r){Iv(typeof r=="function","Invalid request handler"),s.x=r},get followupProvider(){return s.b},set followupProvider(r){s.b=r,i()},get helpTextPrefix(){return T(s.extension,"defaultChatParticipant"),s.d},set helpTextPrefix(r){T(s.extension,"defaultChatParticipant"),s.d=r,i()},get helpTextPostfix(){return T(s.extension,"defaultChatParticipant"),s.g},set helpTextPostfix(r){T(s.extension,"defaultChatParticipant"),s.g=r,i()},get supportIssueReporting(){return T(s.extension,"chatParticipantPrivate"),s.m},set supportIssueReporting(r){T(s.extension,"chatParticipantPrivate"),s.m=r,i()},get onDidReceiveFeedback(){return s.j.event},set participantVariableProvider(r){if(T(s.extension,"chatParticipantAdditions"),s.n=r,r){if(!r.triggerCharacters.length)throw new Error("triggerCharacters are required");s.u.$registerAgentCompletionsProvider(s.w,s.id,r.triggerCharacters)}else s.u.$unregisterAgentCompletionsProvider(s.w,s.id)},get participantVariableProvider(){return T(s.extension,"chatParticipantAdditions"),s.n},set additionalWelcomeMessage(r){T(s.extension,"defaultChatParticipant"),s.o=r,i()},get additionalWelcomeMessage(){return T(s.extension,"defaultChatParticipant"),s.o},set titleProvider(r){T(s.extension,"defaultChatParticipant"),s.q=r,i()},get titleProvider(){return T(s.extension,"defaultChatParticipant"),s.q},set summarizer(r){T(s.extension,"defaultChatParticipant"),s.s=r},get summarizer(){return T(s.extension,"defaultChatParticipant"),s.s},get onDidChangePauseState(){return T(s.extension,"chatParticipantAdditions"),s.t.event},onDidPerformAction:et(this.extension,"chatParticipantAdditions")?this.l.event:void 0,dispose(){e=!0,s.b=void 0,s.j.dispose(),s.u.$unregisterAgent(s.w)}}}invoke(e,t,i,s){return this.x(e,t,i,s)}};function BJ(e,t,i){return new Promise((s,r)=>{const n=i.onCancellationRequested(async()=>{n.dispose(),await ri(e),s(void 0)});t.then(s,r).finally(()=>n.dispose())})}function UP(e){return e.startsWith("github.copilot")}var _J=class{constructor(e,t){this.c=t,this.b=new Map,this.a=e.getProxy(Y.MainThreadChatOutputRenderer)}registerChatOutputRenderer(e,t,i){if(this.b.has(t))throw new Error(`Chat output renderer already registered for: ${t}`);return this.b.set(t,{extension:e,renderer:i}),this.a.$registerChatOutputRenderer(t,e.identifier,e.extensionLocation),new Ce(()=>{this.b.delete(t),this.a.$unregisterChatOutputRenderer(t)})}async $renderChatOutput(e,t,i,s,r){const n=this.b.get(e);if(!n)throw new Error(`No chat output renderer registered for: ${e}`);const o=this.c.createNewWebview(s,{},n.extension);return n.renderer.renderChatOutput(Object.freeze({mime:t,value:i.buffer}),o,{},r)}},G4,VJ=class{constructor(e,t,i,s,r,n){this.session=e,this.extension=t,this.proxy=s,this.commandsConverter=r,this.sessionDisposables=n,this.a=new q4(t,i,s,r,n)}get activeResponseStream(){return this.a}getActiveRequestStream(e){return new q4(this.extension,e,this.proxy,this.commandsConverter,this.sessionDisposables)}},J4=class extends Z{static{G4=this}static{this.a=0}constructor(t,i,s,r){super(),this.n=t,this.q=i,this.s=s,this.t=r,this.c=new Map,this.f=new Map,this.g=0,this.h=0,this.j=new kt,this.m=new kt,this.b=this.s.getProxy(Y.MainThreadChatSessions),t.registerArgumentProcessor({processArgument:n=>{if(n&&n.$mid===25){const o=n.session.resource||n.sessionId,a=this.j.get(o);return a||(this.t.warn(`No chat session found for ID: ${o}`),n)}return n}})}registerChatSessionItemProvider(t,i,s){const r=this.g++,n=new ie;return this.c.set(r,{provider:s,extension:t,disposable:n,sessionType:i}),this.b.$registerChatSessionItemProvider(r,i),s.onDidChangeChatSessionItems&&n.add(s.onDidChangeChatSessionItems(()=>{this.b.$onDidChangeChatSessionItems(r)})),s.onDidCommitChatSessionItem&&n.add(s.onDidCommitChatSessionItem(o=>{const{original:a,modified:c}=o;this.b.$onDidCommitChatSessionItem(r,a.resource,c.resource)})),{dispose:()=>{this.c.delete(r),n.dispose(),this.b.$unregisterChatSessionItemProvider(r)}}}registerChatSessionContentProvider(t,i,s,r,n){const o=this.h++,a=new ie;return this.f.set(o,{provider:r,extension:t,capabilities:n,disposable:a}),this.b.$registerChatSessionContentProvider(o,i),r.onDidChangeChatSessionOptions&&a.add(r.onDidChangeChatSessionOptions(c=>{this.b.$onDidChangeChatSessionOptions(o,c.resource,c.updates)})),r.onDidChangeChatSessionProviderOptions&&a.add(r.onDidChangeChatSessionProviderOptions(()=>{this.b.$onDidChangeChatSessionProviderOptions(o)})),new Ce(()=>{this.f.delete(o),a.dispose(),this.b.$unregisterChatSessionContentProvider(o)})}u(t){if(t!==void 0)switch(t){case 0:return 0;case 1:return 1;case 2:return 2;default:return}}w(t,i){return{resource:i.resource,label:i.label,description:i.description?pe.from(i.description):void 0,badge:i.badge?pe.from(i.badge):void 0,status:this.u(i.status),tooltip:pe.fromStrict(i.tooltip),timing:{startTime:i.timing?.startTime??0,endTime:i.timing?.endTime},changes:i.changes instanceof Array?i.changes:i.changes&&{files:i.changes?.files??0,insertions:i.changes?.insertions??0,deletions:i.changes?.deletions??0}}}async $provideNewChatSessionItem(t,i,s){const r=this.c.get(t);if(!r||!r.provider.provideNewChatSessionItem)throw new Error(`No provider registered for handle ${t} or provider does not support creating sessions`);try{const n=await this.y(i.request,r.extension),a={request:yl.to(Zt(i.request),void 0,n,[],new Map,r.extension,this.t),metadata:i.metadata},c=await r.provider.provideNewChatSessionItem(a,s);if(!c)throw new Error("Provider did not create session");return this.j.set(c.resource,c),this.w(r.sessionType,c)}catch(n){throw this.t.error(`Error creating chat session: ${n}`),n}}async $provideChatSessionItems(t,i){const s=this.c.get(t);if(!s)return this.t.error(`No provider registered for handle ${t}`),[];const r=await s.provider.provideChatSessionItems(i);if(!r)return[];const n=[];for(const o of r)this.j.set(o.resource,o),n.push(this.w(s.sessionType,o));return n}async $provideChatSessionContent(t,i,s){const r=this.f.get(t);if(!r)throw new Error(`No provider for handle ${t}`);const n=y.revive(i),o=await r.provider.provideChatSessionContent(n,s);if(s.isCancellationRequested)throw new dt;const a=new ie,c=G4.a++,l=n.toString(),u=new VJ(o,r.extension,{sessionResource:n,requestId:"ongoing",agentId:l,message:"",variables:{variables:[]},location:ui.Chat},{$handleProgressChunk:(p,g)=>this.b.$handleProgressChunk(t,n,p,g),$handleAnchorResolve:(p,g,v)=>{this.b.$handleAnchorResolve(t,n,p,g,v)}},this.n.converter,a),h=a.add(new Qe);this.m.set(n,{sessionObj:u,disposeCts:h}),o.activeResponseCallback&&Promise.resolve(o.activeResponseCallback(u.activeResponseStream.apiObject,h.token)).finally(()=>{this.b.$handleProgressComplete(t,n,"ongoing")});const{capabilities:f}=r;return{id:c+"",resource:y.revive(n),hasActiveResponseCallback:!!o.activeResponseCallback,hasRequestHandler:!!o.requestHandler,supportsInterruption:!!f?.supportsInterruptions,options:o.options,history:o.history.map(p=>p instanceof yg?this.z(p):this.F(p,a))}}async $provideHandleOptionsChange(t,i,s,r){const n=y.revive(i),o=this.f.get(t);if(!o){this.t.warn(`No provider for handle ${t}`);return}if(!o.provider.provideHandleOptionsChange){this.t.debug(`Provider for handle ${t} does not implement provideHandleOptionsChange`);return}try{const a=s.map(c=>({optionId:c.optionId,value:c.value===void 0?void 0:typeof c.value=="string"?c.value:c.value.id}));await o.provider.provideHandleOptionsChange(n,a,r)}catch(a){this.t.error(`Error calling provideHandleOptionsChange for handle ${t}, sessionResource ${n}:`,a)}}async $provideChatSessionProviderOptions(t,i){const s=this.f.get(t);if(!s){this.t.warn(`No provider for handle ${t} when requesting chat session options`);return}const r=s.provider;if(r.provideChatSessionProviderOptions)try{const{optionGroups:n}=await r.provideChatSessionProviderOptions(i);return n?{optionGroups:n}:void 0}catch(n){this.t.error(`Error calling provideChatSessionProviderOptions for handle ${t}:`,n);return}}async $interruptChatSessionActiveResponse(t,i,s){this.m.get(y.revive(i))?.disposeCts.cancel()}async $disposeChatSessionContent(t,i){const s=this.m.get(y.revive(i));if(!s){this.t.warn(`No chat session found for resource: ${i}`);return}s.disposeCts.cancel(),s.sessionObj.sessionDisposables.dispose(),this.m.delete(y.revive(i))}async $invokeChatSessionRequestHandler(t,i,s,r,n){const o=this.m.get(y.revive(i));if(!o||!o.sessionObj.session.requestHandler)return{};const a=yl.to(s,void 0,await this.y(s,o.sessionObj.extension),[],new Map,o.sessionObj.extension,this.t),c=o.sessionObj.getActiveRequestStream(s);return await o.sessionObj.session.requestHandler(a,{history:r},c.apiObject,n),{}}async y(t,i){let s;if(t.userSelectedModelId&&(s=await this.q.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!s&&(s=await this.q.getDefaultLanguageModel(i),!s))throw new Error("Language model unavailable");return s}z(t){const i=t.references.map(s=>this.C(s));return{type:"request",id:t.id,prompt:t.prompt,participant:t.participant,command:t.command,variableData:i.length>0?{variables:i}:void 0}}C(t){const i=t.value&&typeof t.value=="object"&&"uri"in t.value&&"range"in t.value?Ms.from(t.value):t.value,s=t.range?{start:t.range[0],endExclusive:t.range[1]}:void 0;if(i&&i instanceof Gb&&Array.isArray(i.diagnostics)&&i.diagnostics.length&&i.diagnostics[0][1].length){const o=Da.from(i.diagnostics[0][1][0]),a={filterRange:{startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.endLineNumber,endColumn:o.endColumn},filterSeverity:o.severity,filterUri:i.diagnostics[0][0],problemMessage:i.diagnostics[0][1][0].message};return lw.toEntry(a)}if(rs.isLocation(t.value)&&t.name.startsWith("sym:")){const o=Ms.from(t.value);return{id:t.id,name:t.name,fullName:t.name.substring(4),value:{uri:t.value.uri,range:o.range},symbolKind:6,icon:sw.toIcon(6),kind:"symbol",range:s}}if(y.isUri(i)&&t.name.startsWith("prompt:")&&t.id.startsWith(eo.PromptFile)&&t.id.endsWith(i.toString()))return{id:t.id,name:`prompt:${Li(i)}`,value:i,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:!0,automaticallyAdded:!1,range:s};const r=y.isUri(i)||i&&typeof i=="object"&&"uri"in i,n=r&&y.isUri(i)&&i.path.endsWith("/");return{id:t.id,name:t.name,value:i,modelDescription:t.modelDescription,range:s,kind:n?"directory":r?"file":"generic"}}F(t,i){return{type:"response",parts:gt(t.response.map(r=>Hh.from(r,this.n.converter,i))),participant:t.participant}}};J4=G4=__decorate([__param(2,ke),__param(3,Se)],J4);var qJ=class{constructor(e){this.b=new Map,this.a=e.getProxy(Y.MainThreadChatStatus)}createChatStatusItem(e,t){const i=GJ(e.identifier,t);if(this.b.has(i))throw new Error(`Chat status item '${t}' already exists`);const s={id:i,title:"",description:"",detail:""};let r=!1,n=!1;const o=()=>{if(r)throw new Error("Chat status item is disposed");n&&this.a.$setEntry(t,s)},a=Object.freeze({id:t,get title(){return s.title},set title(c){s.title=c,o()},get description(){return s.description},set description(c){s.description=c,o()},get detail(){return s.detail},set detail(c){s.detail=c,o()},show:()=>{n=!0,o()},hide:()=>{n=!1,this.a.$disposeEntry(t)},dispose:()=>{r=!0,this.a.$disposeEntry(t),this.b.delete(i)}});return this.b.set(i,a),a}};function GJ(e,t){return`${Ye.toKey(e)}.${t}`}var JJ=class{constructor(e){const t=e.getProxy(Y.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}},jP="vscode-cdn.net",ZJ=`vscode-resource.${jP}`,Z4=`'self' https://*.${jP}`;function pd(e,t){return e.scheme===V.http||e.scheme===V.https?e:(t&&t.authority&&t.isRemote&&e.scheme===V.file&&(e=y.from({scheme:V.vscodeRemote,authority:t.authority,path:e.path})),y.from({scheme:V.https,authority:`${e.scheme}+${QJ(e.authority)}.${ZJ}`,path:e.path,fragment:e.fragment,query:e.query}))}function QJ(e){return e.replace(/./g,t=>{const i=t.charCodeAt(0);return i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57?t:"-"+i.toString(16).padStart(4,"0")})}var YJ=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i,this.a=0,this.b=new ie,this.c=new Map,this.b.add(t.onDidChangeVisibleTextEditors(()=>{const s=t.getVisibleTextEditors();for(const r of this.c.values())s.indexOf(r.editor)<0&&r.inset.dispose()}))}dispose(){this.c.forEach(e=>e.inset.dispose()),this.b.dispose()}createWebviewEditorInset(e,t,i,s,r){let n;for(const f of this.e.getVisibleTextEditors(!0))if(f.value===e){n=f;break}if(!n)throw new Error("not a visible editor");const o=this,a=this.a++,c=new I,l=new I,u=new class{constructor(){this.a="",this.b=Object.create(null)}asWebviewUri(f){return pd(f,o.f)}get cspSource(){return Z4}set options(f){this.b=f,o.d.$setOptions(a,f)}get options(){return this.b}set html(f){this.a=f,o.d.$setHtml(a,f)}get html(){return this.a}get onDidReceiveMessage(){return c.event}postMessage(f){return o.d.$postMessage(a,f)}},h=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=u,this.onDidDispose=l.event}dispose(){o.c.delete(a)&&(o.d.$disposeEditorInset(a),l.fire(),l.dispose(),c.dispose())}};return this.d.$createEditorInset(a,n.id,n.value.document.uri,t+1,i,s||{},r.identifier,r.extensionLocation),this.c.set(a,{editor:e,inset:h,onDidReceiveMessage:c}),h}$onDidDispose(e){const t=this.c.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){this.c.get(e)?.onDidReceiveMessage.fire(t)}},XJ=class _M{static{this.a=0}constructor(t){this.c=new Map,this.b=t.getProxy(Y.MainThreadCodeMapper)}async $mapCode(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Received request to map code for unknown provider handle ${t}`);const n={textEdit:(c,l)=>{l=xs(l),this.b.$handleProgress(i.requestId,{uri:c,edits:l.map(ei.from)})},notebookEdit:(c,l)=>{l=xs(l),this.b.$handleProgress(i.requestId,{uri:c,edits:l.map(Yg.from)})}},o={location:i.location,chatRequestId:i.chatRequestId,chatRequestModel:i.chatRequestModel,chatSessionId:i.chatSessionResource?xr.parseLocalSessionId(y.revive(i.chatSessionResource)):void 0,codeBlocks:i.codeBlocks.map(c=>({code:c.code,resource:y.revive(c.resource),markdownBeforeBlock:c.markdownBeforeBlock}))};return await r.provideMappedEdits(o,n,s)??null}registerMappedEditsProvider(t,i){const s=_M.a++;return this.b.$registerCodeMapperProvider(s,t.displayName??t.name),this.c.set(s,i),{dispose:()=>this.b.$unregisterCodeMapperProvider(s)}}};function KJ(e,t,i){const s=e.getProxy(Y.MainThreadComments);class r{static{this.a=0}constructor(){this.b=new Map,this.c=new qn,t.registerArgumentProcessor({processArgument:g=>{if(g&&g.$mid===6){const v=this.b.get(g.handle);return v?v.value:g}else if(g&&g.$mid===7){const v=g,b=this.b.get(v.commentControlHandle);if(!b)return v;const S=b.getCommentThread(v.commentThreadHandle);return S?S.value:v}else if(g&&(g.$mid===9||g.$mid===8)){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);return b?g.$mid===8?b.value:{thread:b.value,text:g.text}:g}else if(g&&g.$mid===10){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);if(!b)return g;const S=g.commentUniqueId,E=b.getCommentByUniqueId(S);return E||g}else if(g&&g.$mid===11){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);if(!b)return g;const S=g.text,E=g.commentUniqueId,k=b.getCommentByUniqueId(E);return k?(typeof k.body=="string"?k.body=S:k.body=new Hi(S),k):g}return g}})}createCommentController(g,v,b){const S=r.a++,E=new o(g,S,v,b);this.b.set(E.handle,E);const k=this.c.get(g.identifier)||[];return k.push(E),this.c.set(g.identifier,k),E.value}async $createCommentThreadTemplate(g,v,b,S){const E=this.b.get(g);E&&E.$createCommentThreadTemplate(v,b,S)}async $setActiveComment(g,v){const b=this.b.get(g);b&&b.$setActiveComment(v??void 0)}async $updateCommentThreadTemplate(g,v,b){const S=this.b.get(g);S&&S.$updateCommentThreadTemplate(v,b)}$deleteCommentThread(g,v){this.b.get(g)?.$deleteCommentThread(v)}async $updateCommentThread(g,v,b){this.b.get(g)?.$updateCommentThread(v,b)}async $provideCommentingRanges(g,v,b){const S=this.b.get(g);if(!S||!S.commentingRangeProvider)return Promise.resolve(void 0);const E=await i.ensureDocumentData(y.revive(v));return fi(async()=>{const k=await S.commentingRangeProvider?.provideCommentingRanges(E.document,b);let j;return Array.isArray(k)?j={ranges:k,fileComments:!1}:k?j={ranges:k.ranges||[],fileComments:k.enableFileComments||!1}:j=k??void 0,j}).then(k=>{let j;return k&&(j={ranges:k.ranges.map(O=>U.from(O)),fileComments:k.fileComments}),j})}$toggleReaction(g,v,b,S,E){const k=this.b.get(g);return!k||!k.reactionHandler?Promise.resolve(void 0):fi(()=>{const j=k.getCommentThread(v);if(j){const O=j.getCommentByUniqueId(S.uniqueIdInThread);if(k!==void 0&&O&&k.reactionHandler)return k.reactionHandler(O,l(E))}return Promise.resolve(void 0)})}}class n{static{this.a=0}set threadId(g){this.n=g}get threadId(){return this.n}get id(){return this.n}get resource(){return this.o}get uri(){return this.o}set range(g){(g===void 0!=(this.p===void 0)||!g||!this.p||!g.isEqual(this.p))&&(this.p=g,this.b.range=g,this.c.fire())}get range(){return this.p}set canReply(g){this.d!==g&&(this.d=g,this.b.canReply=g,this.c.fire())}get canReply(){return this.d}get label(){return this.e}set label(g){this.e=g,this.b.label=g,this.c.fire()}get contextValue(){return this.f}set contextValue(g){this.f=g,this.b.contextValue=g,this.c.fire()}get comments(){return this.q}set comments(g){this.q=g,this.b.comments=g,this.c.fire()}get collapsibleState(){return this.g}set collapsibleState(g){this.g!==g&&(this.g=g,this.b.collapsibleState=g,this.c.fire())}get state(){return this.h}set state(g){this.h=g,typeof g=="object"?(T(this.extensionDescription,"commentThreadApplicability"),this.b.state=g.resolved,this.b.applicability=g.applicability):this.b.state=g,this.c.fire()}get isDisposed(){return this.j}constructor(g,v,b,S,E,k,j,O,Q){this.m=v,this.n=b,this.o=S,this.p=E,this.q=k,this.extensionDescription=j,this.r=O,this.handle=n.a++,this.commentHandle=0,this.b=Object.create(null),this.c=new I,this.onDidUpdateCommentThread=this.c.event,this.d=!0,this.k=new Map,this.l=new Vs,this.l.value=new ie,this.n===void 0&&(this.n=`${g}.${this.handle}`),s.$createCommentThread(v,this.handle,this.n,this.o,U.from(this.p),this.q.map(B=>a(this,B,this.k,this.extensionDescription)),j.identifier,this.r,Q),this.i=[],this.j=!1,this.i.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.i.push({dispose:()=>{s.$deleteCommentThread(v,this.handle)}});const F=this;this.value={get uri(){return F.uri},get range(){return F.range},set range(B){F.range=B},get comments(){return F.comments},set comments(B){F.comments=B},get collapsibleState(){return F.collapsibleState},set collapsibleState(B){F.collapsibleState=B},get canReply(){return F.canReply},set canReply(B){F.canReply=B},get contextValue(){return F.contextValue},set contextValue(B){F.contextValue=B},get label(){return F.label},set label(B){F.label=B},get state(){return F.state},set state(B){F.state=B},reveal:(B,z)=>F.reveal(B,z),hide:()=>F.hide(),dispose:()=>{F.dispose()}}}s(){this.r&&(this.r=!1,this.b.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this.j)return;this.s(),this.l.value||(this.l.value=new ie);const g=b=>Object.prototype.hasOwnProperty.call(this.b,b),v={};g("range")&&(v.range=U.from(this.p)),g("label")&&(v.label=this.label),g("contextValue")&&(v.contextValue=this.contextValue??null),g("comments")&&(v.comments=this.q.map(b=>a(this,b,this.k,this.extensionDescription))),g("collapsibleState")&&(v.collapseState=u(this.g)),g("canReply")&&(v.canReply=this.canReply),g("state")&&(v.state=h(this.h)),g("applicability")&&(v.applicability=f(this.h)),g("isTemplate")&&(v.isTemplate=this.r),this.b={},s.$updateCommentThread(this.m,this.handle,this.n,this.o,v)}getCommentByUniqueId(g){for(const v of this.k){const b=v[0],S=v[1];if(g===S)return b}}async reveal(g,v){T(this.extensionDescription,"commentReveal");let b;g&&g.body!==void 0?b=g:v=v??g;let S=b?this.k.get(b):void 0;S??=this.k.get(this.q[0]);let E=!0,k=!1;return v?.focus===mh.Reply?(k=!0,E=!1):v?.focus===mh.Comment&&(E=!1),s.$revealCommentThread(this.m,this.handle,S,{preserveFocus:E,focusReply:k})}async hide(){return s.$hideCommentThread(this.m,this.handle)}dispose(){this.j=!0,this.l.dispose(),this.i.forEach(g=>g.dispose())}}__decorate([Cf(100)],n.prototype,"eventuallyUpdateCommentThread",null);class o{get id(){return this.j}get label(){return this.k}get handle(){return this.i}get commentingRangeProvider(){return this.b}set commentingRangeProvider(g){this.b=g,g?.resourceHints&&T(this.h,"commentingRangeHint"),s.$updateCommentingRanges(this.handle,g?.resourceHints)}get reactionHandler(){return this.c}set reactionHandler(g){this.c=g,s.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!g})}get options(){return this.d}set options(g){this.d=g,s.$updateCommentControllerFeatures(this.handle,{options:this.d})}get activeComment(){return T(this.h,"activeComment"),this.e}get activeCommentThread(){return T(this.h,"activeComment"),this.f?.value}constructor(g,v,b,S){this.h=g,this.i=v,this.j=b,this.k=S,this.a=new Map,s.$registerCommentController(this.handle,b,S,this.h.identifier.value);const E=this;this.value=Object.freeze({id:E.id,label:E.label,get options(){return E.options},set options(k){E.options=k},get commentingRangeProvider(){return E.commentingRangeProvider},set commentingRangeProvider(k){E.commentingRangeProvider=k},get reactionHandler(){return E.reactionHandler},set reactionHandler(k){E.reactionHandler=k},get activeCommentThread(){return E.activeCommentThread},createCommentThread(k,j,O){return E.createCommentThread(k,j,O).value},dispose:()=>{E.dispose()}}),this.g=[],this.g.push({dispose:()=>{s.$unregisterCommentController(this.handle)}})}createCommentThread(g,v,b){const S=new n(this.id,this.handle,void 0,g,v,b,this.h,!1);return this.a.set(S.handle,S),S}$setActiveComment(g){if(!g){this.e=void 0,this.f=void 0;return}const v=this.a.get(g.commentThreadHandle);v&&(this.e=g.uniqueIdInThread?v.getCommentByUniqueId(g.uniqueIdInThread):void 0,this.f=v)}$createCommentThreadTemplate(g,v,b){const S=new n(this.id,this.handle,void 0,y.revive(g),U.to(v),[],this.h,!0,b);return S.collapsibleState=xc.Expanded,this.a.set(S.handle,S),S}$updateCommentThreadTemplate(g,v){const b=this.a.get(g);b&&(b.range=U.to(v))}$updateCommentThread(g,v){const b=this.a.get(g);if(!b)return;(E=>Object.prototype.hasOwnProperty.call(v,E))("collapseState")&&(b.collapsibleState=u(v.collapseState))}$deleteCommentThread(g){this.a.get(g)?.dispose(),this.a.delete(g)}getCommentThread(g){return this.a.get(g)}dispose(){this.a.forEach(g=>{g.dispose()}),this.g.forEach(g=>g.dispose())}}function a(p,g,v,b){let S=v.get(g);return S||(S=++p.commentHandle,v.set(g,S)),g.state!==void 0&&T(b,"commentsDraftState"),g.reactions?.some(E=>E.reactors!==void 0)&&T(b,"commentReactor"),{mode:g.mode,contextValue:g.contextValue,uniqueIdInThread:S,body:typeof g.body=="string"?g.body:pe.from(g.body),userName:g.author.name,userIconPath:g.author.iconPath,label:g.label,commentReactions:g.reactions?g.reactions.map(E=>c(E)):void 0,state:g.state,timestamp:g.timestamp?.toJSON()}}function c(p){return{label:p.label,iconPath:p.iconPath?$g(p.iconPath):void 0,count:p.count,hasReacted:p.authorHasReacted,reactors:p.reactors&&p.reactors.length>0&&typeof p.reactors[0]!="string"?p.reactors.map(g=>g.name):p.reactors}}function l(p){return{label:p.label||"",count:p.count||0,iconPath:p.iconPath?y.revive(p.iconPath):"",authorHasReacted:p.hasReacted||!1,reactors:p.reactors?.map(g=>({name:g}))}}function u(p){if(p!==void 0)switch(p){case fh.Expanded:return xc.Expanded;case fh.Collapsed:return xc.Collapsed}return xc.Collapsed}function h(p){let g;if(typeof p=="object"?g=p.resolved:g=p,g!==void 0)switch(g){case ph.Unresolved:return Lu.Unresolved;case ph.Resolved:return Lu.Resolved}return Lu.Unresolved}function f(p){let g;if(typeof p=="object"&&(g=p.applicability),g!==void 0)switch(g){case gh.Current:return Ru.Current;case gh.Outdated:return Ru.Outdated}return Ru.Current}return new r}var h1={},qe={exports:h1};(function(e,t){if(typeof h1=="object"&&typeof qe=="object")qe.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var i=t();for(var s in i)(typeof h1=="object"?h1:e)[s]=i[s]}})(typeof self<"u"?self:void 0,function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(s,r,n){i.o(s,r)||Object.defineProperty(s,r,{enumerable:!0,get:n})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,r){if(1&r&&(s=i(s)),8&r||4&r&&typeof s=="object"&&s&&s.__esModule)return s;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:s}),2&r&&typeof s!="string")for(var o in s)i.d(n,o,function(a){return s[a]}.bind(null,o));return n},i.n=function(s){var r=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(r,"a",r),r},i.o=function(s,r){return Object.prototype.hasOwnProperty.call(s,r)},i.p="",i(i.s=0)}([function(e,t,i){(function(s){var r;t=e.exports=Ze,r=typeof s=="object"&&s.env&&s.env.NODE_DEBUG&&/\bsemver\b/i.test(s.env.NODE_DEBUG)?function(){var P=Array.prototype.slice.call(arguments,0);P.unshift("SEMVER"),console.log.apply(console,P)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,a=t.re=[],c=t.src=[],l=0,u=l++;c[u]="0|[1-9]\\d*";var h=l++;c[h]="[0-9]+";var f=l++;c[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var p=l++;c[p]="("+c[u]+")\\.("+c[u]+")\\.("+c[u]+")";var g=l++;c[g]="("+c[h]+")\\.("+c[h]+")\\.("+c[h]+")";var v=l++;c[v]="(?:"+c[u]+"|"+c[f]+")";var b=l++;c[b]="(?:"+c[h]+"|"+c[f]+")";var S=l++;c[S]="(?:-("+c[v]+"(?:\\."+c[v]+")*))";var E=l++;c[E]="(?:-?("+c[b]+"(?:\\."+c[b]+")*))";var k=l++;c[k]="[0-9A-Za-z-]+";var j=l++;c[j]="(?:\\+("+c[k]+"(?:\\."+c[k]+")*))";var O=l++,Q="v?"+c[p]+c[S]+"?"+c[j]+"?";c[O]="^"+Q+"$";var F="[v=\\s]*"+c[g]+c[E]+"?"+c[j]+"?",B=l++;c[B]="^"+F+"$";var z=l++;c[z]="((?:<|>)?=?)";var ue=l++;c[ue]=c[h]+"|x|X|\\*";var Le=l++;c[Le]=c[u]+"|x|X|\\*";var ae=l++;c[ae]="[v=\\s]*("+c[Le]+")(?:\\.("+c[Le]+")(?:\\.("+c[Le]+")(?:"+c[S]+")?"+c[j]+"?)?)?";var J=l++;c[J]="[v=\\s]*("+c[ue]+")(?:\\.("+c[ue]+")(?:\\.("+c[ue]+")(?:"+c[E]+")?"+c[j]+"?)?)?";var q=l++;c[q]="^"+c[z]+"\\s*"+c[ae]+"$";var G=l++;c[G]="^"+c[z]+"\\s*"+c[J]+"$";var K=l++;c[K]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var se=l++;c[se]="(?:~>?)";var ve=l++;c[ve]="(\\s*)"+c[se]+"\\s+",a[ve]=new RegExp(c[ve],"g");var Ne=l++;c[Ne]="^"+c[se]+c[ae]+"$";var Me=l++;c[Me]="^"+c[se]+c[J]+"$";var mt=l++;c[mt]="(?:\\^)";var Vt=l++;c[Vt]="(\\s*)"+c[mt]+"\\s+",a[Vt]=new RegExp(c[Vt],"g");var tt=l++;c[tt]="^"+c[mt]+c[ae]+"$";var Rt=l++;c[Rt]="^"+c[mt]+c[J]+"$";var Si=l++;c[Si]="^"+c[z]+"\\s*("+F+")$|^$";var ii=l++;c[ii]="^"+c[z]+"\\s*("+Q+")$|^$";var As=l++;c[As]="(\\s*)"+c[z]+"\\s*("+F+"|"+c[ae]+")",a[As]=new RegExp(c[As],"g");var Dn=l++;c[Dn]="^\\s*("+c[ae]+")\\s+-\\s+("+c[ae]+")\\s*$";var bi=l++;c[bi]="^\\s*("+c[J]+")\\s+-\\s+("+c[J]+")\\s*$";var Xl=l++;c[Xl]="(<|>)?=?\\s*\\*";for(var Gr=0;Gr<35;Gr++)r(Gr,c[Gr]),a[Gr]||(a[Gr]=new RegExp(c[Gr]));function hs(P,L){if(P instanceof Ze)return P;if(typeof P!="string"||P.length>n||!(L?a[B]:a[O]).test(P))return null;try{return new Ze(P,L)}catch{return null}}function Ze(P,L){if(P instanceof Ze){if(P.loose===L)return P;P=P.version}else if(typeof P!="string")throw new TypeError("Invalid Version: "+P);if(P.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof Ze))return new Ze(P,L);r("SemVer",P,L),this.loose=L;var R=P.trim().match(L?a[B]:a[O]);if(!R)throw new TypeError("Invalid Version: "+P);if(this.raw=P,this.major=+R[1],this.minor=+R[2],this.patch=+R[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");R[4]?this.prerelease=R[4].split(".").map(function(de){if(/^[0-9]+$/.test(de)){var we=+de;if(we>=0&&we<o)return we}return de}):this.prerelease=[],this.build=R[5]?R[5].split("."):[],this.format()}t.parse=hs,t.valid=function(P,L){var R=hs(P,L);return R?R.version:null},t.clean=function(P,L){var R=hs(P.trim().replace(/^[=v]+/,""),L);return R?R.version:null},t.SemVer=Ze,Ze.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Ze.prototype.toString=function(){return this.version},Ze.prototype.compare=function(P){return r("SemVer.compare",this.version,this.loose,P),P instanceof Ze||(P=new Ze(P,this.loose)),this.compareMain(P)||this.comparePre(P)},Ze.prototype.compareMain=function(P){return P instanceof Ze||(P=new Ze(P,this.loose)),Pn(this.major,P.major)||Pn(this.minor,P.minor)||Pn(this.patch,P.patch)},Ze.prototype.comparePre=function(P){if(P instanceof Ze||(P=new Ze(P,this.loose)),this.prerelease.length&&!P.prerelease.length)return-1;if(!this.prerelease.length&&P.prerelease.length)return 1;if(!this.prerelease.length&&!P.prerelease.length)return 0;var L=0;do{var R=this.prerelease[L],de=P.prerelease[L];if(r("prerelease compare",L,R,de),R===void 0&&de===void 0)return 0;if(de===void 0)return 1;if(R===void 0)return-1;if(R!==de)return Pn(R,de)}while(++L)},Ze.prototype.inc=function(P,L){switch(P){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",L);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",L);break;case"prepatch":this.prerelease.length=0,this.inc("patch",L),this.inc("pre",L);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",L),this.inc("pre",L);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var R=this.prerelease.length;--R>=0;)typeof this.prerelease[R]=="number"&&(this.prerelease[R]++,R=-2);R===-1&&this.prerelease.push(0)}L&&(this.prerelease[0]===L?isNaN(this.prerelease[1])&&(this.prerelease=[L,0]):this.prerelease=[L,0]);break;default:throw new Error("invalid increment argument: "+P)}return this.format(),this.raw=this.version,this},t.inc=function(P,L,R,de){typeof R=="string"&&(de=R,R=void 0);try{return new Ze(P,R).inc(L,de).version}catch{return null}},t.diff=function(P,L){if(Ka(P,L))return null;var R=hs(P),de=hs(L);if(R.prerelease.length||de.prerelease.length){for(var we in R)if((we==="major"||we==="minor"||we==="patch")&&R[we]!==de[we])return"pre"+we;return"prerelease"}for(var we in R)if((we==="major"||we==="minor"||we==="patch")&&R[we]!==de[we])return we},t.compareIdentifiers=Pn;var Re=/^[0-9]+$/;function Pn(P,L){var R=Re.test(P),de=Re.test(L);return R&&de&&(P=+P,L=+L),R&&!de?-1:de&&!R?1:P<L?-1:P>L?1:0}function Ws(P,L,R){return new Ze(P,R).compare(new Ze(L,R))}function Ss(P,L,R){return Ws(P,L,R)>0}function vr(P,L,R){return Ws(P,L,R)<0}function Ka(P,L,R){return Ws(P,L,R)===0}function Jd(P,L,R){return Ws(P,L,R)!==0}function Kl(P,L,R){return Ws(P,L,R)>=0}function eu(P,L,R){return Ws(P,L,R)<=0}function ec(P,L,R,de){var we;switch(L){case"===":typeof P=="object"&&(P=P.version),typeof R=="object"&&(R=R.version),we=P===R;break;case"!==":typeof P=="object"&&(P=P.version),typeof R=="object"&&(R=R.version),we=P!==R;break;case"":case"=":case"==":we=Ka(P,R,de);break;case"!=":we=Jd(P,R,de);break;case">":we=Ss(P,R,de);break;case">=":we=Kl(P,R,de);break;case"<":we=vr(P,R,de);break;case"<=":we=eu(P,R,de);break;default:throw new TypeError("Invalid operator: "+L)}return we}function Ni(P,L){if(P instanceof Ni){if(P.loose===L)return P;P=P.value}if(!(this instanceof Ni))return new Ni(P,L);r("comparator",P,L),this.loose=L,this.parse(P),this.semver===Mo?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(P,L){return Pn(L,P)},t.major=function(P,L){return new Ze(P,L).major},t.minor=function(P,L){return new Ze(P,L).minor},t.patch=function(P,L){return new Ze(P,L).patch},t.compare=Ws,t.compareLoose=function(P,L){return Ws(P,L,!0)},t.rcompare=function(P,L,R){return Ws(L,P,R)},t.sort=function(P,L){return P.sort(function(R,de){return t.compare(R,de,L)})},t.rsort=function(P,L){return P.sort(function(R,de){return t.rcompare(R,de,L)})},t.gt=Ss,t.lt=vr,t.eq=Ka,t.neq=Jd,t.gte=Kl,t.lte=eu,t.cmp=ec,t.Comparator=Ni;var Mo={};function bt(P,L){if(P instanceof bt)return P.loose===L?P:new bt(P.raw,L);if(P instanceof Ni)return new bt(P.value,L);if(!(this instanceof bt))return new bt(P,L);if(this.loose=L,this.raw=P,this.set=P.split(/\s*\|\|\s*/).map(function(R){return this.parseRange(R.trim())},this).filter(function(R){return R.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+P);this.format()}function oi(P){return!P||P.toLowerCase()==="x"||P==="*"}function pv(P,L,R,de,we,si,it,Ei,Ht,ai,Es,yt,ci){return((L=oi(R)?"":oi(de)?">="+R+".0.0":oi(we)?">="+R+"."+de+".0":">="+L)+" "+(Ei=oi(Ht)?"":oi(ai)?"<"+(+Ht+1)+".0.0":oi(Es)?"<"+Ht+"."+(+ai+1)+".0":yt?"<="+Ht+"."+ai+"."+Es+"-"+yt:"<="+Ei)).trim()}function gv(P,L){for(var R=0;R<P.length;R++)if(!P[R].test(L))return!1;if(L.prerelease.length){for(R=0;R<P.length;R++)if(r(P[R].semver),P[R].semver!==Mo&&P[R].semver.prerelease.length>0){var de=P[R].semver;if(de.major===L.major&&de.minor===L.minor&&de.patch===L.patch)return!0}return!1}return!0}function Bs(P,L,R){try{L=new bt(L,R)}catch{return!1}return L.test(P)}function tu(P,L,R,de){var we,si,it,Ei,Ht;switch(P=new Ze(P,de),L=new bt(L,de),R){case">":we=Ss,si=eu,it=vr,Ei=">",Ht=">=";break;case"<":we=vr,si=Kl,it=Ss,Ei="<",Ht="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Bs(P,L,de))return!1;for(var ai=0;ai<L.set.length;++ai){var Es=L.set[ai],yt=null,ci=null;if(Es.forEach(function(xi){xi.semver===Mo&&(xi=new Ni(">=0.0.0")),yt=yt||xi,ci=ci||xi,we(xi.semver,yt.semver,de)?yt=xi:it(xi.semver,ci.semver,de)&&(ci=xi)}),yt.operator===Ei||yt.operator===Ht||(!ci.operator||ci.operator===Ei)&&si(P,ci.semver)||ci.operator===Ht&&it(P,ci.semver))return!1}return!0}Ni.prototype.parse=function(P){var L=this.loose?a[Si]:a[ii],R=P.match(L);if(!R)throw new TypeError("Invalid comparator: "+P);this.operator=R[1],this.operator==="="&&(this.operator=""),R[2]?this.semver=new Ze(R[2],this.loose):this.semver=Mo},Ni.prototype.toString=function(){return this.value},Ni.prototype.test=function(P){return r("Comparator.test",P,this.loose),this.semver===Mo||(typeof P=="string"&&(P=new Ze(P,this.loose)),ec(P,this.operator,this.semver,this.loose))},Ni.prototype.intersects=function(P,L){if(!(P instanceof Ni))throw new TypeError("a Comparator is required");var R;if(this.operator==="")return R=new bt(P.value,L),Bs(this.value,R,L);if(P.operator==="")return R=new bt(this.value,L),Bs(P.semver,R,L);var de=!(this.operator!==">="&&this.operator!==">"||P.operator!==">="&&P.operator!==">"),we=!(this.operator!=="<="&&this.operator!=="<"||P.operator!=="<="&&P.operator!=="<"),si=this.semver.version===P.semver.version,it=!(this.operator!==">="&&this.operator!=="<="||P.operator!==">="&&P.operator!=="<="),Ei=ec(this.semver,"<",P.semver,L)&&(this.operator===">="||this.operator===">")&&(P.operator==="<="||P.operator==="<"),Ht=ec(this.semver,">",P.semver,L)&&(this.operator==="<="||this.operator==="<")&&(P.operator===">="||P.operator===">");return de||we||si&&it||Ei||Ht},t.Range=bt,bt.prototype.format=function(){return this.range=this.set.map(function(P){return P.join(" ").trim()}).join("||").trim(),this.range},bt.prototype.toString=function(){return this.range},bt.prototype.parseRange=function(P){var L=this.loose;P=P.trim(),r("range",P,L);var R=L?a[bi]:a[Dn];P=P.replace(R,pv),r("hyphen replace",P),P=P.replace(a[As],"$1$2$3"),r("comparator trim",P,a[As]),P=(P=(P=P.replace(a[ve],"$1~")).replace(a[Vt],"$1^")).split(/\s+/).join(" ");var de=L?a[Si]:a[ii],we=P.split(" ").map(function(si){return function(it,Ei){return r("comp",it),it=function(Ht,ai){return Ht.trim().split(/\s+/).map(function(Es){return function(yt,ci){r("caret",yt,ci);var xi=ci?a[Rt]:a[tt];return yt.replace(xi,function(ds,Ee,je,pt,x){var Ct;return r("caret",yt,ds,Ee,je,pt,x),oi(Ee)?Ct="":oi(je)?Ct=">="+Ee+".0.0 <"+(+Ee+1)+".0.0":oi(pt)?Ct=Ee==="0"?">="+Ee+"."+je+".0 <"+Ee+"."+(+je+1)+".0":">="+Ee+"."+je+".0 <"+(+Ee+1)+".0.0":x?(r("replaceCaret pr",x),x.charAt(0)!=="-"&&(x="-"+x),Ct=Ee==="0"?je==="0"?">="+Ee+"."+je+"."+pt+x+" <"+Ee+"."+je+"."+(+pt+1):">="+Ee+"."+je+"."+pt+x+" <"+Ee+"."+(+je+1)+".0":">="+Ee+"."+je+"."+pt+x+" <"+(+Ee+1)+".0.0"):(r("no pr"),Ct=Ee==="0"?je==="0"?">="+Ee+"."+je+"."+pt+" <"+Ee+"."+je+"."+(+pt+1):">="+Ee+"."+je+"."+pt+" <"+Ee+"."+(+je+1)+".0":">="+Ee+"."+je+"."+pt+" <"+(+Ee+1)+".0.0"),r("caret return",Ct),Ct})}(Es,ai)}).join(" ")}(it,Ei),r("caret",it),it=function(Ht,ai){return Ht.trim().split(/\s+/).map(function(Es){return function(yt,ci){var xi=ci?a[Me]:a[Ne];return yt.replace(xi,function(ds,Ee,je,pt,x){var Ct;return r("tilde",yt,ds,Ee,je,pt,x),oi(Ee)?Ct="":oi(je)?Ct=">="+Ee+".0.0 <"+(+Ee+1)+".0.0":oi(pt)?Ct=">="+Ee+"."+je+".0 <"+Ee+"."+(+je+1)+".0":x?(r("replaceTilde pr",x),x.charAt(0)!=="-"&&(x="-"+x),Ct=">="+Ee+"."+je+"."+pt+x+" <"+Ee+"."+(+je+1)+".0"):Ct=">="+Ee+"."+je+"."+pt+" <"+Ee+"."+(+je+1)+".0",r("tilde return",Ct),Ct})}(Es,ai)}).join(" ")}(it,Ei),r("tildes",it),it=function(Ht,ai){return r("replaceXRanges",Ht,ai),Ht.split(/\s+/).map(function(Es){return function(yt,ci){yt=yt.trim();var xi=ci?a[G]:a[q];return yt.replace(xi,function(ds,Ee,je,pt,x,Ct){r("xRange",yt,ds,Ee,je,pt,x,Ct);var tc=oi(je),re=tc||oi(pt),Ge=re||oi(x);return Ee==="="&&Ge&&(Ee=""),tc?ds=Ee===">"||Ee==="<"?"<0.0.0":"*":Ee&&Ge?(re&&(pt=0),Ge&&(x=0),Ee===">"?(Ee=">=",re?(je=+je+1,pt=0,x=0):Ge&&(pt=+pt+1,x=0)):Ee==="<="&&(Ee="<",re?je=+je+1:pt=+pt+1),ds=Ee+je+"."+pt+"."+x):re?ds=">="+je+".0.0 <"+(+je+1)+".0.0":Ge&&(ds=">="+je+"."+pt+".0 <"+je+"."+(+pt+1)+".0"),r("xRange return",ds),ds})}(Es,ai)}).join(" ")}(it,Ei),r("xrange",it),it=function(Ht,ai){return r("replaceStars",Ht,ai),Ht.trim().replace(a[Xl],"")}(it,Ei),r("stars",it),it}(si,L)}).join(" ").split(/\s+/);return this.loose&&(we=we.filter(function(si){return!!si.match(de)})),we=we.map(function(si){return new Ni(si,L)})},bt.prototype.intersects=function(P,L){if(!(P instanceof bt))throw new TypeError("a Range is required");return this.set.some(function(R){return R.every(function(de){return P.set.some(function(we){return we.every(function(si){return de.intersects(si,L)})})})})},t.toComparators=function(P,L){return new bt(P,L).set.map(function(R){return R.map(function(de){return de.value}).join(" ").trim().split(" ")})},bt.prototype.test=function(P){if(!P)return!1;typeof P=="string"&&(P=new Ze(P,this.loose));for(var L=0;L<this.set.length;L++)if(gv(this.set[L],P))return!0;return!1},t.satisfies=Bs,t.maxSatisfying=function(P,L,R){var de=null,we=null;try{var si=new bt(L,R)}catch{return null}return P.forEach(function(it){si.test(it)&&(de&&we.compare(it)!==-1||(we=new Ze(de=it,R)))}),de},t.minSatisfying=function(P,L,R){var de=null,we=null;try{var si=new bt(L,R)}catch{return null}return P.forEach(function(it){si.test(it)&&(de&&we.compare(it)!==1||(we=new Ze(de=it,R)))}),de},t.validRange=function(P,L){try{return new bt(P,L).range||"*"}catch{return null}},t.ltr=function(P,L,R){return tu(P,L,"<",R)},t.gtr=function(P,L,R){return tu(P,L,">",R)},t.outside=tu,t.prerelease=function(P,L){var R=hs(P,L);return R&&R.prerelease.length?R.prerelease:null},t.intersects=function(P,L,R){return P=new bt(P,R),L=new bt(L,R),P.intersects(L)},t.coerce=function(P){if(P instanceof Ze)return P;if(typeof P!="string")return null;var L=P.match(a[K]);return L==null?null:hs((L[1]||"0")+"."+(L[2]||"0")+"."+(L[3]||"0"))}}).call(this,i(1))},function(e,t){var i,s,r=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(b){if(i===setTimeout)return setTimeout(b,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(b,0);try{return i(b,0)}catch{try{return i.call(null,b,0)}catch{return i.call(this,b,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:n}catch{i=n}try{s=typeof clearTimeout=="function"?clearTimeout:o}catch{s=o}})();var c,l=[],u=!1,h=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!u){var b=a(f);u=!0;for(var S=l.length;S;){for(c=l,l=[];++h<S;)c&&c[h].run();h=-1,S=l.length}c=null,u=!1,function(E){if(s===clearTimeout)return clearTimeout(E);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(E);try{s(E)}catch{try{return s.call(null,E)}catch{return s.call(this,E)}}}(b)}}function g(b,S){this.fun=b,this.array=S}function v(){}r.nextTick=function(b){var S=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)S[E-1]=arguments[E];l.push(new g(b,S)),l.length!==1||u||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(b){return[]},r.binding=function(b){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(b){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}])});var eae=qe.exports.SEMVER_SPEC_VERSION,tae=qe.exports.parse,iae=qe.exports.valid,sae=qe.exports.coerce,rae=qe.exports.clean,nae=qe.exports.inc,oae=qe.exports.major,aae=qe.exports.minor,cae=qe.exports.patch,lae=qe.exports.prerelease,uae=qe.exports.gt,hae=qe.exports.gte,dae=qe.exports.lt,fae=qe.exports.lte,pae=qe.exports.eq,gae=qe.exports.neq,mae=qe.exports.cmp,vae=qe.exports.compare,wae=qe.exports.rcompare,bae=qe.exports.compareIdentifiers,yae=qe.exports.rcompareIdentifiers,Aae=qe.exports.compareBuild,Sae=qe.exports.sort,Eae=qe.exports.rsort,xae=qe.exports.diff,Cae=qe.exports.validRange,kae=qe.exports.satisfies,$ae=qe.exports.maxSatisfying,Iae=qe.exports.minSatisfying,Dae=qe.exports.minVersion,Pae=qe.exports.gtr,Tae=qe.exports.ltr,Nae=qe.exports.outside,Mae=qe.exports.intersects,Lae=qe.exports.SemVer,Rae=qe.exports.Comparator,Oae=qe.exports.Range,zP=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,eZ=/^-(\d{4})(\d{2})(\d{2})$/;function tZ(e){return e=e.trim(),e==="*"||zP.test(e)}function HP(e){if(!tZ(e))return null;if(e=e.trim(),e==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const t=e.match(zP);return t?{hasCaret:t[1]==="^",hasGreaterEquals:t[1]===">=",majorBase:t[2]==="x"?0:parseInt(t[2],10),majorMustEqual:t[2]!=="x",minorBase:t[4]==="x"?0:parseInt(t[4],10),minorMustEqual:t[4]!=="x",patchBase:t[6]==="x"?0:parseInt(t[6],10),patchMustEqual:t[6]!=="x",preRelease:t[8]||null}:null}function WP(e){if(!e)return null;const t=e.majorBase,i=e.majorMustEqual,s=e.minorBase;let r=e.minorMustEqual;const n=e.patchBase;let o=e.patchMustEqual;e.hasCaret&&(t===0||(r=!1),o=!1);let a=0;if(e.preRelease){const c=eZ.exec(e.preRelease);if(c){const[,l,u,h]=c;a=Date.UTC(Number(l),Number(u)-1,Number(h))}}return{majorBase:t,majorMustEqual:i,minorBase:s,minorMustEqual:r,patchBase:n,patchMustEqual:o,isMinimum:e.hasGreaterEquals,notBefore:a}}var iZ=class{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}};function sZ(e,t){if(t.serializeBuffersForPostMessage){const i=new iZ,r=JSON.stringify(e,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a)};if(ArrayBuffer.isView(a)){const c=rZ(a);if(c)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a.buffer),view:{type:c,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),n=i.buffers.map(o=>{const a=new Uint8Array(o);return W.wrap(a)});return{message:r,buffers:n}}else return{message:JSON.stringify(e),buffers:[]}}function rZ(e){switch(e.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function nZ(e,t){const i=t.map(n=>{const o=new ArrayBuffer(n.byteLength);return new Uint8Array(o).set(n.buffer),o}),s=t.length?(n,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:c}=a,l=i[c];if(a.view)switch(a.view.type){case 1:return new Int8Array(l,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(l,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(l,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(l,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(l,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(l,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(l,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(l,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(l,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(l,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(l,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return l}return o}:void 0;return{message:JSON.parse(e,s),arrayBuffers:i}}var oZ=class{#e;#t;#i;#s;#n;#r;#a;#o;#c;#l;#u;#d;constructor(e,t,i,s,r,n,o){this.#a="",this.#c=!1,this.#l=!1,this._onMessageEmitter=new I,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#h=new I,this._onDidDispose=this.#h.event,this.#e=e,this.#t=t,this.#o=i,this.#s=s,this.#n=r,this.#r=n,this.#u=Rl(n),this.#d=aZ(n),this.#i=o}#h;dispose(){this.#c=!0,this.#h.fire(),this.#h.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#l=!0,pd(e,this.#s)}get cspSource(){const e=this.#r.extensionLocation;if(e.scheme===V.https||e.scheme===V.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+Z4}return Z4}get html(){return this.a(),this.#a}set html(e){this.a(),this.#a!==e&&(this.#a=e,this.#d&&!this.#l&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#l=!0,this.#i.report("Webview vscode-resource: uris",this.#r,"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),this.#t.$setHtml(this.#e,this.b(e)))}get options(){return this.a(),this.#o}set options(e){this.a(),Fi(this.#o,e)||this.#t.$setOptions(this.#e,BP(this.#r,this.#n,e)),this.#o=e}async postMessage(e){if(this.#c)return!1;const t=sZ(e,{serializeBuffersForPostMessage:this.#u});return this.#t.$postMessage(this.#e,t.message,...t.buffers)}a(){if(this.#c)throw new Error("Webview is disposed")}b(e){if(!this.#d)return e;const t=this.#r.extensionLocation?.scheme===V.vscodeRemote,i=this.#r.extensionLocation.scheme===V.vscodeRemote?this.#r.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,n,o,a,c)=>{const l=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=pd(l,{isRemote:t,authority:i}).toString();return`${r}${u}${c}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,n,o,a,c)=>{const l=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=pd(l,{isRemote:t,authority:i}).toString();return`${r}${u}${c}`})}};function Rl(e){try{const t=WP(HP(e.engines.vscode));return!!t&&t.majorBase>=1&&t.minorBase>=57}catch{return!1}}function aZ(e){try{const t=WP(HP(e.engines.vscode));return t?t.majorBase<1||t.majorBase===1&&t.minorBase<60:!1}catch{return!1}}var cZ=class extends Z{constructor(e,t,i,s,r){super(),this.c=t,this.f=i,this.g=s,this.h=r,this.b=new Map,this.a=e.getProxy(Y.MainThreadWebviews)}dispose(){super.dispose();for(const e of this.b.values())e.dispose();this.b.clear()}$onMessage(e,t,i){const s=this.j(e);if(s){const{message:r}=nZ(t,i.value);s._onMessageEmitter.fire(r)}}$onMissingCsp(e,t){this.g.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const s=new oZ(e,this.a,lZ(t),this.c,this.f,i,this.h);this.b.set(e,s);const r=s._onDidDispose(()=>{r.dispose(),this.deleteWebview(e)});return s}deleteWebview(e){this.b.delete(e)}j(e){return this.b.get(e)}};function d1(e){return{id:e.identifier,location:e.extensionLocation}}function BP(e,t,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||uZ(e,t)}}function lZ(e){return{enableCommandUris:e.enableCommandUris,enableScripts:e.enableScripts,enableForms:e.enableForms,portMapping:e.portMapping,localResourceRoots:e.localResourceRoots?.map(t=>y.from(t))}}function uZ(e,t){return[...(t?.getWorkspaceFolders()||[]).map(i=>i.uri),e.extensionLocation]}var hr=class VM{static{this.a=!1}constructor(t){this.d=t,this.b=new Map,this.c=1}add(t){const i=this.c++;return this.b.set(i,t),this.e(),i}get(t,i){return this.b.has(t)?this.b.get(t)[i]:void 0}delete(t){this.b.delete(t),this.e()}e(){VM.a&&console.log(`${this.d} cache size - ${this.b.size}`)}},hZ=class{constructor(e,t){this.document=e,this.b=t,this.a=1,this.c=new hr("custom documents")}addEdit(e){return this.c.add([e])}async undo(e,t){await this.f(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.f(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this.c.delete(t)}getNewBackupUri(){if(!this.b)throw new Error("Backup requires a valid storage path");const e=vZ(this.document.uri)+this.a++;return It(this.b,e)}updateBackup(e){this.d?.delete(),this.d=e}disposeBackup(){this.d?.delete(),this.d=void 0}f(e){const t=this.c.get(e,0);if(!t)throw new Error("No edit found");return t}},dZ=class{constructor(){this.a=new Map}get(e,t){return this.a.get(this.b(e,t))}add(e,t,i){const s=this.b(e,t.uri);if(this.a.has(s))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const r=new hZ(t,i);return this.a.set(s,r),r}delete(e,t){const i=this.b(e,t.uri);this.a.delete(i)}b(e,t){return`${e}@@@${t}`}},_P;(function(e){e[e.Text=0]="Text",e[e.Custom=1]="Custom"})(_P||(_P={}));var fZ=class{constructor(){this.a=new Map}addTextProvider(e,t,i){return this.b(e,{type:0,extension:t,provider:i})}addCustomProvider(e,t,i){return this.b(e,{type:1,extension:t,provider:i})}get(e){return this.a.get(e)}b(e,t){if(this.a.has(e))throw new Error(`Provider for viewType:${e} already registered`);return this.a.set(e,t),new Ce(()=>this.a.delete(e))}},pZ=class{constructor(e,t,i,s,r){this.d=t,this.f=i,this.g=s,this.h=r,this.b=new fZ,this.c=new dZ,this.a=e.getProxy(Y.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,s){const r=new ie;return gZ(i)?(r.add(this.b.addTextProvider(t,e,i)),this.a.$registerTextEditorProvider(d1(e),t,s.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},Rl(e))):(r.add(this.b.addCustomProvider(t,e,i)),f1(i)&&r.add(i.onDidChangeCustomDocument(n=>{const o=this.i(t,n.document.uri);if(mZ(n)){const a=o.addEdit(n);this.a.$onDidEdit(n.document.uri,t,a,n.label)}else this.a.$onContentChange(n.document.uri,t)})),this.a.$registerCustomEditorProvider(d1(e),t,s.webviewOptions||{},!!s.supportsMultipleEditorsPerDocument,Rl(e))),Ce.from(r,new Ce(()=>{this.a.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,s,r){const n=this.b.get(t);if(!n)throw new Error(`No provider found for '${t}'`);if(n.type!==1)throw new Error(`Invalid provide type for '${t}'`);const o=y.revive(e),a=await n.provider.openCustomDocument(o,{backupId:i,untitledDocumentData:s?.buffer},r);let c;return f1(n.provider)&&this.f&&(c=this.f.workspaceValue(n.extension)??this.f.globalValue(n.extension)),this.c.add(t,a,c),{editable:f1(n.provider)}}async $disposeCustomDocument(e,t){const i=this.b.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const s=y.revive(e),{document:r}=this.i(t,s);this.c.delete(t,r),r.dispose()}async $resolveCustomEditor(e,t,i,s,r,n){const o=this.b.get(i);if(!o)throw new Error(`No provider found for '${i}'`);const a=Kt.to(r),c=this.g.createNewWebview(t,s.contentOptions,o.extension),l=this.h.createNewWebviewPanel(t,i,s.title,a,s.options,c,s.active),u=y.revive(e);switch(o.type){case 1:{const{document:h}=this.i(i,u);return o.provider.resolveCustomEditor(h,l,n)}case 0:{const h=this.d.getDocument(u);return o.provider.resolveCustomTextEditor(h,l,n)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.i(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const s=this.b.get(i);if(!s)throw new Error(`No provider found for '${i}'`);if(!s.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const r=this.h.getWebviewPanel(e);if(!r)throw new Error("No webview found");const n=y.revive(t),o=this.d.getDocument(n);await s.provider.moveCustomTextEditor(o,r,Fe.None)}async $undo(e,t,i,s){return this.i(t,e).undo(i,s)}async $redo(e,t,i,s){return this.i(t,e).redo(i,s)}async $revert(e,t,i){const s=this.i(t,e);await this.j(t).revertCustomDocument(s.document,i),s.disposeBackup()}async $onSave(e,t,i){const s=this.i(t,e);await this.j(t).saveCustomDocument(s.document,i),s.disposeBackup()}async $onSaveAs(e,t,i,s){const r=this.i(t,e);return this.j(t).saveCustomDocumentAs(r.document,y.revive(i),s)}async $backup(e,t,i){const s=this.i(t,e),n=await this.j(t).backupCustomDocument(s.document,{destination:s.getNewBackupUri()},i);return s.updateBackup(n),n.id}i(e,t){const i=this.c.get(e,y.revive(t));if(!i)throw new Error("No custom document found");return i}j(e){const i=this.b.get(e)?.provider;if(!i||!f1(i))throw new Error("Custom document is not editable");return i}};function f1(e){return!!e.onDidChangeCustomDocument}function gZ(e){return typeof e.resolveCustomTextEditor=="function"}function mZ(e){return typeof e.undo=="function"&&typeof e.redo=="function"}function vZ(e){const t=e.scheme===V.file||e.scheme===V.untitled?e.fsPath:e.toString();return sn(t)+""}var Ba,VP=class qM{#e;#t;#i;constructor(t,i,s,r,n,o,a,c){this.d=t,this.e=i,this.f=s,this.g=r,this.h=n,this.c=!1,this.f=Math.max(r,s),this.#i=new kt(l=>o.getComparisonKey(l)),this.#e=a,this.#t=c}dispose(){this.c||(this.#t.fire([...this.#i.keys()]),this.#e?.$clear(this.e),this.#i.clear(),this.c=!0)}get name(){return this.j(),this.d}set(t,i){if(!t){this.clear();return}this.j();let s=[];if(y.isUri(t)){if(!i){this.delete(t);return}this.#i.set(t,gt(i)),s=[t]}else if(Array.isArray(t)){s=[];let o;t=[...t].sort(qM.k);for(const a of t){const[c,l]=a;if((!o||c.toString()!==o.toString())&&(o&&this.#i.get(o).length===0&&this.#i.delete(o),o=c,s.push(c),this.#i.set(c,[])),l)this.#i.get(c)?.push(...gt(l));else{const u=this.#i.get(c);u&&(u.length=0)}}}if(this.#t.fire(s),!this.#e)return;const r=[];let n=0;for(const o of s){let a=[];const c=this.#i.get(o);if(c)if(c.length>this.g){a=[];const l=[mi.Error,mi.Warning,mi.Information,mi.Hint];e:for(let u=0;u<4;u++)for(const h of c)if(h.severity===l[u]&&a.push({...Da.from(h),modelVersionId:this.h(o)})===this.g)break e;a.push({severity:ji.Info,message:d(3036,null,c.length-this.g),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...Da.from(l),modelVersionId:this.h(o)}));if(r.push([o,a]),n+=a.length,n>this.f)break}this.#e.$changeMany(this.e,r)}delete(t){this.j(),this.#t.fire([t]),this.#i.delete(t),this.#e?.$changeMany(this.e,[[t,void 0]])}clear(){this.j(),this.#t.fire([...this.#i.keys()]),this.#i.clear(),this.#e?.$clear(this.e)}forEach(t,i){this.j();for(const[s,r]of this)t.call(i,s,r,this)}*[Symbol.iterator](){this.j();for(const t of this.#i.keys())yield[t,this.get(t)]}get(t){this.j();const i=this.#i.get(t);return Array.isArray(i)?Object.freeze(i.slice(0)):[]}has(t){return this.j(),Array.isArray(this.#i.get(t))}j(){if(this.c)throw new Error("illegal state - object is disposed")}static k(t,i){return t[0].toString()<i[0].toString()?-1:t[0].toString()>i[0].toString()?1:0}},Q4=class{static{Ba=this}static{this.c=0}static{this.d=1e3}static{this.e=1.1*this.d}static _mapper(t){const i=new kt;for(const s of t)i.set(s,s);return{uris:Object.freeze(Array.from(i.values()))}}constructor(t,i,s,r){this.j=i,this.k=s,this.l=r,this.g=new Map,this.h=new MR({merge:n=>n.flat(),delay:50}),this.onDidChangeDiagnostics=Ie.map(this.h.event,Ba._mapper),this.f=t.getProxy(Y.MainThreadDiagnostics)}createDiagnosticCollection(t,i){const{g:s,f:r,h:n,j:o,k:a,l:c}=this,l=new class{$changeMany(f,p){r.$changeMany(f,p),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",t.value,f,p.length===0?"CLEARING":p)}$clear(f){r.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",t.value,f)}dispose(){r.dispose()}};let u;if(!i)i="_generated_diagnostic_collection_name_#"+Ba.c++,u=i;else if(!s.has(i))u=i;else{this.j.warn(`DiagnosticCollection with name '${i}' does already exist.`);do u=i+Ba.c++;while(s.has(u))}return new class extends VP{constructor(){super(i,u,Ba.e,Ba.d,f=>c.getDocument(f)?.version,a.extUri,l,n),s.set(u,this)}dispose(){super.dispose(),s.delete(u)}}}getDiagnostics(t){if(t)return this.m(t);{const i=new Map,s=[];for(const r of this.g.values())r.forEach((n,o)=>{let a=i.get(n.toString());typeof a>"u"&&(a=s.length,i.set(n.toString(),a),s.push([n,[]])),s[a][1]=s[a][1].concat(...o)});return s}}m(t){let i=[];for(const s of this.g.values())s.has(t)&&(i=i.concat(s.get(t)));return i}$acceptMarkersChange(t){if(!this.n){const i="_generated_mirror",s=new VP(i,i,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,r=>{},this.k.extUri,void 0,this.h);this.g.set(i,s),this.n=s}for(const[i,s]of t)this.n.set(y.revive(i),s.map(Da.to))}};Q4=Ba=__decorate([__param(1,Se),__param(2,yc)],Q4);var wZ=class{constructor(e){this.a=e.getProxy(Y.MainThreadDialogs)}showOpenDialog(e){return this.a.$showOpenDialog(e).then(t=>t?t.map(i=>y.revive(i)):void 0)}showSaveDialog(e){return this.a.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}},bZ=class GM{static{this.a=0}constructor(t,i,s){this.d=i,this.e=s,this.b=new Map,this.c=t.getProxy(Y.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(t,i){if(Object.keys(V).indexOf(t)>=0)throw new Error(`scheme '${t}' already registered`);const s=GM.a++;this.b.set(s,i),this.c.$registerTextContentProvider(s,t);let r;if(typeof i.onDidChange=="function"){let n;r=i.onDidChange(async o=>{if(o.scheme!==t){this.e.warn(`Provider for scheme '${t}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this.d.getDocument(o))return;n&&await n;const a=this.$provideTextDocumentContent(s,o).then(async c=>{if(!c&&typeof c!="string")return;const l=this.d.getDocument(o);if(!l)return;const u=HE(c);if(!l.equalLines(u))return this.c.$onVirtualDocumentChange(o,c)}).catch(lt).finally(()=>{n===a&&(n=void 0)});n=a})}return new Ce(()=>{this.b.delete(s)&&this.c.$unregisterTextContentProvider(s),r&&(r.dispose(),r=void 0)})}$provideTextDocumentContent(t,i){const s=this.b.get(t);return s?Promise.resolve(s.provideTextDocumentContent(y.revive(i),Fe.None)):Promise.reject(new Error(`unsupported uri-scheme: ${i.scheme}`))}},yZ=class{constructor(e,t,i,s={timeout:1500,errors:3}){this.c=e,this.d=t,this.f=i,this.g=s,this.a=new Mn,this.b=new WeakMap}dispose(){this.a.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,s)=>{const n={dispose:this.a.push([t,i,e])};return Array.isArray(s)&&s.push(n),n}}async $participateInSave(e,t){const i=y.revive(e);let s=!1;const r=setTimeout(()=>s=!0,this.g.timeout),n=[];try{for(const o of[...this.a]){if(s)break;const a=this.d.getDocument(i),c=await this.h(o,{document:a,reason:Fg.to(t)});n.push(c)}}finally{clearTimeout(r)}return n}h([e,t,i],s){const r=this.b.get(e);return typeof r=="number"&&r>this.g.errors?Promise.resolve(!1):this.i(i,e,t,s).then(()=>!0,n=>{if(this.c.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this.c.error(n),!(n instanceof Error)||n.message!=="concurrent_edits"){const o=this.b.get(e);this.b.set(e,o?o+1:1),typeof o=="number"&&o>this.g.errors&&this.c.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}i(e,t,i,s){const r=[],n=Date.now(),{document:o,reason:a}=s,{version:c}=o,l=Object.freeze({document:o,reason:a,waitUntil(u){if(Object.isFrozen(r))throw Av("waitUntil can not be called async");r.push(Promise.resolve(u))}});try{t.apply(i,[l])}catch(u){return Promise.reject(u)}return Object.freeze(r),new Promise((u,h)=>{const f=setTimeout(()=>h(new Error("timeout")),this.g.timeout);return Promise.all(r).then(p=>{this.c.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-n}ms`),clearTimeout(f),u(p)}).catch(p=>{clearTimeout(f),h(p)})}).then(u=>{const h={edits:[]};for(const f of u)if(Array.isArray(f)&&f.every(p=>p instanceof lo))for(const{newText:p,newEol:g,range:v}of f)h.edits.push({resource:o.uri,versionId:void 0,textEdit:{range:v&&U.from(v),text:p,eol:g&&hl.from(g)}});if(h.edits.length!==0)return c===o.version?this.f.$tryApplyWorkspaceEdit(new pi(h)):Promise.reject(new Error("concurrent_edits"))})}},AZ=class{constructor(e,t){this.a=new I,this.b=new I,this.c=new I,this.d=new I,this.e=new I,this.onDidAddDocument=this.a.event,this.onDidRemoveDocument=this.b.event,this.onDidChangeDocument=this.c.event,this.onDidChangeDocumentWithReason=this.d.event,this.onDidSaveDocument=this.e.event,this.f=new ie,this.i=new Map,this.g=e.getProxy(Y.MainThreadDocuments),this.h=t,this.h.onDidRemoveDocuments(i=>{for(const s of i)this.b.fire(s.document)},void 0,this.f),this.h.onDidAddDocuments(i=>{for(const s of i)this.a.fire(s.document)},void 0,this.f)}dispose(){this.f.dispose()}getAllDocumentData(){return[...this.h.allDocuments()]}getDocumentData(e){if(!e)return;const t=this.h.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!t?.document)throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e,t){const i=this.h.getDocument(e);if(i&&(!t?.encoding||i.document.encoding===t.encoding))return Promise.resolve(i);let s=this.i.get(e.toString());return s?t?.encoding&&(s=s.then(r=>r.document.encoding!==t.encoding?this.ensureDocumentData(e,t):r)):(s=this.g.$tryOpenDocument(e,t).then(r=>{this.i.delete(e.toString());const n=y.revive(r);return rc(this.h.getDocument(n))},r=>(this.i.delete(e.toString()),Promise.reject(r))),this.i.set(e.toString(),s)),s}createDocumentData(e){return this.g.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const i=y.revive(e),s=this.h.getDocument(i);if(!s)throw new Error("unknown document");this.b.fire(s.document),s._acceptLanguageId(t),this.a.fire(s.document)}$acceptModelSaved(e){const t=y.revive(e),i=this.h.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this.e.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=y.revive(e),s=this.h.getDocument(i);if(!s)throw new Error("unknown document");s._acceptIsDirty(t),this.c.fire({document:s.document,contentChanges:[],reason:void 0}),this.d.fire({document:s.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptEncodingChanged(e,t){const i=y.revive(e),s=this.h.getDocument(i);if(!s)throw new Error("unknown document");s._acceptEncoding(t),this.c.fire({document:s.document,contentChanges:[],reason:void 0}),this.d.fire({document:s.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptModelChanged(e,t,i){const s=y.revive(e),r=this.h.getDocument(s);if(!r)throw new Error("unknown document");r._acceptIsDirty(i),r.onEvents(t);let n;t.isUndoing?n=nh.Undo:t.isRedoing&&(n=nh.Redo),this.c.fire(f0({document:r.document,contentChanges:t.changes.map(o=>({range:U.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:n})),this.d.fire(f0({document:r.document,contentChanges:t.changes.map(o=>({range:U.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:n,detailedReason:t.detailedReason?{source:t.detailedReason.source,metadata:t.detailedReason}:void 0}))}setWordDefinitionFor(e,t){JV(e,t)}},SZ=class{constructor(e){this.b=new Map,this.c=new I,this.onDidChange=this.c.event,this.d=new Set,this.e=0,this.a=e.getProxy(Y.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,i){if(this.d.has(t))throw new Error("An embeddings provider for this model is already registered");const s=this.e++;return this.a.$registerEmbeddingProvider(s,t),this.b.set(s,{id:t,provider:i}),te(()=>{this.d.delete(t),this.a.$unregisterEmbeddingProvider(s),this.b.delete(s)})}async computeEmbeddings(e,t,i){i??=Fe.None;let s=!1;typeof t=="string"&&(t=[t],s=!0);const r=await this.a.$computeEmbeddings(e,t,i);if(r.length!==t.length)throw new Error;if(s){if(r.length!==1)throw new Error;return r[0]}return r}async $provideEmbeddings(e,t,i){const s=this.b.get(e);if(!s)return[];const r=await s.provider.provideEmbeddings(t,i);return r||[]}get embeddingsModels(){return Array.from(this.d)}$acceptEmbeddingModels(e){this.d=new Set(e),this.c.fire()}},EZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(Y.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this.a.size===0)throw new Error("No embedding vector providers registered");const s=this.a.get(e);if(!s)throw new Error("Embedding vector provider not found");const r=await s.provideEmbeddingVector(t,i);if(!r)throw new Error("Embedding vector provider returned undefined");return r}registerEmbeddingVectorProvider(e,t,i){const s=this.b;return this.b++,this.a.set(s,i),this.c.$registerAiEmbeddingVectorProvider(t,s),new Ce(()=>{this.c.$unregisterAiEmbeddingVectorProvider(s),this.a.delete(s)})}},qP;(function(e){e[e.Invalid=0]="Invalid",e[e.Start=1]="Start",e[e.H=2]="H",e[e.HT=3]="HT",e[e.HTT=4]="HTT",e[e.HTTP=5]="HTTP",e[e.F=6]="F",e[e.FI=7]="FI",e[e.FIL=8]="FIL",e[e.BeforeColon=9]="BeforeColon",e[e.AfterColon=10]="AfterColon",e[e.AlmostThere=11]="AlmostThere",e[e.End=12]="End",e[e.Accept=13]="Accept",e[e.LastKnownState=14]="LastKnownState"})(qP||(qP={}));var xZ=class{constructor(e,t,i){const s=new Uint8Array(e*t);for(let r=0,n=e*t;r<n;r++)s[r]=i;this.a=s,this.rows=e,this.cols=t}get(e,t){return this.a[e*this.cols+t]}set(e,t,i){this.a[e*this.cols+t]=i}},GP=class{constructor(e){let t=0,i=0;for(let r=0,n=e.length;r<n;r++){const[o,a,c]=e[r];a>t&&(t=a),o>i&&(i=o),c>i&&(i=c)}t++,i++;const s=new xZ(i,t,0);for(let r=0,n=e.length;r<n;r++){const[o,a,c]=e[r];s.set(o,a,c)}this.a=s,this.b=t}nextState(e,t){return t<0||t>=this.b?0:this.a.get(e,t)}},Y4=null;function CZ(){return Y4===null&&(Y4=new GP([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),Y4}var JP;(function(e){e[e.None=0]="None",e[e.ForceTermination=1]="ForceTermination",e[e.CannotEndIn=2]="CannotEndIn"})(JP||(JP={}));var gd=null;function kZ(){if(gd===null){gd=new i9(0);const e=` 	<>'"\u3001\u3002\uFF61\uFF64\uFF0C\uFF0E\uFF1A\uFF1B\u2018\u3008\u300C\u300E\u3014\uFF08\uFF3B\uFF5B\uFF62\uFF63\uFF5D\uFF3D\uFF09\u3015\u300F\u300D\u3009\u2019\uFF40\uFF5E\u2026|`;for(let i=0;i<e.length;i++)gd.set(e.charCodeAt(i),1);const t=".,;:";for(let i=0;i<t.length;i++)gd.set(t.charCodeAt(i),2)}return gd}var $Z=class W5{static a(t,i,s,r,n){let o=n-1;do{const a=i.charCodeAt(o);if(t.get(a)!==2)break;o--}while(o>r);if(r>0){const a=i.charCodeAt(r-1),c=i.charCodeAt(o);(a===40&&c===41||a===91&&c===93||a===123&&c===125)&&o--}return{range:{startLineNumber:s,startColumn:r+1,endLineNumber:s,endColumn:o+2},url:i.substring(r,o+1)}}static computeLinks(t,i=CZ()){const s=kZ(),r=[];for(let n=1,o=t.getLineCount();n<=o;n++){const a=t.getLineContent(n),c=a.length;let l=0,u=0,h=0,f=1,p=!1,g=!1,v=!1,b=!1;for(;l<c;){let S=!1;const E=a.charCodeAt(l);if(f===13){let k;switch(E){case 40:p=!0,k=0;break;case 41:k=p?0:1;break;case 91:v=!0,g=!0,k=0;break;case 93:v=!1,k=g?0:1;break;case 123:b=!0,k=0;break;case 125:k=b?0:1;break;case 39:case 34:case 96:h===E?k=1:h===39||h===34||h===96?k=0:k=1;break;case 42:k=h===42?1:0;break;case 32:k=v?0:1;break;default:k=s.get(E)}k===1&&(r.push(W5.a(s,a,n,u,l)),S=!0)}else if(f===12){let k;E===91?(g=!0,k=0):k=s.get(E),k===1?S=!0:f=13}else f=i.nextState(f,E),f===0&&(S=!0);S&&(f=1,p=!1,g=!1,b=!1,u=l+1,h=E),l++}f===13&&r.push(W5.a(s,a,n,u,c))}return r}},IZ=class{constructor(){this.a=[]}add(e){this.b=void 0,this.a.push(e)}delete(e){const t=this.a.indexOf(e);t>=0&&(this.a.splice(t,1),this.b=void 0)}c(){if(!this.b){const e=this.a.sort(),t=[];let i,s,r=14,n=14;for(const o of e){let a=i?p2(i,o):0;for(a===0?s=1:s=n;a<o.length;a++)a+1===o.length?(r=n,n=9):n+=1,t.push([s,o.toUpperCase().charCodeAt(a),n]),t.push([s,o.toLowerCase().charCodeAt(a),n]),s=n;i=o,n=r}t.push([9,58,10]),t.push([10,47,12]),this.b=new GP(t)}}provideDocumentLinks(e){this.c();const t=[],i=$Z.computeLinks({getLineContent(s){return e.lineAt(s-1).text},getLineCount(){return e.lineCount}},this.b);for(const s of i){const r=Na.to(s);r.target&&t.push(r)}return t}},DZ=class B5{constructor(t,i){this.i=i,this.b=new IZ,this.c=new Map,this.d=new Set,this.f=new Map,this.h=0,this.a=t.getProxy(Y.MainThreadFileSystem)}dispose(){this.g?.dispose()}registerFileSystemProvider(t,i,s,r={}){if(B5.j(s),this.d.has(i))throw new Error(`a provider for the scheme '${i}' is already registered`);this.g||(this.g=this.i.registerDocumentLinkProvider(t,"*",this.b));const n=this.h++;this.b.add(i),this.d.add(i),this.c.set(n,s);let o=2;r.isCaseSensitive&&(o+=1024),r.isReadonly&&(o+=2048),typeof s.copy=="function"&&(o+=8),typeof s.open=="function"&&typeof s.close=="function"&&typeof s.read=="function"&&typeof s.write=="function"&&(T(t,"fsChunks"),o+=4);let a;r.isReadonly&&Yn(r.isReadonly)&&r.isReadonly.value!==""&&(a={value:r.isReadonly.value,isTrusted:r.isReadonly.isTrusted,supportThemeIcons:r.isReadonly.supportThemeIcons,supportHtml:r.isReadonly.supportHtml,baseUri:r.isReadonly.baseUri,uris:r.isReadonly.uris}),this.a.$registerFileSystemProvider(n,i,o,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${t.identifier.value}-extension for the scheme ${i}`),console.error(l)});const c=s.onDidChangeFile(l=>{const u=[];for(const h of l){const{uri:f,type:p}=h;if(f.scheme!==i)continue;let g;switch(p){case Kc.Changed:g=0;break;case Kc.Created:g=1;break;case Kc.Deleted:g=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:g})}this.a.$onFileSystemChange(n,u)});return te(()=>{c.dispose(),this.b.delete(i),this.d.delete(i),this.c.delete(n),this.a.$unregisterProvider(n)})}static j(t){if(!t)throw new Error("MISSING provider");if(typeof t.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof t.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof t.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof t.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof t.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof t.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof t.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof t.rename!="function")throw new Error("Provider does NOT implement rename")}static k(t){const{type:i,ctime:s,mtime:r,size:n,permissions:o}=t;return{type:i,ctime:s,mtime:r,size:n,permissions:o}}$stat(t,i){return Promise.resolve(this.l(t).stat(y.revive(i))).then(s=>B5.k(s))}$readdir(t,i){return Promise.resolve(this.l(t).readDirectory(y.revive(i)))}$readFile(t,i){return Promise.resolve(this.l(t).readFile(y.revive(i))).then(s=>W.wrap(s))}$writeFile(t,i,s,r){return Promise.resolve(this.l(t).writeFile(y.revive(i),s.buffer,r))}$delete(t,i,s){return Promise.resolve(this.l(t).delete(y.revive(i),s))}$rename(t,i,s,r){return Promise.resolve(this.l(t).rename(y.revive(i),y.revive(s),r))}$copy(t,i,s,r){const n=this.l(t);if(!n.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(n.copy(y.revive(i),y.revive(s),r))}$mkdir(t,i){return Promise.resolve(this.l(t).createDirectory(y.revive(i)))}$watch(t,i,s,r){const n=this.l(t).watch(y.revive(s),r);this.f.set(i,n)}$unwatch(t,i){const s=this.f.get(i);s&&(s.dispose(),this.f.delete(i))}$open(t,i,s){const r=this.l(t);if(!r.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(r.open(y.revive(i),s))}$close(t,i){const s=this.l(t);if(!s.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(s.close(i))}$read(t,i,s,r){const n=this.l(t);if(!n.read)throw new Error('FileSystemProvider does not implement "read"');const o=W.alloc(r);return Promise.resolve(n.read(i,s,o.buffer,0,r)).then(a=>o.slice(0,a))}$write(t,i,s,r){const n=this.l(t);if(!n.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(n.write(i,s,r.buffer,0,r.byteLength))}l(t){const i=this.c.get(t);if(!i){const s=new Error;throw s.name="ENOPRO",s.message="no provider",s}return i}};function ZP(e){return typeof e.correlationId=="number"}function PZ(e){return e.recursive===!0}var QP=class JM extends Z{static{this.a=5}constructor(t,i,s,r){super(),this.h=t,this.j=i,this.m=s,this.n=r,this.c=this.D(new Vs),this.f=void 0,this.g=0}r(){const t=new ie;this.c.value=t,this.b=this.q(t),this.b.setVerboseLogging(this.m),t.add(this.b.onDidChangeFile(i=>this.h(i))),t.add(this.b.onDidLogMessage(i=>this.j(i))),t.add(this.b.onDidError(i=>this.s(i.error,i.request)))}s(t,i){this.t(t,i)?this.g<JM.a&&this.f?(this.w(`restarting watcher after unexpected error: ${t}`),this.u(this.f)):this.w(`gave up attempting to restart watcher after unexpected error: ${t}`):this.w(t)}t(t,i){return!(!this.n.restartOnError||i||t.indexOf("No space left on device")!==-1||t.indexOf("EMFILE")!==-1)}u(t){this.g++,this.r(),this.watch(t)}async watch(t){this.f=t,await this.b?.watch(t)}async setVerboseLogging(t){this.m=t,await this.b?.setVerboseLogging(t)}w(t){this.j({type:"error",message:`[File Watcher (${this.n.type})] ${t}`})}y(t){this.j({type:"trace",message:`[File Watcher (${this.n.type})] ${t}`})}dispose(){return this.b=void 0,super.dispose()}},TZ=class extends QP{constructor(e,t,i){super(e,t,i,{type:"node.js",restartOnError:!1})}},NZ=class extends QP{constructor(e,t,i){super(e,t,i,{type:"universal",restartOnError:!0})}};function YP(e){return e.map(t=>({type:t.type,resource:y.revive(t.resource),cId:t.cId}))}function MZ(e){const t=new LZ;for(const i of e)t.processEvent(i);return t.coalesce()}function XP(e,t){return typeof t=="string"&&!t.startsWith(la)&&!ks(t)?{base:e,pattern:t}:t}function KP(e,t,i){const s=[];for(const r of t)s.push(tr(XP(e,r),{ignoreCase:i}));return s}var LZ=class{constructor(){this.a=new Set,this.b=new Map}c(e){return $t?e.resource.fsPath:e.resource.fsPath.toLowerCase()}processEvent(e){const t=this.b.get(this.c(e));let i=!1;if(t){const s=t.type,r=e.type;t.resource.fsPath!==e.resource.fsPath&&(e.type===2||e.type===1)?i=!0:s===1&&r===2?(this.b.delete(this.c(e)),this.a.delete(t)):s===2&&r===1?t.type=0:s===1&&r===0||(t.type=r)}else i=!0;i&&(this.a.add(e),this.b.set(this.c(e),e))}coalesce(){const e=[],t=[];return Array.from(this.a).filter(i=>i.type!==2?(e.push(i),!1):!0).sort((i,s)=>i.resource.fsPath.length-s.resource.fsPath.length).filter(i=>t.some(s=>Tz(i.resource.fsPath,s,!$t))?!1:(t.push(i.resource.fsPath),!0)).concat(e)}};function RZ(e,t){if(typeof t=="number")switch(e.type){case 1:return(t&4)===0;case 2:return(t&8)===0;case 0:return(t&2)===0}return!1}function OZ(e){if(typeof e=="number"){const t=[];return e&4&&t.push("Added"),e&8&&t.push("Deleted"),e&2&&t.push("Updated"),t.length===0?"<all>":`[${t.join(", ")}]`}return"<none>"}var FZ=class{get ignoreCreateEvents(){return!!(this.h&1)}get ignoreChangeEvents(){return!!(this.h&2)}get ignoreDeleteEvents(){return!!(this.h&4)}constructor(e,t,i,s,r,n,o,a){this.a=Math.random(),this.b=new I,this.c=new I,this.d=new I,this.h=0,a.ignoreCreateEvents&&(this.h+=1),a.ignoreChangeEvents&&(this.h+=2),a.ignoreDeleteEvents&&(this.h+=4);const c=typeof o=="string"?!((i.getCapabilities(V.file)??0)&1024):i.extUri.ignorePathCasing(y.revive(o.baseUri)),l=tr(o,{ignoreCase:c}),u=typeof o=="string",h=!1,f=n(p=>{if(!(typeof p.session=="number"&&p.session!==this.a)&&!(h&&typeof p.session>"u")){if(!a.ignoreCreateEvents)for(const g of p.created){const v=y.revive(g);l(v.fsPath)&&(!u||s.getWorkspaceFolder(v))&&this.b.fire(v)}if(!a.ignoreChangeEvents)for(const g of p.changed){const v=y.revive(g);l(v.fsPath)&&(!u||s.getWorkspaceFolder(v))&&this.c.fire(v)}if(!a.ignoreDeleteEvents)for(const g of p.deleted){const v=y.revive(g);l(v.fsPath)&&(!u||s.getWorkspaceFolder(v))&&this.d.fire(v)}}});this.g=Ce.from(this.i(e,s,t,r,o,a,!1),this.b,this.c,this.d,f)}i(e,t,i,s,r,n,o){const a=Ce.from();if(typeof r=="string"||n.ignoreChangeEvents&&n.ignoreCreateEvents&&n.ignoreDeleteEvents)return a;const c=e.getProxy(Y.MainThreadFileSystemEventService);let l=!1;(r.pattern.includes(la)||r.pattern.includes(Sw))&&(l=!0);const u=[];let h,f;if(o)(n.ignoreChangeEvents||n.ignoreCreateEvents||n.ignoreDeleteEvents)&&(f=14,n.ignoreChangeEvents&&(f&=-3),n.ignoreCreateEvents&&(f&=-5),n.ignoreDeleteEvents&&(f&=-9));else if(l&&u.length===0){const p=t.getWorkspaceFolder(y.revive(r.baseUri)),g=i.getConfiguration("files",p).get("watcherExclude");if(g)for(const v in g)v&&g[v]===!0&&u.push(v)}else if(!l){const p=t.getWorkspaceFolder(y.revive(r.baseUri));if(p){const g=i.getConfiguration("files",p).get("watcherExclude");if(g){for(const v in g)if(v&&g[v]===!0){const b=`${jn(v,"/")}/${la}`;h||(h=[]),h.push(XP(p.uri.fsPath,b))}}if(!h||h.length===0)return a}}return c.$watch(s.identifier.value,this.a,r.baseUri,{recursive:l,excludes:u,includes:h,filter:f},!!o),Ce.from({dispose:()=>c.$unwatch(this.a)})}dispose(){this.g.dispose()}get onDidCreate(){return this.b.event}get onDidChange(){return this.c.event}get onDidDelete(){return this.d.event}},UZ=class{get created(){return this.a.value}get changed(){return this.b.value}get deleted(){return this.c.value}constructor(e){this.d=e,this.a=new Tt(()=>this.d.created.map(y.revive)),this.b=new Tt(()=>this.d.changed.map(y.revive)),this.c=new Tt(()=>this.d.deleted.map(y.revive)),this.session=this.d.session}},jZ=class{constructor(e,t,i){this.j=e,this.k=t,this.l=i,this.a=new I,this.b=new I,this.c=new I,this.d=new I,this.g=new cu,this.h=new cu,this.i=new cu,this.onDidRenameFile=this.b.event,this.onDidCreateFile=this.c.event,this.onDidDeleteFile=this.d.event}createFileSystemWatcher(e,t,i,s,r,n){return new FZ(this.j,t,i,e,s,this.a.event,_i.from(r),n)}$onFileEvent(e){this.a.fire(new UZ(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this.b.fire(Object.freeze({files:t.map(i=>({oldUri:y.revive(i.source),newUri:y.revive(i.target)}))}));break;case 1:this.d.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;case 0:case 3:this.c.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;default:}}getOnWillRenameFileEvent(e){return this.m(e,this.g)}getOnWillCreateFileEvent(e){return this.m(e,this.h)}getOnWillDeleteFileEvent(e){return this.m(e,this.i)}m(e,t){return(i,s,r)=>{const n=function(a){i.call(s,a)};return n.extension=e,t.event(n,void 0,r)}}async $onWillRunFileOperation(e,t,i,s){switch(e){case 2:return await this.n(this.g,{files:t.map(r=>({oldUri:y.revive(r.source),newUri:y.revive(r.target)}))},i,s);case 1:return await this.n(this.i,{files:t.map(r=>y.revive(r.target))},i,s);case 0:case 3:return await this.n(this.h,{files:t.map(r=>y.revive(r.target))},i,s)}}async n(e,t,i,s){const r=new Set,n=[];if(await e.fireAsync(t,s,async(a,c)=>{const l=Date.now(),u=await Promise.resolve(a);u instanceof wa&&(n.push([c.extension,u]),r.add(c.extension.displayName??c.extension.identifier.value)),Date.now()-l>i&&this.k.warn("SLOW file-participant",c.extension.identifier)}),s.isCancellationRequested||n.length===0)return;const o={edits:[]};for(const[,a]of n){const{edits:c}=os.from(a,{getTextDocumentVersion:l=>this.l.getDocument(l)?.version,getNotebookDocumentVersion:()=>{}});o.edits=o.edits.concat(c)}return{edit:o,extensionNames:Array.from(r)}}},zZ=class{constructor(e,t,i,s,r){this.a=t,this.b=i,this.c=s;const n=new Ae("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new _("showOptions","Show Options",o=>!0,o=>o),new _("resource","Interactive resource Uri",o=>!0,o=>o),new _("controllerId","Notebook controller Id",o=>!0,o=>o),new _("title","Interactive editor title",o=>!0,o=>o)],new be("Notebook and input URI",o=>{if(r.debug("[ExtHostInteractive] open iw with notebook editor id",o.notebookEditorId),o.notebookEditorId!==void 0){const a=this.a.getEditorById(o.notebookEditorId);return r.debug("[ExtHostInteractive] notebook editor found",a.id),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri),notebookEditor:a.apiEditor}}return r.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",o.notebookUri,o.inputUri),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri)}}));this.c.registerApiCommand(n)}$willAddInteractiveDocument(e,t,i,s){this.b.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,t){this.b.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}},HZ=class{constructor(e){this.b=0,this.a=e.getProxy(Y.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this.b++;return this.a.$registerResourceLabelFormatter(t,e),te(()=>{this.a.$unregisterResourceLabelFormatter(t)})}},e3;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(e3||(e3={}));var WZ=class Hs extends rt{constructor(t,i,s,r){super(t,i,s,r),this.selectionStartLineNumber=t,this.selectionStartColumn=i,this.positionLineNumber=s,this.positionColumn=r}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(t){return Hs.selectionsEqual(this,t)}static selectionsEqual(t,i){return t.selectionStartLineNumber===i.selectionStartLineNumber&&t.selectionStartColumn===i.selectionStartColumn&&t.positionLineNumber===i.positionLineNumber&&t.positionColumn===i.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(t,i){return this.getDirection()===0?new Hs(this.startLineNumber,this.startColumn,t,i):new Hs(t,i,this.startLineNumber,this.startColumn)}getPosition(){return new ms(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new ms(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,i){return this.getDirection()===0?new Hs(t,i,this.endLineNumber,this.endColumn):new Hs(this.endLineNumber,this.endColumn,t,i)}static fromPositions(t,i=t){return new Hs(t.lineNumber,t.column,i.lineNumber,i.column)}static fromRange(t,i){return i===0?new Hs(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new Hs(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new Hs(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(t,i){if(t&&!i||!t&&i)return!1;if(!t&&!i)return!0;if(t.length!==i.length)return!1;for(let s=0,r=t.length;s<r;s++)if(!this.selectionsEqual(t[s],i[s]))return!1;return!0}static isISelection(t){return!!t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(t,i,s,r,n){return n===0?new Hs(t,i,s,r):new Hs(s,r,t,i)}},t3=class ZM{constructor(t,i){this.d=t,this.e=i}async provideDocumentSymbols(t,i){const s=this.d.getDocument(t),r=await this.e.provideDocumentSymbols(s,i);if(!xv(r))return r[0]instanceof Ku?r.map(ry.from):ZM.f(r)}static f(t){t=t.slice(0).sort((r,n)=>{let o=r.location.range.start.compareTo(n.location.range.start);return o===0&&(o=n.location.range.end.compareTo(r.location.range.end)),o});const i=[],s=[];for(const r of t){const n={name:r.name||"!!MISSING: name!!",kind:Ls.from(r.kind),tags:r.tags?.map(dn.from)||[],detail:"",containerName:r.containerName,range:U.from(r.location.range),selectionRange:U.from(r.location.range),children:[]};for(;;){if(s.length===0){s.push(n),i.push(n);break}const o=s[s.length-1];if(rt.containsRange(o.range,n.range)&&!rt.equalsRange(o.range,n.range)){o.children?.push(n),s.push(n);break}s.pop()}}return i}},p1=class{constructor(e,t,i,s,r,n){this.f=e,this.g=t,this.h=i,this.j=s,this.k=r,this.l=n,this.d=new hr("CodeLens"),this.e=new Map}async provideCodeLenses(e,t){const i=this.f.getDocument(e),s=await this.h.provideCodeLenses(i,t);if(!s||t.isCancellationRequested)return;const r=this.d.add(s),n=new ie;this.e.set(r,n);const o={cacheId:r,lenses:[]};for(let a=0;a<s.length;a++){if(!xe.isRange(s[a].range)){console.warn("INVALID code lens, range is not defined",this.j.identifier.value);continue}o.lenses.push({cacheId:[r,a],range:U.from(s[a].range),command:this.g.toInternal(s[a].command,n)})}return o}async resolveCodeLens(e,t){const i=e.cacheId&&this.d.get(...e.cacheId);if(!i)return;let s;if(typeof this.h.resolveCodeLens!="function"||i.isResolved?s=i:s=await this.h.resolveCodeLens(i,t),s||(s=i),t.isCancellationRequested)return;const r=e.cacheId&&this.e.get(e.cacheId[0]);if(r){if(!s.command){const n=new Error("INVALID code lens resolved, lacks command: "+this.j.identifier.value);this.k.onExtensionError(this.j.identifier,n),this.l.error(n);return}return e.command=this.g.toInternal(s.command,r),e}}releaseCodeLenses(e){this.e.get(e)?.dispose(),this.e.delete(e),this.d.delete(e)}};function g1(e){return Array.isArray(e)?e.map(Ih.from):e?[Ih.from(e)]:[]}var i3=class{constructor(e,t){this.d=e,this.e=t}async provideDefinition(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideDefinition(s,r,i);return g1(n)}},s3=class{constructor(e,t){this.d=e,this.e=t}async provideDeclaration(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideDeclaration(s,r,i);return g1(n)}},r3=class{constructor(e,t){this.d=e,this.e=t}async provideImplementation(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideImplementation(s,r,i);return g1(n)}},n3=class{constructor(e,t){this.d=e,this.e=t}async provideTypeDefinition(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideTypeDefinition(s,r,i);return g1(n)}},X4=class QM{static{this.f=10}constructor(t,i){this.g=t,this.h=i,this.d=0,this.e=new Map}async provideHover(t,i,s,r){const n=this.g.getDocument(t),o=Xe.to(i);let a;if(s&&s.verbosityRequest){const h=s.verbosityRequest.previousHover.id,f=this.e.get(h);if(!f)throw new Error(`Hover with id ${h} not found`);const p={verbosityDelta:s.verbosityRequest.verbosityDelta,previousHover:f};a=await this.h.provideHover(n,o,r,p)}else a=await this.h.provideHover(n,o,r);if(!a||xv(a.contents))return;a.range||(a.range=n.getWordRangeAtPosition(o)),a.range||(a.range=new xe(o,o));const c=Dh.from(a),l=this.d;if(this.e.size===QM.f){const h=Math.min(...this.e.keys());this.e.delete(h)}return this.e.set(l,a),this.d+=1,{...c,id:l}}releaseHover(t){this.e.delete(t)}},o3=class{constructor(e,t){this.d=e,this.e=t}async provideEvaluatableExpression(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideEvaluatableExpression(s,r,i);if(n)return ay.from(n)}},a3=class{constructor(e,t){this.d=e,this.e=t}async provideInlineValues(e,t,i,s){const r=this.d.getDocument(e),n=await this.e.provideInlineValues(r,U.to(t),Pg.to(i),s);if(Array.isArray(n))return n.map(o=>Dg.from(o))}},c3=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentHighlights(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideDocumentHighlights(s,r,i);if(Array.isArray(n))return n.map(cl.from)}},l3=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i}async provideMultiDocumentHighlights(e,t,i,s){const r=this.d.getDocument(e),n=i.map(c=>{try{return this.d.getDocument(c)}catch(l){this.f.error("Error: Unable to retrieve document from URI: "+c+". Error message: "+l);return}}).filter(c=>c!==void 0),o=Xe.to(t),a=await this.e.provideMultiDocumentHighlights(r,o,n,s);if(Array.isArray(a))return a.map(cy.from)}},u3=class{constructor(e,t){this.d=e,this.e=t}async provideLinkedEditingRanges(e,t,i){const s=this.d.getDocument(e),r=Xe.to(t),n=await this.e.provideLinkedEditingRanges(s,r,i);if(n&&Array.isArray(n.ranges))return{ranges:gt(n.ranges.map(U.from)),wordPattern:n.wordPattern}}},h3=class{constructor(e,t){this.d=e,this.e=t}async provideReferences(e,t,i,s){const r=this.d.getDocument(e),n=Xe.to(t),o=await this.e.provideReferences(r,n,i,s);if(Array.isArray(o))return o.map(Bi.from)}},m1=class uv{static{this.d=1e3}constructor(t,i,s,r,n,o,a){this.g=t,this.h=i,this.j=s,this.k=r,this.l=n,this.m=o,this.n=a,this.e=new hr("CodeAction"),this.f=new Map}async provideCodeActions(t,i,s,r){const n=this.g.getDocument(t),o=WZ.isISelection(i)?or.to(i):U.to(i),a=[];for(const p of this.j.getDiagnostics(t))if(o.intersection(p.range)&&a.push(p)>uv.d)break;const c={diagnostics:a,only:s.only?new xt(s.only):void 0,triggerKind:Sy.to(s.trigger)},l=await this.k.provideCodeActions(n,o,c,r);if(!nu(l)||r.isCancellationRequested)return;const u=this.e.add(l),h=new ie;this.f.set(u,h);const f=[];for(let p=0;p<l.length;p++){const g=l[p];if(g)if(uv.o(g)&&!(g instanceof th))this.n.report("CodeActionProvider.provideCodeActions - return commands",this.m,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:g.title,command:this.h.toInternal(g,h)});else{const v=g;c.only&&(v.kind?c.only.contains(v.kind)||this.l.warn(`${this.m.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action is of kind '${v.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this.l.warn(`${this.m.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const b=v.ranges??[];f.push({cacheId:[u,p],title:v.title,command:v.command&&this.h.toInternal(v.command,h),diagnostics:v.diagnostics&&v.diagnostics.map(Da.from),edit:v.edit&&os.from(v.edit,void 0),kind:v.kind&&v.kind.value,isPreferred:v.isPreferred,isAI:et(this.m,"codeActionAI")?v.isAI:!1,ranges:et(this.m,"codeActionRanges")?gt(b.map(U.from)):void 0,disabled:v.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(t,i){const[s,r]=t,n=this.e.get(s,r);if(!n||uv.o(n))return{};if(!this.k.resolveCodeAction)return{};const o=await this.k.resolveCodeAction(n,i)??n;let a;o.edit&&(a=os.from(o.edit,void 0));let c;if(o.command){const l=this.f.get(s);l&&(c=this.h.toInternal(o.command,l))}return{edit:a,command:c}}releaseCodeActions(t){this.f.get(t)?.dispose(),this.f.delete(t),this.e.delete(t)}static o(t){return typeof t.command=="string"&&typeof t.title=="string"}},md=class{constructor(e,t,i,s,r){this.f=e,this.g=t,this.h=i,this.j=s,this.k=r,this.e=new hr("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,t,i,s){if(!this.h.prepareDocumentPaste)return;this.d=void 0;const r=this.g.getDocument(e),n=t.map(u=>U.to(u)),o=vl.toDataTransfer(i,()=>{throw new GL});if(await this.h.prepareDocumentPaste(r,n,o,s),s.isCancellationRequested)return;const a=Array.from(o).filter(([,u])=>!(u instanceof qp)),c=new Map,l=await Promise.all(Array.from(a,async([u,h])=>{const f=Nt();return c.set(f,h),[u,await La.from(u,h,f)]}));return this.d=c,{items:l}}async providePasteEdits(e,t,i,s,r,n){if(!this.h.provideDocumentPasteEdits)return[];const o=this.g.getDocument(t),a=i.map(f=>U.to(f)),c=s.items.map(([f,p])=>{const g=this.d?.get(p.id);return g?[f,g]:[f,La.to(f,p,async v=>(await this.f.$resolvePasteFileData(this.j,e,v)).buffer)]}),l=new Gc(c),u=await this.h.provideDocumentPasteEdits(o,a,l,{only:r.only?new po(r.only):void 0,triggerKind:r.triggerKind},n);if(!u||n.isCancellationRequested)return[];const h=this.e.add(u);return u.map((f,p)=>({_cacheId:[h,p],title:f.title??d(3039,null,this.k.displayName||this.k.name),kind:f.kind,yieldTo:f.yieldTo?.map(g=>g.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?os.from(f.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,t){const[i,s]=e,r=this.e.get(i,s);if(!r||!this.h.resolveDocumentPasteEdit)return{};const n=await this.h.resolveDocumentPasteEdit(r,t)??r;return{insertText:n.insertText,additionalEdit:n.additionalEdit?os.from(n.additionalEdit,void 0):void 0}}releasePasteEdits(e){this.e.delete(e)}},d3=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentFormattingEdits(e,t,i){const s=this.d.getDocument(e),r=await this.e.provideDocumentFormattingEdits(s,t,i);if(Array.isArray(r))return r.map(ei.from)}},K4=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentRangeFormattingEdits(e,t,i,s){const r=this.d.getDocument(e),n=U.to(t),o=await this.e.provideDocumentRangeFormattingEdits(r,n,i,s);if(Array.isArray(o))return o.map(ei.from)}async provideDocumentRangesFormattingEdits(e,t,i,s){Iv(typeof this.e.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const r=this.d.getDocument(e),n=t.map(U.to),o=await this.e.provideDocumentRangesFormattingEdits(r,n,i,s);if(Array.isArray(o))return o.map(ei.from)}},f3=class{constructor(e,t){this.d=e,this.e=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,s,r){const n=this.d.getDocument(e),o=Xe.to(t),a=await this.e.provideOnTypeFormattingEdits(n,o,i,s,r);if(Array.isArray(a))return a.map(ei.from)}},v1=class{constructor(e,t){this.e=e,this.f=t,this.d=new hr("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this.e.provideWorkspaceSymbols(e,t);if(!nu(i))return{symbols:[]};const s=this.d.add(i),r={cacheId:s,symbols:[]};for(let n=0;n<i.length;n++){const o=i[n];if(!o||!o.name){this.f.warn("INVALID SymbolInformation",o);continue}r.symbols.push({...Pa.from(o),cacheId:[s,n]})}return r}async resolveWorkspaceSymbol(e,t){if(typeof this.e.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this.d.get(...e.cacheId);if(i){const s=await this.e.resolveWorkspaceSymbol(i,t);return s&&en(e,Pa.from(s),!0)}}releaseWorkspaceSymbols(e){this.d.delete(e)}},w1=class _5{static supportsResolving(t){return typeof t.prepareRename=="function"}constructor(t,i,s){this.d=t,this.e=i,this.f=s}async provideRenameEdits(t,i,s,r){const n=this.d.getDocument(t),o=Xe.to(i);try{const a=await this.e.provideRenameEdits(n,o,s,r);return a?os.from(a):void 0}catch(a){const c=_5.g(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(t,i,s){if(typeof this.e.prepareRename!="function")return Promise.resolve(void 0);const r=this.d.getDocument(t),n=Xe.to(i);try{const o=await this.e.prepareRename(r,n,s);let a,c;if(xe.isRange(o)?(a=o,c=r.getText(o)):At(o)&&(a=o.range,c=o.placeholder),!a||!c)return;if(a.start.line>n.line||a.end.line<n.line){this.f.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:U.from(a),text:c}}catch(o){const a=_5.g(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static g(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},eS=class V5{static{this.d={[Wf.Invoke]:dh.Invoke,[Wf.Automatic]:dh.Automatic}}constructor(t,i,s){this.e=t,this.f=i,this.g=s}async supportsAutomaticNewSymbolNamesTriggerKind(){return this.f.supportsAutomaticTriggerKind}async provideNewSymbolNames(t,i,s,r){const n=this.e.getDocument(t),o=U.to(i);try{const a=V5.d[s],c=await this.f.provideNewSymbolNames(n,o,a,r);return c?c.map(l=>typeof l=="string"?{newSymbolName:l}:{newSymbolName:l.newSymbolName,tags:l.tags}):void 0}catch(a){this.g.error(V5.h(a)??JSON.stringify(a,null,"	"));return}}static h(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},tS=class{constructor(e,t){this.resultId=e,this.tokens=t}},iS=class gr{constructor(t,i){this.f=t,this.g=i,this.e=1,this.d=new Map}async provideDocumentSemanticTokens(t,i,s){const r=this.f.getDocument(t),n=i!==0?this.d.get(i):null;let o=typeof n?.resultId=="string"&&typeof this.g.provideDocumentSemanticTokensEdits=="function"?await this.g.provideDocumentSemanticTokensEdits(r,n.resultId,s):await this.g.provideDocumentSemanticTokens(r,s);return n&&this.d.delete(i),o?(o=gr.h(o),this.o(gr.n(n,o),o)):null}async releaseDocumentSemanticColoring(t){this.d.delete(t)}static h(t){return gr.j(t)?gr.k(t)?t:new el(new Uint32Array(t.data),t.resultId):gr.l(t)?gr.m(t)?t:new Xp(t.edits.map(i=>new A7(i.start,i.deleteCount,i.data?new Uint32Array(i.data):i.data)),t.resultId):t}static j(t){return t&&!!t.data}static k(t){return t.data instanceof Uint32Array}static l(t){return t&&Array.isArray(t.edits)}static m(t){for(const i of t.edits)if(!(i.data instanceof Uint32Array))return!1;return!0}static n(t,i){if(!gr.j(i)||!t||!t.tokens)return i;const s=t.tokens,r=s.length,n=i.data,o=n.length;let a=0;const c=Math.min(r,o);for(;a<c&&s[a]===n[a];)a++;if(a===r&&a===o)return new Xp([],i.resultId);let l=0;const u=c-a;for(;l<u&&s[r-l-1]===n[o-l-1];)l++;return new Xp([{start:a,deleteCount:r-a-l,data:n.subarray(a,o-l)}],i.resultId)}o(t,i){if(gr.j(t)){const s=this.e++;return this.d.set(s,new tS(t.resultId,t.data)),_4({id:s,type:"full",data:t.data})}if(gr.l(t)){const s=this.e++;return gr.j(i)?this.d.set(s,new tS(i.resultId,i.data)):this.d.set(s,new tS(t.resultId)),_4({id:s,type:"delta",deltas:(t.edits||[]).map(r=>({start:r.start,deleteCount:r.deleteCount,data:r.data}))})}return null}},p3=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentRangeSemanticTokens(e,t,i){const s=this.d.getDocument(e),r=await this.e.provideDocumentRangeSemanticTokens(s,U.to(t),i);return r?this.f(r):null}f(e){return _4({id:0,type:"full",data:e.data})}},vd=class YM{static supportsResolving(t){return typeof t.resolveCompletionItem=="function"}constructor(t,i,s,r,n){this.f=t,this.g=i,this.h=s,this.j=r,this.k=n,this.d=new hr("CompletionItem"),this.e=new Map}async provideCompletionItems(t,i,s,r){const n=this.f.getDocument(t),o=Xe.to(i),a=n.getWordRangeAtPosition(o)||new xe(o,o),c=a.with({end:o}),l=new Qi,u=await this.h.provideCompletionItems(n,o,r,uy.to(s));if(!u||r.isCancellationRequested)return;const h=Array.isArray(u)?new Fc(u):u,f=YM.supportsResolving(this.h)?this.d.add(h.items):this.d.add([]),p=new ie;this.e.set(f,p);const g=[],v={x:f,b:g,a:{replace:U.from(a),insert:U.from(c)},c:h.isIncomplete||void 0,d:l.elapsed()};for(let b=0;b<h.items.length;b++){const S=h.items[b],E=this.l(S,[f,b],c,a);g.push(E)}return v}async resolveCompletionItem(t,i){if(typeof this.h.resolveCompletionItem!="function")return;const s=this.d.get(...t);if(!s)return;const r=this.l(s,t),n=await this.h.resolveCompletionItem(s,i);if(!n)return;const o=this.l(n,t);return(r.h!==o.h||r.i!==o.i)&&this.j.report("CompletionItem.insertText",this.k,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(r.n!==o.n||r.o!==o.o||!Fi(r.p,o.p))&&this.j.report("CompletionItem.command",this.k,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...r,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(t){this.e.get(t)?.dispose(),this.e.delete(t),this.d.delete(t)}l(t,i,s,r){const n=this.e.get(i[0]);if(!n)throw Error("DisposableStore is missing...");const o=this.g.toInternal(t.command,n),a={x:i,a:t.label,b:t.kind!==void 0?Ng.from(t.kind):void 0,m:t.tags&&t.tags.map(Tg.from),c:t.detail,d:typeof t.documentation>"u"?void 0:pe.fromStrict(t.documentation),e:t.sortText!==t.label?t.sortText:void 0,f:t.filterText!==t.label?t.filterText:void 0,g:t.preselect||void 0,i:t.keepWhitespace?1:0,k:t.commitCharacters?.join(""),l:t.additionalTextEdits&&t.additionalTextEdits.map(ei.from),n:o?.$ident,o:o?.id,p:o?.$ident?void 0:o?.arguments};t.textEdit?(this.j.report("CompletionItem.textEdit",this.k,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=t.textEdit.newText):typeof t.insertText=="string"?a.h=t.insertText:t.insertText instanceof ma&&(a.h=t.insertText.value,a.i|=4);let c;return t.textEdit?c=t.textEdit.range:t.range&&(c=t.range),xe.isRange(c)?a.j=U.from(c):c&&(!s?.isEqual(c.inserting)||!r?.isEqual(c.replacing))&&(a.j={insert:U.from(c.inserting),replace:U.from(c.replacing)}),a}},ko=class{constructor(e,t,i,s){this.f=e,this.g=t,this.h=i,this.j=s,this.d=new BZ,this.k={[zf.Automatic]:hh.Automatic,[zf.Explicit]:hh.Invoke},this.e=et(this.f,"inlineCompletionsAdditions")}get supportsHandleEvents(){return et(this.f,"inlineCompletionsAdditions")&&(typeof this.h.handleDidShowCompletionItem=="function"||typeof this.h.handleDidPartiallyAcceptCompletionItem=="function"||typeof this.h.handleDidRejectCompletionItem=="function"||typeof this.h.handleEndOfLifetime=="function")}get supportsSetModelId(){return et(this.f,"inlineCompletionsAdditions")&&typeof this.h.setCurrentModelId=="function"}get modelInfo(){if(this.e)return this.h.modelInfo?{models:this.h.modelInfo.models,currentModelId:this.h.modelInfo.currentModelId}:void 0}setCurrentModelId(e){this.e&&this.h.setCurrentModelId?.(e)}async provideInlineCompletions(e,t,i,s){const r=this.g.getDocument(e),n=Xe.to(t),o=await this.h.provideInlineCompletionItems(r,n,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:U.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.k[i.triggerKind],requestUuid:i.requestUuid,requestIssuedDateTime:i.requestIssuedDateTime,earliestShownDateTime:i.earliestShownDateTime},s);if(!o)return;const{resultItems:a,list:c}=Array.isArray(o)?{resultItems:o,list:void 0}:{resultItems:o.items,list:o},l=this.e?Array.isArray(o)?[]:o.commands||[]:[],u=this.e&&!Array.isArray(o)?o.enableForwardStability:void 0;let h;return{pid:this.d.createReferenceId({dispose(){h?.dispose()},items:a,list:c}),languageId:r.languageId,items:a.map((g,v)=>{let b;g.command&&(h||(h=new ie),b=this.j.toInternal(g.command,h));let S;g.action&&(h||(h=new ie),S=this.j.toInternal(g.action,h));const E=g.insertText;return{insertText:E===void 0?void 0:typeof E=="string"?E:{snippet:E.value},range:g.range?U.from(g.range):void 0,showRange:this.e&&g.showRange?U.from(g.showRange):void 0,command:b,gutterMenuLinkAction:S,idx:v,completeBracketPairs:this.e?g.completeBracketPairs:!1,isInlineEdit:this.e?g.isInlineEdit:!1,showInlineEditMenu:this.e?g.showInlineEditMenu:!1,hint:g.displayLocation&&this.e?{range:U.from(g.displayLocation.range),content:g.displayLocation.label,style:g.displayLocation.kind?Uy.from(g.displayLocation.kind):Sc.Code}:void 0,warning:g.warning&&this.e?{message:pe.from(g.warning.message),icon:g.warning.icon?yo.fromThemeIcon(g.warning.icon):void 0}:void 0,correlationId:this.e?g.correlationId:void 0,suggestionId:void 0,uri:this.e&&g.uri?g.uri:void 0,supportsRename:this.e?g.supportsRename:!1,jumpToPosition:this.e&&g.jumpToPosition?Xe.from(g.jumpToPosition):void 0}}),commands:l.map(g=>(h||(h=new ie),hy.from(g,this.j,h))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e,t){const i=this.d.get(e);if(this.h.handleListEndOfLifetime&&this.e&&i?.list){let n=function(o){switch(o.kind){case"lostRace":return{kind:ln.LostRace};case"tokenCancellation":return{kind:ln.TokenCancellation};case"other":return{kind:ln.Other};case"empty":return{kind:ln.Empty};case"notTaken":return{kind:ln.NotTaken};default:return{kind:ln.Other}}};var s=n;this.h.handleListEndOfLifetime(i.list,n(t))}this.d.disposeReferenceId(e)?.dispose()}handleDidShowCompletionItem(e,t,i){const s=this.d.get(e)?.items[t];s&&this.h.handleDidShowCompletionItem&&this.e&&this.h.handleDidShowCompletionItem(s,i)}handlePartialAccept(e,t,i,s){const r=this.d.get(e)?.items[t];r&&this.h.handleDidPartiallyAcceptCompletionItem&&this.e&&(this.h.handleDidPartiallyAcceptCompletionItem(r,i),this.h.handleDidPartiallyAcceptCompletionItem(r,Ry.to(s)))}handleEndOfLifetime(e,t,i){const s=this.d.get(e)?.items[t];if(s&&this.h.handleEndOfLifetime&&this.e){const r=Fy.to(i,n=>this.d.get(n.pid)?.items[n.idx]);this.h.handleEndOfLifetime(s,r)}}handleRejection(e,t){const i=this.d.get(e)?.items[t];i&&this.h.handleDidRejectCompletionItem&&this.e&&this.h.handleDidRejectCompletionItem(i)}},BZ=class{constructor(){this.d=new Map,this.e=1}createReferenceId(e){const t=this.e++;return this.d.set(t,e),t}disposeReferenceId(e){const t=this.d.get(e);return this.d.delete(e),t}get(e){return this.d.get(e)}},sS=class{constructor(e,t){this.e=e,this.f=t,this.d=new hr("SignatureHelp")}async provideSignatureHelp(e,t,i,s){const r=this.e.getDocument(e),n=Xe.to(t),o=this.g(i),a=await this.f.provideSignatureHelp(r,n,s,o);if(a){const c=this.d.add([a]);return{...Ph.from(a),id:c}}}g(e){let t;if(e.activeSignatureHelp){const i=Ph.to(e.activeSignatureHelp),s=this.d.get(e.activeSignatureHelp.id,0);s?(t=s,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this.d.delete(e)}},b1=class{constructor(e,t,i,s,r){this.f=e,this.g=t,this.h=i,this.j=s,this.k=r,this.d=new hr("InlayHints"),this.e=new Map}async provideInlayHints(e,t,i){const s=this.f.getDocument(e),r=U.to(t),n=await this.h.provideInlayHints(s,r,i);if(!Array.isArray(n)||n.length===0){this.j.trace(`[InlayHints] NO inlay hints from '${this.k.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const o=this.d.add(n);this.e.set(o,new ie);const a={hints:[],cacheId:o};for(let c=0;c<n.length;c++)this.l(n[c],r)&&a.hints.push(this.m(n[c],[o,c]));return this.j.trace(`[InlayHints] ${a.hints.length} inlay hints from '${this.k.identifier.value}' for range ${JSON.stringify(t)}`),a}async resolveInlayHint(e,t){if(typeof this.h.resolveInlayHint!="function")return;const i=this.d.get(...e);if(!i)return;const s=await this.h.resolveInlayHint(i,t);if(s&&this.l(s))return this.m(s,e)}releaseHints(e){this.e.get(e)?.dispose(),this.e.delete(e),this.d.delete(e)}l(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}m(e,t){const i=this.e.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const s={label:"",cacheId:t,tooltip:pe.fromStrict(e.tooltip),position:Xe.from(e.position),textEdits:e.textEdits&&e.textEdits.map(ei.from),kind:e.kind&&Rg.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")s.label=e.label;else{const r=[];s.label=r;for(const n of e.label){if(!n.value){console.warn("INVALID inlay hint, empty label part",this.k.identifier.value);continue}const o={label:n.value,tooltip:pe.fromStrict(n.tooltip)};rs.isLocation(n.location)&&(o.location=Bi.from(n.location)),n.command&&(o.command=this.g.toInternal(n.command,i)),r.push(o)}}return s}},y1=class hv{constructor(t,i){this.e=t,this.f=i,this.d=new hr("DocumentLink")}async provideLinks(t,i){const s=this.e.getDocument(t),r=await this.f.provideDocumentLinks(s,i);if(!(!Array.isArray(r)||r.length===0)&&!i.isCancellationRequested){if(typeof this.f.resolveDocumentLink!="function")return{links:r.filter(hv.g).map(Na.from)};{const n=this.d.add(r),o={links:[],cacheId:n};for(let a=0;a<r.length;a++){if(!hv.g(r[a]))continue;const c=Na.from(r[a]);c.cacheId=[n,a],o.links.push(c)}return o}}}static g(t){return t.target&&t.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(t,i){if(typeof this.f.resolveDocumentLink!="function")return;const s=this.d.get(...t);if(!s)return;const r=await this.f.resolveDocumentLink(s,i);if(!(!r||!hv.g(r)))return Na.from(r)}releaseLinks(t){this.d.delete(t)}},rS=class{constructor(e,t){this.d=e,this.e=t}async provideColors(e,t){const i=this.d.getDocument(e),s=await this.e.provideDocumentColors(i,t);return Array.isArray(s)?s.map(n=>({color:ll.from(n.color),range:U.from(n.range)})):[]}async provideColorPresentations(e,t,i){const s=this.d.getDocument(e),r=U.to(t.range),n=ll.to(t.color),o=await this.e.provideColorPresentations(n,{document:s,range:r},i);if(Array.isArray(o))return o.map(Og.from)}},g3=class{constructor(e,t){this.d=e,this.e=t}async provideFoldingRanges(e,t,i){const s=this.d.getDocument(e),r=await this.e.provideFoldingRanges(s,t,i);if(Array.isArray(r))return r.map(jg.from)}},m3=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i}async provideSelectionRanges(e,t,i){const s=this.d.getDocument(e),r=t.map(Xe.to),n=await this.e.provideSelectionRanges(s,r,i);if(!nu(n))return[];if(n.length!==r.length)return this.f.warn("BAD selection ranges, provider must return ranges for each position"),[];const o=[];for(let a=0;a<r.length;a++){const c=[];o.push(c);let l=r[a],u=n[a];for(;;){if(!u.range.contains(l))throw new Error("INVALID selection range, must contain the previous range");if(c.push(gy.from(u)),!u.parent)break;l=u.range,u=u.parent}}return o}},wd=class{constructor(e,t){this.f=e,this.g=t,this.d=new Lm(""),this.e=new Map}async prepareSession(e,t,i){const s=this.f.getDocument(e),r=Xe.to(t),n=await this.g.prepareCallHierarchy(s,r,i);if(!n)return;const o=this.d.nextId();return this.e.set(o,new Map),Array.isArray(n)?n.map(a=>this.h(o,a)):[this.h(o,n)]}async provideCallsTo(e,t,i){const s=this.j(e,t);if(!s)throw new Error("missing call hierarchy item");const r=await this.g.provideCallHierarchyIncomingCalls(s,i);if(r)return r.map(n=>({from:this.h(e,n.from),fromRanges:n.fromRanges.map(o=>U.from(o))}))}async provideCallsFrom(e,t,i){const s=this.j(e,t);if(!s)throw new Error("missing call hierarchy item");const r=await this.g.provideCallHierarchyOutgoingCalls(s,i);if(r)return r.map(n=>({to:this.h(e,n.to),fromRanges:n.fromRanges.map(o=>U.from(o))}))}releaseSession(e){this.e.delete(e)}h(e,t){const i=this.e.get(e),s=Ta.from(t,e,i.size.toString(36));return i.set(s._itemId,t),s}j(e,t){return this.e.get(e)?.get(t)}},bd=class{constructor(e,t){this.f=e,this.g=t,this.d=new Lm(""),this.e=new Map}async prepareSession(e,t,i){const s=this.f.getDocument(e),r=Xe.to(t),n=await this.g.prepareTypeHierarchy(s,r,i);if(!n)return;const o=this.d.nextId();return this.e.set(o,new Map),Array.isArray(n)?n.map(a=>this.h(o,a)):[this.h(o,n)]}async provideSupertypes(e,t,i){const s=this.j(e,t);if(!s)throw new Error("missing type hierarchy item");const r=await this.g.provideTypeHierarchySupertypes(s,i);if(r)return r.map(n=>this.h(e,n))}async provideSubtypes(e,t,i){const s=this.j(e,t);if(!s)throw new Error("missing type hierarchy item");const r=await this.g.provideTypeHierarchySubtypes(s,i);if(r)return r.map(n=>this.h(e,n))}releaseSession(e){this.e.delete(e)}h(e,t){const i=this.e.get(e),s=Ma.from(t,e,i.size.toString(36));return i.set(s._itemId,t),s}j(e,t){return this.e.get(e)?.get(t)}},A1=class{constructor(e,t,i,s,r){this.e=e,this.f=t,this.g=i,this.h=s,this.j=r,this.d=new hr("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,s,r){const n=this.f.getDocument(t),o=Xe.to(i),a=vl.toDataTransfer(s,async h=>(await this.e.$resolveDocumentOnDropFileData(this.h,e,h)).buffer),c=await this.g.provideDocumentDropEdits(n,o,a,r);if(!c)return;const l=xs(c),u=this.d.add(l);return l.map((h,f)=>({_cacheId:[u,f],title:h.title??d(3040,null,this.j.displayName||this.j.name),kind:h.kind?.value,yieldTo:h.yieldTo?.map(p=>p.value),insertText:typeof h.insertText=="string"?h.insertText:{snippet:h.insertText.value},additionalEdit:h.additionalEdit?os.from(h.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,t){const[i,s]=e,r=this.d.get(i,s);if(!r||!this.g.resolveDocumentDropEdit)return{};const n=await this.g.resolveDocumentDropEdit(r,t)??r;return{additionalEdit:n.additionalEdit?os.from(n.additionalEdit,void 0):void 0}}releaseDropEdits(e){this.d.delete(e)}},yd=class{constructor(e,t){this.adapter=e,this.extension=t}},_Z=class ni extends Z{static{this.f=0}get inlineCompletionsUnificationState(){return this.j}constructor(t,i,s,r,n,o,a,c){super(),this.n=i,this.q=s,this.s=r,this.t=n,this.u=o,this.w=a,this.y=c,this.h=new Map,this.m=this.D(new I),this.onDidChangeInlineCompletionsUnificationState=this.m.event,this.g=t.getProxy(Y.MainThreadLanguageFeatures),this.j={codeUnification:!1,modelUnification:!1,extensionUnification:!1,expAssignments:[]}}z(t,i){return Ia.from(t,this.n,i)}C(t){return new Ce(()=>{this.h.delete(t),this.g.$unregister(t)})}F(){return ni.f++}async G(t,i,s,r,n,o=!1){const a=this.h.get(t);if(!a||!(a.adapter instanceof i))return r;const c=Date.now();o||this.u.trace(`[${a.extension.identifier.value}] INVOKE provider '${s.toString().replace(/[\r\n]/g,"")}'`);const l=s(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{Mi(u)||(this.u.error(`[${a.extension.identifier.value}] provider FAILED`),this.u.error(u),this.y.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this.u.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),Fe.isCancellationToken(n)?vf(l,n):l}H(t,i){const s=this.F();return this.h.set(s,new yd(t,i)),s}static I(t){return t.displayName||t.name}static J(t){return t.identifier.value}registerDocumentSymbolProvider(t,i,s,r){const n=this.H(new t3(this.q,s),t),o=r&&r.label||ni.I(t);return this.g.$registerDocumentSymbolProvider(n,this.z(i,t),o),this.C(n)}$provideDocumentSymbols(t,i,s){return this.G(t,t3,r=>r.provideDocumentSymbols(y.revive(i),s),void 0,s)}registerCodeLensProvider(t,i,s){const r=this.F(),n=typeof s.onDidChangeCodeLenses=="function"?this.F():void 0;this.h.set(r,new yd(new p1(this.q,this.s.converter,s,t,this.y,this.u),t)),this.g.$registerCodeLensSupport(r,this.z(i,t),n);let o=this.C(r);if(n!==void 0){const a=s.onDidChangeCodeLenses(c=>this.g.$emitCodeLensEvent(n));o=Ce.from(o,a)}return o}$provideCodeLenses(t,i,s){return this.G(t,p1,r=>r.provideCodeLenses(y.revive(i),s),void 0,s,i.scheme==="output")}$resolveCodeLens(t,i,s){return this.G(t,p1,r=>r.resolveCodeLens(i,s),void 0,void 0,!0)}$releaseCodeLenses(t,i){this.G(t,p1,s=>Promise.resolve(s.releaseCodeLenses(i)),void 0,void 0,!0)}registerDefinitionProvider(t,i,s){const r=this.H(new i3(this.q,s),t);return this.g.$registerDefinitionSupport(r,this.z(i,t)),this.C(r)}$provideDefinition(t,i,s,r){return this.G(t,i3,n=>n.provideDefinition(y.revive(i),s,r),[],r)}registerDeclarationProvider(t,i,s){const r=this.H(new s3(this.q,s),t);return this.g.$registerDeclarationSupport(r,this.z(i,t)),this.C(r)}$provideDeclaration(t,i,s,r){return this.G(t,s3,n=>n.provideDeclaration(y.revive(i),s,r),[],r)}registerImplementationProvider(t,i,s){const r=this.H(new r3(this.q,s),t);return this.g.$registerImplementationSupport(r,this.z(i,t)),this.C(r)}$provideImplementation(t,i,s,r){return this.G(t,r3,n=>n.provideImplementation(y.revive(i),s,r),[],r)}registerTypeDefinitionProvider(t,i,s){const r=this.H(new n3(this.q,s),t);return this.g.$registerTypeDefinitionSupport(r,this.z(i,t)),this.C(r)}$provideTypeDefinition(t,i,s,r){return this.G(t,n3,n=>n.provideTypeDefinition(y.revive(i),s,r),[],r)}registerHoverProvider(t,i,s,r){const n=this.H(new X4(this.q,s),t);return this.g.$registerHoverProvider(n,this.z(i,t)),this.C(n)}$provideHover(t,i,s,r,n){return this.G(t,X4,o=>o.provideHover(y.revive(i),s,r,n),void 0,n)}$releaseHover(t,i){this.G(t,X4,s=>Promise.resolve(s.releaseHover(i)),void 0,void 0)}registerEvaluatableExpressionProvider(t,i,s,r){const n=this.H(new o3(this.q,s),t);return this.g.$registerEvaluatableExpressionProvider(n,this.z(i,t)),this.C(n)}$provideEvaluatableExpression(t,i,s,r){return this.G(t,o3,n=>n.provideEvaluatableExpression(y.revive(i),s,r),void 0,r)}registerInlineValuesProvider(t,i,s,r){const n=typeof s.onDidChangeInlineValues=="function"?this.F():void 0,o=this.H(new a3(this.q,s),t);this.g.$registerInlineValuesProvider(o,this.z(i,t),n);let a=this.C(o);if(n!==void 0){const c=s.onDidChangeInlineValues(l=>this.g.$emitInlineValuesEvent(n));a=Ce.from(a,c)}return a}$provideInlineValues(t,i,s,r,n){return this.G(t,a3,o=>o.provideInlineValues(y.revive(i),s,r,n),void 0,n)}registerDocumentHighlightProvider(t,i,s){const r=this.H(new c3(this.q,s),t);return this.g.$registerDocumentHighlightProvider(r,this.z(i,t)),this.C(r)}registerMultiDocumentHighlightProvider(t,i,s){const r=this.H(new l3(this.q,s,this.u),t);return this.g.$registerMultiDocumentHighlightProvider(r,this.z(i,t)),this.C(r)}$provideDocumentHighlights(t,i,s,r){return this.G(t,c3,n=>n.provideDocumentHighlights(y.revive(i),s,r),void 0,r)}$provideMultiDocumentHighlights(t,i,s,r,n){return this.G(t,l3,o=>o.provideMultiDocumentHighlights(y.revive(i),s,r.map(a=>y.revive(a)),n),void 0,n)}registerLinkedEditingRangeProvider(t,i,s){const r=this.H(new u3(this.q,s),t);return this.g.$registerLinkedEditingRangeProvider(r,this.z(i,t)),this.C(r)}$provideLinkedEditingRanges(t,i,s,r){return this.G(t,u3,async n=>{const o=await n.provideLinkedEditingRanges(y.revive(i),s,r);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?ni.L(o.wordPattern):void 0}},void 0,r)}registerReferenceProvider(t,i,s){const r=this.H(new h3(this.q,s),t);return this.g.$registerReferenceSupport(r,this.z(i,t)),this.C(r)}$provideReferences(t,i,s,r,n){return this.G(t,h3,o=>o.provideReferences(y.revive(i),s,r,n),void 0,n)}registerCodeActionProvider(t,i,s,r){const n=new ie,o=this.H(new m1(this.q,this.s.converter,this.t,s,this.u,t,this.w),t);return this.g.$registerCodeActionSupport(o,this.z(i,t),{providedKinds:r?.providedCodeActionKinds?.map(a=>a.value),documentation:r?.documentation?.map(a=>({kind:a.kind.value,command:this.s.converter.toInternal(a.command,n)}))},ni.I(t),ni.J(t),!!s.resolveCodeAction),n.add(this.C(o)),n}$provideCodeActions(t,i,s,r,n){return this.G(t,m1,o=>o.provideCodeActions(y.revive(i),s,r,n),void 0,n)}$resolveCodeAction(t,i,s){return this.G(t,m1,r=>r.resolveCodeAction(i,s),{},void 0)}$releaseCodeActions(t,i){this.G(t,m1,s=>Promise.resolve(s.releaseCodeActions(i)),void 0,void 0)}registerDocumentFormattingEditProvider(t,i,s){const r=this.H(new d3(this.q,s),t);return this.g.$registerDocumentFormattingSupport(r,this.z(i,t),t.identifier,t.displayName||t.name),this.C(r)}$provideDocumentFormattingEdits(t,i,s,r){return this.G(t,d3,n=>n.provideDocumentFormattingEdits(y.revive(i),s,r),void 0,r)}registerDocumentRangeFormattingEditProvider(t,i,s){const r=typeof s.provideDocumentRangesFormattingEdits=="function",n=this.H(new K4(this.q,s),t);return this.g.$registerRangeFormattingSupport(n,this.z(i,t),t.identifier,t.displayName||t.name,r),this.C(n)}$provideDocumentRangeFormattingEdits(t,i,s,r,n){return this.G(t,K4,o=>o.provideDocumentRangeFormattingEdits(y.revive(i),s,r,n),void 0,n)}$provideDocumentRangesFormattingEdits(t,i,s,r,n){return this.G(t,K4,o=>o.provideDocumentRangesFormattingEdits(y.revive(i),s,r,n),void 0,n)}registerOnTypeFormattingEditProvider(t,i,s,r){const n=this.H(new f3(this.q,s),t);return this.g.$registerOnTypeFormattingSupport(n,this.z(i,t),r,t.identifier),this.C(n)}$provideOnTypeFormattingEdits(t,i,s,r,n,o){return this.G(t,f3,a=>a.provideOnTypeFormattingEdits(y.revive(i),s,r,n,o),void 0,o)}registerWorkspaceSymbolProvider(t,i){const s=this.H(new v1(i,this.u),t);return this.g.$registerNavigateTypeSupport(s,typeof i.resolveWorkspaceSymbol=="function"),this.C(s)}$provideWorkspaceSymbols(t,i,s){return this.G(t,v1,r=>r.provideWorkspaceSymbols(i,s),{symbols:[]},s)}$resolveWorkspaceSymbol(t,i,s){return this.G(t,v1,r=>r.resolveWorkspaceSymbol(i,s),void 0,void 0)}$releaseWorkspaceSymbols(t,i){this.G(t,v1,s=>s.releaseWorkspaceSymbols(i),void 0,void 0)}registerRenameProvider(t,i,s){const r=this.H(new w1(this.q,s,this.u),t);return this.g.$registerRenameSupport(r,this.z(i,t),w1.supportsResolving(s)),this.C(r)}$provideRenameEdits(t,i,s,r,n){return this.G(t,w1,o=>o.provideRenameEdits(y.revive(i),s,r,n),void 0,n)}$resolveRenameLocation(t,i,s,r){return this.G(t,w1,n=>n.resolveRenameLocation(y.revive(i),s,r),void 0,r)}registerNewSymbolNamesProvider(t,i,s){const r=this.H(new eS(this.q,s,this.u),t);return this.g.$registerNewSymbolNamesProvider(r,this.z(i,t)),this.C(r)}$supportsAutomaticNewSymbolNamesTriggerKind(t){return this.G(t,eS,i=>i.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(t,i,s,r,n){return this.G(t,eS,o=>o.provideNewSymbolNames(y.revive(i),s,r,n),void 0,n)}registerDocumentSemanticTokensProvider(t,i,s,r){const n=this.H(new iS(this.q,s),t),o=typeof s.onDidChangeSemanticTokens=="function"?this.F():void 0;this.g.$registerDocumentSemanticTokensProvider(n,this.z(i,t),r,o);let a=this.C(n);if(o){const c=s.onDidChangeSemanticTokens(l=>this.g.$emitDocumentSemanticTokensEvent(o));a=Ce.from(a,c)}return a}$provideDocumentSemanticTokens(t,i,s,r){return this.G(t,iS,n=>n.provideDocumentSemanticTokens(y.revive(i),s,r),null,r)}$releaseDocumentSemanticTokens(t,i){this.G(t,iS,s=>s.releaseDocumentSemanticColoring(i),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(t,i,s,r){const n=this.H(new p3(this.q,s),t),o=typeof s.onDidChangeSemanticTokens=="function"?this.F():void 0;this.g.$registerDocumentRangeSemanticTokensProvider(n,this.z(i,t),r,o);let a=this.C(n);if(o){const c=s.onDidChangeSemanticTokens(l=>this.g.$emitDocumentRangeSemanticTokensEvent(o));a=Ce.from(a,c)}return a}$provideDocumentRangeSemanticTokens(t,i,s,r){return this.G(t,p3,n=>n.provideDocumentRangeSemanticTokens(y.revive(i),s,r),null,r)}registerCompletionItemProvider(t,i,s,r){const n=this.H(new vd(this.q,this.s.converter,s,this.w,t),t);return this.g.$registerCompletionsProvider(n,this.z(i,t),r,vd.supportsResolving(s),t.identifier),this.C(n)}$provideCompletionItems(t,i,s,r,n){return this.G(t,vd,o=>o.provideCompletionItems(y.revive(i),s,r,n),void 0,n)}$resolveCompletionItem(t,i,s){return this.G(t,vd,r=>r.resolveCompletionItem(i,s),void 0,s)}$releaseCompletionItems(t,i){this.G(t,vd,s=>s.releaseCompletionItems(i),void 0,void 0)}registerInlineCompletionsProvider(t,i,s,r){const n=new ko(t,this.q,s,this.s.converter),o=this.H(n,t);let a=this.C(o);const c=et(t,"inlineCompletionsAdditions")&&typeof s.onDidChange=="function";if(c){const u=s.onDidChange(h=>this.g.$emitInlineCompletionsChange(o));a=Ce.from(a,u)}const l=et(t,"inlineCompletionsAdditions")&&typeof s.onDidChangeModelInfo=="function";if(l){const u=s.onDidChangeModelInfo(h=>this.g.$emitInlineCompletionModelInfoChange(o,n.modelInfo));a=Ce.from(a,u)}return this.g.$registerInlineCompletionsSupport(o,this.z(i,t),n.supportsHandleEvents,Ye.toKey(t.identifier.value),t.version,r?.groupId?Ye.toKey(r.groupId):void 0,r?.yieldTo?.map(u=>Ye.toKey(u))||[],r?.displayName,r?.debounceDelayMs,r?.excludes?.map(u=>Ye.toKey(u))||[],c,n.supportsSetModelId,n.modelInfo,l),a}$provideInlineCompletions(t,i,s,r,n){return this.G(t,ko,o=>o.provideInlineCompletions(y.revive(i),s,r,n),void 0,void 0)}$handleInlineCompletionDidShow(t,i,s,r){this.G(t,ko,async n=>{n.handleDidShowCompletionItem(i,s,r)},void 0,void 0)}$handleInlineCompletionPartialAccept(t,i,s,r,n){this.G(t,ko,async o=>{o.handlePartialAccept(i,s,r,n)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(t,i,s,r){this.G(t,ko,async n=>{n.handleEndOfLifetime(i,s,r)},void 0,void 0)}$handleInlineCompletionRejection(t,i,s){this.G(t,ko,async r=>{r.handleRejection(i,s)},void 0,void 0)}$freeInlineCompletionsList(t,i,s){this.G(t,ko,async r=>{r.disposeCompletions(i,s)},void 0,void 0)}$acceptInlineCompletionsUnificationState(t){this.j=t,this.m.fire()}$handleInlineCompletionSetCurrentModelId(t,i){this.G(t,ko,async s=>{s.setCurrentModelId(i)},void 0,void 0)}registerSignatureHelpProvider(t,i,s,r){const n=Array.isArray(r)?{triggerCharacters:r,retriggerCharacters:[]}:r,o=this.H(new sS(this.q,s),t);return this.g.$registerSignatureHelpProvider(o,this.z(i,t),n),this.C(o)}$provideSignatureHelp(t,i,s,r,n){return this.G(t,sS,o=>o.provideSignatureHelp(y.revive(i),s,r,n),void 0,n)}$releaseSignatureHelp(t,i){this.G(t,sS,s=>s.releaseSignatureHelp(i),void 0,void 0)}registerInlayHintsProvider(t,i,s){const r=typeof s.onDidChangeInlayHints=="function"?this.F():void 0,n=this.H(new b1(this.q,this.s.converter,s,this.u,t),t);this.g.$registerInlayHintsProvider(n,this.z(i,t),typeof s.resolveInlayHint=="function",r,ni.I(t));let o=this.C(n);if(r!==void 0){const a=s.onDidChangeInlayHints(c=>this.g.$emitInlayHintsEvent(r));o=Ce.from(o,a)}return o}$provideInlayHints(t,i,s,r){return this.G(t,b1,n=>n.provideInlayHints(y.revive(i),s,r),void 0,r)}$resolveInlayHint(t,i,s){return this.G(t,b1,r=>r.resolveInlayHint(i,s),void 0,s)}$releaseInlayHints(t,i){this.G(t,b1,s=>s.releaseHints(i),void 0,void 0)}registerDocumentLinkProvider(t,i,s){const r=this.H(new y1(this.q,s),t);return this.g.$registerDocumentLinkProvider(r,this.z(i,t),typeof s.resolveDocumentLink=="function"),this.C(r)}$provideDocumentLinks(t,i,s){return this.G(t,y1,r=>r.provideLinks(y.revive(i),s),void 0,s,i.scheme==="output")}$resolveDocumentLink(t,i,s){return this.G(t,y1,r=>r.resolveLink(i,s),void 0,void 0,!0)}$releaseDocumentLinks(t,i){this.G(t,y1,s=>s.releaseLinks(i),void 0,void 0,!0)}registerColorProvider(t,i,s){const r=this.H(new rS(this.q,s),t);return this.g.$registerDocumentColorProvider(r,this.z(i,t)),this.C(r)}$provideDocumentColors(t,i,s){return this.G(t,rS,r=>r.provideColors(y.revive(i),s),[],s)}$provideColorPresentations(t,i,s,r){return this.G(t,rS,n=>n.provideColorPresentations(y.revive(i),s,r),void 0,r)}registerFoldingRangeProvider(t,i,s){const r=this.F(),n=typeof s.onDidChangeFoldingRanges=="function"?this.F():void 0;this.h.set(r,new yd(new g3(this.q,s),t)),this.g.$registerFoldingRangeProvider(r,this.z(i,t),t.identifier,n);let o=this.C(r);if(n!==void 0){const a=s.onDidChangeFoldingRanges(()=>this.g.$emitFoldingRangeEvent(n));o=Ce.from(o,a)}return o}$provideFoldingRanges(t,i,s,r){return this.G(t,g3,n=>n.provideFoldingRanges(y.revive(i),s,r),void 0,r)}registerSelectionRangeProvider(t,i,s){const r=this.H(new m3(this.q,s,this.u),t);return this.g.$registerSelectionRangeProvider(r,this.z(i,t)),this.C(r)}$provideSelectionRanges(t,i,s,r){return this.G(t,m3,n=>n.provideSelectionRanges(y.revive(i),s,r),[],r)}registerCallHierarchyProvider(t,i,s){const r=this.H(new wd(this.q,s),t);return this.g.$registerCallHierarchyProvider(r,this.z(i,t)),this.C(r)}$prepareCallHierarchy(t,i,s,r){return this.G(t,wd,n=>Promise.resolve(n.prepareSession(y.revive(i),s,r)),void 0,r)}$provideCallHierarchyIncomingCalls(t,i,s,r){return this.G(t,wd,n=>n.provideCallsTo(i,s,r),void 0,r)}$provideCallHierarchyOutgoingCalls(t,i,s,r){return this.G(t,wd,n=>n.provideCallsFrom(i,s,r),void 0,r)}$releaseCallHierarchy(t,i){this.G(t,wd,s=>Promise.resolve(s.releaseSession(i)),void 0,void 0)}registerTypeHierarchyProvider(t,i,s){const r=this.H(new bd(this.q,s),t);return this.g.$registerTypeHierarchyProvider(r,this.z(i,t)),this.C(r)}$prepareTypeHierarchy(t,i,s,r){return this.G(t,bd,n=>Promise.resolve(n.prepareSession(y.revive(i),s,r)),void 0,r)}$provideTypeHierarchySupertypes(t,i,s,r){return this.G(t,bd,n=>n.provideSupertypes(i,s,r),void 0,r)}$provideTypeHierarchySubtypes(t,i,s,r){return this.G(t,bd,n=>n.provideSubtypes(i,s,r),void 0,r)}$releaseTypeHierarchy(t,i){this.G(t,bd,s=>Promise.resolve(s.releaseSession(i)),void 0,void 0)}registerDocumentOnDropEditProvider(t,i,s,r){const n=this.F();return this.h.set(n,new yd(new A1(this.g,this.q,s,n,t),t)),this.g.$registerDocumentOnDropEditProvider(n,this.z(i,t),r?{supportsResolve:!!s.resolveDocumentDropEdit,dropMimeTypes:r.dropMimeTypes,providedDropKinds:r.providedDropEditKinds?.map(o=>o.value)}:void 0),this.C(n)}$provideDocumentOnDropEdits(t,i,s,r,n,o){return this.G(t,A1,a=>Promise.resolve(a.provideDocumentOnDropEdits(i,y.revive(s),r,n,o)),void 0,void 0)}$resolveDropEdit(t,i,s){return this.G(t,A1,r=>r.resolveDropEdit(i,s),{},void 0)}$releaseDocumentOnDropEdits(t,i){this.G(t,A1,s=>Promise.resolve(s.releaseDropEdits(i)),void 0,void 0)}registerDocumentPasteEditProvider(t,i,s,r){const n=this.F();return this.h.set(n,new yd(new md(this.g,this.q,s,n,t),t)),this.g.$registerPasteEditProvider(n,this.z(i,t),{supportsCopy:!!s.prepareDocumentPaste,supportsPaste:!!s.provideDocumentPasteEdits,supportsResolve:!!s.resolveDocumentPasteEdit,providedPasteEditKinds:r.providedPasteEditKinds?.map(o=>o.value),copyMimeTypes:r.copyMimeTypes,pasteMimeTypes:r.pasteMimeTypes}),this.C(n)}$prepareDocumentPaste(t,i,s,r,n){return this.G(t,md,o=>o.prepareDocumentPaste(y.revive(i),s,r,n),void 0,n)}$providePasteEdits(t,i,s,r,n,o,a){return this.G(t,md,c=>c.providePasteEdits(i,y.revive(s),r,n,o,a),void 0,a)}$resolvePasteEdit(t,i,s){return this.G(t,md,r=>r.resolvePasteEdit(i,s),{},void 0)}$releasePasteEdits(t,i){this.G(t,md,s=>Promise.resolve(s.releasePasteEdits(i)),void 0,void 0)}static L(t){return{pattern:t.source,flags:t.flags}}static M(t){return{decreaseIndentPattern:ni.L(t.decreaseIndentPattern),increaseIndentPattern:ni.L(t.increaseIndentPattern),indentNextLinePattern:t.indentNextLinePattern?ni.L(t.indentNextLinePattern):void 0,unIndentedLinePattern:t.unIndentedLinePattern?ni.L(t.unIndentedLinePattern):void 0}}static N(t){return{beforeText:ni.L(t.beforeText),afterText:t.afterText?ni.L(t.afterText):void 0,previousLineText:t.previousLineText?ni.L(t.previousLineText):void 0,action:t.action}}static O(t){return t.map(ni.N)}static P(t){return{open:t.open,close:t.close,notIn:t.notIn?t.notIn.map(i=>Bc.toString(i)):void 0}}static Q(t){return t.map(ni.P)}setLanguageConfiguration(t,i,s){const{wordPattern:r}=s;if(r&&zE(r))throw new Error(`Invalid language configuration: wordPattern '${r}' is not allowed to match the empty string.`);r?this.q.setWordDefinitionFor(i,r):this.q.setWordDefinitionFor(i,void 0),s.__electricCharacterSupport&&this.w.report("LanguageConfiguration.__electricCharacterSupport",t,"Do not use."),s.__characterPairSupport&&this.w.report("LanguageConfiguration.__characterPairSupport",t,"Do not use.");const n=this.F(),o={comments:s.comments,brackets:s.brackets,wordPattern:s.wordPattern?ni.L(s.wordPattern):void 0,indentationRules:s.indentationRules?ni.M(s.indentationRules):void 0,onEnterRules:s.onEnterRules?ni.O(s.onEnterRules):void 0,__electricCharacterSupport:s.__electricCharacterSupport,__characterPairSupport:s.__characterPairSupport,autoClosingPairs:s.autoClosingPairs?ni.Q(s.autoClosingPairs):void 0};return this.g.$setLanguageConfiguration(n,i,o),this.C(n)}$setWordDefinitions(t){for(const i of t)this.q.setWordDefinitionFor(i.languageId,new RegExp(i.regexSource,i.regexFlags))}},VZ=H("notebookService"),qZ=H("codeMapperService"),v3="vscode_editFile",nS="vscode_editFile_internal",GZ={id:nS,displayName:"",modelDescription:"",source:er.Internal},oS=class{constructor(t,i,s){this.a=t,this.b=i,this.c=s}async invoke(t,i,s,r){if(!t.context)throw new Error("toolInvocationToken is required for this tool");const n=t.parameters,o=y.revive(n.uri),a=$w.parse(o)?.notebook||o,c=this.a.getSession(xr.forSession(t.context?.sessionId)),l=c.getRequests().at(-1);c.acceptResponseProgress(l,{kind:"markdownContent",content:new Qn("\n````\n")}),c.acceptResponseProgress(l,{kind:"codeblockUri",uri:a,isEdit:!0}),c.acceptResponseProgress(l,{kind:"markdownContent",content:new Qn("\n````\n")}),this.c.hasSupportedNotebooks(a)&&this.c.getNotebookTextModel(a)?c.acceptResponseProgress(l,{kind:"notebookEdit",edits:[],uri:a}):c.acceptResponseProgress(l,{kind:"textEdit",edits:[],uri:a});const u=c.editingSession;if(!u)throw new Error("This tool must be called from within an editing session");const h=await this.b.mapCode({codeBlocks:[{code:n.code,resource:a,markdownBeforeBlock:n.explanation}],location:"tool",chatRequestId:t.chatRequestId,chatRequestModel:t.modelId,chatSessionResource:t.context.sessionResource},{textEdit:(p,g)=>{c.acceptResponseProgress(l,{kind:"textEdit",uri:p,edits:g})},notebookEdit(p,g){c.acceptResponseProgress(l,{kind:"notebookEdit",uri:p,edits:g})}},r);if(this.c.hasSupportedNotebooks(a)&&this.c.getNotebookTextModel(a)?c.acceptResponseProgress(l,{kind:"notebookEdit",uri:a,edits:[],done:!0}):c.acceptResponseProgress(l,{kind:"textEdit",uri:a,edits:[],done:!0}),h?.errorMessage)throw new Error(h.errorMessage);let f;return await new Promise(p=>{let g=!1;f=Zf(v=>{const S=u.entries.read(v)?.find(E=>E.modifiedURI.toString()===a.toString());S&&(S.isCurrentlyBeingModifiedBy.read(v)?g=!0:g&&p(!0))})}).finally(()=>{f.dispose()}),{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(t,i){return{presentation:Ic.Hidden}}};oS=__decorate([__param(0,OP),__param(1,qZ),__param(2,VZ)],oS);var JZ="vscode_get_confirmation",ZZ={id:JZ,displayName:"Confirmation Tool",modelDescription:"A tool that demonstrates different types of confirmations. Takes a title, message, and confirmation type (basic or terminal).",source:er.Internal,inputSchema:{type:"object",properties:{title:{type:"string",description:"Title for the confirmation dialog"},message:{type:"string",description:"Message to show in the confirmation dialog"},confirmationType:{type:"string",enum:["basic","terminal"],description:"Type of confirmation to show - basic for simple confirmation, terminal for terminal command confirmation"},terminalCommand:{type:"string",description:'Terminal command to show (only used when confirmationType is "terminal")'}},required:["title","message","confirmationType"],additionalProperties:!1}},QZ=class{async prepareToolInvocation(e,t){const i=e.parameters;if(!i.title||!i.message)throw new Error("Missing required parameters for ConfirmationTool");const s=i.confirmationType??"basic";let r;return s==="terminal"?r={kind:"terminal",commandLine:{original:i.terminalCommand??""},language:"bash"}:r=void 0,{confirmationMessages:{title:i.title,message:new Qn(i.message),allowAutoConfirm:!0},toolSpecificData:r,presentation:Ic.HiddenAfterComplete}}async invoke(e,t,i,s){return{content:[{kind:"text",value:"yes"}]}}},Ad;(function(e){e[e.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",e[e.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Ad||(Ad={}));var dr;(function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.Closed=2]="Closed"})(dr||(dr={}));var jae=class XM extends Z{static{this.a=100}constructor(t,i=Object.create(null)){super(),this.q=t,this.r=i,this.b=this.D(new lu),this.onDidChangeStorage=this.b.event,this.c=dr.None,this.f=new Map,this.g=this.D(new pu(XM.a)),this.h=new Set,this.j=new Map,this.m=void 0,this.n=[],this.s()}s(){this.D(this.q.onDidChangeItemsExternal(t=>this.t(t)))}t(t){this.b.pause();try{t.changed?.forEach((i,s)=>this.u(s,i)),t.deleted?.forEach(i=>this.u(i,void 0))}finally{this.b.resume()}}u(t,i){if(this.c===dr.Closed)return;let s=!1;Wt(i)?s=this.f.delete(t):this.f.get(t)!==i&&(this.f.set(t,i),s=!0),s&&this.b.fire({key:t,external:!0})}get items(){return this.f}get size(){return this.f.size}async init(){this.c===dr.None&&(this.c=dr.Initialized,this.r.hint!==Ad.STORAGE_DOES_NOT_EXIST&&(this.f=await this.q.getItems()))}get(t,i){const s=this.f.get(t);return Wt(s)?i:s}getBoolean(t,i){const s=this.get(t);return Wt(s)?i:s==="true"}getNumber(t,i){const s=this.get(t);return Wt(s)?i:parseInt(s,10)}getObject(t,i){const s=this.get(t);return Wt(s)?i:qx(s)}async set(t,i,s=!1){if(this.c===dr.Closed)return;if(Wt(i))return this.delete(t,s);const r=At(i)||Array.isArray(i)?sF(i):String(i);if(this.f.get(t)!==r)return this.f.set(t,r),this.j.set(t,r),this.h.delete(t),this.b.fire({key:t,external:s}),this.C()}async delete(t,i=!1){if(!(this.c===dr.Closed||!this.f.delete(t)))return this.h.has(t)||this.h.add(t),this.j.delete(t),this.b.fire({key:t,external:i}),this.C()}async optimize(){if(this.c!==dr.Closed)return await this.flush(0),this.q.optimize()}async close(){return this.m||(this.m=this.w()),this.m}async w(){this.c=dr.Closed;try{await this.C(0)}catch{}await this.q.close(()=>this.f)}get y(){return this.j.size>0||this.h.size>0}async z(){if(!this.y)return;const t={insert:this.j,delete:this.h};return this.h=new Set,this.j=new Map,this.q.updateItems(t).finally(()=>{if(!this.y)for(;this.n.length;)this.n.pop()?.()})}async flush(t){if(!(this.c===dr.Closed||this.m))return this.C(t)}async C(t){return this.r.hint===Ad.STORAGE_IN_MEMORY?this.z():this.g.trigger(()=>this.z(),t)}async whenFlushed(){if(this.y)return new Promise(t=>this.n.push(t))}isInMemory(){return this.r.hint===Ad.STORAGE_IN_MEMORY}},w3;(function(e){e.Settings="settings",e.Keybindings="keybindings",e.Snippets="snippets",e.Prompts="prompts",e.Tasks="tasks",e.Extensions="extensions",e.GlobalState="globalState",e.Mcp="mcp"})(w3||(w3={}));function YZ(e){const t=e;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&y.isUri(t.location)&&y.isUri(t.globalStorageHome)&&y.isUri(t.settingsResource)&&y.isUri(t.keybindingsResource)&&y.isUri(t.tasksResource)&&y.isUri(t.snippetsHome)&&y.isUri(t.promptsHome)&&y.isUri(t.extensionsResource)&&y.isUri(t.mcpResource))}var XZ=H("IUserDataProfilesService");function S1(e,t,i,s,r,n){return{id:e,name:t,location:i,isDefault:!1,icon:r?.icon,globalStorageHome:n&&r?.useDefaultFlags?.globalState?n.globalStorageHome:It(i,"globalStorage"),settingsResource:n&&r?.useDefaultFlags?.settings?n.settingsResource:It(i,"settings.json"),keybindingsResource:n&&r?.useDefaultFlags?.keybindings?n.keybindingsResource:It(i,"keybindings.json"),tasksResource:n&&r?.useDefaultFlags?.tasks?n.tasksResource:It(i,"tasks.json"),snippetsHome:n&&r?.useDefaultFlags?.snippets?n.snippetsHome:It(i,"snippets"),promptsHome:n&&r?.useDefaultFlags?.prompts?n.promptsHome:It(i,"prompts"),extensionsResource:n&&r?.useDefaultFlags?.extensions?n.extensionsResource:It(i,"extensions.json"),mcpResource:n&&r?.useDefaultFlags?.mcp?n.mcpResource:It(i,"mcp.json"),cacheHome:It(s,e),useDefaultFlags:r?.useDefaultFlags,isTransient:r?.transient,workspaces:r?.workspaces}}var b3=class extends Z{static{this.b="userDataProfiles"}static{this.c="profileAssociations"}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.z.profiles,...this.q.profiles]}constructor(t,i,s,r){super(),this.r=t,this.s=i,this.t=s,this.u=r,this.g=this.D(new I),this.onDidChangeProfiles=this.g.event,this.h=this.D(new I),this.onWillCreateProfile=this.h.event,this.j=this.D(new I),this.onWillRemoveProfile=this.j.event,this.m=this.D(new I),this.onDidResetWorkspaces=this.m.event,this.n=new Map,this.q={profiles:[],emptyWindows:new Map},this.profilesHome=It(this.r.userRoamingDataHome,"profiles"),this.f=It(this.r.cacheHome,"CachedProfilesData")}init(){this.y=void 0}get z(){if(!this.y){const t=this.C(),i=[t];try{for(const r of this.N()){if(!r.name||!Oe(r.name)||!r.location){this.u.warn("Skipping the invalid stored profile",r.location||r.name);continue}i.push(S1(Li(r.location),r.name,r.location,this.f,{icon:r.icon,useDefaultFlags:r.useDefaultFlags},t))}}catch(r){this.u.error(r)}const s=new Map;if(i.length)try{const r=this.P();if(r.workspaces)for(const[n,o]of Object.entries(r.workspaces)){const a=y.parse(n),c=i.find(l=>l.id===o);if(c){const l=c.workspaces?c.workspaces.slice(0):[];l.push(a),c.workspaces=l}}if(r.emptyWindows)for(const[n,o]of Object.entries(r.emptyWindows)){const a=i.find(c=>c.id===o);a&&s.set(n,a)}}catch(r){this.u.error(r)}this.y={profiles:i,emptyWindows:s}}return this.y}C(){const t=S1("__default__profile__",d(2729,null),this.r.userRoamingDataHome,this.f);return{...t,extensionsResource:this.R()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){const i="Temp",s=new RegExp(`${Un(i)}\\s(\\d+)`);let r=0;for(const o of this.profiles){const a=s.exec(o.name),c=a?parseInt(a[1]):0;r=c>r?c:r}const n=`${i} ${r+1}`;return this.createProfile(sn(Nt()).toString(16),n,{transient:!0},t)}async createNamedProfile(t,i,s){return this.createProfile(sn(Nt()).toString(16),t,i,s)}async createProfile(t,i,s,r){return await this.F(t,i,s,r)}async F(t,i,s,r){if(!Oe(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let n=this.n.get(i);return n||(n=(async()=>{try{if(this.profiles.find(u=>u.id===t||!u.isTransient&&!s?.transient&&u.name===i))throw new Error(`Profile with ${i} name already exists`);const a=r?this.G(r):void 0;y.isUri(a)&&(s={...s,workspaces:[a]});const c=S1(t,i,It(this.profilesHome,t),this.f,s,this.defaultProfile);await this.s.createFolder(c.location);const l=[];return this.h.fire({profile:c,join(u){l.push(u)}}),await Wn.settled(l),a&&!y.isUri(a)&&this.L(a,c,!!c.isTransient),this.I([c],[],[]),c}finally{this.n.delete(i)}})(),this.n.set(i,n)),n}async updateProfile(t,i){const s=[];for(const n of this.profiles){let o;if(t.id===n.id)n.isDefault?i.workspaces&&(o=n,o.workspaces=i.workspaces):o=S1(n.id,i.name??n.name,n.location,this.f,{icon:i.icon===null?void 0:i.icon??n.icon,transient:i.transient??n.isTransient,useDefaultFlags:i.useDefaultFlags??n.useDefaultFlags,workspaces:i.workspaces??n.workspaces},this.defaultProfile);else if(i.workspaces){const a=n.workspaces?.filter(c=>!i.workspaces?.some(l=>this.t.extUri.isEqual(c,l)));n.workspaces?.length!==a?.length&&(o=n,o.workspaces=a)}o&&s.push(o)}if(!s.length)throw t.isDefault?new Error("Cannot update default profile"):new Error(`Profile '${t.name}' does not exist`);this.I([],[],s);const r=this.profiles.find(n=>n.id===t.id);if(!r)throw new Error(`Profile '${t.name}' was not updated`);return r}async removeProfile(t){if(t.isDefault)throw new Error("Cannot remove default profile");const i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);const s=[];this.j.fire({profile:i,join(r){s.push(r)}});try{await Promise.allSettled(s)}catch(r){this.u.error(r)}this.I([],[i],[]);try{await this.s.del(i.cacheHome,{recursive:!0})}catch(r){Pz(r)!==1&&this.u.error(r)}}async setProfileForWorkspace(t,i){const s=this.profiles.find(n=>n.id===i.id);if(!s)throw new Error(`Profile '${i.name}' does not exist`);const r=this.G(t);if(y.isUri(r)){const n=s.workspaces?[...s.workspaces]:[];n.some(o=>this.t.extUri.isEqual(o,r))||(n.push(r),await this.updateProfile(s,{workspaces:n}))}else this.L(r,s,!1),this.M(this.profiles)}unsetWorkspace(t,i=!1){const s=this.G(t);if(y.isUri(s)){const r=this.getProfileForWorkspace(t);r&&this.updateProfile(r,{workspaces:r.workspaces?.filter(n=>!this.t.extUri.isEqual(n,s))})}else this.L(s,void 0,i),this.M(this.profiles)}async resetWorkspaces(){this.q.emptyWindows.clear(),this.z.emptyWindows.clear();for(const t of this.profiles)t.workspaces=void 0;this.I([],[],this.profiles),this.m.fire()}async cleanUp(){if(await this.s.exists(this.profilesHome)){const t=await this.s.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(i=>i.isDirectory&&this.profiles.every(s=>!this.t.extUri.isEqual(s.location,i.resource))).map(i=>this.s.del(i.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){const t=this.q.profiles.filter(i=>!this.H(i));await Promise.allSettled(t.map(i=>this.removeProfile(i)))}getProfileForWorkspace(t){const i=this.G(t);return y.isUri(i)?this.profiles.find(s=>s.workspaces?.some(r=>this.t.extUri.isEqual(r,i))):this.z.emptyWindows.get(i)??this.q.emptyWindows.get(i)}G(t){return Aj(t)?t.uri:Sj(t)?t.configPath:t.id}H(t){return!!(t.workspaces?.length||[...this.z.emptyWindows.values()].some(i=>this.t.extUri.isEqual(i.location,t.location))||[...this.q.emptyWindows.values()].some(i=>this.t.extUri.isEqual(i.location,t.location)))}I(t,i,s){const r=[...this.profiles,...t],n=this.q.profiles;this.q.profiles=[];const o=[];for(let a of r){if(i.some(c=>a.id===c.id)){for(const c of[...this.z.emptyWindows.keys()])a.id===this.z.emptyWindows.get(c)?.id&&this.z.emptyWindows.delete(c);continue}if(!a.isDefault){a=s.find(l=>a.id===l.id)??a;const c=n.find(l=>a.id===l.id);if(a.isTransient)this.q.profiles.push(a);else if(c){for(const[l,u]of this.q.emptyWindows.entries())if(a.id===u.id){this.q.emptyWindows.delete(l),this.z.emptyWindows.set(l,a);break}}}a.workspaces?.length===0&&(a.workspaces=void 0),o.push(a)}this.M(o),this.J(t,i,s)}J(t,i,s){this.g.fire({added:t,removed:i,updated:s,all:this.profiles})}L(t,i,s){s=i?.isTransient?!0:s,s?i?this.q.emptyWindows.set(t,i):this.q.emptyWindows.delete(t):(this.q.emptyWindows.delete(t),i?this.z.emptyWindows.set(t,i):this.z.emptyWindows.delete(t))}M(t){const i=[],s={},r={};for(const n of t)if(!n.isTransient&&(n.isDefault||i.push({location:n.location,name:n.name,icon:n.icon,useDefaultFlags:n.useDefaultFlags}),n.workspaces))for(const o of n.workspaces)s[o.toString()]=n.id;for(const[n,o]of this.z.emptyWindows.entries())r[n.toString()]=o.id;this.Q({workspaces:s,emptyWindows:r}),this.O(i),this.y=void 0}N(){return[]}O(t){throw new Error("not implemented")}P(){return{}}Q(t){throw new Error("not implemented")}R(){}};b3=__decorate([__param(0,UA),__param(1,nw),__param(2,A9),__param(3,Se)],b3);var KZ="__$__isNewStorageMarker",E1="__$__targetStorageMarker",_a=H("storageService"),Ol;(function(e){e[e.NONE=0]="NONE",e[e.SHUTDOWN=1]="SHUTDOWN"})(Ol||(Ol={}));var y3;(function(e){e[e.APPLICATION=-1]="APPLICATION",e[e.PROFILE=0]="PROFILE",e[e.WORKSPACE=1]="WORKSPACE"})(y3||(y3={}));var A3;(function(e){e[e.USER=0]="USER",e[e.MACHINE=1]="MACHINE"})(A3||(A3={}));function eQ(e){const t=e.get(E1);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var Hae=class KM extends Z{static{this.a=60*1e3}constructor(t={flushInterval:KM.a}){super(),this.b=this.D(new lu),this.f=this.D(new lu),this.onDidChangeTarget=this.f.event,this.g=this.D(new I),this.onWillSaveState=this.g.event,this.m=this.D(new Vs),this.z=void 0,this.F=void 0,this.H=void 0,this.j=this.D(new br(()=>this.n(),t.flushInterval))}onDidChangeValue(t,i,s){return Ie.filter(this.b.event,r=>r.scope===t&&(i===void 0||r.key===i),s)}n(){this.m.value=xx(()=>{this.q()&&this.flush(),this.j.schedule()})}q(){return!0}r(){Zi([this.m,this.j])}initialize(){return this.h||(this.h=(async()=>{Ut("code/willInitStorage");try{await this.O()}finally{Ut("code/didInitStorage")}this.j.schedule()})()),this.h}t(t,i){const{key:s,external:r}=i;if(s===E1){switch(t){case-1:this.H=void 0;break;case 0:this.F=void 0;break;case 1:this.z=void 0;break}this.f.fire({scope:t})}else this.b.fire({scope:t,key:s,target:this.J(t)[s],external:r})}u(t){this.g.fire({reason:t})}get(t,i,s){return this.P(i)?.get(t,s)}getBoolean(t,i,s){return this.P(i)?.getBoolean(t,s)}getNumber(t,i,s){return this.P(i)?.getNumber(t,s)}getObject(t,i,s){return this.P(i)?.getObject(t,s)}storeAll(t,i){this.w(()=>{for(const s of t)this.store(s.key,s.value,s.scope,s.target,i)})}store(t,i,s,r,n=!1){if(Wt(i)){this.remove(t,s,n);return}this.w(()=>{this.y(t,s,r),this.P(s)?.set(t,i,n)})}remove(t,i,s=!1){this.w(()=>{this.y(t,i,void 0),this.P(i)?.delete(t,s)})}w(t){this.b.pause(),this.f.pause();try{t()}finally{this.b.resume(),this.f.resume()}}keys(t,i){const s=[],r=this.J(t);for(const n of Object.keys(r))r[n]===i&&s.push(n);return s}y(t,i,s,r=!1){const n=this.J(i);typeof s=="number"?n[t]!==s&&(n[t]=s,this.P(i)?.set(E1,JSON.stringify(n),r)):typeof n[t]=="number"&&(delete n[t],this.P(i)?.set(E1,JSON.stringify(n),r))}get C(){return this.z||(this.z=this.L(1)),this.z}get G(){return this.F||(this.F=this.L(0)),this.F}get I(){return this.H||(this.H=this.L(-1)),this.H}J(t){switch(t){case-1:return this.I;case 0:return this.G;default:return this.C}}L(t){const i=this.P(t);return i?eQ(i):Object.create(null)}isNew(t){return this.getBoolean(KZ,t)===!0}async flush(t=Ol.NONE){this.g.fire({reason:t});const i=this.P(-1),s=this.P(0),r=this.P(1);switch(t){case Ol.NONE:await Wn.settled([i?.whenFlushed()??Promise.resolve(),s?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case Ol.SHUTDOWN:await Wn.settled([i?.flush(0)??Promise.resolve(),s?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){const t=this.P(-1)?.items??new Map,i=this.P(0)?.items??new Map,s=this.P(1)?.items??new Map;return tQ(t,i,s,this.Q(-1)??"",this.Q(0)??"",this.Q(1)??"")}async optimize(t){return await this.flush(),this.P(t)?.optimize()}async switch(t,i){return this.u(Ol.NONE),YZ(t)?this.R(t,i):this.S(t,i)}M(t,i){return!(t.id===i.id||S3(i)&&S3(t))}N(t,i,s){this.w(()=>{const r=new Set;for(const[n,o]of t)r.add(n),i.get(n)!==o&&this.t(s,{key:n,external:!0});for(const[n]of i.items)r.has(n)||this.t(s,{key:n,external:!0})})}};function S3(e){return e.isDefault||!!e.useDefaultFlags?.globalState}async function tQ(e,t,i,s,r,n){const o=v=>{try{return JSON.parse(v)}catch{return v}},a=new Map,c=new Map;e.forEach((v,b)=>{a.set(b,v),c.set(b,o(v))});const l=new Map,u=new Map;t.forEach((v,b)=>{l.set(b,v),u.set(b,o(v))});const h=new Map,f=new Map;i.forEach((v,b)=>{h.set(b,v),f.set(b,o(v))}),console.group(s!==r?`Storage: Application (path: ${s})`:`Storage: Application & Profile (path: ${s}, default profile)`);const p=[];if(a.forEach((v,b)=>{p.push({key:b,value:v})}),console.table(p),console.groupEnd(),console.log(c),s!==r){console.group(`Storage: Profile (path: ${r}, profile specific)`);const v=[];l.forEach((b,S)=>{v.push({key:S,value:b})}),console.table(v),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${n})`);const g=[];h.forEach((v,b)=>{g.push({key:b,value:v})}),console.table(g),console.groupEnd(),console.log(f)}var iQ=class Ai{static{this.a=new Map}static{this.b=new Map}static{this.c=new Map}static{this.d="memento/"}constructor(t,i){this.f=i,this.e=Ai.d+t}getMemento(t,i){switch(t){case 1:{let s=Ai.c.get(this.e);return s||(s=new aS(this.e,t,i,this.f),Ai.c.set(this.e,s)),s.getMemento()}case 0:{let s=Ai.b.get(this.e);return s||(s=new aS(this.e,t,i,this.f),Ai.b.set(this.e,s)),s.getMemento()}case-1:{let s=Ai.a.get(this.e);return s||(s=new aS(this.e,t,i,this.f),Ai.a.set(this.e,s)),s.getMemento()}}}onDidChangeValue(t,i){return this.f.onDidChangeValue(t,this.e,i)}saveMemento(){Ai.c.get(this.e)?.save(),Ai.b.get(this.e)?.save(),Ai.a.get(this.e)?.save()}reloadMemento(t){let i;switch(t){case-1:i=Ai.a.get(this.e);break;case 0:i=Ai.b.get(this.e);break;case 1:i=Ai.c.get(this.e);break}i?.reload()}static clear(t){switch(t){case 1:Ai.c.clear();break;case 0:Ai.b.clear();break;case-1:Ai.a.clear();break}}},aS=class{constructor(e,t,i,s){this.b=e,this.c=t,this.d=i,this.e=s,this.a=this.f()}f(){try{return this.e.getObject(this.b,this.c,{})}catch(e){lt(`[memento]: failed to parse contents: ${e} (id: ${this.b}, scope: ${this.c}, contents: ${this.e.get(this.b,this.c)})`)}return{}}getMemento(){return this.a}reload(){for(const e of Object.getOwnPropertyNames(this.a))delete this.a[e];Object.assign(this.a,this.f())}save(){Dv(this.a)?this.e.remove(this.b,this.c):this.e.store(this.b,this.a,this.c,this.d)}},sQ=H("chatTodoListService"),cS=class{constructor(t){this.a=new iQ("chat-todo-list",t)}b(t){return this.a.getMemento(1,1)[this.d(t)]||[]}c(t,i){const s=this.a.getMemento(1,1);s[this.d(t)]=i,this.a.saveMemento()}getTodoList(t){return this.b(t)}setTodoList(t,i){this.c(t,i)}d(t){return cw(t)}};cS=__decorate([__param(0,_a)],cS);var E3=class extends Z{constructor(t){super(),this.a=this.D(new I),this.onDidUpdateTodos=this.a.event,this.b=new cS(t)}getTodos(t){return this.b.getTodoList(t)}setTodos(t,i){this.b.setTodoList(t,i),this.a.fire(t)}};E3=__decorate([__param(0,_a)],E3);var rQ="chat.todoListTool.writeOnly",nQ="chat.todoListTool.descriptionField",x3="manage_todo_list";function C3(e,t=!0){const i={todoList:{type:"array",description:e?"Complete array of all todo items. Must include ALL items - both existing and new.":"Complete array of all todo items (required for write operation, ignored for read). Must include ALL items - both existing and new.",items:{type:"object",properties:{id:{type:"number",description:"Unique identifier for the todo. Use sequential numbers starting from 1."},title:{type:"string",description:"Concise action-oriented todo label (3-7 words). Displayed in UI."},...t&&{description:{type:"string",description:"Detailed context, requirements, or implementation notes. Include file paths, specific methods, or acceptance criteria."}},status:{type:"string",enum:["not-started","in-progress","completed"],description:"not-started: Not begun | in-progress: Currently working (max 1) | completed: Fully finished with no blockers"}},required:t?["id","title","description","status"]:["id","title","status"]}}},s=e?["todoList"]:[];return e||(i.operation={type:"string",enum:["write","read"],description:"write: Replace entire todo list with new content. read: Retrieve current todo list. ALWAYS provide complete list when writing - partial updates not supported."},s.unshift("operation")),{id:x3,toolReferenceName:"todo",legacyToolReferenceFullNames:["todos"],canBeReferencedInPrompt:!0,icon:Dt.fromId(oe.checklist.id),displayName:d(6670,null),userDescription:d(6671,null),modelDescription:`Manage a structured todo list to track progress and plan tasks throughout your coding session. Use this tool VERY frequently to ensure task visibility and proper planning.

When to use this tool:
- Complex multi-step work requiring planning and tracking
- When user provides multiple tasks or requests (numbered/comma-separated)
- After receiving new instructions that require multiple steps
- BEFORE starting work on any todo (mark as in-progress)
- IMMEDIATELY after completing each todo (mark completed individually)
- When breaking down larger tasks into smaller actionable steps
- To give users visibility into your progress and planning

When NOT to use:
- Single, trivial tasks that can be completed in one step
- Purely conversational/informational requests
- When just reading files or performing simple searches

CRITICAL workflow:
1. Plan tasks by writing todo list with specific, actionable items
2. Mark ONE todo as in-progress before starting work
3. Complete the work for that specific todo
4. Mark that todo as completed IMMEDIATELY
5. Move to next todo and repeat

Todo states:
- not-started: Todo not yet begun
- in-progress: Currently working (limit ONE at a time)
- completed: Finished successfully

IMPORTANT: Mark todos completed as soon as they are done. Do not batch completions.`,source:er.Internal,inputSchema:{type:"object",properties:i,required:s}}}var _ae=C3(!1),lS=class extends Z{constructor(t,i,s,r,n){super(),this.a=t,this.b=i,this.c=s,this.f=r,this.g=n}async invoke(t,i,s,r){const n=t.parameters,a=t.context?.sessionId??n.chatSessionId??"default";this.f.debug(`ManageTodoListTool: Invoking with options ${JSON.stringify(n)}`);try{const c=this.a?"write":n.operation;return c?c==="read"?this.m(xr.forSession(a)):c==="write"?this.q(n,xr.forSession(a)):{content:[{kind:"text",value:"Error: Unknown operation"}]}:{content:[{kind:"text",value:"Error: operation parameter is required"}]}}catch(c){return{content:[{kind:"text",value:`Error: ${c instanceof Error?c.message:"Unknown error"}`}]}}}async prepareToolInvocation(t,i){const s=t.parameters,n=t.chatSessionId??s.chatSessionId??"default",o=this.c.getTodos(xr.forSession(n));let a;switch(this.a?"write":s.operation){case"write":{s.todoList&&(a=this.h(o,s.todoList));break}case"read":{a=d(6672,null);break}default:break}const u=(s.todoList??o).map(h=>({id:h.id.toString(),title:h.title,description:h.description||"",status:h.status}));return{pastTenseMessage:new Qn(a??d(6673,null)),toolSpecificData:{kind:"todoList",sessionId:n,todoList:u}}}h(t,i){if(t.length===0)return i.length===1?d(6674,null):d(6675,null,i.length);const s=new Map(t.map(a=>[a.id,a])),r=i.filter(a=>{const c=s.get(a.id);return c&&c.status!=="in-progress"&&a.status==="in-progress"});if(r.length>0){const a=r[0],c=i.length,l=i.findIndex(u=>u.id===a.id)+1;return d(6676,null,a.title,l,c)}const n=i.filter(a=>{const c=s.get(a.id);return c&&c.status!=="completed"&&a.status==="completed"});if(n.length>0){const a=n[0],c=i.length,l=i.findIndex(u=>u.id===a.id)+1;return d(6677,null,a.title,l,c)}const o=i.filter(a=>!s.has(a.id));return o.length>0?o.length===1?d(6678,null):d(6679,null,o.length):d(6680,null)}j(t,i){return t.length===0?"No todo list found.":`# Todo List

${this.s(t)}`}m(t){const i=this.c.getTodos(t),s=this.j(i,t),r=this.r(i);return this.g.publicLog2("todoListToolInvoked",{operation:"read",notStartedCount:r.notStartedCount,inProgressCount:r.inProgressCount,completedCount:r.completedCount,chatSessionId:cw(t)}),{content:[{kind:"text",value:s}]}}q(t,i){if(!t.todoList)return{content:[{kind:"text",value:"Error: todoList is required for write operation"}]};const s=t.todoList.map(c=>({id:c.id,title:c.title,description:c.description||"",status:c.status})),r=this.c.getTodos(i),n=this.t(r,s);this.c.setTodos(i,s);const o=this.r(s),a=[];return s.length<3?a.push("Warning: Small todo list (<3 items). This task might not need a todo list."):s.length>10&&a.push("Warning: Large todo list (>10 items). Consider keeping the list focused and actionable."),n>3&&a.push("Warning: Did you mean to update so many todos at the same time? Consider working on them one by one."),this.g.publicLog2("todoListToolInvoked",{operation:"write",notStartedCount:o.notStartedCount,inProgressCount:o.inProgressCount,completedCount:o.completedCount,chatSessionId:cw(i)}),{content:[{kind:"text",value:`Successfully wrote todo list${a.length?`

`+a.join(`
`):""}`}],toolMetadata:{warnings:a}}}r(t){const i=t.filter(n=>n.status==="not-started").length,s=t.filter(n=>n.status==="in-progress").length,r=t.filter(n=>n.status==="completed").length;return{notStartedCount:i,inProgressCount:s,completedCount:r}}s(t){return t.length===0?"":t.map(i=>{let s;switch(i.status){case"completed":s="[x]";break;case"in-progress":s="[-]";break;case"not-started":default:s="[ ]";break}const r=[`- ${s} ${i.title}`];return this.b&&i.description&&i.description.trim()&&r.push(`  - ${i.description.trim()}`),r.join(`
`)}).join(`
`)}t(t,i){let s=0;const r=Math.min(t.length,i.length);for(let c=0;c<r;c++){const l=t[c],u=i[c];(l.title!==u.title||(l.description??"")!==(u.description??"")||l.status!==u.status)&&s++}const n=Math.max(0,i.length-t.length),o=Math.max(0,t.length-i.length);return n+o+s}};lS=__decorate([__param(2,sQ),__param(3,Se),__param(4,qu)],lS);var k3=H("requestService"),oQ=class{constructor(e){this.b=e}toJSON(){if(!this.a){const e=Object.create(null);for(const t in this.b)t.toLowerCase()==="authorization"||t.toLowerCase()==="proxy-authorization"?e[t]="*****":e[t]=this.b[t];this.a=e}return this.a}},aQ=class extends Z{constructor(e){super(),this.b=e,this.a=0}async c(e,t){const i=`#${++this.a}: ${e.url}`;this.b.trace(`${i} - begin`,e.type,new oQ(e.headers??{}));try{const s=await t();return this.b.trace(`${i} - end`,e.type,s.res.statusCode,s.res.headers),s}catch(s){throw this.b.error(`${i} - error`,e.type,eE(s)),s}}};function cQ(e){return e.res.statusCode&&e.res.statusCode>=200&&e.res.statusCode<300||e.res.statusCode===1223}function $3(e){return e.res.statusCode===204}async function uS(e){return $3(e)?null:(await Px(e.stream)).toString()}async function lQ(e){if(!cQ(e))throw new Error("Server returned "+e.res.statusCode);if($3(e))return null;const i=(await Px(e.stream)).toString();try{return JSON.parse(i)}catch(s){throw s.message+=`:
`+i,s}}var x1=!1,hS=[],I3=void 0,D3=void 0;function uQ(e=!0,t=!0){if(I3===e&&D3===t)return;I3=e,D3=t;const i=Qt.as(oo.Configuration),s=hS;hS=[{id:"http",order:15,title:d(2294,null),type:"object",scope:2,properties:{"http.useLocalProxyConfiguration":{type:"boolean",default:t,markdownDescription:d(2295,null),restricted:!0}}},{id:"http",order:15,title:d(2296,null),type:"object",scope:1,properties:{"http.electronFetch":{type:"boolean",default:!1,description:d(2297,null),restricted:!0}}},{id:"http",order:15,title:d(2298,null),type:"object",scope:e?1:2,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:d(2299,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,markdownDescription:d(2300,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:d(2301,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:d(2302,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:d(2303,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[d(2304,null),d(2305,null),d(2306,null),d(2307,null)],default:"override",markdownDescription:d(2308,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,markdownDescription:d(2309,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificatesNode":{type:"boolean",tags:["experimental"],default:x1,markdownDescription:d(2310,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0,experiment:{mode:"auto"}},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,markdownDescription:d(2311,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.fetchAdditionalSupport":{type:"boolean",default:!0,markdownDescription:d(2312,null,"`#http.useLocalProxyConfiguration#`","`#http.proxySupport#`","`#http.systemCertificates#`"),restricted:!0},"http.experimental.networkInterfaceCheckInterval":{type:"number",default:300,minimum:-1,tags:["experimental"],markdownDescription:d(2313,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0,experiment:{mode:"auto"}}}}],i.updateConfigurations({add:hS,remove:s})}uQ();var qae=new C("isMac",Pt,d(1865,null)),Gae=new C("isLinux",$t,d(1866,null)),Jae=new C("isWindows",ze,d(1867,null)),hQ=new C("isWeb",Uo,d(1868,null)),Zae=new C("isMacNative",Pt&&!Uo,d(1869,null)),Qae=new C("isIOS",VR,d(1870,null)),Yae=new C("isMobile",qR,d(1871,null)),Xae=new C("isDevelopment",!1,!0),Kae=new C("productQualityType","",d(1872,null)),dQ="inputFocus",ece=new C(dQ,!1,d(1873,null)),P3=H("languageService"),T3=H("modelService"),N3=class extends H${constructor(){super(...arguments),this.f=this.D(new I),this.g=this.D(new I),this.j=this.D(new I),this.n=this.D(new I),this.onDidChangeDirty=this.f.event,this.onDidChangeLabel=this.g.event,this.onDidChangeCapabilities=this.j.event,this.onWillDispose=this.n.event}get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}canReopen(){return!0}matches(e){if(Ys(e))return this===e;const t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:hc(this.resource,aw.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this.B.isDisposed}dispose(){this.isDisposed()||this.n.fire(),super.dispose()}},Fl,dS=class extends N3{static{Fl=this}static{this.ID="workbench.editorinputs.sidebysideEditorInput"}get typeId(){return Fl.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.a)return this.primary.resource}constructor(t,i,s,r,n){super(),this.b=t,this.c=i,this.secondary=s,this.primary=r,this.h=n,this.a=this.primary.matches(this.secondary),this.m()}m(){this.D(Ie.once(Ie.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this.D(this.primary.onDidChangeDirty(()=>this.f.fire())),this.D(this.primary.onDidChangeCapabilities(()=>this.j.fire())),this.D(this.secondary.onDidChangeCapabilities(()=>this.j.fire())),this.D(this.primary.onDidChangeLabel(()=>this.g.fire())),this.D(this.secondary.onDidChangeLabel(()=>this.g.fire()))}getName(){const t=this.getPreferredName();return t||(this.a?this.primary.getName():d(4489,null,this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.b}getDescription(t){const i=this.getPreferredDescription();return i||(this.a?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.c}getTitle(t){let i;this.a?i=this.primary.getTitle(t)??this.getName():i=super.getTitle(t);const s=this.q();return s&&(i=`${s} (${i})`),i}q(){if(this.b&&this.c)return`${this.b} ${this.c}`;if(this.b||this.c)return this.b??this.c}getLabelExtraClasses(){return this.a?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.a?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,i){const s=await this.primary.save(t,i);return this.r(s)}async saveAs(t,i){const s=await this.primary.saveAs(t,i);return this.r(s)}r(t){if(!t||!this.a)return t;if(this.primary.matches(t))return this;if(t instanceof N3)return new Fl(this.b,this.c,t,t,this.h);if(!on(t)&&!Ou(t)&&!oa(t)&&!aa(t))return{primary:t,secondary:t,label:this.b,description:this.c}}revert(t,i){return this.primary.revert(t,i)}async rename(t,i){if(!this.a)return;const s=await this.primary.rename(t,i);if(s){if(Ys(s.editor))return{editor:new Fl(this.b,this.c,s.editor,s.editor,this.h),options:{...s.options,viewState:ow(this,t,this.h)}};if(Uz(s.editor))return{editor:{label:this.b,description:this.c,primary:s.editor,secondary:s.editor,options:{...s.options,viewState:ow(this,t,this.h)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){const i=this.primary.toUntyped(t),s=this.secondary.toUntyped(t);if(i&&s&&!on(i)&&!on(s)&&!Ou(i)&&!Ou(s)&&!oa(i)&&!oa(s)&&!aa(i)&&!aa(s)){const r={label:this.b,description:this.c,primary:i,secondary:s};return typeof t?.preserveViewState=="number"&&(r.options={viewState:ow(this,t.preserveViewState,this.h)}),r}}matches(t){return this===t?!0:W$(t)||on(t)?!1:t instanceof Fl?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):oa(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};dS=Fl=__decorate([__param(4,N6)],dS);var M3=class extends Z{constructor(){super(...arguments),this.f=this.D(new I),this.onWillDispose=this.f.event,this.h=!1}async resolve(){this.h=!0}isResolved(){return this.h}isDisposed(){return this.B.isDisposed}dispose(){this.f.fire(),super.dispose()}},fQ={ModesRegistry:"editor.modesRegistry"},pQ=class extends Z{constructor(){super(),this.b=this.D(new I),this.onDidChangeLanguages=this.b.event,this.a=[]}registerLanguage(e){return this.a.push(e),this.b.fire(void 0),{dispose:()=>{for(let t=0,i=this.a.length;t<i;t++)if(this.a[t]===e){this.a.splice(t,1);return}}}}getLanguages(){return this.a}},L3=new pQ;Qt.add(fQ.ModesRegistry,L3);var C1="plaintext",gQ=".txt";L3.registerLanguage({id:C1,extensions:[gQ],aliases:[d(904,null),"text"],mimetypes:[Qs.text]}),Qt.as(oo.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);var mQ=H("ILanguageDetectionService"),R3="languageDetection",vQ=H("accessibilityService"),O3;(function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Enabled=2]="Enabled"})(O3||(O3={}));var ice=new C("accessibilityModeEnabled",!1),fS,k1=class extends M3{static{fS=this}static{this.a=600}constructor(t,i,s,r,n){super(),this.n=t,this.q=i,this.r=s,this.s=r,this.b=void 0,this.j=this.D(new Vs),this.m=this.D(new pu(fS.a)),this.w=!1,this.y=void 0,n&&this.t(n)}t(t){const i=this.n.getModel(t);if(!i)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.b=t,this.u(i)}u(t){this.j.value=t.onWillDispose(()=>{this.b=void 0,this.dispose()})}get textEditorModel(){return this.b?this.n.getModel(this.b):null}isReadonly(){return!0}get languageChangeSource(){return this.y}get hasLanguageSetExplicitly(){return typeof this.y=="string"}setLanguageId(t,i){this.y="user",this.z(t,i)}z(t,i){if(this.isResolved()&&!(!t||t===this.textEditorModel.getLanguageId())){this.w=!0;try{this.textEditorModel.setLanguage(this.q.createById(t),i)}finally{this.w=!1}}}C(t){const i=this.D(t.onDidChangeLanguage(s=>{s.source===R3||this.w||(this.y="api",i.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}F(){return this.m.trigger(()=>this.G())}async G(){if(this.hasLanguageSetExplicitly||!this.b||!this.r.isEnabledForLanguage(this.getLanguageId()??C1))return;const t=await this.r.detectLanguage(this.b),i=this.getLanguageId();if(t&&t!==i&&!this.isDisposed()){this.z(t,R3);const s=this.q.getLanguageName(t);this.s.alert(d(4490,null,s??t))}}H(t,i,s){const r=this.J(t),n=this.L(i,this.q,s,r);return this.I(t,n,i)}I(t,i,s){let r=s&&this.n.getModel(s);return r?this.updateTextEditorModel(t,i.languageId):(r=this.n.createModel(t,i,s),this.g=!0,this.u(r)),this.b=r.uri,r}J(t){const i=t;return typeof i.getFirstLineText=="function"?i.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}L(t,i,s,r){return!s||s===C1?i.createByFilepathOrFirstLine(t??null,r):i.createById(s)}updateTextEditorModel(t,i,s){this.isResolved()&&(t&&this.n.updateModel(this.textEditorModel,t,s),i&&i!==C1&&this.textEditorModel.getLanguageId()!==i&&this.textEditorModel.setLanguage(this.q.createById(i)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.b}dispose(){this.j.dispose(),this.b&&this.g&&this.n.destroyModel(this.b),this.b=void 0,this.g=!1,super.dispose()}};k1=fS=__decorate([__param(0,T3),__param(1,P3),__param(2,mQ),__param(3,vQ)],k1);var F3=class extends M3{get originalModel(){return this.a}get modifiedModel(){return this.b}constructor(e,t){super(),this.a=e,this.b=t}async resolve(){await Promise.all([this.a?.resolve(),this.b?.resolve()])}isResolved(){return!!(this.a?.isResolved()&&this.b?.isResolved())}dispose(){super.dispose()}},wQ=class extends F3{get originalModel(){return this.a}get modifiedModel(){return this.b}get textDiffEditorModel(){return this.j}constructor(e,t){super(e,t),this.j=void 0,this.a=e,this.b=t,this.m()}async resolve(){await super.resolve(),this.m()}m(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this.j?(this.j.original=this.originalModel.textEditorModel,this.j.modified=this.modifiedModel.textEditorModel):this.j={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this.j}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this.j=void 0,super.dispose()}};function U3(e){const t=e;return typeof t?.resolve=="function"&&typeof t?.isResolved=="function"}var j3;(function(e){e[e.ACTIVATE=1]="ACTIVATE",e[e.RESTORE=2]="RESTORE",e[e.PRESERVE=3]="PRESERVE"})(j3||(j3={}));var z3;(function(e){e[e.PICK=0]="PICK",e[e.EXCLUSIVE_ONLY=1]="EXCLUSIVE_ONLY"})(z3||(z3={}));var H3;(function(e){e[e.API=0]="API",e[e.USER=1]="USER"})(H3||(H3={}));var W3;(function(e){e[e.Center=0]="Center",e[e.CenterIfOutsideViewport=1]="CenterIfOutsideViewport",e[e.NearTop=2]="NearTop",e[e.NearTopIfOutsideViewport=3]="NearTopIfOutsideViewport"})(W3||(W3={}));var B3;(function(e){e.PROGRAMMATIC="api",e.NAVIGATION="code.navigation",e.JUMP="code.jump"})(B3||(B3={}));var $1,_3=class extends dS{static{$1=this}static{this.ID="workbench.editors.diffEditorInput"}get typeId(){return $1.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.t.forceDescription&&(t|=64),t}constructor(t,i,s,r,n,o){super(t,i,s,r,o),this.original=s,this.modified=r,this.u=n,this.s=void 0,this.t=this.w()}w(){let t,i=!1;if(this.b)t=this.b;else{const u=this.original.getName(),h=this.modified.getName();t=d(4488,null,u,h),i=u===h}let s,r,n;if(this.c)s=this.c,r=this.c,n=this.c;else{s=this.y(this.original.getDescription(0),this.modified.getDescription(0)),n=this.y(this.original.getDescription(2),this.modified.getDescription(2));const u=this.original.getDescription(1),h=this.modified.getDescription(1);if(typeof u=="string"&&typeof h=="string"&&(u||h)){const[f,p]=cV([u,h]);r=this.y(f,p)}}let o=this.y(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),a=this.y(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),c=this.y(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 ");const l=this.q();return l&&(o=`${l} (${o})`,a=`${l} (${a})`,c=`${l} (${c})`),{name:t,shortDescription:s,mediumDescription:r,longDescription:n,forceDescription:i,shortTitle:o,mediumTitle:a,longTitle:c}}y(t,i,s=" - "){if(!(!t||!i))return t===i?i:`${t}${s}${i}`}getName(){return this.t.name}getDescription(t=1){switch(t){case 0:return this.t.shortDescription;case 2:return this.t.longDescription;case 1:default:return this.t.mediumDescription}}getTitle(t){switch(t){case 0:return this.t.shortTitle;case 2:return this.t.longTitle;default:case 1:return this.t.mediumTitle}}async resolve(){const t=await this.z();return this.s?.dispose(),this.s=t,this.s}prefersEditorPane(t){return this.u?t.find(i=>i.typeId===Fz):t.find(i=>i.typeId===Oz)}async z(){const[t,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return i instanceof k1&&t instanceof k1?new wQ(t,i):new F3(U3(t)?t:void 0,U3(i)?i:void 0)}toUntyped(t){const i=super.toUntyped(t);if(i)return{...i,modified:i.primary,original:i.secondary}}matches(t){return this===t?!0:t instanceof $1?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.u===this.u:on(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.s&&(this.s.dispose(),this.s=void 0),super.dispose()}};_3=$1=__decorate([__param(5,N6)],_3);var fr,nce=new C("workbenchState",void 0,{type:"string",description:d(4410,null)}),oce=new C("workspaceFolderCount",0,d(4411,null)),ace=new C("openFolderWorkspaceSupport",!0,!0),cce=new C("enterMultiRootWorkspaceSupport",!0,!0),lce=new C("emptyWorkspaceSupport",!0,!0),uce=new C("dirtyWorkingCopies",!1,d(4412,null)),bQ=new C("remoteName","",d(4413,null)),hce=new C("virtualWorkspace","",d(4414,null)),dce=new C("temporaryWorkspace",!1,d(4415,null)),fce=new C("hasWebFileSystemAccess",!1,!0),pce=new C("embedderIdentifier",void 0,d(4416,null)),gce=new C("inAutomation",!1,d(4417,null)),mce=new C("isFullscreen",!1,d(4418,null)),vce=new C("isAuxiliaryWindowFocusedContext",!1,d(4419,null)),wce=new C("isWindowAlwaysOnTop",!1,d(4420,null)),bce=new C("isAuxiliaryWindow",!1,d(4421,null)),yce=new C("activeEditorIsDirty",!1,d(4422,null)),Ace=new C("activeEditorIsNotPreview",!1,d(4423,null)),Sce=new C("activeEditorIsFirstInGroup",!1,d(4424,null)),Ece=new C("activeEditorIsLastInGroup",!1,d(4425,null)),xce=new C("activeEditorIsPinned",!1,d(4426,null)),Cce=new C("activeEditorIsReadonly",!1,d(4427,null)),kce=new C("activeCompareEditorCanSwap",!1,d(4428,null)),$ce=new C("activeEditorCanToggleReadonly",!0,d(4429,null)),Ice=new C("activeEditorCanRevert",!1,d(4430,null)),Dce=new C("activeEditorCanSplitInGroup",!0),Pce=new C("activeEditor",null,{type:"string",description:d(4431,null)}),Tce=new C("activeEditorAvailableEditorIds","",d(4432,null)),Nce=new C("textCompareEditorVisible",!1,d(4433,null)),Mce=new C("textCompareEditorActive",!1,d(4434,null)),Lce=new C("sideBySideEditorActive",!1,d(4435,null)),Rce=new C("groupEditorsCount",0,d(4436,null)),Oce=new C("activeEditorGroupEmpty",!1,d(4437,null)),Fce=new C("activeEditorGroupIndex",0,d(4438,null)),Uce=new C("activeEditorGroupLast",!1,d(4439,null)),jce=new C("activeEditorGroupLocked",!1,d(4440,null)),yQ=new C("multipleEditorGroups",!1,d(4441,null)),zce=yQ.toNegated(),Hce=new C("multipleEditorsSelectedInGroup",!1,d(4442,null)),Wce=new C("twoEditorsSelectedInGroup",!1,d(4443,null)),Bce=new C("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,d(4444,null)),AQ=new C("editorPartMultipleEditorGroups",!1,d(4445,null)),_ce=AQ.toNegated(),Vce=new C("editorPartMaximizedEditorGroup",!1,d(4446,null)),qce=new C("editorIsOpen",!1,d(4447,null)),Gce=new C("inZenMode",!1,d(4448,null)),Jce=new C("isCenteredLayout",!1,d(4449,null)),Zce=new C("splitEditorsVertically",!1,d(4450,null)),Qce=new C("mainEditorAreaVisible",!0,d(4451,null)),Yce=new C("editorTabsVisible",!0,d(4452,null)),Xce=new C("sideBarVisible",!1,d(4453,null)),Kce=new C("sideBarFocus",!1,d(4454,null)),ele=new C("activeViewlet","",d(4455,null)),tle=new C("statusBarFocused",!1,d(4456,null)),ile=new C("titleBarStyle","custom",d(4457,null)),sle=new C("titleBarVisible",!1,d(4458,null)),rle=new C("isCompactTitleBar",!1,d(4459,null)),nle=new C("bannerFocused",!1,d(4460,null)),ole=new C("notificationFocus",!0,d(4461,null)),ale=new C("notificationCenterVisible",!1,d(4462,null)),cle=new C("notificationToastsVisible",!1,d(4463,null)),lle=new C("activeAuxiliary","",d(4464,null)),ule=new C("auxiliaryBarFocus",!1,d(4465,null)),hle=new C("auxiliaryBarVisible",!1,d(4466,null)),dle=new C("auxiliaryBarMaximized",!1,d(4467,null)),fle=new C("activePanel","",d(4468,null)),ple=new C("panelFocus",!1,d(4469,null)),gle=new C("panelPosition","bottom",d(4470,null)),mle=new C("panelAlignment","center",d(4471,null)),vle=new C("panelVisible",!1,d(4472,null)),wle=new C("panelMaximized",!1,d(4473,null)),ble=new C("focusedView","",d(4474,null)),V3=class{static{fr=this}static{this.Scheme=new C("resourceScheme",void 0,{type:"string",description:d(4475,null)})}static{this.Filename=new C("resourceFilename",void 0,{type:"string",description:d(4476,null)})}static{this.Dirname=new C("resourceDirname",void 0,{type:"string",description:d(4477,null)})}static{this.Path=new C("resourcePath",void 0,{type:"string",description:d(4478,null)})}static{this.LangId=new C("resourceLangId",void 0,{type:"string",description:d(4479,null)})}static{this.Resource=new C("resource",void 0,{type:"URI",description:d(4480,null)})}static{this.Extension=new C("resourceExtname",void 0,{type:"string",description:d(4481,null)})}static{this.HasResource=new C("resourceSet",void 0,{type:"boolean",description:d(4482,null)})}static{this.IsFileSystemResource=new C("isFileSystemResource",void 0,{type:"boolean",description:d(4483,null)})}constructor(t,i,s,r){this.m=t,this.n=i,this.o=s,this.p=r,this.a=new ie,this.d=fr.Scheme.bindTo(this.m),this.f=fr.Filename.bindTo(this.m),this.g=fr.Dirname.bindTo(this.m),this.h=fr.Path.bindTo(this.m),this.i=fr.LangId.bindTo(this.m),this.c=fr.Resource.bindTo(this.m),this.j=fr.Extension.bindTo(this.m),this.k=fr.HasResource.bindTo(this.m),this.l=fr.IsFileSystemResource.bindTo(this.m),this.a.add(i.onDidChangeFileSystemProviderRegistrations(()=>{const n=this.get();this.l.set(!!(n&&i.hasProvider(n)))})),this.a.add(r.onModelAdded(n=>{hc(n.uri,this.get())&&this.q()})),this.a.add(r.onModelLanguageChanged(n=>{hc(n.model.uri,this.get())&&this.q()}))}dispose(){this.a.dispose()}q(){const t=this.get();if(!t){this.i.set(null);return}const i=this.p.getModel(t)?.getLanguageId()??this.o.guessLanguageIdByFilepathOrFirstLine(t);this.i.set(i)}set(t){t=t??void 0,!hc(this.b,t)&&(this.b=t,this.m.bufferChangeEvents(()=>{this.c.set(t?t.toString():null),this.d.set(t?t.scheme:null),this.f.set(t?Li(t):null),this.g.set(t?this.r(dc(t)):null),this.h.set(t?this.r(t):null),this.q(),this.j.set(t?hx(t):null),this.k.set(!!t),this.l.set(t?this.n.hasProvider(t):!1)}))}r(t){return t.scheme===V.file?t.fsPath:t.path}reset(){this.b=void 0,this.m.bufferChangeEvents(()=>{this.c.reset(),this.d.reset(),this.f.reset(),this.g.reset(),this.h.reset(),this.i.reset(),this.j.reset(),this.k.reset(),this.l.reset()})}get(){return this.b}};V3=fr=__decorate([__param(0,Gn),__param(1,nw),__param(2,P3),__param(3,T3)],V3);var q3=H("dialogService"),G3;(function(e){e[e.Confirmation=1]="Confirmation",e[e.Prompt=2]="Prompt",e[e.Input=3]="Input"})(G3||(G3={}));var Ale=H("fileDialogService"),J3;(function(e){e[e.SAVE=0]="SAVE",e[e.DONT_SAVE=1]="DONT_SAVE",e[e.CANCEL=2]="CANCEL"})(J3||(J3={}));var SQ=H("openerService"),Z3=H("lifecycleService"),Q3;(function(e){e[e.Default=1]="Default",e[e.Last=2]="Last"})(Q3||(Q3={}));var Y3;(function(e){e[e.CLOSE=1]="CLOSE",e[e.QUIT=2]="QUIT",e[e.RELOAD=3]="RELOAD",e[e.LOAD=4]="LOAD"})(Y3||(Y3={}));var X3;(function(e){e[e.NewWindow=1]="NewWindow",e[e.ReloadedWindow=3]="ReloadedWindow",e[e.ReopenedWindow=4]="ReopenedWindow"})(X3||(X3={}));var K3;(function(e){e[e.Starting=1]="Starting",e[e.Ready=2]="Ready",e[e.Restored=3]="Restored",e[e.Eventually=4]="Eventually"})(K3||(K3={}));var $o,Ul,ye;(function(e){e.Setup={hidden:new C("chatSetupHidden",!1,!0),installed:new C("chatSetupInstalled",!1,!0),disabled:new C("chatSetupDisabled",!1,!0),untrusted:new C("chatSetupUntrusted",!1,!0),later:new C("chatSetupLater",!1,!0),registered:new C("chatSetupRegistered",!1,!0)},e.Entitlement={signedOut:new C("chatEntitlementSignedOut",!1,!0),canSignUp:new C("chatPlanCanSignUp",!1,!0),planFree:new C("chatPlanFree",!1,!0),planPro:new C("chatPlanPro",!1,!0),planProPlus:new C("chatPlanProPlus",!1,!0),planBusiness:new C("chatPlanBusiness",!1,!0),planEnterprise:new C("chatPlanEnterprise",!1,!0),organisations:new C("chatEntitlementOrganisations",void 0,!0),internal:new C("chatEntitlementInternal",!1,!0),sku:new C("chatEntitlementSku",void 0,!0)},e.chatQuotaExceeded=new C("chatQuotaExceeded",!1,!0),e.completionsQuotaExceeded=new C("completionsQuotaExceeded",!1,!0),e.chatAnonymous=new C("chatAnonymous",!1,!0)})(ye||(ye={}));var eT=H("chatEntitlementService"),Te;(function(e){e[e.Unknown=1]="Unknown",e[e.Unresolved=2]="Unresolved",e[e.Available=3]="Available",e[e.Unavailable=4]="Unavailable",e[e.Free=5]="Free",e[e.Pro=6]="Pro",e[e.ProPlus=7]="ProPlus",e[e.Business=8]="Business",e[e.Enterprise=9]="Enterprise"})(Te||(Te={}));function EQ(e){return e===Te.Pro||e===Te.ProPlus||e===Te.Business||e===Te.Enterprise}var wi={extensionId:yi.defaultChatAgent?.extensionId??"",chatExtensionId:yi.defaultChatAgent?.chatExtensionId??"",upgradePlanUrl:yi.defaultChatAgent?.upgradePlanUrl??"",provider:yi.defaultChatAgent?.provider??{default:{id:""},enterprise:{id:""}},providerUriSetting:yi.defaultChatAgent?.providerUriSetting??"",providerScopes:yi.defaultChatAgent?.providerScopes??[[]],entitlementUrl:yi.defaultChatAgent?.entitlementUrl??"",entitlementSignupLimitedUrl:yi.defaultChatAgent?.entitlementSignupLimitedUrl??"",completionsAdvancedSetting:yi.defaultChatAgent?.completionsAdvancedSetting??"",chatQuotaExceededContext:yi.defaultChatAgent?.chatQuotaExceededContext??"",completionsQuotaExceededContext:yi.defaultChatAgent?.completionsQuotaExceededContext??""},tT="chat.allowAnonymousAccess";function pS(e,t,i){return!(e.getValue(tT)!==!0||t!==Te.Unknown||i.hidden||i.disabled)}function gS(e,t,i){i.publicLog2("chatEntitlements",{chatHidden:!!e.hidden,chatDisabled:!!e.disabled,chatEntitlement:e.entitlement,chatRegistered:!!e.registered,chatAnonymous:pS(t,e.entitlement,e)})}var mS=class extends Z{constructor(t,i,s,r,n,o,a){if(super(),this.a=r,this.b=n,this.c=o,this.f=a,this.g=this.D(new I),this.onDidChangeQuotaExceeded=this.g.event,this.h=this.D(new I),this.onDidChangeQuotaRemaining=this.h.event,this.j={},this.q={chatQuotaExceeded:wi.chatQuotaExceededContext,completionsQuotaExceeded:wi.completionsQuotaExceededContext},this.w=this.D(new I),this.onDidChangeAnonymous=this.w.event,this.anonymousObs=ju(this.onDidChangeAnonymous,()=>this.anonymous),this.m=ye.chatQuotaExceeded.bindTo(this.a),this.n=ye.completionsQuotaExceeded.bindTo(this.a),this.u=ye.chatAnonymous.bindTo(this.a),this.u.set(this.anonymous),this.onDidChangeEntitlement=Ie.map(Ie.filter(this.a.onDidChangeContext,l=>l.affectsSome(new Set([ye.Entitlement.planPro.key,ye.Entitlement.planBusiness.key,ye.Entitlement.planEnterprise.key,ye.Entitlement.planProPlus.key,ye.Entitlement.planFree.key,ye.Entitlement.canSignUp.key,ye.Entitlement.signedOut.key,ye.Entitlement.organisations.key,ye.Entitlement.internal.key,ye.Entitlement.sku.key])),this.B),()=>{},this.B),this.entitlementObs=ju(this.onDidChangeEntitlement,()=>this.entitlement),this.onDidChangeSentiment=Ie.map(Ie.filter(this.a.onDidChangeContext,l=>l.affectsSome(new Set([ye.Setup.hidden.key,ye.Setup.disabled.key,ye.Setup.untrusted.key,ye.Setup.installed.key,ye.Setup.later.key,ye.Setup.registered.key])),this.B),()=>{},this.B),this.sentimentObs=ju(this.onDidChangeSentiment,()=>this.sentiment),Uo&&!s.remoteAuthority){ye.Setup.hidden.bindTo(this.a).set(!0);return}if(!i.defaultChatAgent)return;const c=this.context=new Tt(()=>this.D(t.createInstance(wS)));this.requests=new Tt(()=>this.D(t.createInstance(vS,c.value,{clearQuotas:()=>this.clearQuotas(),acceptQuotas:l=>this.acceptQuotas(l)}))),this.r()}get entitlement(){return this.a.getContextKeyValue(ye.Entitlement.planPro.key)===!0?Te.Pro:this.a.getContextKeyValue(ye.Entitlement.planBusiness.key)===!0?Te.Business:this.a.getContextKeyValue(ye.Entitlement.planEnterprise.key)===!0?Te.Enterprise:this.a.getContextKeyValue(ye.Entitlement.planProPlus.key)===!0?Te.ProPlus:this.a.getContextKeyValue(ye.Entitlement.planFree.key)===!0?Te.Free:this.a.getContextKeyValue(ye.Entitlement.canSignUp.key)===!0?Te.Available:this.a.getContextKeyValue(ye.Entitlement.signedOut.key)===!0?Te.Unknown:Te.Unresolved}get isInternal(){return this.a.getContextKeyValue(ye.Entitlement.internal.key)===!0}get organisations(){return this.a.getContextKeyValue(ye.Entitlement.organisations.key)}get sku(){return this.a.getContextKeyValue(ye.Entitlement.sku.key)}get quotas(){return this.j}r(){const t=new Set([this.q.chatQuotaExceeded,this.q.completionsQuotaExceeded]),i=this.D(new Vs);this.D(this.a.onDidChangeContext(n=>{n.affectsSome(t)&&(i.value&&i.value.cancel(),i.value=new Qe,this.update(i.value.token))}));let s=this.anonymous;const r=()=>{const n=this.anonymous;n!==s&&(s=n,this.u.set(n),this.context?.hasValue&&gS(this.context.value.state,this.b,this.c),this.w.fire())};this.D(this.b.onDidChangeConfiguration(n=>{n.affectsConfiguration(tT)&&r()})),this.D(this.onDidChangeEntitlement(()=>r())),this.D(this.onDidChangeSentiment(()=>r())),this.f.when(4).then(()=>{this.context?.hasValue&&gS(this.context.value.state,this.b,this.c)})}acceptQuotas(t){const i=this.j;this.j=t,this.t();const{changed:s}=this.s(i.chat,t.chat),{changed:r}=this.s(i.completions,t.completions),{changed:n}=this.s(i.premiumChat,t.premiumChat);(s.exceeded||r.exceeded||n.exceeded)&&this.g.fire(),(s.remaining||r.remaining||n.remaining)&&this.h.fire()}s(t,i){return{changed:{exceeded:t?.percentRemaining===0!=(i?.percentRemaining===0),remaining:t?.percentRemaining!==i?.percentRemaining}}}clearQuotas(){this.acceptQuotas({})}t(){this.m.set(this.j.chat?.percentRemaining===0),this.n.set(this.j.completions?.percentRemaining===0)}get sentiment(){return{installed:this.a.getContextKeyValue(ye.Setup.installed.key)===!0,hidden:this.a.getContextKeyValue(ye.Setup.hidden.key)===!0,disabled:this.a.getContextKeyValue(ye.Setup.disabled.key)===!0,untrusted:this.a.getContextKeyValue(ye.Setup.untrusted.key)===!0,later:this.a.getContextKeyValue(ye.Setup.later.key)===!0,registered:this.a.getContextKeyValue(ye.Setup.registered.key)===!0}}get anonymous(){return pS(this.b,this.entitlement,this.sentiment)}async update(t){await this.requests?.value.forceResolveEntitlement(void 0,t)}};mS=__decorate([__param(0,Xo),__param(1,sd),__param(2,jA),__param(3,Gn),__param(4,gi),__param(5,qu),__param(6,Z3)],mS);var vS=$o=class extends Z{static providerId(t){return t.getValue(`${wi.completionsAdvancedSetting}.authProvider`)===wi.provider.enterprise.id?wi.provider.enterprise.id:wi.provider.default.id}constructor(t,i,s,r,n,o,a,c,l,u,h){super(),this.f=t,this.g=i,this.h=s,this.j=r,this.m=n,this.n=o,this.q=a,this.r=c,this.s=l,this.t=u,this.u=h,this.b=new Qe,this.c=!1,this.a={entitlement:this.f.state.entitlement},this.w(),this.y()}w(){this.D(this.j.onDidChangeDeclaredProviders(()=>this.y())),this.D(this.j.onDidChangeSessions(t=>{t.providerId===$o.providerId(this.s)&&this.y()})),this.D(this.j.onDidRegisterAuthenticationProvider(t=>{t.id===$o.providerId(this.s)&&this.y()})),this.D(this.j.onDidUnregisterAuthenticationProvider(t=>{t.id===$o.providerId(this.s)&&this.y()})),this.D(this.f.onDidChange(()=>{(!this.f.state.installed||this.f.state.disabled||this.f.state.entitlement===Te.Unknown)&&(this.a={entitlement:this.a.entitlement,quotas:void 0},this.g.clearQuotas())}))}async y(){this.b.dispose(!0);const t=this.b=new Qe,i=await this.z(t.token);if(t.token.isCancellationRequested)return;let s;i?this.a.entitlement===Te.Unknown&&(s={entitlement:Te.Unresolved}):(this.c=!1,s={entitlement:Te.Unknown}),s&&this.M(s),i&&!this.c&&await this.G(i,t.token)}async z(t){const i=await this.C($o.providerId(this.s));if(t.isCancellationRequested)return;const s=new Set;for(const r of i)for(const n of wi.providerScopes)this.F(r.scopes,n)&&s.add(r);return s.size>0?Array.from(s):void 0}async C(t){const i=this.t.getAccountPreference(wi.chatExtensionId,t)??this.t.getAccountPreference(wi.extensionId,t);let s;for(const r of await this.j.getAccounts(t))if(r.label===i){s=r;break}try{return await this.j.getSessions(t,void 0,{account:s})}catch{}return[]}F(t,i){return i.every(s=>t.includes(s))}async G(t,i){const s=await this.H(t,i);return typeof s?.entitlement=="number"&&!i.isCancellationRequested&&(this.c=!0,this.M(s)),s}async H(t,i){if(i.isCancellationRequested)return;const s=await this.L(this.I(),"GET",void 0,t,i);if(i.isCancellationRequested)return;if(!s)return this.m.trace("[chat entitlement]: no response"),{entitlement:Te.Unresolved};if(s.res.statusCode&&s.res.statusCode!==200)return this.m.trace(`[chat entitlement]: unexpected status code ${s.res.statusCode}`),s.res.statusCode===401||s.res.statusCode===404?{entitlement:Te.Unknown}:{entitlement:Te.Unresolved};let r=null;try{r=await uS(s)}catch{}if(i.isCancellationRequested)return;if(!r)return this.m.trace("[chat entitlement]: response has no content"),{entitlement:Te.Unresolved};let n;try{n=JSON.parse(r),this.m.trace(`[chat entitlement]: parsed result is ${JSON.stringify(n)}`)}catch(c){return this.m.trace(`[chat entitlement]: error parsing response (${c})`),{entitlement:Te.Unresolved}}let o;n.access_type_sku==="free_limited_copilot"?o=Te.Free:n.can_signup_for_limited?o=Te.Available:n.copilot_plan==="individual"?o=Te.Pro:n.copilot_plan==="individual_pro"?o=Te.ProPlus:n.copilot_plan==="business"?o=Te.Business:n.copilot_plan==="enterprise"?o=Te.Enterprise:n.chat_enabled?o=Te.Pro:o=Te.Unavailable;const a={entitlement:o,organisations:n.organization_login_list,quotas:this.J(n),sku:n.access_type_sku};return this.m.trace(`[chat entitlement]: resolved to ${a.entitlement}, quotas: ${JSON.stringify(a.quotas)}`),this.h.publicLog2("chatInstallEntitlement",{entitlement:a.entitlement,tid:n.analytics_tracking_id,sku:a.sku,quotaChat:a.quotas?.chat?.remaining,quotaPremiumChat:a.quotas?.premiumChat?.remaining,quotaCompletions:a.quotas?.completions?.remaining,quotaResetDate:a.quotas?.resetDate}),a}I(){if($o.providerId(this.s)===wi.provider.enterprise.id)try{const t=new URL(this.s.getValue(wi.providerUriSetting));return`${t.protocol}//api.${t.hostname}${t.port?":"+t.port:""}/copilot_internal/user`}catch(t){this.m.error(t)}return wi.entitlementUrl}J(t){const i={resetDate:t.quota_reset_date_utc??t.quota_reset_date??t.limited_user_reset_date,resetDateHasTime:typeof t.quota_reset_date_utc=="string"};if(t.monthly_quotas?.chat&&typeof t.limited_user_quotas?.chat=="number"&&(i.chat={total:t.monthly_quotas.chat,remaining:t.limited_user_quotas.chat,percentRemaining:Math.min(100,Math.max(0,t.limited_user_quotas.chat/t.monthly_quotas.chat*100)),overageEnabled:!1,overageCount:0,unlimited:!1}),t.monthly_quotas?.completions&&typeof t.limited_user_quotas?.completions=="number"&&(i.completions={total:t.monthly_quotas.completions,remaining:t.limited_user_quotas.completions,percentRemaining:Math.min(100,Math.max(0,t.limited_user_quotas.completions/t.monthly_quotas.completions*100)),overageEnabled:!1,overageCount:0,unlimited:!1}),t.quota_snapshots)for(const s of["chat","completions","premium_interactions"]){const r=t.quota_snapshots[s];if(!r)continue;const n={total:r.entitlement,remaining:r.remaining,percentRemaining:Math.min(100,Math.max(0,r.percent_remaining)),overageEnabled:r.overage_permitted,overageCount:r.overage_count,unlimited:r.unlimited};switch(s){case"chat":i.chat=n;break;case"completions":i.completions=n;break;case"premium_interactions":i.premiumChat=n;break}}return i}async L(t,i,s,r,n){let o;for(const a of r){if(n.isCancellationRequested)return o;try{const c=await this.n.request({type:i,url:t,data:i==="POST"?JSON.stringify(s):void 0,disableCache:!0,headers:{Authorization:`Bearer ${a.accessToken}`}},n),l=c.res.statusCode;if(l&&l!==200){o=c;continue}return c}catch(c){n.isCancellationRequested||this.m.error(`[chat entitlement] request: error ${c}`)}}return o}M(t){this.a=t,this.f.update({entitlement:this.a.entitlement,organisations:this.a.organisations,sku:this.a.sku}),t.quotas&&this.g.acceptQuotas(t.quotas)}async forceResolveEntitlement(t,i=Fe.None){if(t||(t=await this.z(i)),!(!t||t.length===0))return this.G(t,i)}async signUpFree(t){const i={restricted_telemetry:this.h.telemetryLevel===0?"disabled":"enabled",public_code_suggestions:"enabled"},s=await this.L(wi.entitlementSignupLimitedUrl,"POST",i,t,Fe.None);if(!s)return await this.N(d(15214,null),"[chat entitlement] sign-up: no response")?this.signUpFree(t):{errorCode:1};if(s.res.statusCode&&s.res.statusCode!==200){if(s.res.statusCode===422)try{const a=await uS(s);if(a){const c=JSON.parse(a);if(typeof c.message=="string"&&c.message)return this.O(`[chat entitlement] sign-up: unprocessable entity (${c.message})`,c.message),{errorCode:s.res.statusCode}}}catch{}return await this.N(d(15215,null,s.res.statusCode),`[chat entitlement] sign-up: unexpected status code ${s.res.statusCode}`)?this.signUpFree(t):{errorCode:s.res.statusCode}}let r=null;try{r=await uS(s)}catch{}if(!r)return await this.N(d(15216,null),"[chat entitlement] sign-up: response has no content")?this.signUpFree(t):{errorCode:2};let n;try{n=JSON.parse(r),this.m.trace(`[chat entitlement] sign-up: response is ${r}`)}catch(o){return await this.N(d(15217,null),`[chat entitlement] sign-up: error parsing response (${o})`)?this.signUpFree(t):{errorCode:3}}return this.M({entitlement:Te.Free}),!!n?.subscribed}async N(t,i){if(this.m.error(i),!this.u.willShutdown){const{confirmed:s}=await this.q.confirm({type:Lt.Error,message:d(15218,null),detail:t,primaryButton:d(15219,null)});return s}return!1}O(t,i){this.m.error(t),this.u.willShutdown||this.q.prompt({type:Lt.Error,message:d(15220,null),detail:i,buttons:[{label:d(15221,null),run:()=>{}},{label:d(15222,null),run:()=>this.r.open(y.parse(wi.upgradePlanUrl))}]})}async signIn(t){const i=$o.providerId(this.s),s=t?.additionalScopes?Tn([...wi.providerScopes[0],...t.additionalScopes]):wi.providerScopes[0],r=await this.j.createSession(i,s,{extraAuthorizeParameters:{get_started_with:"copilot-vscode"},provider:t?.useSocialProvider});this.t.updateAccountPreference(wi.extensionId,i,r.account),this.t.updateAccountPreference(wi.chatExtensionId,i,r.account);const n=await this.forceResolveEntitlement([r]);return{session:r,entitlements:n}}dispose(){this.b.dispose(!0),super.dispose()}};vS=$o=__decorate([__param(2,qu),__param(3,W_),__param(4,Se),__param(5,k3),__param(6,q3),__param(7,SQ),__param(8,gi),__param(9,B_),__param(10,Z3)],vS);var wS=class extends Z{static{Ul=this}static{this.a="chat.setupContext"}static{this.b="chat.disableAIFeatures"}get state(){return this.P(this.G??this.F)}constructor(t,i,s,r,n){super(),this.J=i,this.L=s,this.M=r,this.N=n,this.G=void 0,this.H=this.D(new I),this.onDidChange=this.H.event,this.I=void 0,this.c=ye.Entitlement.canSignUp.bindTo(t),this.f=ye.Entitlement.signedOut.bindTo(t),this.g=ye.Entitlement.planFree.bindTo(t),this.h=ye.Entitlement.planPro.bindTo(t),this.j=ye.Entitlement.planProPlus.bindTo(t),this.m=ye.Entitlement.planBusiness.bindTo(t),this.n=ye.Entitlement.planEnterprise.bindTo(t),this.q=ye.Entitlement.organisations.bindTo(t),this.r=ye.Entitlement.internal.bindTo(t),this.s=ye.Entitlement.sku.bindTo(t),this.t=ye.Setup.hidden.bindTo(t),this.u=ye.Setup.later.bindTo(t),this.w=ye.Setup.installed.bindTo(t),this.y=ye.Setup.disabled.bindTo(t),this.z=ye.Setup.untrusted.bindTo(t),this.C=ye.Setup.registered.bindTo(t),this.F=this.J.getObject(Ul.a,0)??{entitlement:Te.Unknown,organisations:void 0,sku:void 0},this.R(),this.O()}O(){this.D(this.M.onDidChangeConfiguration(t=>{t.affectsConfiguration(Ul.b)&&this.Q()}))}P(t){return this.M.getValue(Ul.b)===!0?{...t,hidden:!0}:t}async update(t){this.L.trace(`[chat entitlement context] update(): ${JSON.stringify(t)}`);const i=JSON.stringify(this.F);if(typeof t.installed=="boolean"&&typeof t.disabled=="boolean"&&typeof t.untrusted=="boolean"&&(this.F.installed=t.installed,this.F.disabled=t.disabled,this.F.untrusted=t.untrusted,t.installed&&!t.disabled&&(t.hidden=!1)),typeof t.hidden=="boolean"&&(this.F.hidden=t.hidden),typeof t.later=="boolean"&&(this.F.later=t.later),typeof t.entitlement=="number"&&(this.F.entitlement=t.entitlement,this.F.organisations=t.organisations,this.F.sku=t.sku,this.F.entitlement===Te.Free||EQ(this.F.entitlement)?this.F.registered=!0:this.F.entitlement===Te.Available&&(this.F.registered=!1)),pS(this.M,this.F.entitlement,this.F)&&(this.F.sku="no_auth_limited_copilot"),i!==JSON.stringify(this.F))return this.J.store(Ul.a,{...this.F,later:void 0},0,1),this.Q()}async Q(){await this.I?.wait(),this.R()}R(){const t=this.P(this.F);this.f.set(t.entitlement===Te.Unknown),this.c.set(t.entitlement===Te.Available),this.g.set(t.entitlement===Te.Free),this.h.set(t.entitlement===Te.Pro),this.j.set(t.entitlement===Te.ProPlus),this.m.set(t.entitlement===Te.Business),this.n.set(t.entitlement===Te.Enterprise),this.q.set(t.organisations),this.r.set(!!t.organisations?.some(i=>i==="github"||i==="microsoft"||i==="ms-copilot"||i==="MicrosoftCopilot")),this.s.set(t.sku),this.t.set(!!t.hidden),this.u.set(!!t.later),this.w.set(!!t.installed),this.y.set(!!t.disabled),this.z.set(!!t.untrusted),this.C.set(!!t.registered),this.L.trace(`[chat entitlement context] updateContext(): ${JSON.stringify(t)}`),gS(t,this.M,this.N),this.H.fire()}suspend(){this.G={...this.F},this.I=new ps}resume(){this.G=void 0,this.I?.open(),this.I=void 0}};wS=Ul=__decorate([__param(0,Gn),__param(1,_a),__param(2,Se),__param(3,gi),__param(4,qu)],wS),De(eT,mS,0);var Fs;(function(e){e.responseVote=new C("chatSessionResponseVote","",{type:"string",description:d(6430,null)}),e.responseDetectedAgentCommand=new C("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:d(6431,null)}),e.responseSupportsIssueReporting=new C("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:d(6432,null)}),e.responseIsFiltered=new C("chatSessionResponseFiltered",!1,{type:"boolean",description:d(6433,null)}),e.responseHasError=new C("chatSessionResponseError",!1,{type:"boolean",description:d(6434,null)}),e.requestInProgress=new C("chatSessionRequestInProgress",!1,{type:"boolean",description:d(6435,null)}),e.currentlyEditing=new C("chatSessionCurrentlyEditing",!1,{type:"boolean",description:d(6436,null)}),e.currentlyEditingInput=new C("chatSessionCurrentlyEditingInput",!1,{type:"boolean",description:d(6437,null)}),e.isResponse=new C("chatResponse",!1,{type:"boolean",description:d(6438,null)}),e.isRequest=new C("chatRequest",!1,{type:"boolean",description:d(6439,null)}),e.itemId=new C("chatItemId","",{type:"string",description:d(6440,null)}),e.lastItemId=new C("chatLastItemId",[],{type:"string",description:d(6441,null)}),e.editApplied=new C("chatEditApplied",!1,{type:"boolean",description:d(6442,null)}),e.inputHasText=new C("chatInputHasText",!1,{type:"boolean",description:d(6443,null)}),e.inputHasFocus=new C("chatInputHasFocus",!1,{type:"boolean",description:d(6444,null)}),e.inChatInput=new C("inChatInput",!1,{type:"boolean",description:d(6445,null)}),e.inChatSession=new C("inChat",!1,{type:"boolean",description:d(6446,null)}),e.inChatEditor=new C("inChatEditor",!1,{type:"boolean",description:d(6447,null)}),e.inChatTerminalToolOutput=new C("inChatTerminalToolOutput",!1,{type:"boolean",description:d(6448,null)}),e.chatModeKind=new C("chatAgentKind",Ts.Ask,{type:"string",description:d(6449,null)}),e.chatToolCount=new C("chatToolCount",0,{type:"number",description:d(6450,null)}),e.chatToolGroupingThreshold=new C("chat.toolGroupingThreshold",0,{type:"number",description:d(6451,null)}),e.supported=Mt.or(hQ.negate(),bQ.notEqualsTo(""),Mt.has("config.chat.experimental.serverlessWebEnabled")),e.enabled=new C("chatIsEnabled",!1,{type:"boolean",description:d(6452,null)}),e.lockedToCodingAgent=new C("lockedToCodingAgent",!1,{type:"boolean",description:d(6453,null)}),e.agentSupportsAttachments=new C("agentSupportsAttachments",!1,{type:"boolean",description:d(6454,null)}),e.withinEditSessionDiff=new C("withinEditSessionDiff",!1,{type:"boolean",description:d(6455,null)}),e.filePartOfEditSession=new C("filePartOfEditSession",!1,{type:"boolean",description:d(6456,null)}),e.extensionParticipantRegistered=new C("chatPanelExtensionParticipantRegistered",!1,{type:"boolean",description:d(6457,null)}),e.panelParticipantRegistered=new C("chatPanelParticipantRegistered",!1,{type:"boolean",description:d(6458,null)}),e.chatEditingCanUndo=new C("chatEditingCanUndo",!1,{type:"boolean",description:d(6459,null)}),e.chatEditingCanRedo=new C("chatEditingCanRedo",!1,{type:"boolean",description:d(6460,null)}),e.languageModelsAreUserSelectable=new C("chatModelsAreUserSelectable",!1,{type:"boolean",description:d(6461,null)}),e.chatSessionHasModels=new C("chatSessionHasModels",!1,{type:"boolean",description:d(6462,null)}),e.extensionInvalid=new C("chatExtensionInvalid",!1,{type:"boolean",description:d(6463,null)}),e.inputCursorAtTop=new C("chatCursorAtTop",!1),e.inputHasAgent=new C("chatInputHasAgent",!1),e.location=new C("chatLocation",void 0),e.inQuickChat=new C("quickChatHasFocus",!1,{type:"boolean",description:d(6464,null)}),e.hasFileAttachments=new C("chatHasFileAttachments",!1,{type:"boolean",description:d(6465,null)}),e.chatSessionIsEmpty=new C("chatSessionIsEmpty",!0,{type:"boolean",description:d(6466,null)}),e.remoteJobCreating=new C("chatRemoteJobCreating",!1,{type:"boolean",description:d(6467,null)}),e.hasRemoteCodingAgent=new C("hasRemoteCodingAgent",!1,d(6468,null)),e.hasCanDelegateProviders=new C("chatHasCanDelegateProviders",!1,{type:"boolean",description:d(6469,null)}),e.enableRemoteCodingAgentPromptFileOverlay=new C("enableRemoteCodingAgentPromptFileOverlay",!1,d(6470,null)),e.skipChatRequestInProgressMessage=new C("chatSkipRequestInProgressMessage",!1,{type:"boolean",description:d(6471,null)}),e.Setup=ye.Setup,e.Entitlement=ye.Entitlement,e.chatQuotaExceeded=ye.chatQuotaExceeded,e.completionsQuotaExceeded=ye.completionsQuotaExceeded,e.Editing={hasToolConfirmation:new C("chatHasToolConfirmation",!1,{type:"boolean",description:d(6472,null)}),hasElicitationRequest:new C("chatHasElicitationRequest",!1,{type:"boolean",description:d(6473,null)})},e.Tools={toolsCount:new C("toolsCount",0,{type:"number",description:d(6474,null)})},e.Modes={hasCustomChatModes:new C("chatHasCustomAgents",!1,{type:"boolean",description:d(6475,null)}),agentModeDisabledByPolicy:new C("chatAgentModeDisabledByPolicy",!1,{type:"boolean",description:d(6476,null)})},e.panelLocation=new C("chatPanelLocation",void 0,{type:"number",description:d(6477,null)}),e.agentSessionsViewerFocused=new C("agentSessionsViewerFocused",!0,{type:"boolean",description:d(6478,null)}),e.agentSessionsViewerLimited=new C("agentSessionsViewerLimited",void 0,{type:"boolean",description:d(6479,null)}),e.agentSessionsViewerOrientation=new C("agentSessionsViewerOrientation",void 0,{type:"number",description:d(6480,null)}),e.agentSessionsViewerPosition=new C("agentSessionsViewerPosition",void 0,{type:"number",description:d(6481,null)}),e.agentSessionsViewerVisible=new C("agentSessionsViewerVisible",void 0,{type:"boolean",description:d(6482,null)}),e.agentSessionType=new C("chatSessionType","",{type:"string",description:d(6483,null)}),e.agentSessionSection=new C("agentSessionSection","",{type:"string",description:d(6484,null)}),e.isArchivedAgentSession=new C("agentSessionIsArchived",!1,{type:"boolean",description:d(6485,null)}),e.isReadAgentSession=new C("agentSessionIsRead",!1,{type:"boolean",description:d(6486,null)}),e.hasAgentSessionChanges=new C("agentSessionHasChanges",!1,{type:"boolean",description:d(6487,null)}),e.isKatexMathElement=new C("chatIsKatexMathElement",!1,{type:"boolean",description:d(6488,null)})})(Fs||(Fs={}));var iT;(function(e){e.inEditingMode=Mt.or(Fs.chatModeKind.isEqualTo(Ts.Edit),Fs.chatModeKind.isEqualTo(Ts.Agent)),e.chatSetupTriggerContext=Mt.or(Fs.Setup.installed.negate(),Fs.Entitlement.canSignUp)})(iT||(iT={}));var Sd,sT=H("chatAgentService"),rT=class extends Z{static{this.AGENT_LEADER="@"}constructor(t,i){super(),this.r=t,this.s=i,this.b=new Map,this.f=new I,this.onDidChangeAgents=this.f.event,this.g=new Set,this.n=!1,this.q=new Map,this.w=new Map,this.h=Fs.enabled.bindTo(this.r),this.j=Fs.extensionParticipantRegistered.bindTo(this.r),this.m=Fs.panelParticipantRegistered.bindTo(this.r),this.D(t.onDidChangeContext(s=>{s.affectsSome(this.g)&&this.u()}))}registerAgent(t,i){if(this.getAgent(t))throw new Error(`Agent already registered: ${JSON.stringify(t)}`);const r=this,n=i.slashCommands;i={...i,get slashCommands(){return n.filter(a=>!a.when||r.r.contextMatchesRules(Mt.deserialize(a.when)))}};const o={data:i};return this.b.set(t,o),this.t(),this.u(),this.f.fire(void 0),te(()=>{this.b.delete(t),this.t(),this.u(),this.f.fire(void 0)})}t(){this.g.clear();for(const t of this.b.values())if(t.data.when){const i=Mt.deserialize(t.data.when);for(const s of i?.keys()||[])this.g.add(s)}}u(){let t=!1,i=!1,s=!1;for(const r of this.getAgents())r.isDefault&&(r.isCore||(t=!0),r.id==="chat.setup"||r.id==="github.copilot.editsAgent"?s=!0:i=!0);this.m.set(i),this.j.set(t),s!==this.n&&(this.n=s,this.f.fire(this.getDefaultAgent(ui.Chat,Ts.Agent)))}registerAgentImplementation(t,i){const s=this.b.get(t);if(!s)throw new Error(`Unknown agent: ${JSON.stringify(t)}`);if(s.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(t)}`);return s.data.isDefault&&this.h.set(!0),s.impl=i,this.f.fire(new I1(s.data,i)),te(()=>{s.impl=void 0,this.f.fire(void 0),s.data.isDefault&&this.h.set(Bt.some(this.b.values(),r=>r.data.isDefault))})}registerDynamicAgent(t,i){t.isDynamic=!0;const s={data:t,impl:i};return this.b.set(t.id,s),this.f.fire(new I1(t,i)),te(()=>{this.b.delete(t.id),this.f.fire(void 0)})}registerAgentCompletionProvider(t,i){return this.w.set(t,i),{dispose:()=>{this.w.delete(t)}}}async getAgentCompletionItems(t,i,s){return await this.w.get(t)?.(i,s)??[]}updateAgent(t,i){const s=this.b.get(t);if(!s?.impl)throw new Error(`No activated agent with id ${JSON.stringify(t)} registered`);s.data.metadata={...s.data.metadata,...i},this.f.fire(new I1(s.data,s.impl))}getDefaultAgent(t,i=Ts.Ask){return this.y(this.getActivatedAgents().filter(s=>i&&!s.modes.includes(i)?!1:!!s.isDefault&&s.locations.includes(t)))}get hasToolsAgent(){return!!this.s.getValue(to.AgentEnabled)}getContributedDefaultAgent(t){return this.y(this.getAgents().filter(i=>!!i.isDefault&&i.locations.includes(t)))}y(t){return JL(t,i=>!i.isCore)??t.at(-1)}getAgent(t,i=!1){if(!(!this.z(t)&&!i))return this.b.get(t)?.data}z(t){const i=typeof t=="string"?this.b.get(t):t;return!i?.data.when||this.r.contextMatchesRules(Mt.deserialize(i.data.when))}getAgentByFullyQualifiedId(t){const i=Bt.find(this.b.values(),s=>xQ(s.data)===t)?.data;if(!(i&&!this.z(i.id)))return i}getAgents(){return Array.from(this.b.values()).map(t=>t.data).filter(t=>this.z(t.id))}getActivatedAgents(){return Array.from(this.b.values()).filter(t=>!!t.impl).filter(t=>this.z(t.data.id)).map(t=>new I1(t.data,t.impl))}getAgentsByName(t){return this.C(this.getAgents().filter(i=>i.name===t))}C(t){const i=t.filter(s=>!s.isCore);return i.length>0?i:t}agentHasDupeName(t){const i=this.getAgent(t);return i?this.getAgentsByName(i.name).filter(s=>s.extensionId.value!==i.extensionId.value).length>0:!1}async invokeAgent(t,i,s,r,n){const o=this.b.get(t);if(!o?.impl)throw new Error(`No activated agent with id "${t}"`);return await o.impl.invoke(i,s,r,n)}setRequestTools(t,i,s){const r=this.b.get(t);if(!r?.impl)throw new Error(`No activated agent with id "${t}"`);r.impl.setRequestTools?.(i,s)}async getFollowups(t,i,s,r,n){const o=this.b.get(t);return o?.impl?.provideFollowups?o.impl.provideFollowups(i,s,r,n):[]}async getChatTitle(t,i,s){const r=this.b.get(t);if(r?.impl?.provideChatTitle)return r.impl.provideChatTitle(i,s)}async getChatSummary(t,i,s){const r=this.b.get(t);if(r?.impl?.provideChatSummary)return r.impl.provideChatSummary(i,s)}registerChatParticipantDetectionProvider(t,i){return this.q.set(t,i),te(()=>{this.q.delete(t)})}hasChatParticipantDetectionProviders(){return this.q.size>0}async detectAgentOrCommand(t,i,s,r){const n=Bt.first(this.q.values());if(!n)return;const o=this.getAgents().reduce((u,h)=>{if(h.locations.includes(s.location)){u.push({participant:h.id,disambiguation:h.disambiguation??[]});for(const f of h.slashCommands)u.push({participant:h.id,command:f.name,disambiguation:f.disambiguation??[]})}return u},[]),a=await n.provideParticipantDetection(t,i,{...s,participants:o},r);if(!a)return;const c=this.getAgent(a.participant);if(!c)return;if(!a.command)return{agent:c};const l=c?.slashCommands.find(u=>u.name===a.command);if(l)return{agent:c,command:l}}};rT=__decorate([__param(0,Gn),__param(1,gi)],rT);var I1=class{constructor(e,t){this.b=e,this.d=t}get id(){return this.b.id}get name(){return this.b.name??""}get fullName(){return this.b.fullName??""}get description(){return this.b.description??""}get extensionId(){return this.b.extensionId}get extensionVersion(){return this.b.extensionVersion}get extensionPublisherId(){return this.b.extensionPublisherId}get extensionPublisherDisplayName(){return this.b.publisherDisplayName}get extensionDisplayName(){return this.b.extensionDisplayName}get isDefault(){return this.b.isDefault}get isCore(){return this.b.isCore}get metadata(){return this.b.metadata}get slashCommands(){return this.b.slashCommands}get locations(){return this.b.locations}get modes(){return this.b.modes}get disambiguation(){return this.b.disambiguation}async invoke(e,t,i,s){return this.d.invoke(e,t,i,s)}setRequestTools(e,t){this.d.setRequestTools?.(e,t)}async provideFollowups(e,t,i,s){return this.d.provideFollowups?this.d.provideFollowups(e,t,i,s):[]}toJSON(){return this.b}},kle=H("chatAgentNameService"),nT=class{static{Sd=this}static{this.b="chat.participantNameRegistry"}constructor(t,i,s,r){if(this.h=i,this.i=s,this.j=r,this.f=ss(this,Object.create(null)),this.g=!1,!t.chatParticipantRegistry)return;this.d=t.chatParticipantRegistry;const n=r.get(Sd.b,-1);try{this.f.set(JSON.parse(n??"{}"),void 0)}catch{r.remove(Sd.b,-1)}this.k()}k(){this.g||this.l().catch(t=>this.i.warn("Failed to fetch chat participant registry",t)).then(()=>ri(5*60*1e3)).then(()=>this.k())}async l(){const t=await this.h.request({type:"GET",url:this.d},Fe.None);if(t.res.statusCode!==200)throw new Error("Could not get extensions report.");const i=await lQ(t);if(!i||i.version!==1)throw new Error("Unexpected chat participant registry response.");const s=i.restrictedChatParticipants;this.f.set(s,void 0),this.j.store(Sd.b,JSON.stringify(s),-1,1)}getAgentNameRestriction(t){if(t.isCore)return!0;const i=this.m(t.name,t).get(),s=!t.fullName||this.m(t.fullName.replace(/\s/g,""),t).get();return i&&s}m(t,i){return this.f.map(r=>r[t.toLowerCase()]).map(r=>r?r.some(n=>$s(n,n.includes(".")?i.extensionId.value:i.extensionPublisherId)):!0)}dispose(){this.g=!0}};nT=Sd=__decorate([__param(0,sd),__param(1,k3),__param(2,Se),__param(3,_a)],nT);function xQ(e){return`${e.extensionId.value}.${e.id}`}var oT=H("IPromptsService"),jr;(function(e){e.local="local",e.user="user",e.extension="extension"})(jr||(jr={}));var bS;(function(e){e.contribution="contribution",e.provider="provider"})(bS||(bS={}));var D1,CQ=H("chatModeService"),aT=class extends Z{static{D1=this}static{this.a="chat.customModes"}constructor(t,i,s,r,n,o){super(),this.h=t,this.j=i,this.m=r,this.n=n,this.q=o,this.f=new Map,this.g=new I,this.onDidChangeChatModes=this.g.event,this.b=Fs.Modes.hasCustomChatModes.bindTo(s),this.c=Fs.Modes.agentModeDisabledByPolicy.bindTo(s),this.z(),this.r(),this.u(!0),this.D(this.h.onDidChangeCustomAgents(()=>{this.u(!0)})),this.D(this.n.onWillSaveState(()=>this.t())),this.D(this.q.onDidChangeConfiguration(c=>{c.affectsConfiguration(to.AgentEnabled)&&(this.z(),this.g.fire())}));let a=this.j.hasToolsAgent;this.D(this.j.onDidChangeAgents(()=>{a!==this.j.hasToolsAgent&&(a=this.j.hasToolsAgent,this.g.fire())}))}r(){try{const t=this.n.getObject(D1.a,1);t&&this.s(t)}catch(t){this.m.error(t,"Failed to load cached custom agents")}}s(t){if(!Array.isArray(t)){this.m.error("Invalid cached custom modes data: expected array");return}for(const i of t)if(kQ(i)&&i.uri)try{const s=y.revive(i.uri),r={uri:s,name:i.name,description:i.description,tools:i.customTools,model:i.model,argumentHint:i.argumentHint,agentInstructions:i.modeInstructions??{content:i.body??"",toolReferences:[]},handOffs:i.handOffs,target:i.target,infer:i.infer,source:DQ(i.source)??{storage:jr.local}},n=new cT(r);this.f.set(s.toString(),n)}catch(s){this.m.error(s,"Failed to revive cached custom agent")}this.b.set(this.f.size>0)}t(){try{const t=Array.from(this.f.values());this.n.store(D1.a,t,1,1)}catch(t){this.m.warn("Failed to save cached custom agents",t)}}async u(t){try{const i=await this.h.getCustomAgents(Fe.None),s=new Set;for(const r of i){const n=r.uri.toString();s.add(n);let o=this.f.get(n);o?o.updateData(r):(o=new cT(r),this.f.set(n,o))}for(const[r]of this.f.entries())s.has(r)||this.f.delete(r);this.b.set(this.f.size>0)}catch(i){this.m.error(i,"Failed to load custom agents"),this.f.clear(),this.b.set(!1)}t&&this.g.fire()}getModes(){return{builtin:this.w(),custom:this.y()}}findModeById(t){return this.w().find(i=>i.id===t)??this.f.get(t)}findModeByName(t){return this.w().find(i=>i.name.get()===t)??this.y().find(i=>i.name.get()===t)}w(){const t=[Io.Ask];return(this.j.hasToolsAgent||this.C())&&t.unshift(Io.Agent),t.push(Io.Edit),t}y(){return this.j.hasToolsAgent||this.C()?Array.from(this.f.values()):[]}z(){this.c.set(this.C())}C(){return this.q.inspect(to.AgentEnabled).policyValue===!1}};aT=D1=__decorate([__param(0,oT),__param(1,sT),__param(2,Gn),__param(3,Se),__param(4,_a),__param(5,gi)],aT);function kQ(e){if(typeof e!="object"||e===null)return!1;const t=e;return typeof t.id=="string"&&typeof t.name=="string"&&typeof t.kind=="string"&&(t.description===void 0||typeof t.description=="string")&&(t.customTools===void 0||Array.isArray(t.customTools))&&(t.modeInstructions===void 0||typeof t.modeInstructions=="object"&&t.modeInstructions!==null)&&(t.model===void 0||typeof t.model=="string")&&(t.argumentHint===void 0||typeof t.argumentHint=="string")&&(t.handOffs===void 0||Array.isArray(t.handOffs))&&(t.uri===void 0||typeof t.uri=="object"&&t.uri!==null)&&(t.source===void 0||$Q(t.source))&&(t.target===void 0||typeof t.target=="string")&&(t.infer===void 0||typeof t.infer=="boolean")}var cT=class{get name(){return this.a}get description(){return this.b}get isBuiltin(){return lT(this)}get customTools(){return this.c}get model(){return this.g}get argumentHint(){return this.h}get modeInstructions(){return this.d}get uri(){return this.f}get label(){return this.name}get handOffs(){return this.i}get source(){return this.l}get target(){return this.j}get infer(){return this.k}constructor(e){this.kind=Ts.Agent,this.id=e.uri.toString(),this.a=ss("name",e.name),this.b=ss("description",e.description),this.c=ss("customTools",e.tools),this.g=ss("model",e.model),this.h=ss("argumentHint",e.argumentHint),this.i=ss("handOffs",e.handOffs),this.j=ss("target",e.target),this.k=ss("infer",e.infer),this.d=ss("_modeInstructions",e.agentInstructions),this.f=ss("uri",e.uri),this.l=e.source}updateData(e){mw(t=>{this.a.set(e.name,t),this.b.set(e.description,t),this.c.set(e.tools,t),this.g.set(e.model,t),this.h.set(e.argumentHint,t),this.i.set(e.handOffs,t),this.j.set(e.target,t),this.k.set(e.infer,t),this.d.set(e.agentInstructions,t),this.f.set(e.uri,t),this.l=e.source})}toJSON(){return{id:this.id,name:this.name.get(),description:this.description.get(),kind:this.kind,customTools:this.customTools.get(),model:this.model.get(),argumentHint:this.argumentHint.get(),modeInstructions:this.modeInstructions.get(),uri:this.uri.get(),handOffs:this.handOffs.get(),source:IQ(this.l),target:this.target.get(),infer:this.infer.get()}}};function $Q(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.storage===jr.extension?typeof t.extensionId=="string":t.storage===jr.local||t.storage===jr.user}function IQ(e){if(e)return e.storage===jr.extension?{storage:jr.extension,extensionId:e.extensionId.value,type:e.type}:{storage:e.storage}}function DQ(e){if(e)return e.storage===jr.extension?{storage:jr.extension,extensionId:new Ye(e.extensionId),type:e.type??bS.contribution}:{storage:e.storage}}var yS=class{constructor(e,t,i){this.kind=e,this.name=pI(e),this.label=pI(t),this.description=ss("description",i)}get isBuiltin(){return lT(this)}get id(){return this.kind}get target(){return ss("target",void 0)}toJSON(){return{id:this.id,name:this.name.get(),description:this.description.get(),kind:this.kind}}},Io;(function(e){e.Ask=new yS(Ts.Ask,"Ask",d(6497,null)),e.Edit=new yS(Ts.Edit,"Edit",d(6498,null)),e.Agent=new yS(Ts.Agent,"Agent",d(6499,null))})(Io||(Io={}));function lT(e){return e.id===Io.Ask.id||e.id===Io.Edit.id||e.id===Io.Agent.id}var uT;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.Assistant=2]="Assistant"})(uT||(uT={}));var hT;(function(e){e[e.Assistant=0]="Assistant",e[e.User=1]="User",e[e.Extension=2]="Extension"})(hT||(hT={}));var dT;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(dT||(dT={}));var fT;(function(e){e.Low="low",e.High="high"})(fT||(fT={}));var AS;(function(e){function t(r){return(typeof r.capabilities?.agentMode>"u"||r.capabilities.agentMode)&&!!r.capabilities?.toolCalling}e.suitableForAgentMode=t;function i(r){return`${r.name} (${r.vendor})`}e.asQualifiedName=i;function s(r,n){return n.vendor==="copilot"&&r===n.name?!0:r===i(n)}e.matchesQualifiedName=s})(AS||(AS={}));var PQ=H("ILanguageModelsService"),pT={type:"object",required:["vendor","displayName"],properties:{vendor:{type:"string",description:d(6523,null)},displayName:{type:"string",description:d(6524,null)},managementCommand:{type:"string",description:d(6525,null)},when:{type:"string",description:d(6526,null)}}},TQ=j9.registerExtensionPoint({extensionPoint:"languageModelChatProviders",jsonSchema:{description:d(6527,null),oneOf:[pT,{type:"array",items:pT}]},activationEventsGenerator:function*(e){for(const t of e)yield`onLanguageModelChatProvider:${t.vendor}`}}),gT=class{constructor(t,i,s,r,n,o){this.j=t,this.k=i,this.l=s,this.n=n,this.o=o,this.a=new ie,this.b=new Map,this.c=new Map,this.d=new Map,this.e=new vx,this.f={},this.i=this.a.add(new I),this.onDidChangeLanguageModels=this.i.event,this.g=Fs.languageModelsAreUserSelectable.bindTo(r),this.h=r,this.f=this.l.getObject("chatModelPickerPreferences",0,this.f);const a=()=>{(this.o.entitlement===Te.Business||this.o.entitlement===Te.Enterprise)&&!this.o.isInternal&&(this.f={},this.l.store("chatModelPickerPreferences",this.f,0,0))};a(),this.a.add(this.o.onDidChangeEntitlement(a)),this.a.add(this.onDidChangeLanguageModels(()=>{this.g.set(this.c.size>0&&Array.from(this.c.values()).some(c=>c.isUserSelectable))})),this.a.add(TQ.setHandler(c=>{this.d.clear();for(const l of c)for(const u of Bt.wrap(l.value)){if(this.d.has(u.vendor)){l.collector.error(d(6528,null,u.vendor));continue}if(fu(u.vendor)){l.collector.error(d(6529,null));continue}if(u.vendor.trim()!==u.vendor){l.collector.error(d(6530,null));continue}this.d.set(u.vendor,u),this.p(u.vendor)&&this.j.activateByEvent(`onLanguageModelChatProvider:${u.vendor}`)}for(const[l,u]of this.b)this.d.has(l)||this.b.delete(l)}))}p(t){return Object.keys(this.f).some(i=>i.startsWith(t))}dispose(){this.a.dispose(),this.b.clear()}updateModelPickerPreference(t,i){const s=this.c.get(t);if(!s){this.k.warn(`[LM] Cannot update model picker preference for unknown model ${t}`);return}this.f[t]=i,i===s.isUserSelectable?(delete this.f[t],this.l.store("chatModelPickerPreferences",this.f,0,0)):s.isUserSelectable!==i&&this.l.store("chatModelPickerPreferences",this.f,0,0),this.i.fire(s.vendor),this.k.trace(`[LM] Updated model picker preference for ${t} to ${i}`)}getVendors(){return Array.from(this.d.values()).filter(t=>{if(!t.when)return!0;const i=Mt.deserialize(t.when);return i?this.h.contextMatchesRules(i):!1})}getLanguageModelIds(){return Array.from(this.c.keys())}lookupLanguageModel(t){const i=this.c.get(t);return i&&this.n.getValue("chat.experimentalShowAllModels")?{...i,isUserSelectable:!0}:i&&this.f[t]!==void 0?{...i,isUserSelectable:this.f[t]}:i}q(t){for(const[i,s]of this.c.entries())s.vendor===t&&this.c.delete(i)}async r(t,i){await this.j.activateByEvent(`onLanguageModelChatProvider:${t}`);const s=this.b.get(t);if(!s){this.k.warn(`[LM] No provider registered for vendor ${t}`);return}return this.e.queue(t,async()=>{try{let r=await s.provideLanguageModelChatInfo({silent:i},Fe.None);!i&&r.some(n=>n.metadata.isUserSelectable)&&(r=r.filter(n=>n.metadata.isUserSelectable||this.f[n.identifier]===!0)),this.q(t);for(const n of r){if(this.c.has(n.identifier)){this.k.warn(`[LM] Model ${n.identifier} is already registered. Skipping.`);continue}this.c.set(n.identifier,n.metadata)}this.k.trace(`[LM] Resolved language models for vendor ${t}`,r)}catch(r){this.k.error(`[LM] Error resolving language models for vendor ${t}:`,r)}this.i.fire(t)})}async selectLanguageModels(t,i){if(t.vendor)await this.r(t.vendor,!i);else{const r=Array.from(this.d.keys());await Promise.all(r.map(n=>this.r(n,!i)))}const s=[];for(const[r,n]of this.c)(t.vendor===void 0||n.vendor===t.vendor)&&(t.family===void 0||n.family===t.family)&&(t.version===void 0||n.version===t.version)&&(t.id===void 0||n.id===t.id)&&s.push(r);return this.k.trace("[LM] selected language models",t,s),s}registerLanguageModelProvider(t,i){if(this.k.trace("[LM] registering language model provider",t,i),!this.d.has(t))throw new Error(`Chat model provider uses UNKNOWN vendor ${t}.`);if(this.b.has(t))throw new Error(`Chat model provider for vendor ${t} is already registered.`);this.b.set(t,i),this.p(t)&&this.r(t,!0);const s=i.onDidChange(async()=>{await this.r(t,!0)});return te(()=>{this.k.trace("[LM] UNregistered language model provider",t),this.q(t),this.b.delete(t),s.dispose()})}async sendChatRequest(t,i,s,r,n){const o=this.b.get(this.c.get(t)?.vendor||"");if(!o)throw new Error(`Chat provider for model ${t} is not registered.`);return o.sendChatRequest(t,s,i,r,n)}computeTokenLength(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Chat model ${t} could not be found.`);const n=this.b.get(r.vendor);if(!n)throw new Error(`Chat provider for model ${t} is not registered.`);return n.provideTokenCount(t,i,s)}};gT=__decorate([__param(0,K6),__param(1,Se),__param(2,_a),__param(3,Gn),__param(4,gi),__param(5,eT)],gT);var NQ=H("labelService"),mT;(function(e){e[e.SHORT=0]="SHORT",e[e.MEDIUM=1]="MEDIUM",e[e.LONG=2]="LONG"})(mT||(mT={}));var bs;(function(e){e.instructions="instructions",e.prompt="prompt",e.agent="agent"})(bs||(bs={}));var MQ=".prompt.md",LQ=".instructions.md",RQ=".chatmode.md",OQ=".agent.md",FQ="copilot-instructions.md",UQ=".github/prompts",jQ=".github/instructions",SS=".github/agents";function zQ(e){const t=$i(e.path);return t.endsWith("/"+SS)||t===SS}function HQ(e){const t=vt(e.path);if(t.endsWith(MQ))return bs.prompt;if(t.endsWith(LQ)||t===FQ)return bs.instructions;if(t.endsWith(RQ)||t.endsWith(OQ)||t.endsWith(".md")&&zQ(e))return bs.agent}function vT(e){return HQ(e)!==void 0}function WQ(e){switch(e){case bs.instructions:return jQ;case bs.prompt:return UQ;case bs.agent:return SS;default:throw new Error("Unknown prompt type")}}var zr;(function(e){e.PROMPT_LOCATIONS_KEY="chat.promptFilesLocations",e.INSTRUCTIONS_LOCATION_KEY="chat.instructionsFilesLocations",e.MODE_LOCATION_KEY="chat.modeFilesLocations",e.PROMPT_FILES_SUGGEST_KEY="chat.promptFilesRecommendations",e.USE_COPILOT_INSTRUCTION_FILES="github.copilot.chat.codeGeneration.useInstructionFiles",e.USE_AGENT_MD="chat.useAgentsMdFile",e.USE_NESTED_AGENT_MD="chat.useNestedAgentsMdFiles",e.USE_AGENT_SKILLS="chat.useAgentSkills";function t(r,n){const o=BQ(n),a=r.getValue(o);if(!(a==null||Array.isArray(a))&&typeof a=="object"){const c={};for(const[l,u]of Object.entries(a)){const h=l.trim(),f=wT(u);f!==void 0&&h&&(c[h]=f)}return c}}e.getLocationsValue=t;function i(r,n){const o=t(r,n),a=WQ(n);if(o&&typeof o=="object"){const c=[];o[a]!==!1&&c.push(a);for(const[l,u]of Object.entries(o))u===!1||l===a||c.push(l);return c}return[]}e.promptSourceFolders=i;function s(r,n){const o=r.getValue(e.PROMPT_FILES_SUGGEST_KEY,{resource:n});if(!o||typeof o!="object"||Array.isArray(o))return;const a={};for(const[c,l]of Object.entries(o)){const u=c.trim();if(!u)continue;if(typeof l=="boolean"){a[u]=l;continue}if(typeof l=="string"){const f=l.trim();f&&(a[u]=f);continue}const h=wT(l);h!==void 0&&(a[u]=h)}return Object.keys(a).length>0?a:void 0}e.getPromptFilesRecommendationsValue=s})(zr||(zr={}));function BQ(e){switch(e){case bs.instructions:return zr.INSTRUCTIONS_LOCATION_KEY;case bs.prompt:return zr.PROMPT_LOCATIONS_KEY;case bs.agent:return zr.MODE_LOCATION_KEY;default:throw new Error("Unknown prompt type")}}function wT(e){if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();return t==="true"?!0:t==="false"?!1:void 0}}var _Q=class us{static fromTo(t,i){return new us(t,i)}static addRange(t,i){let s=0;for(;s<i.length&&i[s].endExclusive<t.start;)s++;let r=s;for(;r<i.length&&i[r].start<=t.endExclusive;)r++;if(s===r)i.splice(s,0,t);else{const n=Math.min(t.start,i[s].start),o=Math.max(t.endExclusive,i[r-1].endExclusive);i.splice(s,r-s,new us(n,o))}}static tryCreate(t,i){if(!(t>i))return new us(t,i)}static ofLength(t){return new us(0,t)}static ofStartAndLength(t,i){return new us(t,t+i)}static emptyAt(t){return new us(t,t)}constructor(t,i){if(this.start=t,this.endExclusive=i,t>i)throw new qt(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(t){return new us(this.start+t,this.endExclusive+t)}deltaStart(t){return new us(this.start+t,this.endExclusive)}deltaEnd(t){return new us(this.start,this.endExclusive+t)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(t){return this.start===t.start&&this.endExclusive===t.endExclusive}containsRange(t){return this.start<=t.start&&t.endExclusive<=this.endExclusive}contains(t){return this.start<=t&&t<this.endExclusive}join(t){return new us(Math.min(this.start,t.start),Math.max(this.endExclusive,t.endExclusive))}intersect(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);if(i<=s)return new us(i,s)}intersectionLength(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);return Math.max(0,s-i)}intersects(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);return i<s}intersectsOrTouches(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);return i<=s}isBefore(t){return this.endExclusive<=t.start}isAfter(t){return this.start>=t.endExclusive}slice(t){return t.slice(this.start,this.endExclusive)}substring(t){return t.substring(this.start,this.endExclusive)}clip(t){if(this.isEmpty)throw new qt(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,t))}clipCyclic(t){if(this.isEmpty)throw new qt(`Invalid clipping range: ${this.toString()}`);return t<this.start?this.endExclusive-(this.start-t)%this.length:t>=this.endExclusive?this.start+(t-this.start)%this.length:t}map(t){const i=[];for(let s=this.start;s<this.endExclusive;s++)i.push(t(s));return i}forEach(t){for(let i=this.start;i<this.endExclusive;i++)t(i)}joinRightTouching(t){if(this.endExclusive!==t.start)throw new qt(`Invalid join: ${this.toString()} and ${t.toString()}`);return new us(this.start,t.endExclusive)}withMargin(t,i){return i===void 0&&(i=t),new us(this.start-t,this.endExclusive+i)}};function VQ(){return{applyingInstructionsCount:0,referencedInstructionsCount:0,agentInstructionsCount:0,listedInstructionsCount:0,totalInstructionsCount:0}}var ES=class{constructor(t,i,s,r,n,o,a,c,l){this.b=t,this.c=i,this._logService=s,this.d=r,this.e=n,this.f=o,this.g=a,this.h=c,this.j=l,this.a=new kt}async k(t,i){if(this.a.has(t))return this.a.get(t);try{const s=await this.c.parseNew(t,i);return this.a.set(t,s),s}catch(s){this._logService.error(`[InstructionsContextComputer] Failed to parse instruction file: ${t}`,s);return}}async collect(t,i){const s=await this.c.listPromptFiles(bs.instructions,i);this._logService.trace(`[InstructionsContextComputer] ${s.length} instruction files available.`);const r=VQ(),n=this.m(t);await this.addApplyingInstructions(s,n,t,r,i),await this.r(t,r,i),await this.n(t,r,i);const o=await this.q(s,t,i);o&&(t.add(o),r.listedInstructionsCount++),this.l(r)}l(t){t.totalInstructionsCount=t.agentInstructionsCount+t.referencedInstructionsCount+t.applyingInstructionsCount+t.listedInstructionsCount,this.h.publicLog2("instructionsCollected",t)}async addApplyingInstructions(t,i,s,r,n){for(const{uri:o}of t){const a=await this.k(o,n);if(!a){this._logService.trace(`[InstructionsContextComputer] Unable to read: ${o}`);continue}const c=a.header?.applyTo;if(!c){this._logService.trace(`[InstructionsContextComputer] No 'applyTo' found: ${o}`);continue}if(i.instructions.has(o)){this._logService.trace(`[InstructionsContextComputer] Skipping already processed instruction file: ${o}`);continue}const l=this.o(i.files,c);if(l){this._logService.trace(`[InstructionsContextComputer] Match for ${o} with ${l.pattern}${l.file?` for file ${l.file}`:""}`);const u=l.file?d(6548,null,c,this.d.getUriLabel(l.file,{relative:!0})):d(6547,null);s.add(qf(o,eo.Instruction,u,!0)),r.applyingInstructionsCount++}else this._logService.trace(`[InstructionsContextComputer] No match for ${o} with ${c}`)}}m(t){const i=new ou,s=new ou;for(const r of t.asArray())if(hw(r))s.add(r.value);else{const n=uw.toUri(r);n&&i.add(n)}return{files:i,instructions:s}}async n(t,i,s){const r=this.e.getValue(zr.USE_COPILOT_INSTRUCTION_FILES),n=this.e.getValue(zr.USE_AGENT_MD);if(!r&&!n){this._logService.trace("[InstructionsContextComputer] No agent instructions files added (settings disabled).");return}const o=new Y$;if(r){const a=await this.c.listCopilotInstructionsMDs(s);for(const c of a)o.add(qf(c,eo.Instruction,d(6549,null,zr.USE_COPILOT_INSTRUCTION_FILES),!0)),i.agentInstructionsCount++,this._logService.trace(`[InstructionsContextComputer] copilot-instruction.md files added: ${c.toString()}`);await this.r(o,i,s)}if(n){const a=await this.c.listAgentMDs(s,!1);for(const c of a)o.add(qf(c,eo.Instruction,d(6550,null,zr.USE_AGENT_MD),!0)),i.agentInstructionsCount++,this._logService.trace(`[InstructionsContextComputer] AGENTS.md files added: ${c.toString()}`)}for(const a of o.asArray())t.add(a)}o(t,i){const s=Dc(i,","),r=n=>{if(n=n.trim(),n.length!==0){if(n==="**"||n==="**/*"||n==="*")return{pattern:n};!n.startsWith("/")&&!n.startsWith("**/")&&(n="**/"+n);for(const o of t)if(ua(n,o.path,{ignoreCase:!0}))return{pattern:n,file:o}}};for(const n of s){const o=r(n);if(o)return o}}p(t){if(!this.b)return;const i=this.j.getToolByName(t);if(i&&this.b.get(i))return{tool:i,variable:`#tool:${this.j.getFullReferenceName(i)}`}}async q(t,i,s){const r=this.p("readFile"),n=this.p(Xf.runSubagent),o=[];if(r){const h=this.e.getValue(zr.USE_NESTED_AGENT_MD)?this.c.findAgentMDsInWorkspace(s):Promise.resolve([]);o.push("<instructions>"),o.push("Here is a list of instruction files that contain rules for modifying or creating new code."),o.push("These files are important for ensuring that the code is modified or created correctly."),o.push("Please make sure to follow the rules specified in these files when working with the codebase."),o.push(`If the file is not already available as attachment, use the ${r.variable} tool to acquire it.`),o.push("Make sure to acquire the instructions before making any changes to the code.");let f=!1;for(const{uri:v}of t){const b=await this.k(v,s);if(b){if(o.push("<instruction>"),b.header){const{description:S,applyTo:E}=b.header;S&&o.push(`<description>${S}</description>`),o.push(`<file>${P1(v)}</file>`),E&&o.push(`<applyTo>${E}</applyTo>`)}else o.push(`<file>${P1(v)}</file>`);o.push("</instruction>"),f=!0}}const p=await h;for(const v of p)if(v){const b=this.d.getUriLabel(dc(v),{relative:!0}),S=b.trim().length===0?d(6551,null):d(6552,null,b);o.push("<instruction>"),o.push(`<description>${S}</description>`),o.push(`<file>${P1(v)}</file>`),o.push("</instruction>"),f=!0}f?o.push("</instructions>","",""):o.length=0;const g=await this.c.findAgentSkills(s);if(g&&g.length>0){o.push("<skills>"),o.push("Here is a list of skills that contain domain specific knowledge on a variety of topics."),o.push("Each skill comes with a description of the topic and a file path that contains the detailed instructions."),o.push(`When a user asks you to perform a task that falls within the domain of a skill, use the ${r.variable} tool to acquire the full instructions from the file URI.`);for(const v of g)o.push("<skill>"),o.push(`<name>${v.name}</name>`),v.description&&o.push(`<description>${v.description}</description>`),o.push(`<file>${P1(v.uri)}</file>`),o.push("</skill>");o.push("</skills>","","")}}if(n&&this.e.getValue(to.SubagentToolCustomAgents)){const h=await this.c.getCustomAgents(s);if(h.length>0){o.push("<agents>"),o.push("Here is a list of agents that can be used when running a subagent."),o.push("Each agent has optionally a description with the agent's purpose and expertise. When asked to run a subagent, choose the most appropriate agent from this list."),o.push(`Use the ${n.variable} tool with the agent name to run the subagent.`);for(const f of h)f.infer!==!1&&(o.push("<agent>"),o.push(`<name>${f.name}</name>`),f.description&&o.push(`<description>${f.description}</description>`),f.argumentHint&&o.push(`<argumentHint>${f.argumentHint}</argumentHint>`),o.push("</agent>"));o.push("</agents>","","")}}if(o.length===0)return;const a=o.join(`
`),c=[],l=u=>{if(u){let h=a.indexOf(u.variable);for(;h>=0;)c.push(Gz(u.tool,new _Q(h,h+u.variable.length))),h=a.indexOf(u.variable,h+1)}};return l(r),l(n),qz(a,!0,c)}async r(t,i,s){const r=new ou,n=[];for(const a of t.asArray())hw(a)&&(r.has(a.value)||(n.push(a.value),r.add(a.value)));let o=n.pop();for(;o;){const a=await this.k(o,s);if(a&&a.body){const c=[];for(const l of a.body.fileReferences){const u=a.body.resolveFilePath(l.content);u&&!r.has(u)&&(vT(u)||this.f.getWorkspaceFolder(u)!==void 0)&&(c.push({resource:u}),r.add(u))}if(c.length>0){const l=await this.g.resolveAll(c);for(let u=0;u<l.length;u++){const h=l[u],f=c[u].resource;if(h.success&&h.stat?.isFile){vT(f)&&n.push(f);const p=d(6553,null,Li(o));t.add(qf(f,eo.InstructionReference,p,!0)),i.referencedInstructionsCount++,this._logService.trace(`[InstructionsContextComputer] ${f.toString()} added, referenced by ${o.toString()}`)}}}}o=n.pop()}}};ES=__decorate([__param(1,oT),__param(2,Se),__param(3,NQ),__param(4,gi),__param(5,$u),__param(6,nw),__param(7,qu),__param(8,Yf)],ES);function P1(e){return e.scheme===V.file||e.scheme===V.vscodeRemote?e.fsPath:e.toString()}function T1(e){return{content:[{kind:"text",value:e}]}}var bT="runSubagent",qQ=`Launch a new agent to handle complex, multi-step tasks autonomously. This tool is good at researching complex questions, searching for code, and executing multi-step tasks. When you are searching for a keyword or file and are not confident that you will find the right match in the first few tries, use this agent to perform the search for you.

- Agents do not run async or in the background, you will wait for the agent's result.
- When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.
- Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.
- The agent's outputs should generally be trusted
- Clearly tell the agent whether you expect it to write code or just to do research (search, file reads, web fetches, etc.), since it is not aware of the user's intent`,xS=class extends Z{constructor(t,i,s,r,n,o,a,c,l){super(),this.a=t,this.b=i,this.c=s,this.f=r,this.g=n,this.h=o,this.j=a,this.m=c,this.n=l,this.onDidUpdateToolData=Ie.filter(this.m.onDidChangeConfiguration,u=>u.affectsConfiguration(to.SubagentToolCustomAgents))}getToolData(){let t=qQ;const i={type:"object",properties:{prompt:{type:"string",description:"A detailed description of the task for the agent to perform"},description:{type:"string",description:"A short (3-5 word) description of the task"}},required:["prompt","description"]};return this.m.getValue(to.SubagentToolCustomAgents)&&(i.properties.agentName={type:"string",description:"Optional name of a specific agent to invoke. If not provided, uses the current agent."},t+=`
- If the user asks for a certain agent, you MUST provide that EXACT agent name (case-sensitive) to invoke that specific agent.`),{id:bT,toolReferenceName:Xf.runSubagent,icon:Dt.fromId(oe.organization.id),displayName:d(6681,null),userDescription:d(6682,null),modelDescription:t,source:er.Internal,inputSchema:i}}async invoke(t,i,s,r){const n=t.parameters;if(this.h.debug(`RunSubagentTool: Invoking with prompt: ${n.prompt.substring(0,100)}...`),!t.context)throw new Error("toolInvocationToken is required for this tool");const o=this.b.getSession(t.context.sessionResource);if(!o)throw new Error("Chat model not found for session");const a=o.getRequests().at(-1);try{const c=this.a.getDefaultAgent(ui.Chat,Ts.Agent);if(!c)return T1("Error: No default agent available");let l=t.modelId,u=t.userSelectedTools,h;if(n.agentName){const E=this.c.findModeByName(n.agentName);if(E){const k=E.model?.get();if(k){const Q=this.g.getLanguageModelIds();for(const F of Q){const B=this.g.lookupLanguageModel(F);if(B&&AS.matchesQualifiedName(k,B)){l=F;break}}}const j=E.customTools?.get();if(j){const Q=this.f.toToolAndToolSetEnablementMap(j,E.target?.get());u={};for(const[F,B]of Q)F instanceof jH||(u[F.id]=B)}const O=E.modeInstructions?.get();h=O&&{name:E.name.get(),content:O.content,toolReferences:this.j.toToolReferences(O.toolReferences),metadata:O.metadata}}else this.h.warn(`RunSubagentTool: Agent '${n.agentName}' not found, using current configuration`)}const f=[];let p=!1;const g=E=>{for(const k of E)k.kind==="prepareToolInvocation"||k.kind==="textEdit"||k.kind==="notebookEdit"||k.kind==="codeblockUri"?(k.kind==="codeblockUri"&&!p&&(p=!0,o.acceptResponseProgress(a,{kind:"markdownContent",content:new Qn("```\n"),fromSubagent:!0})),o.acceptResponseProgress(a,k),k.kind==="prepareToolInvocation"&&(f.length=0)):k.kind==="markdownContent"&&(p&&(o.acceptResponseProgress(a,{kind:"markdownContent",content:new Qn("\n```\n\n"),fromSubagent:!0}),p=!1),f.push(k.content.value))};u&&(u[bT]=!1,u[x3]=!1);const v=await this.q(u,r),b={sessionResource:t.context.sessionResource,requestId:t.callId??`subagent-${Date.now()}`,agentId:c.id,message:n.prompt,variables:{variables:v.asArray()},location:ui.Chat,isSubagent:!0,userSelectedModelId:l,userSelectedTools:u,modeInstructions:h},S=await this.a.invokeAgent(c.id,b,g,[],r);return S.errorDetails?T1(`Agent error: ${S.errorDetails.message}`):T1(f.join("")||"Agent completed with no output")}catch(c){const l=`Error invoking subagent: ${c instanceof Error?c.message:"Unknown error"}`;return this.h.error(l,c),T1(l)}}async prepareToolInvocation(t,i){return{invocationMessage:t.parameters.description}}async q(t,i){let s;if(t){const c=Object.entries(t).filter(([,l])=>l).map(([l])=>l).map(l=>this.f.getTool(l)).filter(l=>!!l).map(l=>this.f.getFullReferenceName(l));c.length>0&&(s=this.f.toToolAndToolSetEnablementMap(c,void 0))}const r=new Y$;return await this.n.createInstance(ES,s).collect(r,i),r}};xS=__decorate([__param(0,sT),__param(1,OP),__param(2,CQ),__param(3,Yf),__param(4,PQ),__param(5,Se),__param(6,Yf),__param(7,gi),__param(8,Xo)],xS);var yT=class extends Z{static{this.ID="chat.builtinTools"}constructor(t,i,s){super(),this.a=s;const r=i.createInstance(oS);this.D(t.registerTool(GZ,r));const n=this.a.getValue(rQ)===!0,o=this.a.getValue(nQ)!==!1,a=C3(n,o),c=this.D(i.createInstance(lS,n,o));this.D(t.registerTool(a,c));const l=i.createInstance(QZ);this.D(t.registerTool(ZZ,l));const u=this.D(i.createInstance(xS)),h=this.D(t.createToolSet(er.Internal,"custom-agent",yw.agent,{icon:Dt.fromId(oe.agent.id),description:d(6683,null)}));let f,p;const g=()=>{f?.dispose(),p?.dispose();const v=u.getToolData();f=t.registerTool(v,u),p=h.addTool(v)};g(),this.D(u.onDidUpdateToolData(g)),this.D({dispose:()=>{f?.dispose(),p?.dispose()}})}};yT=__decorate([__param(0,Yf),__param(1,Xo),__param(2,gi)],yT);var GQ="vscode_fetchWebPage_internal",AT=H("commandService"),CS=new class{constructor(){this.a=new Map,this.b=new I,this.onDidRegisterCommand=this.b.event}registerCommand(e,t){if(!e)throw new Error("invalid command");if(typeof e=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:e,handler:t})}if(e.metadata&&Array.isArray(e.metadata.args)){const o=[];for(const c of e.metadata.args)o.push(c.constraint);const a=e.handler;e.handler=function(c,...l){return vR(l,o),a(c,...l)}}const{id:i}=e;let s=this.a.get(i);s||(s=new Mn,this.a.set(i,s));const r=s.unshift(e),n=te(()=>{r(),this.a.get(i)?.isEmpty()&&this.a.delete(i)});return this.b.fire(i),Pv(n)}registerCommandAlias(e,t){return CS.registerCommand(e,(i,...s)=>i.get(AT).executeCommand(t,...s))}getCommand(e){const t=this.a.get(e);if(!(!t||t.isEmpty()))return Bt.first(t)}getCommands(){const e=new Map;for(const t of this.a.keys()){const i=this.getCommand(t);i&&e.set(t,i)}return e}};CS.registerCommand("noop",()=>{});var ST;(function(e){e[e.CtrlCmd=2048]="CtrlCmd",e[e.Shift=1024]="Shift",e[e.Alt=512]="Alt",e[e.WinCtrl=256]="WinCtrl",e[e.KeyCode=255]="KeyCode"})(ST||(ST={}));function ET(e,t){if(typeof e=="number"){if(e===0)return null;const i=(e&65535)>>>0,s=(e&4294901760)>>>16;return s!==0?new M1([N1(i,t),N1(s,t)]):new M1([N1(i,t)])}else{const i=[];for(let s=0;s<e.length;s++)i.push(N1(e[s],t));return new M1(i)}}function N1(e,t){const i=!!(e&2048),s=!!(e&256),r=t===2?s:i,n=!!(e&1024),o=!!(e&512),a=t===2?i:s,c=e&255;return new JQ(r,n,o,a,c)}var JQ=class eL{constructor(t,i,s,r,n){this.ctrlKey=t,this.shiftKey=i,this.altKey=s,this.metaKey=r,this.keyCode=n}equals(t){return t instanceof eL&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){const t=this.ctrlKey?"1":"0",i=this.shiftKey?"1":"0",s=this.altKey?"1":"0",r=this.metaKey?"1":"0";return`K${t}${i}${s}${r}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new M1([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},M1=class{constructor(e){if(e.length===0)throw $e("chords");this.chords=e}getHashCode(){let e="";for(let t=0,i=this.chords.length;t<i;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}},xT;(function(e){e[e.EditorCore=0]="EditorCore",e[e.EditorContrib=100]="EditorContrib",e[e.WorkbenchContrib=200]="WorkbenchContrib",e[e.BuiltinExtension=300]="BuiltinExtension",e[e.ExternalExtension=400]="ExternalExtension"})(xT||(xT={}));var ZQ=class tL{constructor(){this.c=new Mn,this.d=[],this.e=null}static f(t){if(zo===1){if(t&&t.win)return t.win}else if(zo===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){const i=tL.f(t),s=new ie;if(i&&i.primary){const r=ET(i.primary,zo);r&&s.add(this.g(r,t.id,t.args,t.weight,0,t.when))}if(i&&Array.isArray(i.secondary))for(let r=0,n=i.secondary.length;r<n;r++){const o=i.secondary[r],a=ET(o,zo);a&&s.add(this.g(a,t.id,t.args,t.weight,-r-1,t.when))}return s}setExtensionKeybindings(t){const i=[];let s=0;for(const r of t)r.keybinding&&(i[s++]={keybinding:r.keybinding,command:r.id,commandArgs:r.args,when:r.when,weight1:r.weight,weight2:0,extensionId:r.extensionId||null,isBuiltinExtension:r.isBuiltinExtension||!1});this.d=i,this.e=null}registerCommandAndKeybindingRule(t){return Tv(this.registerKeybindingRule(t),CS.registerCommand(t))}g(t,i,s,r,n,o){const a=this.c.push({keybinding:t,command:i,commandArgs:s,when:o,weight1:r,weight2:n,extensionId:null,isBuiltinExtension:!1});return this.e=null,te(()=>{a(),this.e=null})}getDefaultKeybindings(){return this.e||(this.e=Array.from(this.c).concat(this.d),this.e.sort(XQ)),this.e.slice(0)}},QQ=new ZQ,YQ={EditorModes:"platform.keybindingsRegistry"};Qt.add(YQ.EditorModes,QQ);function XQ(e,t){if(e.weight1!==t.weight1)return e.weight1-t.weight1;if(e.command&&t.command){if(e.command<t.command)return-1;if(e.command>t.command)return 1}return e.weight2-t.weight2}var L1;function KQ(e){return e.command!==void 0}var Ed=class D{static{this.a=new Map}static{this.CommandPalette=new D("CommandPalette")}static{this.DebugBreakpointsContext=new D("DebugBreakpointsContext")}static{this.DebugCallStackContext=new D("DebugCallStackContext")}static{this.DebugConsoleContext=new D("DebugConsoleContext")}static{this.DebugVariablesContext=new D("DebugVariablesContext")}static{this.NotebookVariablesContext=new D("NotebookVariablesContext")}static{this.DebugHoverContext=new D("DebugHoverContext")}static{this.DebugWatchContext=new D("DebugWatchContext")}static{this.DebugToolBar=new D("DebugToolBar")}static{this.DebugToolBarStop=new D("DebugToolBarStop")}static{this.DebugDisassemblyContext=new D("DebugDisassemblyContext")}static{this.DebugCallStackToolbar=new D("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new D("DebugCreateConfiguration")}static{this.DebugScopesContext=new D("DebugScopesContext")}static{this.EditorContext=new D("EditorContext")}static{this.SimpleEditorContext=new D("SimpleEditorContext")}static{this.EditorContent=new D("EditorContent")}static{this.EditorLineNumberContext=new D("EditorLineNumberContext")}static{this.EditorContextCopy=new D("EditorContextCopy")}static{this.EditorContextPeek=new D("EditorContextPeek")}static{this.EditorContextShare=new D("EditorContextShare")}static{this.EditorTitle=new D("EditorTitle")}static{this.CompactWindowEditorTitle=new D("CompactWindowEditorTitle")}static{this.EditorTitleRun=new D("EditorTitleRun")}static{this.EditorTitleContext=new D("EditorTitleContext")}static{this.EditorTitleContextShare=new D("EditorTitleContextShare")}static{this.EmptyEditorGroup=new D("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new D("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new D("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new D("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new D("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new D("EditorActionsPositionSubmenu")}static{this.EditorSplitMoveSubmenu=new D("EditorSplitMoveSubmenu")}static{this.ExplorerContext=new D("ExplorerContext")}static{this.ExplorerContextShare=new D("ExplorerContextShare")}static{this.ExtensionContext=new D("ExtensionContext")}static{this.ExtensionEditorContextMenu=new D("ExtensionEditorContextMenu")}static{this.GlobalActivity=new D("GlobalActivity")}static{this.CommandCenter=new D("CommandCenter")}static{this.CommandCenterCenter=new D("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new D("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new D("LayoutControlMenu")}static{this.MenubarMainMenu=new D("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new D("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new D("MenubarDebugMenu")}static{this.MenubarEditMenu=new D("MenubarEditMenu")}static{this.MenubarCopy=new D("MenubarCopy")}static{this.MenubarFileMenu=new D("MenubarFileMenu")}static{this.MenubarGoMenu=new D("MenubarGoMenu")}static{this.MenubarHelpMenu=new D("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new D("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new D("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new D("PanelAlignmentMenu")}static{this.PanelPositionMenu=new D("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new D("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new D("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new D("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new D("MenubarSelectionMenu")}static{this.MenubarShare=new D("MenubarShare")}static{this.MenubarSwitchEditorMenu=new D("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new D("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new D("MenubarTerminalMenu")}static{this.MenubarTerminalSuggestStatusMenu=new D("MenubarTerminalSuggestStatusMenu")}static{this.MenubarViewMenu=new D("MenubarViewMenu")}static{this.MenubarHomeMenu=new D("MenubarHomeMenu")}static{this.OpenEditorsContext=new D("OpenEditorsContext")}static{this.OpenEditorsContextShare=new D("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new D("ProblemsPanelContext")}static{this.SCMInputBox=new D("SCMInputBox")}static{this.SCMChangeContext=new D("SCMChangeContext")}static{this.SCMResourceContext=new D("SCMResourceContext")}static{this.SCMResourceContextShare=new D("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new D("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new D("SCMResourceGroupContext")}static{this.SCMSourceControl=new D("SCMSourceControl")}static{this.SCMSourceControlInline=new D("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new D("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new D("SCMHistoryTitle")}static{this.SCMHistoryItemContext=new D("SCMHistoryItemContext")}static{this.SCMHistoryItemChangeContext=new D("SCMHistoryItemChangeContext")}static{this.SCMHistoryItemRefContext=new D("SCMHistoryItemRefContext")}static{this.SCMArtifactGroupContext=new D("SCMArtifactGroupContext")}static{this.SCMArtifactContext=new D("SCMArtifactContext")}static{this.SCMQuickDiffDecorations=new D("SCMQuickDiffDecorations")}static{this.SCMTitle=new D("SCMTitle")}static{this.SearchContext=new D("SearchContext")}static{this.SearchActionMenu=new D("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new D("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new D("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new D("StickyScrollContext")}static{this.TestItem=new D("TestItem")}static{this.TestItemGutter=new D("TestItemGutter")}static{this.TestProfilesContext=new D("TestProfilesContext")}static{this.TestMessageContext=new D("TestMessageContext")}static{this.TestMessageContent=new D("TestMessageContent")}static{this.TestPeekElement=new D("TestPeekElement")}static{this.TestPeekTitle=new D("TestPeekTitle")}static{this.TestCallStack=new D("TestCallStack")}static{this.TestCoverageFilterItem=new D("TestCoverageFilterItem")}static{this.TouchBarContext=new D("TouchBarContext")}static{this.TitleBar=new D("TitleBar")}static{this.TitleBarContext=new D("TitleBarContext")}static{this.TitleBarTitleContext=new D("TitleBarTitleContext")}static{this.TunnelContext=new D("TunnelContext")}static{this.TunnelPrivacy=new D("TunnelPrivacy")}static{this.TunnelProtocol=new D("TunnelProtocol")}static{this.TunnelPortInline=new D("TunnelInline")}static{this.TunnelTitle=new D("TunnelTitle")}static{this.TunnelLocalAddressInline=new D("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new D("TunnelOriginInline")}static{this.ViewItemContext=new D("ViewItemContext")}static{this.ViewContainerTitle=new D("ViewContainerTitle")}static{this.ViewContainerTitleContext=new D("ViewContainerTitleContext")}static{this.ViewTitle=new D("ViewTitle")}static{this.ViewTitleContext=new D("ViewTitleContext")}static{this.CommentEditorActions=new D("CommentEditorActions")}static{this.CommentThreadTitle=new D("CommentThreadTitle")}static{this.CommentThreadActions=new D("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new D("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new D("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new D("CommentThreadCommentContext")}static{this.CommentTitle=new D("CommentTitle")}static{this.CommentActions=new D("CommentActions")}static{this.CommentsViewThreadActions=new D("CommentsViewThreadActions")}static{this.InteractiveToolbar=new D("InteractiveToolbar")}static{this.InteractiveCellTitle=new D("InteractiveCellTitle")}static{this.InteractiveCellDelete=new D("InteractiveCellDelete")}static{this.InteractiveCellExecute=new D("InteractiveCellExecute")}static{this.InteractiveInputExecute=new D("InteractiveInputExecute")}static{this.InteractiveInputConfig=new D("InteractiveInputConfig")}static{this.ReplInputExecute=new D("ReplInputExecute")}static{this.IssueReporter=new D("IssueReporter")}static{this.NotebookToolbar=new D("NotebookToolbar")}static{this.NotebookToolbarContext=new D("NotebookToolbarContext")}static{this.NotebookStickyScrollContext=new D("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new D("NotebookCellTitle")}static{this.NotebookCellDelete=new D("NotebookCellDelete")}static{this.NotebookCellInsert=new D("NotebookCellInsert")}static{this.NotebookCellBetween=new D("NotebookCellBetween")}static{this.NotebookCellListTop=new D("NotebookCellTop")}static{this.NotebookCellExecute=new D("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new D("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new D("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new D("NotebookDiffCellInputTitle")}static{this.NotebookDiffDocumentMetadata=new D("NotebookDiffDocumentMetadata")}static{this.NotebookDiffCellMetadataTitle=new D("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new D("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new D("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new D("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new D("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new D("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new D("NotebookKernelSource")}static{this.BulkEditTitle=new D("BulkEditTitle")}static{this.BulkEditContext=new D("BulkEditContext")}static{this.TimelineItemContext=new D("TimelineItemContext")}static{this.TimelineTitle=new D("TimelineTitle")}static{this.TimelineTitleContext=new D("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new D("TimelineFilterSubMenu")}static{this.AccountsContext=new D("AccountsContext")}static{this.SidebarTitle=new D("SidebarTitle")}static{this.PanelTitle=new D("PanelTitle")}static{this.AuxiliaryBarTitle=new D("AuxiliaryBarTitle")}static{this.TerminalInstanceContext=new D("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new D("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new D("TerminalNewDropdownContext")}static{this.TerminalTabContext=new D("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new D("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new D("TerminalStickyScrollContext")}static{this.WebviewContext=new D("WebviewContext")}static{this.InlineCompletionsActions=new D("InlineCompletionsActions")}static{this.InlineEditsActions=new D("InlineEditsActions")}static{this.NewFile=new D("NewFile")}static{this.MergeInput1Toolbar=new D("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new D("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new D("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new D("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new D("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new D("InlineEditToolbar")}static{this.ChatContext=new D("ChatContext")}static{this.ChatCodeBlock=new D("ChatCodeblock")}static{this.ChatCompareBlock=new D("ChatCompareBlock")}static{this.ChatMessageTitle=new D("ChatMessageTitle")}static{this.ChatWelcomeContext=new D("ChatWelcomeContext")}static{this.ChatMessageFooter=new D("ChatMessageFooter")}static{this.ChatExecute=new D("ChatExecute")}static{this.ChatInput=new D("ChatInput")}static{this.ChatInputSide=new D("ChatInputSide")}static{this.ChatModePicker=new D("ChatModePicker")}static{this.ChatEditingWidgetToolbar=new D("ChatEditingWidgetToolbar")}static{this.ChatEditingSessionChangesToolbar=new D("ChatEditingSessionChangesToolbar")}static{this.ChatEditingEditorContent=new D("ChatEditingEditorContent")}static{this.ChatEditingEditorHunk=new D("ChatEditingEditorHunk")}static{this.ChatEditingDeletedNotebookCell=new D("ChatEditingDeletedNotebookCell")}static{this.ChatInputAttachmentToolbar=new D("ChatInputAttachmentToolbar")}static{this.ChatEditingWidgetModifiedFilesToolbar=new D("ChatEditingWidgetModifiedFilesToolbar")}static{this.ChatInputResourceAttachmentContext=new D("ChatInputResourceAttachmentContext")}static{this.ChatInputSymbolAttachmentContext=new D("ChatInputSymbolAttachmentContext")}static{this.ChatInlineResourceAnchorContext=new D("ChatInlineResourceAnchorContext")}static{this.ChatInlineSymbolAnchorContext=new D("ChatInlineSymbolAnchorContext")}static{this.ChatMessageCheckpoint=new D("ChatMessageCheckpoint")}static{this.ChatMessageRestoreCheckpoint=new D("ChatMessageRestoreCheckpoint")}static{this.ChatNewMenu=new D("ChatNewMenu")}static{this.ChatEditingCodeBlockContext=new D("ChatEditingCodeBlockContext")}static{this.ChatTitleBarMenu=new D("ChatTitleBarMenu")}static{this.ChatAttachmentsContext=new D("ChatAttachmentsContext")}static{this.ChatToolOutputResourceToolbar=new D("ChatToolOutputResourceToolbar")}static{this.ChatTextEditorMenu=new D("ChatTextEditorMenu")}static{this.ChatToolOutputResourceContext=new D("ChatToolOutputResourceContext")}static{this.ChatMultiDiffContext=new D("ChatMultiDiffContext")}static{this.ChatConfirmationMenu=new D("ChatConfirmationMenu")}static{this.ChatEditorInlineExecute=new D("ChatEditorInputExecute")}static{this.ChatEditorInlineInputSide=new D("ChatEditorInputSide")}static{this.AccessibleView=new D("AccessibleView")}static{this.MultiDiffEditorContent=new D("MultiDiffEditorContent")}static{this.MultiDiffEditorFileToolbar=new D("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new D("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new D("DiffEditorSelectionToolbar")}static{this.AgentSessionsViewerFilterSubMenu=new D("AgentSessionsViewerFilterSubMenu")}static{this.AgentSessionsContext=new D("AgentSessionsContext")}static{this.AgentSessionsCreateSubMenu=new D("AgentSessionsCreateSubMenu")}static{this.AgentSessionsToolbar=new D("AgentSessionsToolbar")}static{this.AgentSessionItemToolbar=new D("AgentSessionItemToolbar")}static{this.AgentSessionSectionToolbar=new D("AgentSessionSectionToolbar")}static{this.ChatViewSessionTitleNavigationToolbar=new D("ChatViewSessionTitleNavigationToolbar")}static{this.ChatViewSessionTitleToolbar=new D("ChatViewSessionTitleToolbar")}static for(t){return D.a.get(t)??new D(t)}constructor(t){if(D.a.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);D.a.set(t,this),this.id=t}},Mle=H("menuService"),xd=class q5{static{this.a=new Map}static for(t){let i=this.a.get(t);return i||(i=new q5(t),this.a.set(t,i)),i}static merge(t){const i=new Set;for(const s of t)s instanceof q5&&i.add(s.b);return i}constructor(t){this.b=t,this.has=i=>i===t}},Lle=new class{constructor(){this.a=new Map,this.b=new Map,this.c=new LR({merge:xd.merge}),this.onDidChangeMenu=this.c.event}addCommand(e){return this.a.set(e.id,e),this.c.fire(xd.for(Ed.CommandPalette)),Pv(te(()=>{this.a.delete(e.id)&&this.c.fire(xd.for(Ed.CommandPalette))}))}getCommand(e){return this.a.get(e)}getCommands(){const e=new Map;return this.a.forEach((t,i)=>e.set(i,t)),e}appendMenuItem(e,t){let i=this.b.get(e);i||(i=new Mn,this.b.set(e,i));const s=i.push(t);return this.c.fire(xd.for(e)),Pv(te(()=>{s(),this.c.fire(xd.for(e))}))}appendMenuItems(e){const t=new ie;for(const{id:i,item:s}of e)t.add(this.appendMenuItem(i,s));return t}getMenuItems(e){let t;return this.b.has(e)?t=[...this.b.get(e)]:t=[],e===Ed.CommandPalette&&this.d(t),t}d(e){const t=new Set;for(const i of e)KQ(i)&&(t.add(i.command.id),i.alt&&t.add(i.alt.id));this.a.forEach((i,s)=>{t.has(s)||e.push({command:i})})}},CT=L1=class{static label(t,i){return i?.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}constructor(t,i,s,r,n,o,a){this.hideActions=r,this.menuKeybinding=n,this.b=a,this.id=t.id,this.label=L1.label(t,s),this.tooltip=(typeof t.tooltip=="string"?t.tooltip:t.tooltip?.value)??"",this.enabled=!t.precondition||o.contextMatchesRules(t.precondition),this.checked=void 0;let c;if(t.toggled){const l=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=o.contextMatchesRules(l.condition),this.checked&&l.tooltip&&(this.tooltip=typeof l.tooltip=="string"?l.tooltip:l.tooltip.value),this.checked&&Dt.isThemeIcon(l.icon)&&(c=l.icon),this.checked&&l.title&&(this.label=typeof l.title=="string"?l.title:l.title.value)}c||(c=Dt.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=i?new L1(i,void 0,s,r,void 0,o,a):void 0,this.a=s,this.class=c&&Dt.asClassName(c)}run(...t){let i=[];return this.a?.arg&&(i=[...i,this.a.arg]),this.a?.shouldForwardArgs&&(i=[...i,...t]),this.b.executeCommand(this.id,...i)}};CT=L1=__decorate([__param(5,Gn),__param(6,AT)],CT);var Ole=sf(8635,"Extensions"),kT;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(kT||(kT={}));var $T;(function(e){e.ReloadWindow="reloadWindow",e.RestartExtensions="restartExtensions",e.DownloadUpdate="downloadUpdate",e.ApplyUpdate="applyUpdate",e.QuitAndInstall="quitAndInstall"})($T||($T={}));var IT=H("extensionsWorkbenchService"),DT;(function(e){e.Readme="readme",e.Features="features",e.Changelog="changelog",e.Dependencies="dependencies",e.ExtensionPack="extensionPack"})(DT||(DT={}));var PT=class extends Z{constructor(t,i){super(),this.a=t,this.D(i.onChange(this.b,this))}set extension(t){this.a.forEach(i=>i.extension=t)}b(t){for(const i of this.a)t&&i.extension?zW(i.extension.identifier,t.identifier)&&(i.extension.server&&t.server&&i.extension.server!==t.server?i.updateWhenCounterExtensionChanges&&i.update():i.extension=t):i.update()}};PT=__decorate([__param(1,IT)],PT);var Ule=new C("defaultExtensionViews",!0),jle=new C("hasOutdatedExtensions",!1),zle=new C("hasGallery",!1),Hle=new C("extensionsGalleryStatus","unavailable"),Wle=new C("extensionResultListFocused ",!0),Ble=new C("searchMcpServers",!1),_le=new Ed("extensionsSearchActionsMenu"),Vle=new Ed("extensionsFilterSubMenu"),TT="vscode_searchExtensions_internal",qle={id:TT,toolReferenceName:"extensions",legacyToolReferenceFullNames:["extensions"],icon:Dt.fromId(oe.extensions.id),displayName:d(8655,null),modelDescription:"This is a tool for browsing Visual Studio Code Extensions Marketplace. It allows the model to search for extensions and retrieve detailed information about them. The model should use this tool whenever it needs to discover extensions or resolve information about known ones. To use the tool, the model has to provide the category of the extensions, relevant search keywords, or known extension IDs. Note that search results may include false positives, so reviewing and filtering is recommended.",userDescription:d(8656,null),source:er.Internal,inputSchema:{type:"object",properties:{category:{type:"string",description:"The category of extensions to search for",enum:XC},keywords:{type:"array",items:{type:"string"},description:"The keywords to search for"},ids:{type:"array",items:{type:"string"},description:"The ids of the extensions to search for"}}}},NT=class{constructor(t){this.a=t}async invoke(t,i,s,r){const n=t.parameters;if(!n.keywords?.length&&!n.category&&!n.ids?.length)return{content:[{kind:"text",value:d(8657,null)}]};const o=new Map,a=u=>{for(const h of u)h.deprecationInfo||h.isMalicious||o.set(h.identifier.id.toLowerCase(),{id:h.identifier.id,name:h.displayName,description:h.description,installed:h.state===1,installCount:h.installCount??0,rating:h.rating??0,categories:h.categories??[],tags:h.gallery?.tags??[]})},c=async u=>{const h=await this.a.queryGallery({text:u,pageSize:10,sortBy:"InstallCount"},r);h.firstPage.length&&a(h.firstPage)};if(n.ids?.length){const u=await this.a.getExtensions(n.ids.map(h=>({id:h})),r);a(u)}if(n.keywords?.length)for(const u of n.keywords??[])if(u==="featured")await c("featured");else{let h=n.category?`category:"${n.category}"`:"";h=u?`${h} ${u}`.trim():h,await c(h)}else await c(`category:"${n.category}"`);const l=Array.from(o.values());return{content:[{kind:"text",value:`Here are the list of extensions:
${JSON.stringify(l)}
. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.
\`\`\`vscode-extensions
extensionId1,extensionId2
\`\`\`
.`}],toolResultDetails:{input:JSON.stringify(n),output:[{type:"embed",isText:!0,value:JSON.stringify(l.map(u=>u.id))}]}}}};NT=__decorate([__param(0,IT)],NT);var MT=class{constructor(e){this.b=new Tt(()=>{const t=this;return Object.freeze({get name(){return t.a.id},get description(){return t.a.modelDescription},get inputSchema(){return t.a.inputSchema},get tags(){return t.a.tags??[]},get source(){}})}),this.c=new Tt(()=>{const t=this,i=zy.to(t.a.source);return Object.freeze({get name(){return t.a.id},get description(){return t.a.modelDescription},get inputSchema(){return t.a.inputSchema},get tags(){return t.a.tags??[]},get source(){return i}})}),this.a=e}update(e){this.a=e}get data(){return this.a}get apiObject(){return this.b.value}get apiObjectWithChatParticipantAdditions(){return this.c.value}},eY=class{constructor(e,t){this.e=t,this.a=new Map,this.c=new Map,this.d=new Map,this.b=e.getProxy(Y.MainThreadLanguageModelTools),this.b.$getTools().then(i=>{for(const s of i)this.d.set(s.id,new MT(Zt(s)))})}async $countTokensForInvocation(e,t,i){const s=this.c.get(e);if(!s)throw new Error(`Tool invocation call ${e} not found`);return await s(t,i)}async invokeTool(e,t,i,s){const r=Nt();i.tokenizationOptions&&this.c.set(r,i.tokenizationOptions.countTokens);try{if(i.toolInvocationToken&&!UH(i.toolInvocationToken))throw new Error("Invalid tool invocation token");if((t===nS||t===v3)&&!et(e,"chatParticipantPrivate"))throw new Error(`Invalid tool: ${t}`);const n=await this.b.$invokeTool({toolId:t,callId:r,parameters:i.input,tokenBudget:i.tokenizationOptions?.tokenBudget,context:i.toolInvocationToken,chatRequestId:et(e,"chatParticipantPrivate")?i.chatRequestId:void 0,chatInteractionId:et(e,"chatParticipantPrivate")?i.chatInteractionId:void 0,fromSubAgent:et(e,"chatParticipantPrivate")?i.fromSubAgent:void 0},s),o=n instanceof pi?n.value:n;return nm.to(Zt(o))}finally{this.c.delete(r)}}$onDidChangeTools(e){const t=new Set(this.a.keys());for(const i of e){t.delete(i.id);const s=this.d.get(i.id);s?s.update(i):this.d.set(i.id,new MT(Zt(i)))}for(const i of t)this.d.delete(i)}getTools(e){const t=et(e,"chatParticipantPrivate");return Array.from(this.d.values()).map(i=>t?i.apiObjectWithChatParticipantAdditions:i.apiObject).filter(i=>{switch(i.name){case nS:case v3:case GQ:case TT:return et(e,"chatParticipantPrivate");default:return!0}})}async $invokeTool(e,t){const i=this.a.get(e.toolId);if(!i)throw new Error(`Unknown tool ${e.toolId}`);const s={input:e.parameters,toolInvocationToken:Zt(e.context)};et(i.extension,"chatParticipantPrivate")&&(s.chatRequestId=e.chatRequestId,s.chatInteractionId=e.chatInteractionId,s.chatSessionId=e.context?.sessionId,s.fromSubAgent=e.fromSubAgent),et(i.extension,"chatParticipantAdditions")&&e.modelId&&(s.model=await this.f(e.modelId,i.extension)),e.tokenBudget!==void 0&&(s.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this.c.get(e.callId)||((o,a=Fe.None)=>this.b.$countTokensForInvocation(e.callId,o,a))});let r;if(et(i.extension,"toolProgress")){let o;r={report:a=>{a.increment!==void 0&&(o=(o??0)+a.increment),this.b.$acceptToolProgress(e.callId,{message:pe.fromStrict(a.message),progress:o===void 0?void 0:o/100})}}}const n=await rO(Promise.resolve(i.tool.invoke(s,t,r)),t);if(!n)throw new dt;return nm.from(n,i.extension)}async f(e,t){let i;if(e&&(i=await this.e.getLanguageModelByIdentifier(t,e)),!i&&(i=await this.e.getDefaultLanguageModel(t),!i))throw new Error("Language model unavailable");return i}async $prepareToolInvocation(e,t,i){const s=this.a.get(e);if(!s)throw new Error(`Unknown tool ${e}`);const r={input:t.parameters,chatRequestId:t.chatRequestId,chatSessionId:t.chatSessionId,chatInteractionId:t.chatInteractionId};if(s.tool.prepareInvocation){const n=await s.tool.prepareInvocation(r,i);return n?((n.pastTenseMessage||n.presentation)&&T(s.extension,"chatParticipantPrivate"),{confirmationMessages:n.confirmationMessages?{title:typeof n.confirmationMessages.title=="string"?n.confirmationMessages.title:pe.from(n.confirmationMessages.title),message:typeof n.confirmationMessages.message=="string"?n.confirmationMessages.message:pe.from(n.confirmationMessages.message)}:void 0,invocationMessage:pe.fromStrict(n.invocationMessage),pastTenseMessage:pe.fromStrict(n.pastTenseMessage),presentation:n.presentation}):void 0}}registerTool(e,t,i){return this.a.set(t,{extension:e,tool:i}),this.b.$registerTool(t),te(()=>{this.a.delete(t),this.b.$unregisterTool(t)})}},tY=class{constructor(e,t,i,s){this.c=t,this.d=i,this.e=s,this.b=[],this.f=0,this.g=new Set,this.a=e.getProxy(Y.MainThreadLanguages)}$acceptLanguageIds(e){this.b=e}async getLanguages(){return this.b.slice(0)}async changeLanguage(e,t){await this.a.$changeLanguage(e,t);const i=this.c.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,s=Xe.from(t),r=await this.a.$tokensAtPosition(e.uri,s),n={type:mo.Other,range:e.getWordRangeAtPosition(t)??new xe(t.line,t.character,t.line,t.character)};if(!r)return n;const o={range:U.to(r.range),type:ty.to(r.type)};return!o.range.contains(t)||i!==e.version?n:o}createLanguageStatusItem(e,t,i){const s=this.f++,r=this.a,n=this.g,o=`${e.identifier.value}/${t}`;if(n.has(o))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);n.add(o);const a={selector:i,id:t,name:e.displayName??e.name,severity:Rc.Information,command:void 0,text:"",detail:"",busy:!1};let c;const l=new ie,u=()=>{if(c?.dispose(),!n.has(o)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=Qv(()=>{l.clear(),this.a.$setLanguageStatus(s,{id:o,name:a.name??e.displayName??e.name,source:e.displayName??e.name,selector:Ia.from(a.selector,this.e),label:a.text,detail:a.detail??"",severity:a.severity===Rc.Error?Lt.Error:a.severity===Rc.Warning?Lt.Warning:Lt.Info,command:a.command&&this.d.toInternal(a.command,l),accessibilityInfo:a.accessibilityInformation,busy:a.busy})},0)},h={dispose(){l.dispose(),c?.dispose(),r.$removeLanguageStatus(s),n.delete(o)},get id(){return a.id},get name(){return a.name},set name(f){a.name=f,u()},get selector(){return a.selector},set selector(f){a.selector=f,u()},get text(){return a.text},set text(f){a.text=f,u()},set text2(f){T(e,"languageStatusText"),a.text=f,u()},get text2(){return T(e,"languageStatusText"),a.text},get detail(){return a.detail},set detail(f){a.detail=f,u()},get severity(){return a.severity},set severity(f){a.severity=f,u()},get accessibilityInformation(){return a.accessibilityInformation},set accessibilityInformation(f){a.accessibilityInformation=f,u()},get command(){return a.command},set command(f){a.command=f,u()},get busy(){return a.busy},set busy(f){a.busy=f,u()}};return u(),h}};function iY(e){return e&&e.title}var kS=class{constructor(t,i){this.b=i,this.a=t.getProxy(Y.MainThreadMessageService)}showMessage(t,i,s,r,n){const o={source:{identifier:t.identifier,label:t.displayName||t.name}};let a;typeof r=="string"||iY(r)?a=[r,...n]:(o.modal=r?.modal,o.useCustom=r?.useCustom,o.detail=r?.detail,a=n),o.useCustom&&T(t,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const h=a[u];if(typeof h=="string")c.push({title:h,handle:u,isCloseAffordance:!1});else if(typeof h=="object"){const{title:f,isCloseAffordance:p}=h;c.push({title:f,isCloseAffordance:!!p,handle:u}),p&&(l?this.b.warn(`[${t.identifier}] Only one message item can have 'isCloseAffordance':`,h):l=!0)}else this.b.warn(`[${t.identifier}] Invalid message item:`,h)}return this.a.$showMessage(i,s,o,c).then(u=>{if(typeof u=="number")return a[u]})}};kS=__decorate([__param(1,Se)],kS);var $S=class{constructor(e,t,i,s){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=s}asApiEvent(){return{range:new Ir(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}},IS=class{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1,encoding:"utf8"}}constructor(e,t,i){this.notebook=e,this.h=t,this.j=i,this.handle=i.handle,this.uri=y.revive(i.uri),this.cellKind=i.cellKind,this.a=i.outputs.map(wo.to),this.e=i.internalMetadata??{},this.b=Object.freeze(i.metadata??{}),this.d=Object.freeze(dl.to(i.internalMetadata??{}))}get internalMetadata(){return this.e}get apiCell(){if(!this.f){const e=this,t=this.h.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Nh.to(this.j.cellKind),document:t.document,get mime(){return e.g},set mime(s){e.g=s},get outputs(){return e.a.slice(0)},get metadata(){return e.b},get executionSummary(){return e.d}};this.f=Object.freeze(i)}return this.f}setOutputs(e){this.a=e.map(wo.to)}setOutputItems(e,t,i){const s=i.map(pl.to),r=this.a.find(n=>n.id===e);if(r&&(t||(r.items.length=0),r.items.push(...s),r.items.length>1&&r.items.every(n=>n$(n.mime)))){const n=new Map,o=[];r.items.forEach(a=>{let c;n.has(a.mime)?c=n.get(a.mime):(c=[],n.set(a.mime,c),o.push(a.mime)),c.push(a.data)}),r.items.length=0,o.forEach(a=>{const c=lW(n.get(a));r.items.push({mime:a,data:c.data.buffer})})}}setMetadata(e){this.b=Object.freeze(e)}setInternalMetadata(e){this.e=e,this.d=Object.freeze(dl.to(e))}setMime(e){}},sY=class iL{static{this.a=0}constructor(t,i,s,r,n){this.k=t,this.l=i,this.m=s,this.uri=r,this.handle=iL.a++,this.b=[],this.g=0,this.h=!1,this.j=!1,this.d=n.viewType,this.f=Object.freeze(n.metadata??Object.create(null)),this.r([[0,0,n.cells]],!0,void 0),this.g=n.versionId}dispose(){this.j=!0}get versionId(){return this.g}get apiNotebook(){if(!this.e){const t=this,i={get uri(){return t.uri},get version(){return t.g},get notebookType(){return t.d},get isDirty(){return t.h},get isUntitled(){return t.uri.scheme===V.untitled},get isClosed(){return t.j},get metadata(){return t.f},get cellCount(){return t.b.length},cellAt(s){return s=t.n(s),t.b[s].apiCell},getCells(s){return(s?t.p(s):t.b).map(n=>n.apiCell)},save(){return t.q()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this.e=Object.freeze(i)}return this.e}acceptDocumentPropertiesChanged(t){t.metadata&&(this.f=Object.freeze({...this.f,...t.metadata}))}acceptDirty(t){this.h=t}acceptModelChanged(t,i,s){this.g=t.versionId,this.h=i,this.acceptDocumentPropertiesChanged({metadata:s});const r={notebook:this.apiNotebook,metadata:s,cellChanges:[],contentChanges:[]},n=[];for(const a of t.rawEvents)a.kind===ir.ModelChange?this.r(a.changes,!1,r.contentChanges):a.kind===ir.Move?this.s(a.index,a.length,a.newIdx,r.contentChanges):a.kind===ir.Output?(this.t(a.index,a.outputs),n.push({cell:this.b[a.index].apiCell,outputs:this.b[a.index].apiCell.outputs})):a.kind===ir.OutputItem?(this.u(a.index,a.outputId,a.append,a.outputItems),n.push({cell:this.b[a.index].apiCell,outputs:this.b[a.index].apiCell.outputs})):a.kind===ir.ChangeCellLanguage?(this.v(a.index,a.language),n.push({cell:this.b[a.index].apiCell,document:this.b[a.index].apiCell.document})):a.kind===ir.ChangeCellContent?n.push({cell:this.b[a.index].apiCell,document:this.b[a.index].apiCell.document}):a.kind===ir.ChangeCellMime?this.w(a.index,a.mime):a.kind===ir.ChangeCellMetadata?(this.x(a.index,a.metadata),n.push({cell:this.b[a.index].apiCell,metadata:this.b[a.index].apiCell.metadata})):a.kind===ir.ChangeCellInternalMetadata&&(this.y(a.index,a.internalMetadata),n.push({cell:this.b[a.index].apiCell,executionSummary:this.b[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<n.length;a++){const c=n[a],l=o.get(c.cell);if(l===void 0){const u=r.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});o.set(c.cell,u-1)}else r.cellChanges[l]={...r.cellChanges[l],...c}}return Object.freeze(r),Object.freeze(r.cellChanges),Object.freeze(r.contentChanges),r}n(t){return t=t|0,t<0?0:t>=this.b.length?this.b.length-1:t}o(t){let i=t.start|0,s=t.end|0;return i<0&&(i=0),s>this.b.length&&(s=this.b.length),t.with({start:i,end:s})}p(t){t=this.o(t);const i=[];for(let s=t.start;s<t.end;s++)i.push(this.b[s]);return i}async q(){return this.j?Promise.reject(new Error("Notebook has been closed")):this.k.$trySaveNotebook(this.uri)}r(t,i,s){if(this.j)return;const r=[],n=[],o=[];if(t.reverse().forEach(a=>{const l=a[2].map(f=>{const p=new IS(this,this.l,f);return i||n.push(IS.asModelAddData(f)),p}),u=new $S(a[0],a[1],[],l),h=this.b.splice(a[0],a[1],...l);for(const f of h)o.push(f.uri),u.deletedItems.push(f.apiCell);r.push(u)}),this.l.acceptDocumentsAndEditorsDelta({addedDocuments:n,removedDocuments:o}),s)for(const a of r)s.push(a.asApiEvent())}s(t,i,s,r){const n=this.b.splice(t,i);this.b.splice(s,0,...n);const o=[new $S(t,i,n.map(a=>a.apiCell),[]),new $S(s,0,[],n)];for(const a of o)r.push(a.asApiEvent())}t(t,i){this.b[t].setOutputs(i)}u(t,i,s,r){this.b[t].setOutputItems(i,s,r)}v(t,i){const s=this.b[t];s.apiCell.document.languageId!==i&&this.m.$acceptModelLanguageChanged(s.uri,i)}w(t,i){const s=this.b[t];s.apiCell.mime=i}x(t,i){this.b[t].setMetadata(i)}y(t,i){this.b[t].setInternalMetadata(i)}getCellFromApiCell(t){return this.b.find(i=>i.apiCell===t)}getCellFromIndex(t){return this.b[t]}getCell(t){return this.b.find(i=>i.handle===t)}getCellIndex(t){return this.b.indexOf(t)}},DS=class sL{static{this.apiEditorsToExtHost=new WeakMap}constructor(t,i,s,r,n,o,a){this.id=t,this.c=i,this.notebookData=s,this.d=r,this.e=n,this.f=o,this.g=a,this.a=!1}get apiEditor(){if(!this.b){const t=this;this.b={get notebook(){return t.notebookData.apiNotebook},get selection(){return t.e[0]},set selection(i){this.selections=[i]},get selections(){return t.e},set selections(i){if(!Array.isArray(i)||!i.every(Ir.isNotebookRange))throw $e("selections");t.e=i.length===0?[new Ir(0,0)]:i,t.h(t.e)},get visibleRanges(){return t.d},revealRange(i,s){t.c.$tryRevealRange(t.id,Rr.from(i),s??ig.Default)},get viewColumn(){return t.f},get replOptions(){if(t.g==="repl")return{appendIndex:this.notebook.cellCount-1}},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}},sL.apiEditorsToExtHost.set(this.b,this)}return this.b}get visible(){return this.a}_acceptVisibility(t){this.a=t}_acceptVisibleRanges(t){this.d=t}_acceptSelections(t){this.e=t}h(t){this.c.$trySetSelections(this.id,t.map(Rr.from))}_acceptViewColumn(t){this.f=t}},PS=class{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==ce)return TS(this.right);let e=this;for(;e.parent!==ce&&e.parent.left!==e;)e=e.parent;return e.parent===ce?ce:e.parent}prev(){if(this.left!==ce)return RT(this.left);let e=this;for(;e.parent!==ce&&e.parent.right!==e;)e=e.parent;return e.parent===ce?ce:e.parent}detach(){this.parent=null,this.left=null,this.right=null}},LT;(function(e){e[e.Black=0]="Black",e[e.Red=1]="Red"})(LT||(LT={}));var ce=new PS(null,0);ce.parent=ce,ce.left=ce,ce.right=ce,ce.color=0;function TS(e){for(;e.left!==ce;)e=e.left;return e}function RT(e){for(;e.right!==ce;)e=e.right;return e}function NS(e){return e===ce?0:e.size_left+e.piece.length+NS(e.right)}function MS(e){return e===ce?0:e.lf_left+e.piece.lineFeedCnt+MS(e.right)}function LS(){ce.parent=ce}function Cd(e,t){const i=t.right;i.size_left+=t.size_left+(t.piece?t.piece.length:0),i.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=i.left,i.left!==ce&&(i.left.parent=t),i.parent=t.parent,t.parent===ce?e.root=i:t.parent.left===t?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i}function kd(e,t){const i=t.left;t.left=i.right,i.right!==ce&&(i.right.parent=t),i.parent=t.parent,t.size_left-=i.size_left+(i.piece?i.piece.length:0),t.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0),t.parent===ce?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i}function R1(e,t){let i,s;if(t.left===ce?(s=t,i=s.right):t.right===ce?(s=t,i=s.left):(s=TS(t.right),i=s.right),s===e.root){e.root=i,i.color=0,t.detach(),LS(),e.root.parent=ce;return}const r=s.color===1;if(s===s.parent.left?s.parent.left=i:s.parent.right=i,s===t?(i.parent=s.parent,$d(e,i)):(s.parent===t?i.parent=s:i.parent=s.parent,$d(e,i),s.left=t.left,s.right=t.right,s.parent=t.parent,s.color=t.color,t===e.root?e.root=s:t===t.parent.left?t.parent.left=s:t.parent.right=s,s.left!==ce&&(s.left.parent=s),s.right!==ce&&(s.right.parent=s),s.size_left=t.size_left,s.lf_left=t.lf_left,$d(e,s)),t.detach(),i.parent.left===i){const o=NS(i),a=MS(i);if(o!==i.parent.size_left||a!==i.parent.lf_left){const c=o-i.parent.size_left,l=a-i.parent.lf_left;i.parent.size_left=o,i.parent.lf_left=a,bn(e,i.parent,c,l)}}if($d(e,i.parent),r){LS();return}let n;for(;i!==e.root&&i.color===0;)i===i.parent.left?(n=i.parent.right,n.color===1&&(n.color=0,i.parent.color=1,Cd(e,i.parent),n=i.parent.right),n.left.color===0&&n.right.color===0?(n.color=1,i=i.parent):(n.right.color===0&&(n.left.color=0,n.color=1,kd(e,n),n=i.parent.right),n.color=i.parent.color,i.parent.color=0,n.right.color=0,Cd(e,i.parent),i=e.root)):(n=i.parent.left,n.color===1&&(n.color=0,i.parent.color=1,kd(e,i.parent),n=i.parent.left),n.left.color===0&&n.right.color===0?(n.color=1,i=i.parent):(n.left.color===0&&(n.right.color=0,n.color=1,Cd(e,n),n=i.parent.left),n.color=i.parent.color,i.parent.color=0,n.left.color=0,kd(e,i.parent),i=e.root));i.color=0,LS()}function OT(e,t){for($d(e,t);t!==e.root&&t.parent.color===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Cd(e,t)),t.parent.color=0,t.parent.parent.color=1,kd(e,t.parent.parent))}else{const i=t.parent.parent.left;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,kd(e,t)),t.parent.color=0,t.parent.parent.color=1,Cd(e,t.parent.parent))}e.root.color=0}function bn(e,t,i,s){for(;t!==e.root&&t!==ce;)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=s),t=t.parent}function $d(e,t){let i=0,s=0;if(t!==e.root){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t!==e.root)for(t=t.parent,i=NS(t.left)-t.size_left,s=MS(t.left)-t.lf_left,t.size_left+=i,t.lf_left+=s;t!==e.root&&(i!==0||s!==0);)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=s),t=t.parent}}var yn=65535;function FT(e){let t;return e[e.length-1]<65536?t=new Uint16Array(e.length):t=new Uint32Array(e.length),t.set(e,0),t}var rY=class{constructor(e,t,i,s,r){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=s,this.isBasicASCII=r}};function An(e,t=!0){const i=[0];let s=1;for(let r=0,n=e.length;r<n;r++){const o=e.charCodeAt(r);o===13?r+1<n&&e.charCodeAt(r+1)===10?(i[s++]=r+2,r++):i[s++]=r+1:o===10&&(i[s++]=r+1)}return t?FT(i):i}function nY(e,t){e.length=0,e[0]=0;let i=1,s=0,r=0,n=0,o=!0;for(let c=0,l=t.length;c<l;c++){const u=t.charCodeAt(c);u===13?c+1<l&&t.charCodeAt(c+1)===10?(n++,e[i++]=c+2,c++):(s++,e[i++]=c+1):u===10?(r++,e[i++]=c+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new rY(FT(e),s,r,n,o);return e.length=0,a}var qi=class{constructor(e,t,i,s,r){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=s,this.length=r}},Va=class{constructor(e,t){this.buffer=e,this.lineStarts=t}},oY=class{constructor(e,t){this.a=[],this.c=e,this.d=t,this.b=0,e.root!==ce&&e.iterate(e.root,i=>(i!==ce&&this.a.push(i.piece),!0))}read(){return this.a.length===0?this.b===0?(this.b++,this.d):null:this.b>this.a.length-1?null:this.b===0?this.d+this.c.getPieceContent(this.a[this.b++]):this.c.getPieceContent(this.a[this.b++])}},aY=class{constructor(e){this.a=e,this.b=[]}get(e){for(let t=this.b.length-1;t>=0;t--){const i=this.b[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this.b.length-1;t>=0;t--){const i=this.b[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this.b.length>=this.a&&this.b.shift(),this.b.push(e)}validate(e){let t=!1;const i=this.b;for(let s=0;s<i.length;s++){const r=i[s];if(r.node.parent===null||r.nodeStartOffset>=e){i[s]=null,t=!0;continue}}if(t){const s=[];for(const r of i)r!==null&&s.push(r);this.b=s}}},cY=class{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this.a=[new Va("",[0])],this.g={line:0,column:0},this.root=ce,this.b=1,this.c=0,this.d=t,this.e=t.length,this.f=i;let s=null;for(let r=0,n=e.length;r<n;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=An(e[r].buffer));const o=new qi(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this.a.push(e[r]),s=this.S(s,o)}this.h=new aY(1),this.j={lineNumber:0,value:""},this.y()}normalizeEOL(e){const t=yn,i=t-Math.floor(t/3),s=i*2;let r="",n=0;const o=[];if(this.iterate(this.root,a=>{const c=this.R(a),l=c.length;if(n<=i||n+l<s)return r+=c,n+=l,!0;const u=r.replace(/\r\n|\r|\n/g,e);return o.push(new Va(u,An(u))),r=c,n=l,!0}),n>0){const a=r.replace(/\r\n|\r|\n/g,e);o.push(new Va(a,An(a)))}this.create(o,e,!0)}getEOL(){return this.d}setEOL(e){this.d=e,this.e=this.d.length,this.normalizeEOL(e)}createSnapshot(e){return new oY(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,s=>{if(s===ce)return!0;const r=this.R(s),n=r.length,o=e.G(t),a=e.G(t+n),c=e.getValueInRange2(o,a);return t+=n,r===c})}getOffsetAt(e,t){let i=0,s=this.root;for(;s!==ce;)if(s.left!==ce&&s.lf_left+1>=e)s=s.left;else if(s.lf_left+s.piece.lineFeedCnt+1>=e){i+=s.size_left;const r=this.B(s,e-s.lf_left-2);return i+=r+t-1}else e-=s.lf_left+s.piece.lineFeedCnt,i+=s.size_left+s.piece.length,s=s.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const s=e;for(;t!==ce;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const r=this.A(t,e-t.size_left);if(i+=t.lf_left+r.index,r.index===0){const n=this.getOffsetAt(i+1,1),o=s-n;return new ms(i+1,o+1)}return new ms(i+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===ce){const r=this.getOffsetAt(i+1,1),n=s-e-r;return new ms(i+1,n+1)}else t=t.right;return new ms(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.H(e.startLineNumber,e.startColumn),s=this.H(e.endLineNumber,e.endColumn),r=this.getValueInRange2(i,s);return t?t!==this.d||!this.f?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this.f?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){const o=e.node,a=this.a[o.piece.bufferIndex].buffer,c=this.u(o.piece.bufferIndex,o.piece.start);return a.substring(c+e.remainder,c+t.remainder)}let i=e.node;const s=this.a[i.piece.bufferIndex].buffer,r=this.u(i.piece.bufferIndex,i.piece.start);let n=s.substring(r+e.remainder,r+i.piece.length);for(i=i.next();i!==ce;){const o=this.a[i.piece.bufferIndex].buffer,a=this.u(i.piece.bufferIndex,i.piece.start);if(i===t.node){n+=o.substring(a,a+t.remainder);break}else n+=o.substr(a,i.piece.length);i=i.next()}return n}getLinesContent(){const e=[];let t=0,i="",s=!1;return this.iterate(this.root,r=>{if(r===ce)return!0;const n=r.piece;let o=n.length;if(o===0)return!0;const a=this.a[n.bufferIndex].buffer,c=this.a[n.bufferIndex].lineStarts,l=n.start.line,u=n.end.line;let h=c[l]+n.start.column;if(s&&(a.charCodeAt(h)===10&&(h++,o--),e[t++]=i,i="",s=!1,o===0))return!0;if(l===u)return!this.f&&a.charCodeAt(h+o-1)===13?(s=!0,i+=a.substr(h,o-1)):i+=a.substr(h,o),!0;i+=this.f?a.substring(h,Math.max(h,c[l+1]-this.e)):a.substring(h,c[l+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=l+1;f<u;f++)i=this.f?a.substring(c[f],c[f+1]-this.e):a.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this.f&&a.charCodeAt(c[u]+n.end.column-1)===13?(s=!0,n.end.column===0?t--:i=a.substr(c[u],n.end.column-1)):i=a.substr(c[u],n.end.column),!0}),s&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this.c}getLineCount(){return this.b}getLineContent(e){return this.j.lineNumber===e?this.j.value:(this.j.lineNumber=e,e===this.b?this.j.value=this.getLineRawContent(e):this.f?this.j.value=this.getLineRawContent(e,this.e):this.j.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this.j.value)}l(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this.a[t.piece.bufferIndex],s=this.u(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(s)}else{const t=this.a[e.node.piece.bufferIndex],s=this.u(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(s)}}getLineCharCode(e,t){const i=this.H(e,t+1);return this.l(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this.e}getCharCode(e){const t=this.G(e);return this.l(t)}getNearestChunk(e){const t=this.G(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===ce)return"";const s=this.a[i.piece.bufferIndex],r=this.u(i.piece.bufferIndex,i.piece.start);return s.buffer.substring(r,r+i.piece.length)}else{const i=this.a[t.node.piece.bufferIndex],s=this.u(t.node.piece.bufferIndex,t.node.piece.start),r=s+t.remainder,n=s+t.node.piece.length;return i.buffer.substring(r,n)}}findMatchesInNode(e,t,i,s,r,n,o,a,c,l,u){const h=this.a[e.piece.bufferIndex],f=this.u(e.piece.bufferIndex,e.piece.start),p=this.u(e.piece.bufferIndex,r),g=this.u(e.piece.bufferIndex,n);let v;const b={line:0,column:0};let S,E;t._wordSeparators?(S=h.buffer.substring(p,g),E=k=>k+p,t.reset(0)):(S=h.buffer,E=k=>k,t.reset(p));do if(v=t.next(S),v){if(E(v.index)>=g)return l;this.s(e,E(v.index)-f,b);const k=this.t(e.piece.bufferIndex,r,b),j=b.line===r.line?b.column-r.column+s:b.column+1,O=j+v[0].length;if(u[l++]=b9(new rt(i+k,j,i+k,O),v,a),E(v.index)+v[0].length>=g||l>=c)return l}while(v);return l}findMatchesLineByLine(e,t,i,s){const r=[];let n=0;const o=new wV(t.wordSeparators,t.regex);let a=this.H(e.startLineNumber,e.startColumn);if(a===null)return[];const c=this.H(e.endLineNumber,e.endColumn);if(c===null)return[];let l=this.s(a.node,a.remainder);const u=this.s(c.node,c.remainder);if(a.node===c.node)return this.findMatchesInNode(a.node,o,e.startLineNumber,e.startColumn,l,u,t,i,s,n,r),r;let h=e.startLineNumber,f=a.node;for(;f!==c.node;){const g=this.t(f.piece.bufferIndex,l,f.piece.end);if(g>=1){const b=this.a[f.piece.bufferIndex].lineStarts,S=this.u(f.piece.bufferIndex,f.piece.start),E=b[l.line+g],k=h===e.startLineNumber?e.startColumn:1;if(n=this.findMatchesInNode(f,o,h,k,l,this.s(f,E-S),t,i,s,n,r),n>=s)return r;h+=g}const v=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const b=this.getLineContent(h).substring(v,e.endColumn-1);return n=this.n(t,o,b,e.endLineNumber,v,n,r,i,s),r}if(n=this.n(t,o,this.getLineContent(h).substr(v),h,v,n,r,i,s),n>=s)return r;h++,a=this.H(h,1),f=a.node,l=this.s(a.node,a.remainder)}if(h===e.endLineNumber){const g=h===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(h).substring(g,e.endColumn-1);return n=this.n(t,o,v,e.endLineNumber,g,n,r,i,s),r}const p=h===e.startLineNumber?e.startColumn:1;return n=this.findMatchesInNode(c.node,o,h,p,l,u,t,i,s,n,r),r}n(e,t,i,s,r,n,o,a,c){const l=e.wordSeparators;if(!a&&e.simpleSearch){const h=e.simpleSearch,f=h.length,p=i.length;let g=-f;for(;(g=i.indexOf(h,g+f))!==-1;)if((!l||y9(l,i,p,g,f))&&(o[n++]=new FA(new rt(s,g+1+r,s,g+1+f+r),null),n>=c))return n;return n}let u;t.reset(0);do if(u=t.next(i),u&&(o[n++]=b9(new rt(s,u.index+1+r,s,u.index+1+u[0].length+r),u,a),n>=c))return n;while(u);return n}insert(e,t,i=!1){if(this.f=this.f&&i,this.j.lineNumber=0,this.j.value="",this.root!==ce){const{node:s,remainder:r,nodeStartOffset:n}=this.G(e),o=s.piece,a=o.bufferIndex,c=this.s(s,r);if(s.piece.bufferIndex===0&&o.end.line===this.g.line&&o.end.column===this.g.column&&n+o.length===e&&t.length<yn){this.F(s,t),this.y();return}if(n===e)this.o(t,s),this.h.validate(e);else if(n+s.piece.length>e){const l=[];let u=new qi(o.bufferIndex,c,o.end,this.t(o.bufferIndex,c,o.end),this.u(a,o.end)-this.u(a,c));if(this.K()&&this.M(t)&&this.I(s,r)===10){const g={line:u.start.line+1,column:0};u=new qi(u.bufferIndex,g,u.end,this.t(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.K()&&this.L(t))if(this.I(s,r-1)===13){const g=this.s(s,r-1);this.C(s,g),t="\r"+t,s.piece.length===0&&l.push(s)}else this.C(s,c);else this.C(s,c);const h=this.w(t);u.length>0&&this.S(s,u);let f=s;for(let p=0;p<h.length;p++)f=this.S(f,h[p]);this.v(l)}else this.q(t,s)}else{const s=this.w(t);let r=this.T(null,s[0]);for(let n=1;n<s.length;n++)r=this.S(r,s[n])}this.y()}delete(e,t){if(this.j.lineNumber=0,this.j.value="",t<=0||this.root===ce)return;const i=this.G(e),s=this.G(e+t),r=i.node,n=s.node;if(r===n){const h=this.s(r,i.remainder),f=this.s(r,s.remainder);if(i.nodeStartOffset===e){if(t===r.piece.length){const p=r.next();R1(this,r),this.N(p),this.y();return}this.D(r,f),this.h.validate(e),this.N(r),this.y();return}if(i.nodeStartOffset+r.piece.length===e+t){this.C(r,h),this.O(r),this.y();return}this.E(r,h,f),this.y();return}const o=[],a=this.s(r,i.remainder);this.C(r,a),this.h.validate(e),r.piece.length===0&&o.push(r);const c=this.s(n,s.remainder);this.D(n,c),n.piece.length===0&&o.push(n);const l=r.next();for(let h=l;h!==ce&&h!==n;h=h.next())o.push(h);const u=r.piece.length===0?r.prev():r;this.v(o),this.O(u),this.y()}o(e,t){const i=[];if(this.K()&&this.M(e)&&this.L(t)){const n=t.piece,o={line:n.start.line+1,column:0},a=new qi(n.bufferIndex,o,n.end,this.t(n.bufferIndex,o,n.end),n.length-1);t.piece=a,e+=`
`,bn(this,t,-1,-1),t.piece.length===0&&i.push(t)}const s=this.w(e);let r=this.T(t,s[s.length-1]);for(let n=s.length-2;n>=0;n--)r=this.T(r,s[n]);this.N(r),this.v(i)}q(e,t){this.Q(e,t)&&(e+=`
`);const i=this.w(e),s=this.S(t,i[0]);let r=s;for(let n=1;n<i.length;n++)r=this.S(r,i[n]);this.N(s)}s(e,t,i){const s=e.piece,r=e.piece.bufferIndex,n=this.a[r].lineStarts,a=n[s.start.line]+s.start.column+t;let c=s.start.line,l=s.end.line,u=0,h=0,f=0;for(;c<=l&&(u=c+(l-c)/2|0,f=n[u],u!==l);)if(h=n[u+1],a<f)l=u-1;else if(a>=h)c=u+1;else break;return i?(i.line=u,i.column=a-f,null):{line:u,column:a-f}}t(e,t,i){if(i.column===0)return i.line-t.line;const s=this.a[e].lineStarts;if(i.line===s.length-1)return i.line-t.line;const r=s[i.line+1],n=s[i.line]+i.column;if(r>n+1)return i.line-t.line;const o=n-1;return this.a[e].buffer.charCodeAt(o)===13?i.line-t.line+1:i.line-t.line}u(e,t){return this.a[e].lineStarts[t.line]+t.column}v(e){for(let t=0;t<e.length;t++)R1(this,e[t])}w(e){if(e.length>yn){const l=[];for(;e.length>yn;){const h=e.charCodeAt(yn-1);let f;h===13||h>=55296&&h<=56319?(f=e.substring(0,yn-1),e=e.substring(yn-1)):(f=e.substring(0,yn),e=e.substring(yn));const p=An(f);l.push(new qi(this.a.length,{line:0,column:0},{line:p.length-1,column:f.length-p[p.length-1]},p.length-1,f.length)),this.a.push(new Va(f,p))}const u=An(e);return l.push(new qi(this.a.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this.a.push(new Va(e,u)),l}let t=this.a[0].buffer.length;const i=An(e,!1);let s=this.g;if(this.a[0].lineStarts[this.a[0].lineStarts.length-1]===t&&t!==0&&this.L(e)&&this.M(this.a[0].buffer)){this.g={line:this.g.line,column:this.g.column+1},s=this.g;for(let l=0;l<i.length;l++)i[l]+=t+1;this.a[0].lineStarts=this.a[0].lineStarts.concat(i.slice(1)),this.a[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let l=0;l<i.length;l++)i[l]+=t;this.a[0].lineStarts=this.a[0].lineStarts.concat(i.slice(1)),this.a[0].buffer+=e}const r=this.a[0].buffer.length,n=this.a[0].lineStarts.length-1,o=r-this.a[0].lineStarts[n],a={line:n,column:o},c=new qi(0,s,a,this.t(0,s,a),r-t);return this.g=a,[c]}getLinesRawContent(){return this.U(this.root)}getLineRawContent(e,t=0){let i=this.root,s="";const r=this.h.get2(e);if(r){i=r.node;const n=this.B(i,e-r.nodeStartLineNumber-1),o=this.a[i.piece.bufferIndex].buffer,a=this.u(i.piece.bufferIndex,i.piece.start);if(r.nodeStartLineNumber+i.piece.lineFeedCnt===e)s=o.substring(a+n,a+i.piece.length);else{const c=this.B(i,e-r.nodeStartLineNumber);return o.substring(a+n,a+c-t)}}else{let n=0;const o=e;for(;i!==ce;)if(i.left!==ce&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const a=this.B(i,e-i.lf_left-2),c=this.B(i,e-i.lf_left-1),l=this.a[i.piece.bufferIndex].buffer,u=this.u(i.piece.bufferIndex,i.piece.start);return n+=i.size_left,this.h.set({node:i,nodeStartOffset:n,nodeStartLineNumber:o-(e-1-i.lf_left)}),l.substring(u+a,u+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const a=this.B(i,e-i.lf_left-2),c=this.a[i.piece.bufferIndex].buffer,l=this.u(i.piece.bufferIndex,i.piece.start);s=c.substring(l+a,l+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==ce;){const n=this.a[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const o=this.B(i,0),a=this.u(i.piece.bufferIndex,i.piece.start);return s+=n.substring(a,a+o-t),s}else{const o=this.u(i.piece.bufferIndex,i.piece.start);s+=n.substr(o,i.piece.length)}i=i.next()}return s}y(){let e=this.root,t=1,i=0;for(;e!==ce;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this.b=t,this.c=i,this.h.validate(this.c)}A(e,t){const i=e.piece,s=this.s(e,t),r=s.line-i.start.line;if(this.u(i.bufferIndex,i.end)-this.u(i.bufferIndex,i.start)===t){const n=this.t(e.piece.bufferIndex,i.start,s);if(n!==r)return{index:n,remainder:0}}return{index:r,remainder:s.column}}B(e,t){if(t<0)return 0;const i=e.piece,s=this.a[i.bufferIndex].lineStarts,r=i.start.line+t+1;return r>i.end.line?s[i.end.line]+i.end.column-s[i.start.line]-i.start.column:s[r]-s[i.start.line]-i.start.column}C(e,t){const i=e.piece,s=i.lineFeedCnt,r=this.u(i.bufferIndex,i.end),n=t,o=this.u(i.bufferIndex,n),a=this.t(i.bufferIndex,i.start,n),c=a-s,l=o-r,u=i.length+l;e.piece=new qi(i.bufferIndex,i.start,n,a,u),bn(this,e,l,c)}D(e,t){const i=e.piece,s=i.lineFeedCnt,r=this.u(i.bufferIndex,i.start),n=t,o=this.t(i.bufferIndex,n,i.end),a=this.u(i.bufferIndex,n),c=o-s,l=r-a,u=i.length+l;e.piece=new qi(i.bufferIndex,n,i.end,o,u),bn(this,e,l,c)}E(e,t,i){const s=e.piece,r=s.start,n=s.end,o=s.length,a=s.lineFeedCnt,c=t,l=this.t(s.bufferIndex,s.start,c),u=this.u(s.bufferIndex,t)-this.u(s.bufferIndex,r);e.piece=new qi(s.bufferIndex,s.start,c,l,u),bn(this,e,u-o,l-a);const h=new qi(s.bufferIndex,i,n,this.t(s.bufferIndex,i,n),this.u(s.bufferIndex,n)-this.u(s.bufferIndex,i)),f=this.S(e,h);this.N(f)}F(e,t){this.Q(t,e)&&(t+=`
`);const i=this.K()&&this.L(t)&&this.M(e),s=this.a[0].buffer.length;this.a[0].buffer+=t;const r=An(t,!1);for(let f=0;f<r.length;f++)r[f]+=s;if(i){const f=this.a[0].lineStarts[this.a[0].lineStarts.length-2];this.a[0].lineStarts.pop(),this.g={line:this.g.line-1,column:s-f}}this.a[0].lineStarts=this.a[0].lineStarts.concat(r.slice(1));const n=this.a[0].lineStarts.length-1,o=this.a[0].buffer.length-this.a[0].lineStarts[n],a={line:n,column:o},c=e.piece.length+t.length,l=e.piece.lineFeedCnt,u=this.t(0,e.piece.start,a),h=u-l;e.piece=new qi(e.piece.bufferIndex,e.piece.start,a,u,c),this.g=a,bn(this,e,t.length,h)}G(e){let t=this.root;const i=this.h.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let s=0;for(;t!==ce;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){s+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:s};return this.h.set(r),r}else e-=t.size_left+t.piece.length,s+=t.size_left+t.piece.length,t=t.right;return null}H(e,t){let i=this.root,s=0;for(;i!==ce;)if(i.left!==ce&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.B(i,e-i.lf_left-2),n=this.B(i,e-i.lf_left-1);return s+=i.size_left,{node:i,remainder:Math.min(r+t-1,n),nodeStartOffset:s}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const r=this.B(i,e-i.lf_left-2);if(r+t-1<=i.piece.length)return{node:i,remainder:r+t-1,nodeStartOffset:s};t-=i.piece.length-r;break}else e-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==ce;){if(i.piece.lineFeedCnt>0){const r=this.B(i,0),n=this.J(i);return{node:i,remainder:Math.min(t-1,r),nodeStartOffset:n}}else if(i.piece.length>=t-1){const r=this.J(i);return{node:i,remainder:t-1,nodeStartOffset:r}}else t-=i.piece.length;i=i.next()}return null}I(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this.a[e.piece.bufferIndex],s=this.u(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(s)}J(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}K(){return!(this.f&&this.d===`
`)}L(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===ce||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this.a[t.bufferIndex].lineStarts,s=t.start.line,r=i[s]+t.start.column;return s===i.length-1||i[s+1]>r+1?!1:this.a[t.bufferIndex].buffer.charCodeAt(r)===10}M(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===ce||e.piece.lineFeedCnt===0?!1:this.I(e,e.piece.length-1)===13}N(e){if(this.K()&&this.L(e)){const t=e.prev();this.M(t)&&this.P(t,e)}}O(e){if(this.K()&&this.M(e)){const t=e.next();this.L(t)&&this.P(e,t)}}P(e,t){const i=[],s=this.a[e.piece.bufferIndex].lineStarts;let r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};const n=e.piece.length-1,o=e.piece.lineFeedCnt-1;e.piece=new qi(e.piece.bufferIndex,e.piece.start,r,o,n),bn(this,e,-1,-1),e.piece.length===0&&i.push(e);const a={line:t.piece.start.line+1,column:0},c=t.piece.length-1,l=this.t(t.piece.bufferIndex,a,t.piece.end);t.piece=new qi(t.piece.bufferIndex,a,t.piece.end,l,c),bn(this,t,-1,-1),t.piece.length===0&&i.push(t);const u=this.w(`\r
`);this.S(e,u[0]);for(let h=0;h<i.length;h++)R1(this,i[h])}Q(e,t){if(this.K()&&this.M(e)){const i=t.next();if(this.L(i)){if(e+=`
`,i.piece.length===1)R1(this,i);else{const s=i.piece,r={line:s.start.line+1,column:0},n=s.length-1,o=this.t(s.bufferIndex,r,s.end);i.piece=new qi(s.bufferIndex,r,s.end,o,n),bn(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===ce)return t(ce);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}R(e){if(e===ce)return"";const t=this.a[e.piece.bufferIndex],i=e.piece,s=this.u(i.bufferIndex,i.start),r=this.u(i.bufferIndex,i.end);return t.buffer.substring(s,r)}getPieceContent(e){const t=this.a[e.bufferIndex],i=this.u(e.bufferIndex,e.start),s=this.u(e.bufferIndex,e.end);return t.buffer.substring(i,s)}S(e,t){const i=new PS(t,1);if(i.left=ce,i.right=ce,i.parent=ce,i.size_left=0,i.lf_left=0,this.root===ce)this.root=i,i.color=0;else if(e.right===ce)e.right=i,i.parent=e;else{const r=TS(e.right);r.left=i,i.parent=r}return OT(this,i),i}T(e,t){const i=new PS(t,1);if(i.left=ce,i.right=ce,i.parent=ce,i.size_left=0,i.lf_left=0,this.root===ce)this.root=i,i.color=0;else if(e.left===ce)e.left=i,i.parent=e;else{const s=RT(e.left);s.right=i,i.parent=s}return OT(this,i),i}U(e){let t="";return this.iterate(e,i=>(t+=this.R(i),!0)),t}},UT;(function(e){e[e.Unknown=0]="Unknown",e[e.Invalid=3]="Invalid",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(UT||(UT={}));function RS(e){let t=0,i=0,s=0,r=0;for(let n=0,o=e.length;n<o;n++){const a=e.charCodeAt(n);a===13?(t===0&&(i=n),t++,n+1<o&&e.charCodeAt(n+1)===10?(r|=2,n++):r|=3,s=n+1):a===10&&(r|=1,t===0&&(i=n),t++,s=n+1)}return t===0&&(i=e.length),[t,i,e.length-s,r]}var OS;function lY(){return OS||(OS=new TextDecoder("UTF-16LE")),OS}function uY(e,t,i){const s=new Uint16Array(e.buffer,t,i);return i>0&&(s[0]===65279||s[0]===65534)?hY(e,t,i):lY().decode(s)}function hY(e,t,i){const s=[];let r=0;for(let n=0;n<i;n++){const o=EO(e,t);t+=2,s[r++]=String.fromCharCode(o)}return s.join("")}function O1(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var dY=class qr{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(t,i,s,r){this.oldPosition=t,this.oldText=i,this.newPosition=s,this.newText=r}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${O1(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${O1(this.oldText)}")`:`(replace@${this.oldPosition} "${O1(this.oldText)}" with "${O1(this.newText)}")`}static a(t){return 4+2*t.length}static c(t,i,s){const r=i.length;Af(t,r,s),s+=4;for(let n=0;n<r;n++)xO(t,i.charCodeAt(n),s),s+=2;return s}static d(t,i){const s=yf(t,i);return i+=4,uY(t,i,s)}writeSize(){return 8+qr.a(this.oldText)+qr.a(this.newText)}write(t,i){return Af(t,this.oldPosition,i),i+=4,Af(t,this.newPosition,i),i+=4,i=qr.c(t,this.oldText,i),i=qr.c(t,this.newText,i),i}static read(t,i,s){const r=yf(t,i);i+=4;const n=yf(t,i);i+=4;const o=qr.d(t,i);i+=qr.a(o);const a=qr.d(t,i);return i+=qr.a(a),s.push(new qr(r,o,n,a)),i}},fY=class _d extends Z{get onDidChangeContent(){return this.m.event}constructor(t,i,s,r,n,o,a){super(),this.m=this.D(new I),this.f=i,this.j=!o,this.g=r,this.h=n,this.c=new cY(t,s,a)}equals(t){return!(t instanceof _d)||this.f!==t.f||this.getEOL()!==t.getEOL()?!1:this.c.equal(t.c)}mightContainRTL(){return this.g}mightContainUnusualLineTerminators(){return this.h}resetMightContainUnusualLineTerminators(){this.h=!1}mightContainNonBasicASCII(){return this.j}getBOM(){return this.f}getEOL(){return this.c.getEOL()}createSnapshot(t){return this.c.createSnapshot(t?this.f:"")}getOffsetAt(t,i){return this.c.getOffsetAt(t,i)}getPositionAt(t){return this.c.getPositionAt(t)}getRangeAt(t,i){const s=t+i,r=this.getPositionAt(t),n=this.getPositionAt(s);return new rt(r.lineNumber,r.column,n.lineNumber,n.column)}getValueInRange(t,i=0){if(t.isEmpty())return"";const s=this.n(i);return this.c.getValueInRange(t,s)}getValueLengthInRange(t,i=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;const s=this.getOffsetAt(t.startLineNumber,t.startColumn),r=this.getOffsetAt(t.endLineNumber,t.endColumn);let n=0;const o=this.n(i),a=this.getEOL();if(o.length!==a.length){const c=o.length-a.length,l=t.endLineNumber-t.startLineNumber;n=c*l}return r-s+n}getCharacterCountInRange(t,i=0){if(this.j){let s=0;const r=t.startLineNumber,n=t.endLineNumber;for(let o=r;o<=n;o++){const a=this.getLineContent(o),c=o===r?t.startColumn-1:0,l=o===n?t.endColumn-1:a.length;for(let u=c;u<l;u++)uf(a.charCodeAt(u))?(s=s+1,u=u+1):s=s+1}return s+=this.n(i).length*(n-r),s}return this.getValueLengthInRange(t,i)}getNearestChunk(t){return this.c.getNearestChunk(t)}getLength(){return this.c.getLength()}getLineCount(){return this.c.getLineCount()}getLinesContent(){return this.c.getLinesContent()}getLineContent(t){return this.c.getLineContent(t)}getLineCharCode(t,i){return this.c.getLineCharCode(t,i)}getCharCode(t){return this.c.getCharCode(t)}getLineLength(t){return this.c.getLineLength(t)}getLineMinColumn(t){return 1}getLineMaxColumn(t){return this.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){const i=jv(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){const i=d2(this.getLineContent(t));return i===-1?0:i+2}n(t){switch(t){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this.c.setEOL(t)}applyEdits(t,i,s){let r=this.g,n=this.h,o=this.j,a=!0,c=[];for(let v=0;v<t.length;v++){const b=t[v];a&&b._isTracked&&(a=!1);const S=b.range;if(b.text){let Q=!0;o||(Q=!y2(b.text),o=Q),!r&&Q&&(r=qE(b.text)),!n&&Q&&(n=GE(b.text))}let E="",k=0,j=0,O=0;if(b.text){let Q;[k,j,O,Q]=RS(b.text);const F=this.getEOL();Q===0||Q===(F===`\r
`?2:1)?E=b.text:E=b.text.replace(/\r\n|\r|\n/g,F)}c[v]={sortIndex:v,identifier:b.identifier||null,range:S,rangeOffset:this.getOffsetAt(S.startLineNumber,S.startColumn),rangeLength:this.getValueLengthInRange(S),text:E,eolCount:k,firstLineLength:j,lastLineLength:O,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}c.sort(_d.t);let l=!1;for(let v=0,b=c.length-1;v<b;v++){const S=c[v].range.getEndPosition(),E=c[v+1].range.getStartPosition();if(E.isBeforeOrEqual(S)){if(E.isBefore(S))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(c=this.q(c));const u=s||i?_d._getInverseEditRanges(c):[],h=[];if(i)for(let v=0;v<c.length;v++){const b=c[v],S=u[v];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let E=S.startLineNumber;E<=S.endLineNumber;E++){let k="";E===S.startLineNumber&&(k=this.getLineContent(b.range.startLineNumber),jv(k)!==-1)||h.push({lineNumber:E,oldContent:k})}}let f=null;if(s){let v=0;f=[];for(let b=0;b<c.length;b++){const S=c[b],E=u[b],k=this.getValueInRange(S.range),j=S.rangeOffset+v;v+=S.text.length-k.length,f[b]={sortIndex:S.sortIndex,identifier:S.identifier,range:E,text:k,textChange:new dY(S.rangeOffset,k,j,S.text)}}l||f.sort((b,S)=>b.sortIndex-S.sortIndex)}this.g=r,this.h=n,this.j=o;const p=this.s(c);let g=null;if(i&&h.length>0){h.sort((v,b)=>b.lineNumber-v.lineNumber),g=[];for(let v=0,b=h.length;v<b;v++){const S=h[v].lineNumber;if(v>0&&h[v-1].lineNumber===S)continue;const E=h[v].oldContent,k=this.getLineContent(S);k.length===0||k===E||jv(k)!==-1||g.push(S)}}return this.m.fire(),new gV(f,p,g)}q(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let i=!1;const s=t[0].range,r=t[t.length-1].range,n=new rt(s.startLineNumber,s.startColumn,r.endLineNumber,r.endColumn);let o=s.startLineNumber,a=s.startColumn;const c=[];for(let p=0,g=t.length;p<g;p++){const v=t[p],b=v.range;i=i||v.forceMoveMarkers,c.push(this.getValueInRange(new rt(o,a,b.startLineNumber,b.startColumn))),v.text.length>0&&c.push(v.text),o=b.endLineNumber,a=b.endColumn}const l=c.join(""),[u,h,f]=RS(l);return{sortIndex:0,identifier:t[0].identifier,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n,0),text:l,eolCount:u,firstLineLength:h,lastLineLength:f,forceMoveMarkers:i,isAutoWhitespaceEdit:!1}}s(t){t.sort(_d.u);const i=[];for(let s=0;s<t.length;s++){const r=t[s],n=r.range.startLineNumber,o=r.range.startColumn,a=r.range.endLineNumber,c=r.range.endColumn;if(n===a&&o===c&&r.text.length===0)continue;r.text?(this.c.delete(r.rangeOffset,r.rangeLength),this.c.insert(r.rangeOffset,r.text,!0)):this.c.delete(r.rangeOffset,r.rangeLength);const l=new rt(n,o,a,c);i.push({range:l,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return i}findMatchesLineByLine(t,i,s,r){return this.c.findMatchesLineByLine(t,i,s,r)}getPieceTree(){return this.c}static _getInverseEditRange(t,i){const s=t.startLineNumber,r=t.startColumn,[n,o,a]=RS(i);let c;if(i.length>0){const l=n+1;l===1?c=new rt(s,r,s,r+o):c=new rt(s,r,s+l-1,a+1)}else c=new rt(s,r,s,r);return c}static _getInverseEditRanges(t){const i=[];let s=0,r=0,n=null;for(let o=0,a=t.length;o<a;o++){const c=t[o];let l,u;n?n.range.endLineNumber===c.range.startLineNumber?(l=s,u=r+(c.range.startColumn-n.range.endColumn)):(l=s+(c.range.startLineNumber-n.range.endLineNumber),u=c.range.startColumn):(l=c.range.startLineNumber,u=c.range.startColumn);let h;if(c.text.length>0){const f=c.eolCount+1;f===1?h=new rt(l,u,l,u+c.firstLineLength):h=new rt(l,u,l+f-1,c.lastLineLength+1)}else h=new rt(l,u,l,u);s=h.endLineNumber,r=h.endColumn,i.push(h),n=c}return i}static t(t,i){const s=rt.compareRangesUsingEnds(t.range,i.range);return s===0?t.sortIndex-i.sortIndex:s}static u(t,i){const s=rt.compareRangesUsingEnds(t.range,i.range);return s===0?i.sortIndex-t.sortIndex:-s}},pY=class{constructor(e,t,i,s,r,n,o,a,c){this.a=e,this.b=t,this.c=i,this.d=s,this.e=r,this.f=n,this.g=o,this.h=a,this.j=c}k(e){const t=this.c+this.d+this.e,i=this.c+this.e;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this.k(e),i=this.a;if(this.j&&(t===`\r
`&&(this.c>0||this.d>0)||t===`
`&&(this.c>0||this.e>0)))for(let r=0,n=i.length;r<n;r++){const o=i[r].buffer.replace(/\r\n|\r|\n/g,t),a=An(o);i[r]=new Va(o,a)}const s=new fY(i,this.b,t,this.f,this.g,this.h,this.j);return{textBuffer:s,disposable:s}}getFirstLineText(e){return this.a[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},jT=class{constructor(){this.a=[],this.b="",this.c=!1,this.d=0,this.e=[],this.f=0,this.g=0,this.h=0,this.j=!1,this.k=!1,this.l=!0}acceptChunk(e){if(e.length===0)return;this.a.length===0&&k2(e)&&(this.b=C2,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this.m(e.substr(0,e.length-1),!1),this.c=!0,this.d=t):(this.m(e,!1),this.c=!1,this.d=t)}m(e,t){!t&&e.length===0||(this.c?this.n(String.fromCharCode(this.d)+e):this.n(e))}n(e){const t=nY(this.e,e);this.a.push(new Va(e,t.lineStarts)),this.f+=t.cr,this.g+=t.lf,this.h+=t.crlf,t.isBasicASCII||(this.l=!1,this.j||(this.j=qE(e)),this.k||(this.k=GE(e)))}finish(e=!0){return this.o(),new pY(this.a,this.b,this.f,this.g,this.h,this.j,this.k,this.l,e)}o(){if(this.a.length===0&&this.m("",!0),this.c){this.c=!1;const e=this.a[this.a.length-1];e.buffer+=String.fromCharCode(this.d);const t=An(e.buffer);e.lineStarts=t,this.d===13&&this.f++}}},gY=class extends Z{constructor(e,t,i){super(),this._source=e,this.b=t,this.c=i,this.a=void 0}f(e){const t=e.getLineCount();return new rt(1,1,t,this.g(e,t))}g(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this.b){const e=new jT;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:s}=t.create(1);this.b=i,this.D(s)}return this.b}get outputTextBuffers(){return this.a||(this.a=this.c.map(e=>{const t=new jT;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:s,disposable:r}=i.create(1);return this.D(r),s})),this.a}findInInputs(e){const i=new v9(e,!1,!1,null).parseSearchRequest();if(!i)return[];const s=this.f(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(s,i,!0,5e3)}findInOutputs(e){const i=new v9(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(s=>{const r=s.findMatchesLineByLine(this.f(s),i,!0,5e3);if(r.length!==0)return{textBuffer:s,matches:r}}).filter(s=>!!s):[]}};function zT(e,t){let i=-1;const s=[];let r=[];return e.forEach(o=>{o.range.startLineNumber!==i&&r.length>0&&(s.push([...r]),r=[]),r.push(o),i=o.range.endLineNumber}),r.length>0&&s.push([...r]),s.map(o=>{const a=[],c=o[0].range.startLineNumber,l=o[o.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(t.getLineContent(u));return new tD(a.join(`
`)+`
`,o.map(u=>new rt(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}var Zle=Object.freeze({id:"application",order:100,title:d(4400,null),type:"object"}),mY=Object.freeze({id:"workbench",order:7,title:d(4401,null),type:"object"}),vY=Object.freeze({id:"security",scope:1,title:d(4402,null),type:"object",order:7}),Qle=Object.freeze({id:"problems",title:d(4403,null),type:"object",order:101}),wY=Object.freeze({id:"window",order:8,title:d(4404,null),type:"object"}),bY={ConfigurationMigration:"base.contributions.configuration.migration"},yY=class{constructor(){this.migrations=[],this.a=new I,this.onDidRegisterConfigurationMigration=this.a.event}registerConfigurationMigrations(e){this.migrations.push(...e)}},F1=new yY;Qt.add(bY.ConfigurationMigration,F1);var HT=class extends Z{static{this.ID="workbench.contrib.configurationMigration"}constructor(t,i){super(),this.a=t,this.b=i,this.D(this.b.onDidChangeWorkspaceFolders(async s=>{for(const r of s.added)await this.f(r,F1.migrations)})),this.c(F1.migrations),this.D(F1.onDidRegisterConfigurationMigration(s=>this.c(s)))}async c(t){await this.f(void 0,t);for(const i of this.b.getWorkspace().folders)await this.f(i,t)}async f(t,i){await Promise.all([i.map(s=>this.g(s,t?.uri))])}async g(t,i){const s=this.a.inspect(t.key,{resource:i}),r=this.b.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[n,o]of r){const a=s[n];if(!a)continue;const c=[];if(a.value!==void 0){const l=await this.h(t,n,a.value,i,void 0);for(const u of l??[])c.push([u,[]])}for(const{identifiers:l,value:u}of a.overrides??[])if(u!==void 0){const h=await this.h(t,n,u,i,l);for(const f of h??[])c.push([f,l])}c.length&&await Promise.allSettled(c.map(async([[l,u],h])=>this.a.updateValue(l,u.value,{resource:i,overrideIdentifiers:h},o)))}}async h(t,i,s,r,n){const o=c=>{const u=this.a.inspect(c,{resource:r})[i];if(u)return n?u.overrides?.find(({identifiers:h})=>Fi(h,n))?.value:u.value},a=await t.migrateFn(s,o);return Array.isArray(a)?a:[[t.key,a]]}};HT=__decorate([__param(0,gi),__param(1,$u)],HT);var WT=class extends Z{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(t){super(),this.b=t,this.a=new Ri,this.ready=this.a.p,this.c()}async c(){try{await this.f()}finally{this.a.complete()}}async f(){if(!ze&&(await this.b.getEnvironment())?.os!==1)return;Qt.as(oo.Configuration).registerConfiguration({...vY,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:d(4405,null)},default:[],markdownDescription:d(4406,null),scope:3},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:d(4407,null),scope:3}}})}};WT=__decorate([__param(0,E9)],WT);var Id="window.newWindowProfile",BT=class extends Z{static{this.ID="workbench.contrib.dynamicWindowConfiguration"}constructor(t,i){super(),this.c=t,this.f=i,this.g(),this.D(this.c.onDidChangeProfiles(s=>this.g())),this.h(),this.j(),this.D(i.onDidChangeConfiguration(s=>{s.source!==7&&s.affectsConfiguration(Id)&&this.h()})),this.D(this.c.onDidChangeProfiles(()=>this.j()))}g(){const t=Qt.as(oo.Configuration),i={...wY,properties:{[Id]:{type:["string","null"],default:null,enum:[...this.c.profiles.map(s=>s.name),null],enumItemLabels:[...this.c.profiles.map(()=>""),d(4408,null)],description:d(4409,null),scope:1}}};this.a?t.updateConfigurations({add:[i],remove:[this.a]}):t.registerConfiguration(i),this.a=i}h(){const t=this.f.getValue(Id);this.b=t?this.c.profiles.find(i=>i.name===t):void 0}j(){const t=this.f.getValue(Id);if(!t)return;const i=this.b?this.c.profiles.find(s=>s.id===this.b.id):void 0;t!==i?.name&&this.f.updateValue(Id,i?.name)}};BT=__decorate([__param(0,XZ),__param(1,gi)],BT);var eue=H("editorResolverService"),AY=Qt.as(oo.Configuration),SY={...mY,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:d(15370,null),additionalProperties:{type:"string"}}}};AY.registerConfiguration(SY);var FS;(function(e){e.builtin="builtin",e.option="option",e.exclusive="exclusive",e.default="default"})(FS||(FS={}));var _T;(function(e){e[e.ABORT=1]="ABORT",e[e.NONE=2]="NONE"})(_T||(_T={}));function EY(e,t){if(new Set([V.extension,V.webviewPanel,V.vscodeWorkspaceTrust,V.vscodeSettings]).has(t.scheme))return!1;const r=typeof e=="string"&&e.indexOf(Be.sep)>=0?`${t.scheme}:${t.path}`:Li(t);return ua(e,r,{ignoreCase:!0})}var xY=class Vd{static{this.a=0}get activeNotebookEditor(){return this.k?.apiEditor}get visibleNotebookEditors(){return this.l.map(t=>t.apiEditor)}constructor(t,i,s,r,n,o,a){this.q=s,this.r=r,this.s=n,this.t=o,this.u=a,this.f=new Map,this.g=new kt,this.h=new Map,this.j=new I,this.onDidChangeActiveNotebookEditor=this.j.event,this.l=[],this.m=new I,this.onDidOpenNotebookDocument=this.m.event,this.n=new I,this.onDidCloseNotebookDocument=this.n.event,this.o=new I,this.onDidChangeVisibleNotebookEditors=this.o.event,this.p=new hr("NotebookCellStatusBarCache"),this.x=0,this.y=new Map,this.b=t.getProxy(Y.MainThreadNotebook),this.c=t.getProxy(Y.MainThreadNotebookDocuments),this.d=t.getProxy(Y.MainThreadNotebookEditors),this.i=i.converter,i.registerArgumentProcessor({processArgument:c=>{if(c&&c.$mid===13){const l=c.notebookEditor?.notebookUri,u=c.cell.handle,f=this.g.get(l)?.getCell(u);if(f)return f.apiCell}if(c&&c.$mid===14){const l=c.uri,u=this.g.get(l);if(u)return u.apiNotebook}return c}}),Vd.C(i)}getEditorById(t){const i=this.h.get(t);if(!i)throw new Error(`unknown text editor: ${t}. known editors: ${[...this.h.keys()]} `);return i}getIdByEditor(t){for(const[i,s]of this.h)if(s.apiEditor===t)return i}get notebookDocuments(){return[...this.g.values()]}getNotebookDocument(t,i){const s=this.g.get(t);if(!s&&!i)throw new Error(`NO notebook document for '${t}'`);return s}static w(t,i){if(!i)return;const s=i.filenamePattern.map(r=>Hg.from(r)).filter(r=>r!==void 0);if(i.filenamePattern&&!s){console.warn(`Notebook content provider view options file name pattern is invalid ${i.filenamePattern}`);return}return{extension:t.identifier,providerDisplayName:t.displayName||t.name,displayName:i.displayName,filenamePattern:s,priority:i.exclusive?FS.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(t,i,s){const r=Vd.a++,n=typeof s.onDidChangeCellStatusBarItems=="function"?Vd.a++:void 0;this.f.set(r,s),this.b.$registerNotebookCellStatusBarItemProvider(r,n,i);let o;return n!==void 0&&(o=s.onDidChangeCellStatusBarItems(a=>this.b.$emitCellStatusBarEvent(n))),new Ce(()=>{this.f.delete(r),this.b.$unregisterNotebookCellStatusBarItemProvider(r,n),o?.dispose()})}async createNotebookDocument(t){const i=await this.c.$tryCreateNotebook({viewType:t.viewType,content:t.content&&vo.from(t.content)});return y.revive(i)}async openNotebookDocument(t){const i=this.g.get(t);if(i)return i.apiNotebook;const s=await this.c.$tryOpenNotebook(t),r=this.g.get(y.revive(s));return rc(r?.apiNotebook)}async showNotebookDocument(t,i){let s;typeof i=="object"?s={position:Kt.from(i.viewColumn),preserveFocus:i.preserveFocus,selections:i.selections&&i.selections.map(Rr.from),pinned:typeof i.preview=="boolean"?!i.preview:void 0,label:typeof i.asRepl=="string"?i.asRepl:typeof i.asRepl=="object"?i.asRepl.label:void 0}:s={preserveFocus:!1,pinned:!0};const r=i?.asRepl?"repl":t.notebookType,n=await this.d.$tryShowNotebookDocument(t.uri,r,s),o=n&&this.h.get(n)?.apiEditor;if(o)return o;throw n?new Error(`Could NOT open editor for "${t.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${t.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(t,i,s,r){const n=this.f.get(t),o=y.revive(i),a=this.g.get(o);if(!a||!n)return;const c=a.getCellFromIndex(s);if(!c)return;const l=await n.provideCellStatusBarItems(c.apiCell,r);if(!l)return;const u=new ie,h=this.p.add([u]),p=(Array.isArray(l)?l:[l]).map(g=>vy.from(g,this.i,u));return{cacheId:h,items:p}}$releaseNotebookCellStatusBarItems(t){this.p.delete(t)}registerNotebookSerializer(t,i,s,r,n){if(fu(i))throw new Error("viewType cannot be empty or just whitespace");const o=this.x++;return this.y.set(o,{viewType:i,serializer:s,options:r}),this.b.$registerNotebookSerializer(o,{id:t.identifier,location:t.extensionLocation},i,by.from(r),Vd.w(t,n)),te(()=>{this.b.$unregisterNotebookSerializer(o)})}async $dataToNotebook(t,i,s){const r=this.y.get(t);if(!r)throw new Error("NO serializer found");const n=await r.serializer.deserializeNotebook(i.buffer,s);return new pi(vo.from(n))}async $notebookToData(t,i,s){const r=this.y.get(t);if(!r)throw new Error("NO serializer found");const n=await r.serializer.serializeNotebook(vo.to(i.value),s);return W.wrap(n)}async $saveNotebook(t,i,s,r,n){const o=y.revive(i),a=this.y.get(t);this.D(`enter saveNotebook(versionId: ${s}, ${o.toString()})`);try{if(!a)throw new US("NO serializer found");const c=this.g.get(o);if(!c)throw new US("Document NOT found");if(c.versionId!==s)throw new US("Document version mismatch, expected: "+s+", actual: "+c.versionId);if(!this.s.value.isWritableFileSystem(o.scheme))throw new Vf(d(3045,null,this.A(o)),6);const l={metadata:dC(c.apiNotebook.metadata,g=>!(a.options?.transientDocumentMetadata??{})[g]),cells:[]};for(const g of c.apiNotebook.getCells()){const v=new kp(g.kind,g.document.getText(),g.document.languageId,g.mime,a.options?.transientOutputs?[]:[...g.outputs],g.metadata,g.executionSummary);v.metadata=dC(g.metadata,b=>!(a.options?.transientCellMetadata??{})[b]),l.cells.push(v)}if(await this.z(o,r),n.isCancellationRequested)throw new dt;const u=await a.serializer.serializeNotebook(l,n);if(n.isCancellationRequested)throw new dt;this.D(`serialized versionId: ${s} ${o.toString()}`),await this.s.value.writeFile(o,u),this.D(`Finished write versionId: ${s} ${o.toString()}`);const h=this.s.getFileSystemProviderExtUri(o.scheme),f=await this.s.value.stat(o),p={name:h.basename(o),isFile:(f.type&is.File)!==0,isDirectory:(f.type&is.Directory)!==0,isSymbolicLink:(f.type&is.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&Xn.Readonly)||!this.s.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&Xn.Locked),etag:L$({mtime:f.mtime,size:f.size}),children:void 0};return this.D(`exit saveNotebook(versionId: ${s}, ${o.toString()})`),p}catch(c){if(c instanceof Vf)return{...c,message:c.message};throw c}}async $searchInNotebooks(t,i,s,r,n){const o=this.y.get(t)?.serializer;if(!o)return{limitHit:!1,results:[]};const a=new ou;await(async(f,p,g)=>{await Promise.all(f.map(async v=>await Promise.all(v.filenamePatterns.map(b=>{const S={_reason:g._reason,folderQueries:g.folderQueries,includePattern:g.includePattern,excludePattern:g.excludePattern,maxResults:g.maxResults,type:1,filePattern:b};return this.t.doInternalFileSearchWithCustomCallback(S,p,E=>{E.forEach(k=>{a.has(k)||r.some(O=>v.isFromSettings&&!O.isFromSettings?!1:O.filenamePatterns.some(Q=>EY(Q,k)))||a.add(k)})}).catch(E=>{if(E.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw E})}))))})(s,n,i);const l=new kt;let u=!1;const h=Array.from(a).map(async f=>{const p=[];try{if(n.isCancellationRequested)return;if(i.maxResults&&[...l.values()].reduce((S,E)=>S+E.cellResults.length,0)>i.maxResults){u=!0;return}const g=[],v=this.g.get(f);if(v)v.apiNotebook.getCells().forEach(E=>g.push({input:E.document.getText(),outputs:E.outputs.flatMap(k=>k.items.map(j=>j.data.toString()))}));else{const S=await this.s.value.readFile(f),E=W.fromString(S.toString()),k=await o.deserializeNotebook(E.buffer,n);if(n.isCancellationRequested)return;vo.from(k).cells.forEach(O=>g.push({input:O.source,outputs:O.outputs.flatMap(Q=>Q.items.map(F=>F.valueBytes.toString()))}))}if(n.isCancellationRequested)return;g.forEach((S,E)=>{const k=i.contentPattern.pattern,j=new gY(S.input,void 0,S.outputs),O=j.findInInputs(k),Q=j.findInOutputs(k),F=Q.flatMap(B=>zT(B.matches,B.textBuffer)).map((B,z)=>(B.webviewIndex=z,B));if(O.length>0||Q.length>0){const B={index:E,contentResults:zT(O,j.inputTextBuffer),webviewResults:F};p.push(B)}});const b={resource:f,cellResults:p};l.set(f,b);return}catch{return}});return await Promise.all(h),{limitHit:u,results:[...l.values()]}}async z(t,i){const s=await this.s.value.stat(t);if(typeof i?.mtime=="number"&&typeof i.etag=="string"&&i.etag!==Nz&&typeof s.mtime=="number"&&typeof s.size=="number"&&i.mtime<s.mtime&&i.etag!==L$({mtime:i.mtime,size:s.size}))throw new Vf(d(3046,null),3,i)}A(t){return t.scheme===V.file?t.fsPath:t.toString()}B(t,i,s){if(this.h.has(i))throw new Error(`editor with id ALREADY EXSIST: ${i}`);const r=new DS(i,this.d,t,s.visibleRanges.map(Rr.to),s.selections.map(Rr.to),typeof s.viewColumn=="number"?Kt.to(s.viewColumn):void 0,s.viewType);this.h.set(i,r)}$acceptDocumentAndEditorsDelta(t){if(t.value.removedDocuments)for(const s of t.value.removedDocuments){const r=y.revive(s),n=this.g.get(r);n&&(n.dispose(),this.g.delete(r),this.q.$acceptDocumentsAndEditorsDelta({removedDocuments:n.apiNotebook.getCells().map(o=>o.document.uri)}),this.n.fire(n.apiNotebook));for(const o of this.h.values())o.notebookData.uri.toString()===r.toString()&&this.h.delete(o.id)}if(t.value.addedDocuments){const s=[];for(const r of t.value.addedDocuments){const n=y.revive(r.uri);if(this.g.has(n))throw new Error(`adding EXISTING notebook ${n} `);const o=new sY(this.c,this.q,this.r,n,r);s.push(...r.cells.map(a=>IS.asModelAddData(a))),this.g.get(n)?.dispose(),this.g.set(n,o),this.q.$acceptDocumentsAndEditorsDelta({addedDocuments:s}),this.m.fire(o.apiNotebook)}}if(t.value.addedEditors)for(const s of t.value.addedEditors){if(this.h.has(s.id))return;const r=y.revive(s.documentUri),n=this.g.get(r);n&&this.B(n,s.id,s)}const i=[];if(t.value.removedEditors)for(const s of t.value.removedEditors){const r=this.h.get(s);r&&(this.h.delete(s),this.k?.id===r.id&&(this.k=void 0),i.push(r))}if(t.value.visibleEditors){this.l=t.value.visibleEditors.map(r=>this.h.get(r)).filter(r=>!!r);const s=new Set;this.l.forEach(r=>s.add(r.id));for(const r of this.h.values()){const n=s.has(r.id);r._acceptVisibility(n)}this.l=[...this.h.values()].map(r=>r).filter(r=>r.visible),this.o.fire(this.visibleNotebookEditors)}t.value.newActiveEditor===null?this.k=void 0:t.value.newActiveEditor&&(this.h.get(t.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${t.value.newActiveEditor}`),this.k=this.h.get(t.value.newActiveEditor)),t.value.newActiveEditor!==void 0&&this.j.fire(this.k?.apiEditor)}static C(t){const i=_.String.with("notebookType","A notebook type"),s=new Ae("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[i,new _("data","Bytes to convert to data",n=>n instanceof Uint8Array,n=>W.wrap(n))],new be("Notebook Data",n=>vo.to(n.value))),r=new Ae("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[i,new _("NotebookData","Notebook data to convert to bytes",n=>!0,n=>new pi(vo.from(n)))],new be("Bytes",n=>n.buffer));t.registerApiCommand(s),t.registerApiCommand(r)}D(t){this.u.trace(`[Extension Host Notebook] ${t}`)}},US=class extends Error{constructor(e){super(e),this.name="NotebookSaveError"}},CY=class{constructor(e,t,i,s={timeout:1500,errors:3}){this.b=e,this.c=t,this.d=i,this.f=s,this.a=new cu}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,s)=>{const r=function(o){t.call(i,o)};return r.extension=e,this.a.event(r,void 0,s)}}async $participateInSave(e,t,i){const s=y.revive(e),r=this.c.getNotebookDocument(s);if(!r)throw new Error("Unable to resolve notebook document");const n=[];if(await this.a.fireAsync({notebook:r.apiNotebook,reason:Fg.to(t)},i,async(a,c)=>{const l=Date.now(),u=await await Promise.resolve(a);Date.now()-l>this.f.timeout&&this.b.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier),!i.isCancellationRequested&&u&&(u instanceof wa?n.push(u):this.b.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(n.length===0)return!0;const o={edits:[]};for(const a of n){const{edits:c}=os.from(a);o.edits=o.edits.concat(c)}return this.d.$tryApplyWorkspaceEdit(new pi(o))}},kY=class{constructor(e){this.c=e,this.a=new I,this.onDidSaveNotebookDocument=this.a.event,this.b=new I,this.onDidChangeNotebookDocument=this.b.event}$acceptModelChanged(e,t,i,s){const n=this.c.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,i,s);this.b.fire(n)}$acceptDirtyStateChanged(e,t){this.c.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this.c.getNotebookDocument(y.revive(e));this.a.fire(t.apiNotebook)}},jS=class{constructor(t,i){this.c=t,this.d=i,this.a=new I,this.b=new I,this.onDidChangeNotebookEditorSelection=this.a.event,this.onDidChangeNotebookEditorVisibleRanges=this.b.event}$acceptEditorPropertiesChanged(t,i){this.c.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",t,i);const s=this.d.getEditorById(t);i.visibleRanges&&s._acceptVisibleRanges(i.visibleRanges.ranges.map(Rr.to)),i.selections&&s._acceptSelections(i.selections.selections.map(Rr.to)),i.visibleRanges&&this.b.fire({notebookEditor:s.apiEditor,visibleRanges:s.apiEditor.visibleRanges}),i.selections&&this.a.fire(Object.freeze({notebookEditor:s.apiEditor,selections:s.apiEditor.selections}))}$acceptEditorViewColumns(t){for(const i in t)this.d.getEditorById(i)._acceptViewColumn(Kt.to(t[i]))}};jS=__decorate([__param(0,Se)],jS);var jl;(function(e){e[e.Output=1]="Output",e[e.OutputItems=2]="OutputItems",e[e.ExecutionState=3]="ExecutionState"})(jl||(jl={}));var iue=H("INotebookExecutionService"),$Y=100,VT;(function(e){e[e.Disconnected=1]="Disconnected",e[e.Connected=2]="Connected",e[e.Initializing=3]="Initializing"})(VT||(VT={}));var sue=H("INotebookKernelService"),rue=H("INotebookKernelHistoryService"),zS=class{constructor(t,i,s,r,n){this.l=i,this.m=s,this.n=r,this.o=n,this.b=new kt,this.c=new kt,this.f=new Map,this.g=0,this.h=new Map,this.i=0,this.j=new Map,this.k=0,this.q=0,this.r={},this.a=t.getProxy(Y.MainThreadNotebookKernels);const o=new Ae("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new _("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this.m.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this.m.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return"skipIfAlreadySelected"in c?{notebookEditorId:l,skipIfAlreadySelected:c.skipIfAlreadySelected}:{notebookEditorId:l}}return c})],be.Void),a=new Ae("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[_.Uri],new be("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this.n.registerApiCommand(o),this.n.registerApiCommand(a)}createNotebookController(t,i,s,r,n,o){for(const O of this.j.values())if(O.controller.id===i&&Ye.equals(t.identifier,O.extensionId))throw new Error(`notebook controller with id '${i}' ALREADY exist`);const a=this.k++,c=this;this.o.trace(`NotebookController[${a}], CREATED by ${t.identifier.value}, ${i}`);const l=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${t.identifier}'`);let u=!1;const h=new I,f=new I,p={id:U1(t.identifier,i),notebookType:s,extensionId:t.identifier,extensionLocation:t.extensionLocation,label:r||t.identifier.value,preloads:o?o.map(Wg.from):[]};let g=n??l,v,b;this.a.$addKernel(a,p).catch(O=>{console.log(O),u=!0});let S=0;const E=()=>{if(u)return;const O=++S;Promise.resolve().then(()=>{O===S&&this.a.$updateKernel(a,p)})},k=new kt,j={get id(){return i},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:h.event,get label(){return p.label},set label(O){p.label=O??t.displayName??t.name,E()},get detail(){return p.detail??""},set detail(O){p.detail=O,E()},get description(){return p.description??""},set description(O){p.description=O,E()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(O){p.supportedLanguages=O,E()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(O){p.supportsExecutionOrder=O,E()},get rendererScripts(){return p.preloads?p.preloads.map(Wg.to):[]},get executeHandler(){return g},set executeHandler(O){g=O??l},get interruptHandler(){return v},set interruptHandler(O){v=O,p.supportsInterrupt=!!O,E()},set variableProvider(O){T(t,"notebookVariableProvider"),b=O,p.hasVariableProvider=!!O,O?.onDidChangeVariables(Q=>c.a.$variablesUpdated(Q.uri)),E()},get variableProvider(){return b},createNotebookCellExecution(O){if(u)throw new Error("notebook controller is DISPOSED");if(!k.has(O.notebook.uri))throw c.o.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(k.keys()).map(Q=>Q.toString())),new Error(`notebook controller is NOT associated to notebook: ${O.notebook.uri.toString()}`);return c._createNotebookCellExecution(O,U1(t.identifier,this.id))},createNotebookExecution(O){if(T(t,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!k.has(O.uri))throw c.o.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(k.keys()).map(Q=>Q.toString())),new Error(`notebook controller is NOT associated to notebook: ${O.uri.toString()}`);return c._createNotebookExecution(O,U1(t.identifier,this.id))},dispose:()=>{u||(this.o.trace(`NotebookController[${a}], DISPOSED`),u=!0,this.j.delete(a),h.dispose(),f.dispose(),this.a.$removeKernel(a))},updateNotebookAffinity(O,Q){Q===sg.Hidden&&T(t,"notebookControllerAffinityHidden"),c.a.$updateNotebookPriority(a,O.uri,Q)},onDidReceiveMessage:f.event,postMessage(O,Q){return T(t,"notebookMessaging"),c.a.$postMessage(a,Q&&c.m.getIdByEditor(Q),O)},asWebviewUri(O){return T(t,"notebookMessaging"),pd(O,c.l.remote)}};return this.j.set(a,{extensionId:t.identifier,controller:j,onDidReceiveMessage:f,onDidChangeSelection:h,associatedNotebooks:k}),j}getIdByController(t){for(const[i,s]of this.j)if(s.controller===t)return U1(s.extensionId,t.id);return null}createNotebookControllerDetectionTask(t,i){const s=this.g++,r=this;this.o.trace(`NotebookControllerDetectionTask[${s}], CREATED by ${t.identifier.value}`),this.a.$addKernelDetectionTask(s,i);const n={dispose:()=>{this.f.delete(s),r.a.$removeKernelDetectionTask(s)}};return this.f.set(s,n),n}registerKernelSourceActionProvider(t,i,s){const r=this.i++,n=typeof s.onDidChangeNotebookKernelSourceActions=="function"?r:void 0,o=this;this.h.set(r,s),this.o.trace(`NotebookKernelSourceActionProvider[${r}], CREATED by ${t.identifier.value}`),this.a.$addKernelSourceActionProvider(r,r,i);let a;return n!==void 0&&(a=s.onDidChangeNotebookKernelSourceActions(c=>this.a.$emitNotebookKernelSourceActionsChangeEvent(n))),{dispose:()=>{this.h.delete(r),o.a.$removeKernelSourceActionProvider(r,r),a?.dispose()}}}async $provideKernelSourceActions(t,i){const s=this.h.get(t);if(s){const r=new ie;return(await s.provideNotebookKernelSourceActions(i)??[]).map(o=>wy.from(o,this.n.converter,r))}return[]}$acceptNotebookAssociation(t,i,s){const r=this.j.get(t);if(r){const n=this.m.getNotebookDocument(y.revive(i));s?r.associatedNotebooks.set(n.uri,!0):r.associatedNotebooks.delete(n.uri),this.o.trace(`NotebookController[${t}] ASSOCIATE notebook`,n.uri.toString(),s),r.onDidChangeSelection.fire({selected:s,notebook:n.apiNotebook})}}async $executeCells(t,i,s){const r=this.j.get(t);if(!r)return;const n=this.m.getNotebookDocument(y.revive(i)),o=[];for(const a of s){const c=n.getCell(a);c&&o.push(c.apiCell)}try{this.o.trace(`NotebookController[${t}] EXECUTE cells`,n.uri.toString(),o.length),await r.controller.executeHandler.call(r.controller,o,n.apiNotebook,r.controller)}catch(a){this.o.error(`NotebookController[${t}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(t,i,s){const r=this.j.get(t);if(!r)return;const n=this.m.getNotebookDocument(y.revive(i));if(r.controller.interruptHandler)await r.controller.interruptHandler.call(r.controller,n.apiNotebook);else for(const o of s){const a=n.getCell(o);a&&this.b.get(a.uri)?.cancel()}if(r.controller.interruptHandler){const o=this.c.get(n.uri);this.c.delete(n.uri),s.length&&Array.isArray(o)&&o.length&&o.forEach(a=>a.dispose())}}async $provideVariables(t,i,s,r,n,o,a){const c=this.j.get(t);if(!c)return;const l=this.m.getNotebookDocument(y.revive(s)),u=c.controller.variableProvider;if(!u)return;let h;if(r!==void 0){if(h=this.r[r],!h)return}else this.r={};const f=n==="named"?bh.Named:bh.Indexed,p=u.provideVariables(l.apiNotebook,h,f,o,a);let g=0;for await(const v of p){if(a.isCancellationRequested)return;const b={id:this.q++,name:v.variable.name,value:v.variable.value,type:v.variable.type,interfaces:v.variable.interfaces,language:v.variable.language,expression:v.variable.expression,hasNamedChildren:v.hasNamedChildren,indexedChildrenCount:v.indexedChildrenCount,extensionId:c.extensionId.value};if(this.r[b.id]=v.variable,this.a.$receiveVariable(i,b),g++>=$Y)return}}$acceptKernelMessageFromRenderer(t,i,s){const r=this.j.get(t);if(!r)return;const n=this.m.getEditorById(i);r.onDidReceiveMessage.fire(Object.freeze({editor:n.apiEditor,message:s}))}_createNotebookCellExecution(t,i){if(t.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const r=this.m.getNotebookDocument(t.notebook.uri).getCellFromApiCell(t);if(!r)throw new Error("invalid cell");if(this.b.has(r.uri))throw new Error(`duplicate execution for ${r.uri}`);const n=new IY(i,r,this.a);this.b.set(r.uri,n);const o=n.onDidChangeState(()=>{n.state===pr.Resolved&&(n.dispose(),o.dispose(),this.b.delete(r.uri))});return n.asApiObject()}_createNotebookExecution(t,i){const s=this.m.getNotebookDocument(t.uri),r=t.getCells().find(a=>{const c=s.getCellFromApiCell(a);return c&&this.b.has(c.uri)});if(r)throw new Error(`duplicate cell execution for ${r.document.uri}`);if(this.c.has(s.uri))throw new Error(`duplicate notebook execution for ${s.uri}`);const n=new PY(i,s,this.a),o=n.onDidChangeState(()=>{n.state===Sn.Resolved&&(n.dispose(),o.dispose(),this.c.delete(s.uri))});return this.c.set(s.uri,[n,o]),n.asApiObject()}};zS=__decorate([__param(4,Se)],zS);var pr;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(pr||(pr={}));var IY=class rL extends Z{static{this.a=0}get state(){return this.f}constructor(t,i,s){super(),this.m=i,this.n=s,this.b=rL.a++,this.c=new I,this.onDidChangeState=this.c.event,this.f=pr.Init,this.g=this.D(new Qe),this.h=new TY(10,r=>this.r(r)),this.j=i.internalMetadata.executionOrder,this.n.$createExecution(this.b,t,this.m.notebook.uri,this.m.handle)}cancel(){this.g.cancel()}async q(t){await this.h.addItem(t)}async r(t){const i=Array.isArray(t)?t:[t];return this.n.$updateExecution(this.b,new pi(i))}s(){if(this.f===pr.Init)throw new Error("Must call start before modifying cell output");if(this.f===pr.Resolved)throw new Error("Cannot modify cell output after calling resolve")}t(t){let i=this.m;if(t&&(i=this.m.notebook.getCellFromApiCell(t)),!i)throw new Error("INVALID cell");return i.handle}w(t){return t.map(i=>{const s=Ip.ensureUniqueMimeTypes(i.items,!0);return s===i.items?wo.from(i):wo.from({items:s,id:i.id,metadata:i.metadata})})}async y(t,i,s){const r=this.t(i),n=this.w(xs(t));return this.q({editType:jl.Output,cellHandle:r,append:s,outputs:n})}async z(t,i,s){return t=Ip.ensureUniqueMimeTypes(xs(t),!0),this.q({editType:jl.OutputItems,items:t.map(pl.from),outputId:i.id,append:s})}asApiObject(){const t=this;return Object.freeze({get token(){return t.g.token},get cell(){return t.m.apiCell},get executionOrder(){return t.j},set executionOrder(s){t.j=s,t.r([{editType:jl.ExecutionState,executionOrder:t.j}])},start(s){if(t.f===pr.Resolved||t.f===pr.Started)throw new Error("Cannot call start again");t.f=pr.Started,t.c.fire(),t.r({editType:jl.ExecutionState,runStartTime:s})},end(s,r,n){if(t.f===pr.Resolved)throw new Error("Cannot call resolve twice");t.f=pr.Resolved,t.c.fire(),t.h.flush();const o=DY(n);t.n.$completeExecution(t.b,new pi({runEndTime:r,lastRunSuccess:s,error:o}))},clearOutput(s){return t.s(),t.y([],s,!1)},appendOutput(s,r){return t.s(),t.y(s,r,!0)},replaceOutput(s,r){return t.s(),t.y(s,r,!1)},appendOutputItems(s,r){return t.s(),t.z(s,r,!0)},replaceOutputItems(s,r){return t.s(),t.z(s,r,!1)}})}};function DY(e){const t=r=>r?{startLineNumber:r.start.line,startColumn:r.start.character,endLineNumber:r.end.line,endColumn:r.end.character}:void 0,i=r=>({uri:r.uri,position:r.position,label:r.label});return e?{name:e.name,message:e.message,stack:e.stack instanceof Array?e.stack.map(r=>i(r)):e.stack,location:t(e.location),uri:e.uri}:void 0}var Sn;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(Sn||(Sn={}));var PY=class nL extends Z{static{this.a=0}get state(){return this.f}constructor(t,i,s){super(),this.h=i,this.j=s,this.b=nL.a++,this.c=new I,this.onDidChangeState=this.c.event,this.f=Sn.Init,this.g=this.D(new Qe),this.j.$createNotebookExecution(this.b,t,this.h.uri)}cancel(){this.g.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this.f===Sn.Resolved||this.f===Sn.Started)throw new Error("Cannot call start again");this.f=Sn.Started,this.c.fire(),this.j.$beginNotebookExecution(this.b)},end:()=>{if(this.f===Sn.Resolved)throw new Error("Cannot call resolve twice");this.f=Sn.Resolved,this.c.fire(),this.j.$completeNotebookExecution(this.b)}})}},TY=class{constructor(e,t){this.f=e,this.g=t,this.a=[],this.b=Date.now()}addItem(e){return this.a.push(e),this.c||(this.c=new Ri,this.b=Date.now(),ri(this.f).then(()=>this.flush())),Date.now()-this.b>this.f?this.flush():this.c.p}flush(){if(this.a.length===0||!this.c)return Promise.resolve();const e=this.c;this.c=void 0;const t=this.a;return this.a=[],this.g(t).finally(()=>e.complete())}};function U1(e,t){return`${e.value}/${t}`}var NY=class{constructor(e,t){this.c=t,this.a=new Map,this.b=e.getProxy(Y.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){const s=this.c.getEditorById(e);this.a.get(t)?.fire({editor:s.apiEditor,message:i})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some(s=>s.id===t))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(s,r,n)=>this.d(t).event(s,r,n),postMessage:(s,r)=>{DS.apiEditorsToExtHost.has(s)&&([s,r]=[r,s]);const n=r&&DS.apiEditorsToExtHost.get(r);return this.b.$postMessage(n?.id,t,s)}}}d(e){let t=this.a.get(e);return t||(t=new I({onDidRemoveLastListener:()=>{t?.dispose(),this.a.delete(e)}}),this.a.set(e,t),t)}},MY=class{constructor(e){this.b=new Map,this.a=e.getProxy(Y.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(T(e,"profileContentHandlers"),this.b.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.b.set(t,i),this.a.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),te(()=>{this.b.delete(t),this.a.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,s){const r=this.b.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.saveProfile(t,i,s)}async $readProfile(e,t,i){const s=this.b.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.readProfile(Oe(t)?t:y.revive(t),i)}},LY=class oL{static{this.a=0}constructor(t,i){this.d=i,this.c=new Map,this.b=t.getProxy(Y.MainThreadQuickDiff)}$provideOriginalResource(t,i,s){const r=y.revive(i),n=this.c.get(t);return n?fi(()=>n.provideOriginalResource(r,s)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(t,i,s,r,n,o){const a=oL.a++;this.c.set(a,s);const c=Ye.toKey(t.identifier);return this.b.$registerQuickDiffProvider(a,Ia.from(i,this.d),`${c}.${r}`,n,o),{dispose:()=>{this.b.$unregisterQuickDiffProvider(a),this.c.delete(a)}}}};function RY(e,t,i){const s=e.getProxy(Y.MainThreadQuickOpen);class r{constructor(l,u){this.e=new Map,this.f=0,this.a=l,this.b=u}showQuickPick(l,u,h,f=Fe.None){this.c=void 0;const p=Promise.resolve(u),g=++this.f,v=s.$show(g,{title:h?.title,placeHolder:h?.placeHolder,prompt:h?.prompt,matchOnDescription:h?.matchOnDescription,matchOnDetail:h?.matchOnDetail,ignoreFocusLost:h?.ignoreFocusOut,canPickMany:h?.canPickMany},f),b={},S=v.then(()=>b);return Promise.race([S,p]).then(E=>{if(E!==b)return p.then(k=>{const j=[];for(let O=0;O<k.length;O++){const Q=k[O];typeof Q=="string"?j.push({label:Q,handle:O}):Q.kind===wh.Separator?j.push({type:"separator",label:Q.label}):(Q.tooltip&&T(l,"quickPickItemTooltip"),j.push({label:Q.label,iconPathDto:yo.from(Q.iconPath),description:Q.description,detail:Q.detail,picked:Q.picked,alwaysShow:Q.alwaysShow,tooltip:pe.fromStrict(Q.tooltip),resourceUri:Q.resourceUri,handle:O}))}return h&&typeof h.onDidSelectItem=="function"&&(this.c=O=>{h.onDidSelectItem(k[O])}),s.$setItems(g,j),v.then(O=>{if(typeof O=="number")return k[O];if(Array.isArray(O))return O.map(Q=>k[Q])})})}).then(void 0,E=>{if(!Mi(E))return s.$setError(g,E),Promise.reject(E)})}$onItemSelected(l){this.c?.(l)}showInput(l,u=Fe.None){return this.d=l?.validateInput,s.$input(l,typeof this.d=="function",u).then(void 0,h=>{if(!Mi(h))return Promise.reject(h)})}async $validateInput(l){if(!this.d)return;const u=await this.d(l);if(!u||typeof u=="string")return u;let h;switch(u.severity){case tl.Info:h=Lt.Info;break;case tl.Warning:h=Lt.Warning;break;case tl.Error:h=Lt.Error;break;default:h=u.message?Lt.Error:Lt.Ignore;break}return{content:u.message,severity:h}}async showWorkspaceFolderPick(l,u=Fe.None){const h=await this.b.executeCommand("_workbench.pickWorkspaceFolder",[l]);if(!h)return;const f=await this.a.getWorkspaceFolders2();if(f)return f.find(p=>p.uri.toString()===h.uri.toString())}createQuickPick(l){const u=new o(l,()=>this.e.delete(u._id));return this.e.set(u._id,u),u}createInputBox(l){const u=new a(l,()=>this.e.delete(u._id));return this.e.set(u._id,u),u}$onDidChangeValue(l,u){this.e.get(l)?._fireDidChangeValue(u)}$onDidAccept(l){this.e.get(l)?._fireDidAccept()}$onDidChangeActive(l,u){const h=this.e.get(l);h instanceof o&&h._fireDidChangeActive(u)}$onDidChangeSelection(l,u){const h=this.e.get(l);h instanceof o&&h._fireDidChangeSelection(u)}$onDidTriggerButton(l,u,h){this.e.get(l)?._fireDidTriggerButton(u,h)}$onDidTriggerItemButton(l,u,h){const f=this.e.get(l);f instanceof o&&f._fireDidTriggerItemButton(u,h)}$onDidHide(l){this.e.get(l)?._fireDidHide()}}class n{static{this.a=1}constructor(l,u){this.y=l,this.z=u,this._id=o.a++,this.e=!1,this.f=!1,this.g=!0,this.j=!1,this.k=!0,this.l="",this.m=void 0,this.o=[],this.p=new Map,this.q=new I,this.r=new I,this.s=new I,this.t=new I,this.v={id:this._id},this.w=!1,this.x=[this.s,this.t,this.q,this.r],this.onDidChangeValue=this.r.event,this.onDidAccept=this.q.event,this.onDidTriggerButton=this.s.event,this.onDidHide=this.t.event}get title(){return this.b}set title(l){this.b=l,this.A({title:l})}get step(){return this.c}set step(l){this.c=l,this.A({step:l})}get totalSteps(){return this.d}set totalSteps(l){this.d=l,this.A({totalSteps:l})}get enabled(){return this.g}set enabled(l){this.g=l,this.A({enabled:l})}get busy(){return this.j}set busy(l){this.j=l,this.A({busy:l})}get ignoreFocusOut(){return this.k}set ignoreFocusOut(l){this.k=l,this.A({ignoreFocusOut:l})}get value(){return this.l}set value(l){this.l=l,this.A({value:l})}get valueSelection(){return this.m}set valueSelection(l){this.m=l,this.A({valueSelection:l})}get placeholder(){return this.n}set placeholder(l){this.n=l,this.A({placeholder:l})}get buttons(){return this.o}set buttons(l){l.some(u=>typeof u.location=="number"||typeof u.toggle=="object"&&typeof u.toggle.checked=="boolean")&&T(this.y,"quickInputButtonLocation"),this.o=l.slice(),this.p.clear(),l.forEach((u,h)=>{const f=u===vh.Back?-1:h;this.p.set(f,u)}),this.A({buttons:l.map((u,h)=>({iconPathDto:yo.from(u.iconPath),tooltip:u.tooltip,handle:u===vh.Back?-1:h,location:typeof u.location=="number"?u.location:void 0,toggle:typeof u.toggle=="object"&&typeof u.toggle.checked=="boolean"?{checked:u.toggle.checked}:void 0}))})}show(){this.e=!0,this.f=!0,this.A({visible:!0})}hide(){this.e=!1,this.A({visible:!1})}_fireDidAccept(){this.q.fire()}_fireDidChangeValue(l){this.l=l,this.r.fire(l)}_fireDidTriggerButton(l,u){const h=this.p.get(l);h&&(u!==void 0&&h.toggle&&(h.toggle.checked=u),this.s.fire(h))}_fireDidHide(){this.f&&(this.f=this.e,this.t.fire())}dispose(){this.w||(this.w=!0,this._fireDidHide(),this.x=Zi(this.x),this.u&&(clearTimeout(this.u),this.u=void 0),this.z(),s.$dispose(this._id))}A(l){if(!this.w){for(const u of Object.keys(l)){const h=l[u];this.v[u]=h===void 0?null:h}"visible"in this.v?(this.u&&(clearTimeout(this.u),this.u=void 0),this.B()):this.e&&!this.u&&(this.u=setTimeout(()=>{this.u=void 0,this.B()},0))}}B(){s.$createOrUpdate(this.v),this.v={id:this._id}}}class o extends n{constructor(l,u){super(l,u),this.C=[],this.D=new Map,this.E=new Map,this.F=!1,this.G=!0,this.H=!0,this.I=!0,this.J=!1,this.K=[],this.M=new I,this.N=[],this.O=new I,this.P=new I,this.onDidChangeActive=this.M.event,this.onDidChangeSelection=this.O.event,this.onDidTriggerItemButton=this.P.event,this.x.push(this.M,this.O,this.P),this.A({type:"quickPick"})}get items(){return this.C}set items(l){this.C=l.slice(),this.D.clear(),this.E.clear(),l.forEach((h,f)=>{this.D.set(f,h),this.E.set(h,f)});const u=[];for(let h=0;h<l.length;h++){const f=l[h];f.kind===wh.Separator?u.push({type:"separator",label:f.label}):(f.tooltip&&T(this.y,"quickPickItemTooltip"),u.push({handle:h,label:f.label,iconPathDto:yo.from(f.iconPath),description:f.description,detail:f.detail,picked:f.picked,alwaysShow:f.alwaysShow,tooltip:pe.fromStrict(f.tooltip),resourceUri:f.resourceUri,buttons:f.buttons?.map((p,g)=>({iconPathDto:yo.from(p.iconPath),tooltip:p.tooltip,handle:g}))}))}this.A({items:u})}get canSelectMany(){return this.F}set canSelectMany(l){this.F=l,this.A({canSelectMany:l})}get matchOnDescription(){return this.G}set matchOnDescription(l){this.G=l,this.A({matchOnDescription:l})}get matchOnDetail(){return this.H}set matchOnDetail(l){this.H=l,this.A({matchOnDetail:l})}get sortByLabel(){return this.I}set sortByLabel(l){this.I=l,this.A({sortByLabel:l})}get keepScrollPosition(){return this.J}set keepScrollPosition(l){this.J=l,this.A({keepScrollPosition:l})}get prompt(){return this.L}set prompt(l){this.L=l,this.A({prompt:l})}get activeItems(){return this.K}set activeItems(l){this.K=l.filter(u=>this.E.has(u)),this.A({activeItems:this.K.map(u=>this.E.get(u))})}get selectedItems(){return this.N}set selectedItems(l){this.N=l.filter(u=>this.E.has(u)),this.A({selectedItems:this.N.map(u=>this.E.get(u))})}_fireDidChangeActive(l){const u=gt(l.map(h=>this.D.get(h)));this.K=u,this.M.fire(u)}_fireDidChangeSelection(l){const u=gt(l.map(h=>this.D.get(h)));this.N=u,this.O.fire(u)}_fireDidTriggerItemButton(l,u){const h=this.D.get(l);if(!h||!h.buttons||!h.buttons.length)return;const f=h.buttons[u];f&&this.P.fire({button:f,item:h})}}class a extends n{constructor(l,u){super(l,u),this.C=!1,this.A({type:"inputBox"})}get password(){return this.C}set password(l){this.C=l,this.A({password:l})}get prompt(){return this.D}set prompt(l){this.D=l,this.A({prompt:l})}get validationMessage(){return this.E}set validationMessage(l){this.E=l,l?typeof l=="string"?this.A({validationMessage:l,severity:Lt.Error}):this.A({validationMessage:l.message,severity:l.severity??Lt.Error}):this.A({validationMessage:void 0,severity:Lt.Ignore})}}return new r(t,i)}function qT(e){return e instanceof y}function OY(e,t){return e.scheme===V.file&&t.scheme===V.file&&$t?e.toString()===t.toString():e.toString().toLowerCase()===t.toString().toLowerCase()}function HS(e){if(e)return typeof e.iconPath=="string"?y.file(e.iconPath):y.isUri(e.iconPath)||Dt.isThemeIcon(e.iconPath)?e.iconPath:void 0}function Hr(e){if(e){if(y.isUri(e))return e;if(Dt.isThemeIcon(e))return e;{const t=e;return{light:t.light,dark:t.dark}}}else return}function GT(e){const t=Hr(e.authorIcon),i=Array.isArray(e.tooltip)?pe.fromMany(e.tooltip):e.tooltip?pe.from(e.tooltip):void 0,s=e.references?.map(r=>({...r,icon:Hr(r.icon)}));return{...e,authorIcon:t,references:s,tooltip:i}}function WS(e){return e?{...e,icon:Hr(e.icon)}:void 0}function BS(e,t){if(!e.iconPath&&!t.iconPath)return 0;if(e.iconPath){if(!t.iconPath)return 1}else return-1;const i=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id,s=typeof t.iconPath=="string"?t.iconPath:y.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;return i1(i,s)}function FY(e,t){let i=0;if(e.strikeThrough!==t.strikeThrough)return e.strikeThrough?1:-1;if(e.faded!==t.faded)return e.faded?1:-1;if(e.tooltip!==t.tooltip)return(e.tooltip||"").localeCompare(t.tooltip||"");if(i=BS(e,t),i!==0)return i;if(e.light&&t.light)i=BS(e.light,t.light);else{if(e.light)return 1;if(t.light)return-1}if(i!==0)return i;if(e.dark&&t.dark)i=BS(e.dark,t.dark);else{if(e.dark)return 1;if(t.dark)return-1}return i}function UY(e,t){if(e.command!==t.command)return e.command<t.command?-1:1;if(e.title!==t.title)return e.title<t.title?-1:1;if(e.tooltip!==t.tooltip){if(e.tooltip!==void 0&&t.tooltip!==void 0)return e.tooltip<t.tooltip?-1:1;if(e.tooltip!==void 0)return 1;if(t.tooltip!==void 0)return-1}if(e.arguments===t.arguments)return 0;if(e.arguments)if(t.arguments){if(e.arguments.length!==t.arguments.length)return e.arguments.length-t.arguments.length}else return 1;else return-1;for(let i=0;i<e.arguments.length;i++){const s=e.arguments[i],r=t.arguments[i];if(s!==r&&!(qT(s)&&qT(r)&&OY(s,r)))return s<r?-1:1}return 0}function JT(e,t){let i=i1(e.resourceUri.fsPath,t.resourceUri.fsPath,!0);if(i!==0)return i;if(e.command&&t.command)i=UY(e.command,t.command);else{if(e.command)return 1;if(t.command)return-1}if(i!==0)return i;if(e.decorations&&t.decorations)i=FY(e.decorations,t.decorations);else{if(e.decorations)return 1;if(t.decorations)return-1}if(i!==0)return i;if(e.multiFileDiffEditorModifiedUri&&t.multiFileDiffEditorModifiedUri)i=i1(e.multiFileDiffEditorModifiedUri.fsPath,t.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(e.multiFileDiffEditorModifiedUri)return 1;if(t.multiFileDiffEditorModifiedUri)return-1}if(i!==0)return i;if(e.multiDiffEditorOriginalUri&&t.multiDiffEditorOriginalUri)i=i1(e.multiDiffEditorOriginalUri.fsPath,t.multiDiffEditorOriginalUri.fsPath,!0);else{if(e.multiDiffEditorOriginalUri)return 1;if(t.multiDiffEditorOriginalUri)return-1}return i}function jY(e,t){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function zY(e,t){return e.command===t.command&&e.title===t.title&&e.tooltip===t.tooltip&&(e.arguments&&t.arguments?jY(e.arguments,t.arguments):e.arguments===t.arguments)}function HY(e,t){return Ci(e,t,zY)}var WY=class{#e;#t;get value(){return this.d}set value(e){e=e??"",this.#e.$setInputBoxValue(this.m,e),this.o(e)}get onDidChange(){return this.f.event}get placeholder(){return this.g}set placeholder(e){this.#e.$setInputBoxPlaceholder(this.m,e),this.g=e}get validateInput(){return T(this.l,"scmValidation"),this.h}set validateInput(e){if(T(this.l,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this.l.identifier.value}]: Invalid SCM input box validation function`);this.h=e,this.#e.$setValidationProviderIsEnabled(this.m,!!e)}get enabled(){return this.j}set enabled(e){e=!!e,this.j!==e&&(this.j=e,this.#e.$setInputBoxEnablement(this.m,e))}get visible(){return this.k}set visible(e){e=!!e,this.k!==e&&(this.k=e,this.#e.$setInputBoxVisibility(this.m,e))}get document(){return T(this.l,"scmTextDocument"),this.#t.getDocument(this.n)}constructor(e,t,i,s,r){this.l=e,this.m=s,this.n=r,this.d="",this.f=new I,this.g="",this.j=!0,this.k=!0,this.#t=t,this.#e=i}showValidationMessage(e,t){T(this.l,"scmValidation"),this.#e.$showValidationMessage(this.m,e,Wy.from(t))}$onInputBoxValueChange(e){this.o(e)}o(e){this.d=e,this.f.fire(e)}},BY=class aL{static{this.d=0}get disposed(){return this.m}get id(){return this.x}get label(){return this.y}set label(t){this.y=t,this.u.$updateGroupLabel(this.w,this.handle,t)}get contextValue(){return this.q}set contextValue(t){this.q=t,this.u.$updateGroup(this.w,this.handle,this.features)}get hideWhenEmpty(){return this.t}set hideWhenEmpty(t){this.t=t,this.u.$updateGroup(this.w,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this.g]}set resourceStates(t){this.g=[...t],this.l.fire()}constructor(t,i,s,r,n,o,a){this.u=t,this.v=i,this.w=s,this.x=r,this.y=n,this.multiDiffEditorEnableViewChanges=o,this.z=a,this.f=0,this.g=[],this.h=new Map,this.j=new Map,this.k=new Map,this.l=new I,this.onDidUpdateResourceStates=this.l.event,this.m=!1,this.n=new I,this.onDidDispose=this.n.event,this.o=[],this.p=[],this.q=void 0,this.t=void 0,this.handle=aL.d++}getResourceState(t){return this.h.get(t)}$executeResourceCommand(t,i){const s=this.j.get(t);return s?fi(()=>this.v.executeCommand(s.command,...s.arguments||[],i)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){const t=[...this.g].sort(JT),s=tE(this.p,t,JT).map(o=>{const a=o.toInsert.map(c=>{const l=this.f++;this.h.set(l,c);const u=c.resourceUri;let h;if(c.command)if(c.command.command==="vscode.open"||c.command.command==="vscode.diff"||c.command.command==="vscode.changes"){const B=new ie;h=this.v.converter.toInternal(c.command,B),this.k.set(l,B)}else this.j.set(l,c.command);const f=et(this.z,"scmMultiDiffEditor"),p=f?c.multiDiffEditorOriginalUri:void 0,g=f?c.multiFileDiffEditorModifiedUri:void 0,v=HS(c.decorations),b=c.decorations&&HS(c.decorations.light)||v,S=c.decorations&&HS(c.decorations.dark)||v,E=[b,S],k=c.decorations&&c.decorations.tooltip||"",j=c.decorations&&!!c.decorations.strikeThrough,O=c.decorations&&!!c.decorations.faded,Q=c.contextValue||"";return{rawResource:[l,u,E,k,j,O,Q,h,p,g],handle:l}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}}),r=s.map(({start:o,deleteCount:a,toInsert:c})=>[o,a,c.map(l=>l.rawResource)]),n=s.reverse();for(const{start:o,deleteCount:a,toInsert:c}of n){const l=c.map(h=>h.handle),u=this.o.splice(o,a,...l);for(const h of u)this.h.delete(h),this.j.delete(h),this.k.get(h)?.dispose(),this.k.delete(h)}return this.p=t,r}dispose(){this.m=!0,this.n.fire()}},_S=class cL{static{this.d=0}#e;get id(){return this.F}get label(){return this.G}get rootUri(){return this.H}get contextValue(){return T(this.D,"scmProviderOptions"),this.h}set contextValue(t){T(this.D,"scmProviderOptions"),this.h!==t&&(this.h=t,this.#e.$updateSourceControl(this.handle,{contextValue:t}))}get inputBox(){return this.j}get count(){return this.k}set count(t){this.k!==t&&(this.k=t,this.#e.$updateSourceControl(this.handle,{count:t}))}get quickDiffProvider(){return this.l}set quickDiffProvider(t){this.l=t;let i;et(this.D,"quickDiffProvider")&&(i=t?.label),this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!t,quickDiffLabel:i})}get secondaryQuickDiffProvider(){return T(this.D,"quickDiffProvider"),this.m}set secondaryQuickDiffProvider(t){T(this.D,"quickDiffProvider"),this.m=t;const i=t?.label;this.#e.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!t,secondaryQuickDiffLabel:i})}get historyProvider(){return T(this.D,"scmHistoryProvider"),this.n}set historyProvider(t){T(this.D,"scmHistoryProvider"),this.n=t,this.o.value=new ie,this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!t}),t&&(this.o.value.add(t.onDidChangeCurrentHistoryItemRefs(()=>{const i=WS(t?.currentHistoryItemRef),s=WS(t?.currentHistoryItemRemoteRef),r=WS(t?.currentHistoryItemBaseRef);this.#e.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,i,s,r)})),this.o.value.add(t.onDidChangeHistoryItemRefs(i=>{if(i.added.length===0&&i.modified.length===0&&i.removed.length===0)return;const s=i.added.map(o=>({...o,icon:Hr(o.icon)})),r=i.modified.map(o=>({...o,icon:Hr(o.icon)})),n=i.removed.map(o=>({...o,icon:Hr(o.icon)}));this.#e.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:s,modified:r,removed:n,silent:i.silent})})))}get artifactProvider(){return T(this.D,"scmArtifactProvider"),this.p}set artifactProvider(t){T(this.D,"scmArtifactProvider"),this.p=t,this.q.value=new ie,this.#e.$updateSourceControl(this.handle,{hasArtifactProvider:!!t}),t&&this.q.value.add(t.onDidChangeArtifacts(i=>{i.length!==0&&this.#e.$onDidChangeArtifacts(this.handle,i)}))}get commitTemplate(){return this.t}set commitTemplate(t){t!==this.t&&(this.t=t,this.#e.$updateSourceControl(this.handle,{commitTemplate:t}))}get acceptInputCommand(){return this.v}set acceptInputCommand(t){this.u.value=new ie,this.v=t;const i=this.E.converter.toInternal(t,this.u.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:i})}get actionButton(){return T(this.D,"scmActionButton"),this.x}set actionButton(t){if(T(this.D,"scmActionButton"),Fu(this.x,t))return;const i=this.w;this.w=new ie,this.x=t;const s=t!==void 0?{command:{...this.E.converter.toInternal(t.command,this.w),shortTitle:t.command.shortTitle},secondaryCommands:t.secondaryCommands?.map(r=>r.map(n=>this.E.converter.toInternal(n,this.w))),enabled:t.enabled}:null;this.#e.$updateSourceControl(this.handle,{actionButton:s}).finally(()=>i.dispose())}get statusBarCommands(){return this.z}set statusBarCommands(t){if(this.z&&t&&HY(this.z,t))return;const i=this.y;this.y=new ie,this.z=t;const s=(t||[]).map(r=>this.E.converter.toInternal(r,this.y));this.#e.$updateSourceControl(this.handle,{statusBarCommands:s}).finally(()=>i.dispose())}get selected(){return this.A}constructor(t,i,s,r,n,o,a,c,l,u){this.D=t,this.E=r,this.F=n,this.G=o,this.H=a,this.f=new I,this.onDidDispose=this.f.event,this.g=new Map,this.h=void 0,this.k=void 0,this.l=void 0,this.m=void 0,this.o=new Vs,this.q=new Vs,this.t=void 0,this.u=new Vs,this.v=void 0,this.w=new ie,this.y=new ie,this.z=void 0,this.A=!1,this.B=new I,this.onDidChangeSelection=this.B.event,this.C=new Fo,this.handle=cL.d++,this.I=new Map,this.J=new Set,this.#e=s;const h=y.from({scheme:V.vscodeSourceControl,path:`${n}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this.j=new WY(t,i,this.#e,this.handle,h),this.#e.$registerSourceControl(this.handle,u?.handle,n,o,a,Hr(c),l,h),this.onDidDisposeParent=u?u.onDidDispose:Ie.None}createResourceGroup(t,i,s){const r=et(this.D,"scmMultiDiffEditor")&&s?.multiDiffEditorEnableViewChanges===!0,n=new BY(this.#e,this.E,this.handle,t,i,r,this.D),o=Ie.once(n.onDidDispose)(()=>this.I.delete(n));return this.I.set(n,o),this.eventuallyAddResourceGroups(),n}eventuallyAddResourceGroups(){const t=[],i=[];for(const[s,r]of this.I){r.dispose();const n=s.onDidUpdateResourceStates(()=>{this.J.add(s),this.eventuallyUpdateResourceStates()});Ie.once(s.onDidDispose)(()=>{this.J.delete(s),n.dispose(),this.g.delete(s.handle),this.#e.$unregisterGroup(this.handle,s.handle)}),t.push([s.handle,s.id,s.label,s.features,s.multiDiffEditorEnableViewChanges]);const o=s._takeResourceStateSnapshot();o.length>0&&i.push([s.handle,o]),this.g.set(s.handle,s)}this.#e.$registerGroups(this.handle,t,i),this.I.clear()}eventuallyUpdateResourceStates(){const t=[];this.J.forEach(i=>{const s=i._takeResourceStateSnapshot();s.length!==0&&t.push([i.handle,s])}),t.length>0&&this.#e.$spliceResourceStates(this.handle,t),this.J.clear()}getResourceGroup(t){return this.g.get(t)}setSelectionState(t){this.A=t,this.B.fire(t)}async provideArtifacts(t,i){const s=new ie,n=(await this.artifactProvider?.provideArtifacts(t,i))?.map(o=>({...o,icon:Hr(o.icon),command:o.command?this.E.converter.toInternal(o.command,s):void 0}));return this.C.get(t)?.dispose(),this.C.set(t,s),n}dispose(){this.u.dispose(),this.w.dispose(),this.y.dispose(),this.o.dispose(),this.q.dispose(),this.C.dispose(),this.g.forEach(t=>t.dispose()),this.#e.$unregisterSourceControl(this.handle),this.f.fire(),this.f.dispose()}};__decorate([Cf(100)],_S.prototype,"eventuallyAddResourceGroups",null),__decorate([Cf(100)],_S.prototype,"eventuallyUpdateResourceStates",null);var VS=class{get onDidChangeActiveProvider(){return this.j.event}constructor(t,i,s,r){this.l=i,this.m=s,this.n=r,this.g=new Map,this.h=new qn,this.j=new I,this.d=t.getProxy(Y.MainThreadSCM),this.f=t.getProxy(Y.MainThreadTelemetry),i.registerArgumentProcessor({processArgument:n=>{if(n&&n.$mid===3){const o=this.g.get(n.sourceControlHandle);if(!o)return n;const a=o.getResourceGroup(n.groupHandle);return a?a.getResourceState(n.handle):n}else if(n&&n.$mid===4){const o=this.g.get(n.sourceControlHandle);return o?o.getResourceGroup(n.groupHandle):n}else if(n&&n.$mid===5){const o=this.g.get(n.handle);return o||n}return n}})}createSourceControl(t,i,s,r,n,o,a){this.n.trace("ExtHostSCM#createSourceControl",t.identifier.value,i,s,r),this.f.$publicLog2("api/scm/createSourceControl",{extensionId:t.identifier.value});const c=a?Bt.find(this.g.values(),h=>h===a):void 0,l=new _S(t,this.m,this.d,this.l,i,s,r,n,o,c);this.g.set(l.handle,l);const u=this.h.get(t.identifier)||[];return u.push(l),this.h.set(t.identifier,u),l}getLastInputBox(t){this.n.trace("ExtHostSCM#getLastInputBox",t.identifier.value);const i=this.h.get(t.identifier),s=i&&i[i.length-1];return s&&s.inputBox}$provideOriginalResource(t,i,s){const r=y.revive(i);this.n.trace("ExtHostSCM#$provideOriginalResource",t,r.toString());const n=this.g.get(t);return!n||!n.quickDiffProvider||!n.quickDiffProvider.provideOriginalResource?Promise.resolve(null):fi(()=>n.quickDiffProvider.provideOriginalResource(r,s)).then(o=>o||null)}$provideSecondaryOriginalResource(t,i,s){const r=y.revive(i);this.n.trace("ExtHostSCM#$provideSecondaryOriginalResource",t,r.toString());const n=this.g.get(t);return!n||!n.secondaryQuickDiffProvider||!n.secondaryQuickDiffProvider.provideOriginalResource?Promise.resolve(null):fi(()=>n.secondaryQuickDiffProvider.provideOriginalResource(r,s)).then(o=>o||null)}$onInputBoxValueChange(t,i){this.n.trace("ExtHostSCM#$onInputBoxValueChange",t);const s=this.g.get(t);return s&&s.inputBox.$onInputBoxValueChange(i),Promise.resolve(void 0)}$executeResourceCommand(t,i,s,r){this.n.trace("ExtHostSCM#$executeResourceCommand",t,i,s);const n=this.g.get(t);if(!n)return Promise.resolve(void 0);const o=n.getResourceGroup(i);return o?o.$executeResourceCommand(s,r):Promise.resolve(void 0)}$validateInput(t,i,s){this.n.trace("ExtHostSCM#$validateInput",t);const r=this.g.get(t);return!r||!r.inputBox.validateInput?Promise.resolve(void 0):fi(()=>r.inputBox.validateInput(i,s)).then(n=>{if(!n)return Promise.resolve(void 0);const o=pe.fromStrict(n.message);return o?Promise.resolve([o,n.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(t){return this.n.trace("ExtHostSCM#$setSelectedSourceControl",t),this.k===t||(t!==void 0&&this.g.get(t)?.setSelectionState(!0),this.k!==void 0&&this.g.get(this.k)?.setSelectionState(!1),this.k=t),Promise.resolve(void 0)}async $resolveHistoryItem(t,i,s){try{const n=await this.g.get(t)?.historyProvider?.resolveHistoryItem(i,s);return n?GT(n):void 0}catch(r){this.n.error("ExtHostSCM#$resolveHistoryItem",r);return}}async $resolveHistoryItemChatContext(t,i,s){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemChatContext(i,s)??void 0}catch(r){this.n.error("ExtHostSCM#$resolveHistoryItemChatContext",r);return}}async $resolveHistoryItemChangeRangeChatContext(t,i,s,r,n){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemChangeRangeChatContext?.(i,s,r,n)??void 0}catch(o){this.n.error("ExtHostSCM#$resolveHistoryItemChangeRangeChatContext",o);return}}async $resolveHistoryItemRefsCommonAncestor(t,i,s){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemRefsCommonAncestor(i,s)??void 0}catch(r){this.n.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",r);return}}async $provideHistoryItemRefs(t,i,s){try{return(await this.g.get(t)?.historyProvider?.provideHistoryItemRefs(i,s))?.map(o=>({...o,icon:Hr(o.icon)}))??void 0}catch(r){this.n.error("ExtHostSCM#$provideHistoryItemRefs",r);return}}async $provideHistoryItems(t,i,s){try{return(await this.g.get(t)?.historyProvider?.provideHistoryItems(i,s))?.map(o=>GT(o))??void 0}catch(r){this.n.error("ExtHostSCM#$provideHistoryItems",r);return}}async $provideHistoryItemChanges(t,i,s,r){try{return await this.g.get(t)?.historyProvider?.provideHistoryItemChanges(i,s,r)??void 0}catch(n){this.n.error("ExtHostSCM#$provideHistoryItemChanges",n);return}}async $provideArtifactGroups(t,i){try{return(await this.g.get(t)?.artifactProvider?.provideArtifactGroups(i))?.map(n=>({...n,icon:Hr(n.icon)}))}catch(s){this.n.error("ExtHostSCM#$provideArtifactGroups",s);return}}async $provideArtifacts(t,i,s){try{return this.g.get(t)?.provideArtifacts(i,s)}catch(r){this.n.error("ExtHostSCM#$provideArtifacts",r);return}}};VS=__decorate([__param(3,Se)],VS);var _Y=class lL{static{this.a=0}constructor(t,i){this.d=i,this.c=new Map,this.b=t.getProxy(Y.MainThreadShare)}async $provideShare(t,i,s){return await this.c.get(t)?.provideShare({selection:U.to(i.selection),resourceUri:y.revive(i.resourceUri)},s)??void 0}registerShareProvider(t,i){const s=lL.a++;return this.c.set(s,i),this.b.$registerShareProvider(s,Ia.from(t,this.d),i.id,i.label,i.priority),{dispose:()=>{this.b.$unregisterShareProvider(s),this.c.delete(s)}}}},VY=class uL{static{this.a=1}constructor(t){this.c=new Map,this.d=new Map,this.f=new Map,this.b=t.getProxy(Y.MainThreadSpeech)}async $createSpeechToTextSession(t,i,s){const r=this.c.get(t);if(!r)return;const n=new ie,o=new Qe;this.d.set(i,o);const a=await r.provideSpeechToTextSession(o.token,s?{language:s}:void 0);a&&(n.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.b.$emitSpeechToTextEvent(i,c)})),n.add(o.token.onCancellationRequested(()=>n.dispose())))}async $cancelSpeechToTextSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t)}async $createTextToSpeechSession(t,i,s){const r=this.c.get(t);if(!r)return;const n=new ie,o=new Qe;this.d.set(i,o);const a=await r.provideTextToSpeechSession(o.token,s?{language:s}:void 0);a&&(this.f.set(i,a),n.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.b.$emitTextToSpeechEvent(i,c)})),n.add(o.token.onCancellationRequested(()=>n.dispose())))}async $synthesizeSpeech(t,i){this.f.get(t)?.synthesize(i)}async $cancelTextToSpeechSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t),this.f.delete(t)}async $createKeywordRecognitionSession(t,i){const s=this.c.get(t);if(!s)return;const r=new ie,n=new Qe;this.d.set(i,n);const o=await s.provideKeywordRecognitionSession(n.token);o&&(r.add(o.onDidChange(a=>{n.token.isCancellationRequested||this.b.$emitKeywordRecognitionEvent(i,a)})),r.add(n.token.onCancellationRequested(()=>r.dispose())))}async $cancelKeywordRecognitionSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t)}registerProvider(t,i,s){const r=uL.a++;return this.c.set(r,s),this.b.$registerProvider(r,i,{extension:t,displayName:t.value}),te(()=>{this.b.$unregisterProvider(r),this.c.delete(r)})}},qY=class dv{static{this.a=0}static{this.b=new Map([["statusBarItem.errorBackground",new ch("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new ch("statusBarItem.warningForeground")]])}#e;#t;constructor(t,i,s,r,n,o=uo.Left,a,c){if(this.v=c,this.i=!1,this.k="",this.r=new ie,this.#e=t,this.#t=i,n&&r){this.c=iB(r.identifier,n);const l=s.get(this.c);l&&(o=l.alignLeft?uo.Left:uo.Right,a=l.priority,this.j=!0,this.name=l.name,this.text=l.text,this.tooltip=l.tooltip,this.command=l.command,this.accessibilityInformation=l.accessibilityInformation)}else this.c=String(dv.a++);this.e=r,this.f=n,this.g=o,this.h=this.w(a)}w(t){if(Cs(t))return t===Number.POSITIVE_INFINITY?Number.MAX_VALUE:t===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t}get id(){return this.f??this.e.identifier.value}get entryId(){return this.c}get alignment(){return this.g}get priority(){return this.h}get text(){return this.k}get name(){return this.n}get tooltip(){return this.l}get tooltip2(){return this.e&&T(this.e,"statusBarItemTooltip"),this.m}get color(){return this.o}get backgroundColor(){return this.p}get command(){return this.s?.fromApi}get accessibilityInformation(){return this.u}set text(t){this.k=t,this.x()}set name(t){this.n=t,this.x()}set tooltip(t){this.l=t,this.x()}set tooltip2(t){this.e&&T(this.e,"statusBarItemTooltip"),this.m=t,this.x()}set color(t){this.o=t,this.x()}set backgroundColor(t){t&&!dv.b.has(t.id)&&(t=void 0),this.p=t,this.x()}set command(t){this.s?.fromApi!==t&&(this.q&&this.r.add(this.q),this.q=new ie,typeof t=="string"?this.s={fromApi:t,internal:this.#t.toInternal({title:"",command:t},this.q)}:t?this.s={fromApi:t,internal:this.#t.toInternal(t,this.q)}:this.s=void 0,this.x())}set accessibilityInformation(t){this.u=t,this.x()}show(){this.j=!0,this.x()}hide(){clearTimeout(this.t),this.j=!1,this.#e.$disposeEntry(this.c)}x(){this.i||!this.j||(clearTimeout(this.t),this.t=setTimeout(()=>{this.t=void 0;let t;this.e?this.f?t=`${this.e.identifier.value}.${this.f}`:t=this.e.identifier.value:t=this.f;let i;this.n?i=this.n:i=d(3047,null,this.e.displayName||this.e.name);let s=this.o;this.p&&(s=dv.b.get(this.p.id));let r,n;typeof this.m=="function"?(r=pe.fromStrict(this.l),n=!0):(r=pe.fromStrict(this.m??this.l),n=!1),this.#e.$setEntry(this.c,t,this.e?.identifier.value,i,this.k,r,n,this.s?.internal,s,this.p,this.g===uo.Left,this.h,this.u),this.r.clear()},0))}dispose(){this.hide(),this.v?.(),this.i=!0}},GY=class{constructor(e){this.b=[],this.a=e.createStatusBarEntry(void 0,"status.extensionMessage",uo.Left,Number.MIN_VALUE),this.a.name=d(3048,null)}dispose(){this.b.length=0,this.a.dispose()}setMessage(e){const t={message:e};return this.b.unshift(t),this.c(),new Ce(()=>{const i=this.b.indexOf(t);i>=0&&(this.b.splice(i,1),this.c())})}c(){this.b.length>0?(this.a.text=this.b[0].message,this.a.show()):this.a.hide()}},JY=class{constructor(e,t){this.e=new Map,this.f=new Map,this.a=e.getProxy(Y.MainThreadStatusBar),this.b=t,this.c=new GY(this)}$acceptStaticEntries(e){for(const t of e)this.f.set(t.entryId,t)}async $provideTooltip(e,t){const i=this.e.get(e);if(!i)return;const s=typeof i.tooltip2=="function"?await i.tooltip2(t):i.tooltip2;return t.isCancellationRequested?void 0:pe.fromStrict(s)}createStatusBarEntry(e,t,i,s){const r=new qY(this.a,this.b,this.f,e,t,i,s,()=>this.e.delete(r.entryId));return this.e.set(r.entryId,r),r}setStatusBarMessage(e,t){const i=this.c.setMessage(e);let s;return typeof t=="number"?s=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new Ce(()=>{i.dispose(),clearTimeout(s)})}},ZY=class extends Z{constructor(e,t){super(),this.n=t,this.a=new I,this.b=new I,this.c=new I,this.f=new I,this.g=new I,this.h=new I,this.j=new I,this.onDidChangeTextEditorSelection=this.a.event,this.onDidChangeTextEditorOptions=this.b.event,this.onDidChangeTextEditorVisibleRanges=this.c.event,this.onDidChangeTextEditorViewColumn=this.f.event,this.onDidChangeTextEditorDiffInformation=this.g.event,this.onDidChangeActiveTextEditor=this.h.event,this.onDidChangeVisibleTextEditors=this.j.event,this.m=e.getProxy(Y.MainThreadTextEditors),this.D(this.n.onDidChangeVisibleTextEditors(i=>this.j.fire(i))),this.D(this.n.onDidChangeActiveTextEditor(i=>this.h.fire(i)))}getActiveTextEditor(){return this.n.activeEditor()}getVisibleTextEditors(e){const t=this.n.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let s;typeof t=="number"?s={position:Kt.from(t),preserveFocus:i}:typeof t=="object"?s={position:Kt.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?U.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:s={preserveFocus:!1};const r=await this.m.$tryShowTextDocument(e.uri,s),n=r&&this.n.getEditor(r);if(n)return n.value;throw r?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new XV(this.m,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this.n.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const s=t.selections.selections.map(or.to);i._acceptSelections(s)}if(t.visibleRanges){const s=gt(t.visibleRanges.map(U.to));i._acceptVisibleRanges(s)}if(t.options&&this.b.fire({textEditor:i.value,options:{...t.options,lineNumbers:ul.to(t.options.lineNumbers)}}),t.selections){const s=Hc.fromValue(t.selections.source),r=t.selections.selections.map(or.to);this.a.fire({textEditor:i.value,selections:r,kind:s})}if(t.visibleRanges){const s=gt(t.visibleRanges.map(U.to));this.c.fire({textEditor:i.value,visibleRanges:s})}}$acceptEditorPositionData(e){for(const t in e){const i=this.n.getEditor(t);if(!i)throw new Error("Unknown text editor");const s=Kt.to(e[t]);i.value.viewColumn!==s&&(i._acceptViewColumn(s),this.f.fire({textEditor:i.value,viewColumn:s}))}}$acceptEditorDiffInformation(e,t){const i=this.n.getEditor(e);if(!i)throw new Error("unknown text editor");if(!t){i._acceptDiffInformation(void 0),this.g.fire({textEditor:i.value,diffInformation:void 0});return}const s=this,r=t.map(n=>{const o=y.revive(n.original),a=y.revive(n.modified),c=n.changes.map(l=>{const[u,h,f,p]=l;let g;return u===h?g=Wc.Addition:f===p?g=Wc.Deletion:g=Wc.Modification,{original:{startLineNumber:u,endLineNumberExclusive:h},modified:{startLineNumber:f,endLineNumberExclusive:p},kind:g}});return Object.freeze({documentVersion:n.documentVersion,original:o,modified:a,changes:c,get isStale(){return s.n.getDocument(a)?.version!==n.documentVersion}})});i._acceptDiffInformation(r),this.g.fire({textEditor:i.value,diffInformation:r})}getDiffInformation(e){return Promise.resolve(this.m.$getDiffInformation(e))}},qS=class{constructor(t){this.a=new eg(go.Dark),this.b=new I}get activeColorTheme(){return this.a}$onColorThemeChange(t){let i;switch(t){case"light":i=go.Light;break;case"hcDark":i=go.HighContrast;break;case"hcLight":i=go.HighContrastLight;break;default:i=go.Dark}this.a=new eg(i),this.b.fire(this.a)}get onDidChangeActiveColorTheme(){return this.b.event}};qS=__decorate([__param(0,ke)],qS);var cue=H("IExtHostTimeline"),QY=class{constructor(e,t){this.b=new Map,this.c=new Map,this.a=e.getProxy(Y.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,s)=>{if(i&&i.$mid===12)if(this.b.get(i.source)&&s&&et(s,"timeline")){const r=i.uri===void 0?void 0:y.revive(i.uri);return this.c.get(i.source)?.get(ZT(r))?.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,s){return this.b.get(e)?.provider.provideTimeline(y.revive(t),i,s)}registerTimelineProvider(e,t,i,s){const r=new ie,n=this.d(t.id,s,r).bind(this);let o;t.onDidChange&&(o=t.onDidChange(c=>this.a.$emitTimelineChangeEvent({uri:void 0,reset:!0,...c,id:t.id}),this));const a=this.c;return this.f({...t,scheme:e,onDidChange:void 0,async provideTimeline(c,l,u){l?.resetCache&&(r.clear(),a.get(t.id)?.clear());const h=await t.provideTimeline(c,l,u);if(h==null)return;const f=n(c,l);return{...h,source:t.id,items:h.items.map(f)}},dispose(){for(const c of a.values())c.get(t.id)?.clear();o?.dispose(),r.dispose()}},i)}d(e,t,i){return(s,r)=>{let n;if(r?.cacheResults){let o=this.c.get(e);o===void 0&&(o=new Map,this.c.set(e,o));const a=ZT(s);n=o.get(a),n===void 0&&(n=new Map,o.set(a,n))}return o=>{const{iconPath:a,...c}=o,l=`${e}|${o.id??o.timestamp}`;n?.set(l,o);let u,h,f;o.iconPath&&(a instanceof Ti?f={id:a.id,color:a.color}:y.isUri(a)?(u=a,h=a):{light:u,dark:h}=a);let p;return Hi.isMarkdownString(c.tooltip)?p=pe.from(c.tooltip):Oe(c.tooltip)?p=c.tooltip:Hi.isMarkdownString(c.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=pe.from(c.detail)):Oe(c.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=c.detail),{...c,id:c.id??void 0,handle:l,source:e,command:o.command?t.toInternal(o.command,i):void 0,icon:u,iconDark:h,themeIcon:f,tooltip:p,accessibilityInformation:o.accessibilityInformation}}}}f(e,t){if(this.b.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this.a.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this.b.set(e.id,{provider:e,extension:t}),te(()=>{for(const s of this.c.values())s.get(e.id)?.clear();this.b.delete(e.id),this.a.$unregisterTimelineProvider(e.id),e.dispose()})}};function ZT(e){return e?.toString()}var lue=d(4651,null),uue=rd("default-view-icon",oe.window,d(4652,null)),j1;(function(e){e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"})(j1||(j1={}));var QT;(function(e){e[e.Sidebar=0]="Sidebar",e[e.Panel=1]="Panel",e[e.AuxiliaryBar=2]="AuxiliaryBar"})(QT||(QT={}));var YY=class extends Z{constructor(){super(...arguments),this.c=this.D(new I),this.onDidRegister=this.c.event,this.f=this.D(new I),this.onDidDeregister=this.f.event,this.g=new Map,this.h=[]}get all(){return[...this.g.values()].flat()}registerViewContainer(e,t,i){const s=this.get(e.id);if(s)return s;const r=e;return r.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id},oR(this.g,t,[]).push(r),i?.isDefault&&this.h.push(r),this.c.fire({viewContainer:r,viewContainerLocation:t}),r}deregisterViewContainer(e){for(const t of this.g.keys()){const i=this.g.get(t),s=i?.indexOf(e);if(s!==-1){i?.splice(s,1),i.length===0&&this.g.delete(t),this.f.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.g.get(e)||[]]}getViewContainerLocation(e){return[...this.g.keys()].filter(t=>this.getViewContainers(t).filter(i=>i?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.h.find(t=>this.getViewContainerLocation(t)===e)}};Qt.add(j1.ViewContainersRegistry,new YY);var z1;(function(e){e.Open="2_open",e.Debug="4_debug",e.SCM="5_scm",e.More="9_more"})(z1||(z1={}));function XY(e,t){const i=e.group??z1.More,s=t.group??z1.More;return i!==s?i.localeCompare(s):(e.order??5)-(t.order??5)}var KY=class extends Z{constructor(){super(...arguments),this.c=this.D(new I),this.onViewsRegistered=this.c.event,this.f=this.D(new I),this.onViewsDeregistered=this.f.event,this.g=this.D(new I),this.onDidChangeContainer=this.g.event,this.h=this.D(new I),this.onDidChangeViewWelcomeContent=this.h.event,this.j=[],this.m=new Map,this.n=new cE}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.q(t,i)),this.c.fire(e)}deregisterViews(e,t){const i=this.r(e,t);i.length&&this.f.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this.m.keys())if(i!==t){const s=this.r(e,i);s.length&&(this.q(s,t),this.g.fire({views:s,from:i,to:t}))}}getViews(e){return this.m.get(e)||[]}getView(e){for(const t of this.j){const i=(this.m.get(t)||[]).filter(s=>s.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this.j)if((this.m.get(t)||[]).filter(s=>s.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this.n.add(e,t),this.h.fire(e),te(()=>{this.n.delete(e,t),this.h.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[s,r]of t)this.n.add(e,r),i.set(s,te(()=>{this.n.delete(e,r),this.h.fire(e)}));return this.h.fire(e),i}getViewWelcomeContent(e){const t=[];return this.n.forEach(e,i=>t.push(i)),t.sort(XY)}q(e,t){let i=this.m.get(t);i||(i=[],this.m.set(t,i),this.j.push(t));for(const s of e){if(this.getView(s.id)!==null)throw new Error(d(4653,null,s.id));i.push(s)}}r(e,t){const i=this.m.get(t);if(!i)return[];const s=[],r=[];for(const n of i)e.includes(n)?s.push(n):r.push(n);return s.length&&(r.length?this.m.set(t,r):(this.m.delete(t),this.j.splice(this.j.indexOf(t),1))),s}};Qt.add(j1.ViewsRegistry,new KY);var hue=H("viewDescriptorService"),YT;(function(e){e[e.Default=0]="Default",e[e.Expand=1]="Expand"})(YT||(YT={}));var XT;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(XT||(XT={}));var En=class extends Error{constructor(e){super(d(4654,null,e)),this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}},eX=class{constructor(){this.a=new Map}removeDragOperationTransfer(e){if(e&&this.a.has(e)){const t=this.a.get(e);return this.a.delete(e),t}}addDragOperationTransfer(e,t){this.a.set(e,t)}};function KT(e,t){if(Oe(e))return{label:e};if(e&&typeof e=="object"&&e.label){let i;if(Array.isArray(e.highlights)&&(i=e.highlights.filter(s=>s.length===2&&typeof s[0]=="number"&&typeof s[1]=="number"),i=i.length?i:void 0),Oe(e.label))return{label:e.label,highlights:i};if(Hi.isMarkdownString(e.label))return T(t,"treeItemMarkdownLabel"),{label:pe.from(e.label),highlights:i}}}var tX=class extends Z{constructor(e,t,i){super(),this.f=e,this.g=t,this.h=i,this.a=new Map,this.b=new eX;function s(r){return r&&r.$treeViewId&&(r.$treeItemHandle||r.$selectedTreeItems||r.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:r=>s(r)?this.q(r):Array.isArray(r)&&r.length>0?r.map(n=>s(n)?this.q(n):n):r})}registerTreeDataProvider(e,t,i){const s=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>s.dispose()}}createTreeView(e,t,i){if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const s=t.dragAndDropController?.dropMimeTypes??[],r=t.dragAndDropController?.dragMimeTypes??[],n=!!t.dragAndDropController?.handleDrag,o=!!t.dragAndDropController?.handleDrop,a=this.m(e,t,i),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:s,dragMimeTypes:r,hasHandleDrag:n,hasHandleDrop:o,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},l=this.f.$registerTreeViewDataProvider(e,c),u={get onDidCollapseElement(){return a.onDidCollapseElement},get onDidExpandElement(){return a.onDidExpandElement},get selection(){return a.selectedElements},get onDidChangeSelection(){return a.onDidChangeSelection},get activeItem(){return T(i,"treeViewActiveItem"),a.focusedElement},get onDidChangeActiveItem(){return T(i,"treeViewActiveItem"),a.onDidChangeActiveItem},get visible(){return a.visible},get onDidChangeVisibility(){return a.onDidChangeVisibility},get onDidChangeCheckboxState(){return a.onDidChangeCheckboxState},get message(){return a.message},set message(h){Yn(h)&&T(i,"treeViewMarkdownMessage"),a.message=h},get title(){return a.title},set title(h){a.title=h},get description(){return a.description},set description(h){a.description=h},get badge(){return a.badge},set badge(h){h!==void 0&&ub.isViewBadge(h)?a.badge={value:Math.floor(Math.abs(h.value)),tooltip:h.tooltip}:h===void 0&&(a.badge=void 0)},reveal:(h,f)=>a.reveal(h,f),dispose:async()=>{await l,this.a.delete(e),a.dispose()}};return this.D(u),u}async $getChildren(e,t){const i=this.a.get(e);if(!i)return Promise.reject(new En(e));if(!t){const r=await i.getChildren();return r?[[0,...r]]:void 0}const s=[];for(let r=0;r<t.length;r++){const n=t[r],o=await i.getChildren(n);o&&s.push([r,...o])}return s}async $handleDrop(e,t,i,s,r,n,o,a){const c=this.a.get(e);if(!c)return Promise.reject(new En(e));const l=vl.toDataTransfer(i,async u=>(await this.f.$resolveDropFileData(e,t,u)).buffer);return o===e&&a&&await this.j(l,c,a,r,n),c.onDrop(l,s,r)}async j(e,t,i,s,r){const n=this.b.removeDragOperationTransfer(r);if(n)(await n)?.forEach((o,a)=>{o&&e.set(a,o)});else if(r&&t.handleDrag){const o=t.handleDrag(i,e,s);this.b.addDragOperationTransfer(r,o),await o}return e}async $handleDrag(e,t,i,s){const r=this.a.get(e);if(!r)return Promise.reject(new En(e));const n=await this.j(new Gc,r,t,s,i);if(!(!n||s.isCancellationRequested))return vl.from(n)}async $hasResolve(e){const t=this.a.get(e);if(!t)throw new En(e);return t.hasResolve}$resolve(e,t,i){const s=this.a.get(e);if(!s)throw new En(e);return s.resolveTreeItem(t,i)}$setExpanded(e,t,i){const s=this.a.get(e);if(!s)throw new En(e);s.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const s=this.a.get(e);if(!s)throw new En(e);s.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.a.get(e);if(!i){if(!t)return;throw new En(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.a.get(e);if(!i)throw new En(e);i.setCheckboxState(t)}m(e,t,i){const s=this.D(new iX(e,t,this.f,this.g.converter,this.h,i));return this.a.set(e,s),s}q(e){const t=this.a.get(e.$treeViewId),i=e;return t&&i.$treeItemHandle?t.getExtensionElement(i.$treeItemHandle):t&&e.$focusedTreeItem?t.focusedElement:null}},iX=class qd extends Z{static{this.a="0"}static{this.b="1"}static{this.f=Symbol("extHostTreeViewRoot")}get visible(){return this.t}get selectedElements(){return this.u.map(t=>this.getExtensionElement(t)).filter(t=>!Wt(t))}get focusedElement(){return this.w?this.getExtensionElement(this.w):void 0}constructor(t,i,s,r,n,o){if(super(),this.N=t,this.O=s,this.P=r,this.Q=n,this.R=o,this.j=void 0,this.m=new Map,this.q=new Map,this.s=new Map,this.t=!1,this.u=[],this.w=void 0,this.y=this.D(new I),this.onDidExpandElement=this.y.event,this.z=this.D(new I),this.onDidCollapseElement=this.z.event,this.C=this.D(new I),this.onDidChangeSelection=this.C.event,this.F=this.D(new I),this.onDidChangeActiveItem=this.F.event,this.G=this.D(new I),this.onDidChangeVisibility=this.G.event,this.H=this.D(new I),this.onDidChangeCheckboxState=this.H.event,this.I=this.D(new I),this.J=Promise.resolve(),this.L=Promise.resolve(),this.M=new Set,this.X="",this.Y="",this.gb=new Qe,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const h of o.contributes.views[u])h.id===t&&(this.Y=h.name);this.g=i.treeDataProvider,this.h=i.dragAndDropController,this.g.onDidChangeTreeData&&this.D(this.g.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this.I.fire({message:!1,element:u})}));let a,c;const l=Ie.debounce(this.I.event,(u,h)=>(u||(u={message:!1,elements:[]}),h.element!==!1&&(a||(a=new Promise(f=>c=f),this.J=this.J.then(()=>a)),Array.isArray(h.element)?u.elements.push(...h.element):u.elements.push(h.element)),h.message&&(u.message=!0),u),200,!0);this.D(l(({message:u,elements:h})=>{h.length&&(h=Tn(h),this.L=this.L.then(()=>{const f=c;a=null;const p=Array.from(this.M);return this.M.clear(),this.U("start",h,p),this.hb(h).then(()=>(this.U("done",h,p),this.Bb(p),f())).catch(g=>{const v=g instanceof Error?g.message:JSON.stringify(g);return this.U("error",h,p),this.Bb(p),this.Q.error(`Unable to refresh tree view ${this.N}: ${v}`),f()})})),u&&this.O.$setMessage(this.N,pe.fromStrict(this.X)??"")}))}S(t){const i=[];for(const r of t){if(!r){i.push("<root>");continue}const n=this.q.get(r);n&&i.push(n.item.handle)}const s=this.j?.map(r=>r.item.handle)??[];return{changed:i,roots:s}}U(t,i,s){if(this.W())try{const r=this.S(i);r.clearing=s.map(a=>a.item.handle);const n=r.changed.length,o=s.length;this.Q.debug(`[TreeView:${this.N}] refresh ${t} changed=${n} nodesToClear=${o} elements.size=${this.m.size} nodes.size=${this.q.size} handles=${JSON.stringify(r)}`)}catch{this.Q.debug(`[TreeView:${this.N}] refresh ${t} (snapshot failed)`)}}W(){try{const t=this.Q.getLevel();return t===X.Debug||t===X.Trace}catch{return!1}}async getChildren(t){const i=t?this.getExtensionElement(t):void 0;if(t&&!i)return this.Q.error(`No tree item with id '${t}' found.`),Promise.resolve([]);let s=this.db(t);return s||(s=await this.fb(i)),s?s.map(r=>r.item):void 0}getExtensionElement(t){return this.m.get(t)}reveal(t,i){i=i||{select:!0,focus:!1};const s=Wt(i.select)?!0:i.select,r=Wt(i.focus)?!1:i.focus,n=Wt(i.expand)?!1:i.expand;return typeof this.g.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):t?this.J.then(()=>this.ab(t)).then(o=>this.cb(t,o[o.length-1]).then(a=>this.O.$reveal(this.N,{item:a.item,parentChain:o.map(c=>c.item)},{select:s,focus:r,expand:n})),o=>this.Q.error(o)):this.O.$reveal(this.N,void 0,{select:s,focus:r,expand:n})}get message(){return this.X}set message(t){this.X=t,this.I.fire({message:!0,element:!1})}get title(){return this.Y}set title(t){this.Y=t,this.O.$setTitle(this.N,t,this.Z)}get description(){return this.Z}set description(t){this.Z=t,this.O.$setTitle(this.N,this.Y,t)}get badge(){return this.$}set badge(t){this.$?.value===t?.value&&this.$?.tooltip===t?.tooltip||(this.$=Bg.from(t),this.O.$setBadge(this.N,t))}setExpanded(t,i){const s=this.getExtensionElement(t);s&&(i?this.y.fire(Object.freeze({element:s})):this.z.fire(Object.freeze({element:s})))}setSelectionAndFocus(t,i){const s=!Ci(this.u,t);this.u=t;const r=this.w!==i;this.w=i,s&&this.C.fire(Object.freeze({selection:this.selectedElements})),r&&this.F.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(t){t!==this.t&&(this.t=t,this.G.fire(Object.freeze({visible:this.t})))}async setCheckboxState(t){const i=(await Promise.all(t.map(async s=>{const r=this.getExtensionElement(s.treeItemHandle);return r?{extensionItem:r,treeItem:await this.g.getTreeItem(r),newState:s.newState?Nr.Checked:Nr.Unchecked}:Promise.resolve(void 0)}))).filter(s=>s!==void 0);i.forEach(s=>{s.treeItem.checkboxState=s.newState?Nr.Checked:Nr.Unchecked}),this.H.fire({items:i.map(s=>[s.extensionItem,s.newState])})}async handleDrag(t,i,s){const r=[];for(const n of t){const o=this.getExtensionElement(n);o&&r.push(o)}if(!(!this.h?.handleDrag||r.length===0))return await this.h.handleDrag(r,i,s),i}get hasHandleDrag(){return!!this.h?.handleDrag}async onDrop(t,i,s){const r=i?this.getExtensionElement(i):void 0;if(!(!r&&i||!this.h?.handleDrop))return fi(()=>this.h?.handleDrop?this.h.handleDrop(r,t,s):void 0)}get hasResolve(){return!!this.g.resolveTreeItem}async resolveTreeItem(t,i){if(!this.g.resolveTreeItem)return;const s=this.m.get(t);if(s){const r=this.q.get(s);if(r){const n=await this.g.resolveTreeItem(r.extensionItem,s,i)??r.extensionItem;return this.pb(n),r.item.tooltip=this.mb(n.tooltip),r.item.command=this.nb(r.disposableStore,n.command),r.item}}}ab(t){return this.bb(t).then(i=>i?this.ab(i).then(s=>this.cb(i,s[s.length-1]).then(r=>(s.push(r),s))):Promise.resolve([]))}bb(t){const i=this.q.get(t);return i?Promise.resolve(i.parent?this.m.get(i.parent.item.handle):void 0):fi(()=>this.g.getParent(t))}cb(t,i){const s=this.q.get(t);return s?Promise.resolve(s):fi(()=>this.g.getTreeItem(t)).then(r=>this.sb(t,r,i,!0)).then(r=>this.getChildren(i?i.item.handle:void 0).then(()=>{const n=this.getExtensionElement(r);if(n){const o=this.q.get(n);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${r} from extension ${this.R.identifier.value}`)}))}db(t){if(t){let i;if(typeof t=="string"){const s=this.getExtensionElement(t);i=s?this.q.get(s):void 0}else i=t;return i&&i.children||void 0}return this.j}eb(t){return t??qd.f}async fb(t){this.zb(t);const i=this.eb(t);let s=this.s.get(i)??0;s++,this.s.set(i,s);const r=new Qe(this.gb.token);try{const n=await this.g.getChildren(t);if(this.s.get(i)!==s)return;const o=t?this.q.get(t):void 0;if(r.token.isCancellationRequested)return;const a=gt(n||[]),c=await Promise.all(gt(a).map(u=>this.g.getTreeItem(u)));if(this.s.get(i)!==s||r.token.isCancellationRequested)return;const l=c.map((u,h)=>u?this.lb(a[h],u,o):null);return this.s.get(i)!==s?void 0:gt(l)}finally{r.dispose()}}hb(t){if(t.some(s=>!s))return this.gb.dispose(!0),this.gb=new Qe,this.zb(),this.O.$refresh(this.N);{const s=this.ib(t);if(s.length)return this.jb(s)}return Promise.resolve(void 0)}ib(t){const i=new Set,s=t.map(n=>this.q.get(n));for(const n of s)if(n&&!i.has(n.item.handle)){let o=n;for(;o&&o.parent&&s.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.m.get(o.parent.item.handle);o=a?this.q.get(a):void 0}o&&!o.parent&&i.add(n.item.handle)}const r=[];return i.forEach(n=>{const o=this.m.get(n);if(o){const a=this.q.get(o);a&&(!a.parent||!i.has(a.parent.item.handle))&&r.push(n)}}),r}jb(t){const i={};return Promise.all(t.map(s=>this.kb(s).then(r=>{r&&(i[s]=r.item)}))).then(()=>Object.keys(i).length?this.O.$refresh(this.N,i):void 0)}kb(t){const i=this.getExtensionElement(t);if(i){const s=this.q.get(i);if(s)return this.zb(i),fi(()=>this.g.getTreeItem(i)).then(r=>{if(r){const n=this.qb(i,r,s.parent);return this.xb(i,n,s,s.parent),s.dispose(),n}return null})}return Promise.resolve(null)}lb(t,i,s){const r=i.id?`${qd.b}/${i.id}`:void 0;if(r){const o=this.m.get(r);if(o){if(o!==t)throw new Error(d(3051,null,i.id));const a=this.q.get(o);if(a){const c=this.qb(t,i,s);return this.xb(t,c,a,s),a.dispose(),c}}}const n=this.qb(t,i,s);return this.wb(t,n),this.yb(n,s),n}mb(t){return Hi.isMarkdownString(t)?pe.from(t):t}nb(t,i){return i?{...this.P.toInternal(i,t),originalId:i.command}:void 0}ob(t){if(t.checkboxState===void 0)return;let i,s,r;return typeof t.checkboxState=="number"?i=t.checkboxState:(i=t.checkboxState.state,s=t.checkboxState.tooltip,r=t.checkboxState.accessibilityInformation),{isChecked:i===Nr.Checked,tooltip:s,accessibilityInformation:r}}pb(t){if(!_p.isTreeItem(t,this.R))throw new Error(`Extension ${this.R.identifier.value} has provided an invalid tree item.`)}qb(t,i,s){this.pb(i);const r=this.D(new ie),n=this.sb(t,i,s),o=this.tb(i);return{item:{handle:n,parentHandle:s?s.item.handle:void 0,label:KT(i.label,this.R),description:i.description,resourceUri:i.resourceUri,tooltip:this.mb(i.tooltip),command:this.nb(r,i.command),contextValue:i.contextValue,icon:o,iconDark:this.ub(i)||o,themeIcon:this.rb(i),collapsibleState:Wt(i.collapsibleState)?Sa.None:i.collapsibleState,accessibilityInformation:i.accessibilityInformation,checkbox:this.ob(i)},extensionItem:i,parent:s,children:void 0,disposableStore:r,dispose(){r.dispose()}}}rb(t){return t.iconPath instanceof Ti?t.iconPath:void 0}sb(t,{id:i,label:s,resourceUri:r},n,o){if(i)return`${qd.b}/${i}`;const a=KT(s,this.R),c=n?n.item.handle:qd.a;let l="";a&&(Yn(a.label)?l=a.label.value:l=a.label);let u=l||(r?Li(r):"");u=u.indexOf("/")!==-1?u.replace("/","//"):u;const h=this.q.has(t)?this.q.get(t).item.handle:void 0,f=this.db(n)||[];let p,g=0;do{if(p=`${c}/${g}:${u}`,o||!this.m.has(p)||h===p)break;g++}while(g<=f.length);return p}tb(t){if(t.iconPath&&!(t.iconPath instanceof Ti))return typeof t.iconPath=="string"||y.isUri(t.iconPath)?this.vb(t.iconPath):this.vb(t.iconPath.light)}ub(t){if(t.iconPath&&!(t.iconPath instanceof Ti)&&t.iconPath.dark)return this.vb(t.iconPath.dark)}vb(t){return y.isUri(t)?t:y.file(t)}wb(t,i){this.m.set(i.item.handle,t),this.q.set(t,i)}xb(t,i,s,r){this.m.delete(i.item.handle),this.q.delete(t),i.item.handle!==s.item.handle&&this.m.delete(s.item.handle),this.wb(t,i);const n=this.db(r)||[],o=n.filter(a=>a.item.handle===s.item.handle)[0];o&&n.splice(n.indexOf(o),1,i)}yb(t,i){i?(i.children||(i.children=[]),i.children.push(t)):(this.j||(this.j=[]),this.j.push(t))}zb(t){if(t){const i=this.q.get(t);if(i){if(i.children)for(const s of i.children){this.M.add(s);const r=this.m.get(s.item.handle);r&&(this.zb(r),this.q.delete(r),this.m.delete(s.item.handle))}i.children=void 0}}else this.Ab()}Ab(){this.j=void 0,this.q.forEach(t=>{this.M.add(t)}),this.q.clear(),this.m.clear(),this.s.clear()}Bb(t){Zi(t)}Cb(){this.j=void 0,this.m.clear(),Zi(this.q.values()),this.q.clear(),Zi(this.M),this.M.clear(),this.s.clear()}dispose(){super.dispose(),this.gb.dispose(),this.Cb(),this.O.$disposeTree(this.N)}},sX=class hL{static{this.a=new Set([V.http,V.https])}constructor(t){this.c=new Map,this.b=t.getProxy(Y.MainThreadUriOpeners)}registerExternalUriOpener(t,i,s,r){if(this.c.has(i))throw new Error(`Opener with id '${i}' already registered`);const n=r.schemes.find(o=>!hL.a.has(o));if(n)throw new Error(`Scheme '${n}' is not supported. Only http and https are currently supported.`);return this.c.set(i,s),this.b.$registerUriOpener(i,r.schemes,t,r.label),te(()=>{this.c.delete(i),this.b.$unregisterUriOpener(i)})}async $canOpenUri(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Unknown opener with id: ${t}`);const n=y.revive(i);return r.canOpenExternalUri(n,s)}async $openUri(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Unknown opener id: '${t}'`);return r.openExternalUri(y.revive(i.resolvedUri),{sourceUri:y.revive(i.sourceUri)},s)}},rX=class extends Z{#e;#t;#i;#s;#n;#r;#a;#o;#c;#l;#u;#d;#h;constructor(e,t,i,s){super(),this.#o=void 0,this.#c=!0,this.#u=!1,this.#d=this.D(new I),this.onDidDispose=this.#d.event,this.#h=this.D(new I),this.onDidChangeViewState=this.#h.event,this.#e=e,this.#t=t,this.#s=i,this.#i=s.viewType,this.#n=s.panelOptions,this.#o=s.viewColumn,this.#r=s.title,this.#l=s.active}dispose(){this.#u||(this.#u=!0,this.#d.fire(),this.#t.$disposeWebview(this.#e),this.#s.dispose(),super.dispose())}get webview(){return this.c(),this.#s}get viewType(){return this.c(),this.#i}get title(){return this.c(),this.#r}set title(e){this.c(),this.#r!==e&&(this.#r=e,this.#t.$setTitle(this.#e,e))}get iconPath(){return this.c(),this.#a}set iconPath(e){this.c(),this.#a!==e&&(this.#a=e,y.isUri(e)?this.#t.$setIconPath(this.#e,{light:e,dark:e}):this.#t.$setIconPath(this.#e,e))}get options(){return this.#n}get viewColumn(){if(this.c(),!(typeof this.#o=="number"&&this.#o<0))return this.#o}get active(){return this.c(),this.#l}get visible(){return this.c(),this.#c}_updateViewState(e){this.#u||(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn)&&(this.#l=e.active,this.#c=e.visible,this.#o=e.viewColumn,this.#h.fire({webviewPanel:this}))}reveal(e,t){this.c(),this.#t.$reveal(this.#e,{viewColumn:typeof e>"u"?void 0:Kt.from(e),preserveFocus:!!t})}c(){if(this.#u)throw new Error("Webview is disposed")}},nX=class dL extends Z{static c(){return Nt()}constructor(t,i,s){super(),this.j=i,this.m=s,this.g=new Map,this.h=new Map,this.f=t.getProxy(Y.MainThreadWebviewPanels)}dispose(){super.dispose(),this.g.forEach(t=>t.dispose()),this.g.clear()}createWebviewPanel(t,i,s,r,n={}){const o=typeof r=="object"?r.viewColumn:r,a={viewColumn:Kt.from(o),preserveFocus:typeof r=="object"&&!!r.preserveFocus},c=Rl(t),l=dL.c();this.f.$createWebviewPanel(d1(t),l,i,{title:s,panelOptions:oX(n),webviewOptions:BP(t,this.m,n),serializeBuffersForPostMessage:c},a);const u=this.j.createNewWebview(l,n,t);return this.createNewWebviewPanel(l,i,s,o,n,u,!0)}$onDidChangeWebviewPanelViewStates(t){const i=Object.keys(t);i.sort((s,r)=>{const n=t[s],o=t[r];return n.active?1:o.active?-1:+n.visible-+o.visible});for(const s of i){const r=this.getWebviewPanel(s);if(!r)continue;const n=t[s];r._updateViewState({active:n.active,visible:n.visible,viewColumn:Kt.to(n.position)})}}async $onDidDisposeWebviewPanel(t){this.getWebviewPanel(t)?.dispose(),this.g.delete(t),this.j.deleteWebview(t)}registerWebviewPanelSerializer(t,i,s){if(this.h.has(i))throw new Error(`Serializer for '${i}' already registered`);return this.h.set(i,{serializer:s,extension:t}),this.f.$registerSerializer(i,{serializeBuffersForPostMessage:Rl(t)}),new Ce(()=>{this.h.delete(i),this.f.$unregisterSerializer(i)})}async $deserializeWebviewPanel(t,i,s,r){const n=this.h.get(i);if(!n)throw new Error(`No serializer found for '${i}'`);const{serializer:o,extension:a}=n,c=this.j.createNewWebview(t,s.webviewOptions,a),l=this.createNewWebviewPanel(t,i,s.title,r,s.panelOptions,c,s.active);await o.deserializeWebviewPanel(l,s.state)}createNewWebviewPanel(t,i,s,r,n,o,a){const c=new rX(t,this.f,o,{viewType:i,title:s,viewColumn:r,panelOptions:n,active:a});return this.g.set(t,c),c}getWebviewPanel(t){return this.g.get(t)}};function oX(e){return{enableFindWidget:e.enableFindWidget,retainContextWhenHidden:e.retainContextWhenHidden}}var aX=class extends Z{#e;#t;#i;#s;#n;#r;#a;#o;#c;constructor(e,t,i,s,r,n){super(),this.#n=!1,this.#l=this.D(new I),this.onDidChangeVisibility=this.#l.event,this.#u=this.D(new I),this.onDidDispose=this.#u.event,this.#i=i,this.#a=s,this.#e=e,this.#t=t,this.#s=r,this.#r=n}dispose(){this.#n||(this.#n=!0,this.#u.fire(),this.#s.dispose(),super.dispose())}#l;#u;get title(){return this.a(),this.#a}set title(e){this.a(),this.#a!==e&&(this.#a=e,this.#t.$setWebviewViewTitle(this.#e,e))}get description(){return this.a(),this.#o}set description(e){this.a(),this.#o!==e&&(this.#o=e,this.#t.$setWebviewViewDescription(this.#e,e))}get visible(){return this.#r}get webview(){return this.#s}get viewType(){return this.#i}_setVisible(e){e===this.#r||this.#n||(this.#r=e,this.#l.fire())}get badge(){return this.a(),this.#c}set badge(e){this.a(),!(e?.value===this.#c?.value&&e?.tooltip===this.#c?.tooltip)&&(this.#c=Bg.from(e),this.#t.$setWebviewViewBadge(this.#e,e))}show(e){this.a(),this.#t.$show(this.#e,!!e)}a(){if(this.#n)throw new Error("Webview is disposed")}},cX=class{constructor(e,t){this.d=t,this.b=new Map,this.c=new Map,this.a=e.getProxy(Y.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,s){if(this.b.has(t))throw new Error(`View provider for '${t}' already registered`);return this.b.set(t,{provider:i,extension:e}),this.a.$registerWebviewViewProvider(d1(e),t,{retainContextWhenHidden:s?.retainContextWhenHidden,serializeBuffersForPostMessage:Rl(e)}),new Ce(()=>{this.b.delete(t),this.a.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,s,r){const n=this.b.get(t);if(!n)throw new Error(`No view provider found for '${t}'`);const{provider:o,extension:a}=n,c=this.d.createNewWebview(e,{},a),l=new aX(e,this.a,t,i,c,!0);this.c.set(e,l),await o.resolveWebviewView(l,{state:s},r)}async $onDidChangeWebviewViewVisibility(e,t){this.e(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.e(e);this.c.delete(e),t.dispose(),this.d.deleteWebview(e)}e(e){const t=this.c.get(e);if(!t)throw new Error("No webview found");return t}},GS=class extends Z{constructor(t){super(),this.b=0,this.c=new Map,this.f=0,this.g=new Map,this.a=t.getProxy(Y.MainThreadChatContext)}async $provideChatContext(t,i){this.g.delete(t);const s=this.n(t);if(!s.provideChatContextExplicit)throw new Error("provideChatContext not implemented");const r=await s.provideChatContextExplicit(i)??[],n=[];for(const o of r){const a=this.h(t,o);n.push({handle:a,icon:o.icon,label:o.label,modelDescription:o.modelDescription,value:o.value})}return n}h(t,i){const s=this.f++;return this.g.has(t)||this.g.set(t,new Map),this.g.get(t).set(s,i),s}async $provideChatContextForResource(t,i,s){const r=this.n(t);if(!r.provideChatContextForResource)throw new Error("provideChatContextForResource not implemented");const n=await r.provideChatContextForResource({resource:y.revive(i.resource)},s);if(!n)return;const a={handle:this.h(t,n),icon:n.icon,label:n.label,modelDescription:n.modelDescription,value:i.withValue?n.value:void 0};if(i.withValue&&!a.value&&r.resolveChatContext){const c=await r.resolveChatContext(n,s);a.value=c?.value}return a}async j(t,i,s,r){const o=await t.resolveChatContext(s,r)??i;return{handle:i.handle,icon:o.icon,label:o.label,modelDescription:o.modelDescription,value:o.value}}async $resolveChatContext(t,i,s){const r=this.n(t);if(!r.resolveChatContext)throw new Error("resolveChatContext not implemented");const n=this.g.get(t)?.get(i.handle);if(!n)throw new Error("Chat context item not found");return this.j(r,i,n,s)}registerChatContextProvider(t,i,s){const r=this.b++,n=new ie;return this.m(r,s,n),this.c.set(r,{provider:s,disposables:n}),this.a.$registerChatContextProvider(r,`${i}`,t?Ia.from(t):void 0,{},{supportsResource:!!s.provideChatContextForResource,supportsResolve:!!s.resolveChatContext}),{dispose:()=>{this.c.delete(r),this.a.$unregisterChatContextProvider(r),n.dispose()}}}m(t,i,s){!i.onDidChangeWorkspaceChatContext||!i.provideWorkspaceChatContext||s.add(i.onDidChangeWorkspaceChatContext(async()=>{const r=await i.provideWorkspaceChatContext(Fe.None),n=[];for(const o of r??[]){const a={icon:o.icon,label:o.label,modelDescription:o.modelDescription,value:o.value,handle:this.f++},c=await this.j(i,a,o,Fe.None);n.push(c)}this.a.$updateWorkspaceContextItems(t,n)}))}n(t){if(!this.c.has(t))throw new Error("Chat context provider not found");return this.c.get(t).provider}dispose(){super.dispose();for(const{disposables:t}of this.c.values())t.dispose()}};GS=__decorate([__param(0,ke)],GS);function lX(e){const t=e.get(jt),i=e.get(yc),s=e.get(Gh),r=e.get(vn),n=e.get(Rs),o=e.get(Em),a=e.get(ws),c=e.get(Cu),l=e.get(ke),u=e.get(lA),h=e.get(hA),f=e.get(Jn),p=e.get(Se),g=e.get(Am),v=e.get(Dl),b=e.get(km),S=e.get($m),E=e.get(BA),k=e.get(Tl),j=e.get(qA),O=e.get(Im),Q=e.get(PA),F=e.get(MA),B=e.get(Xm),z=e.get(I8);l.set(ne.ExtHostFileSystemInfo,i),l.set(ne.ExtHostLogLevelServiceShape,f),l.set(ne.ExtHostWorkspace,n),l.set(ne.ExtHostConfiguration,a),l.set(ne.ExtHostExtensionService,r),l.set(ne.ExtHostStorage,u),l.set(ne.ExtHostTunnelService,g),l.set(ne.ExtHostWindow,b),l.set(ne.ExtHostUrls,S),l.set(ne.ExtHostSecretState,E),l.set(ne.ExtHostTelemetry,o),l.set(ne.ExtHostEditorTabs,k),l.set(ne.ExtHostManagedSockets,j),l.set(ne.ExtHostProgress,O),l.set(ne.ExtHostAuthentication,Q),l.set(ne.ExtHostChatProvider,F),l.set(ne.ExtHostDataChannels,z);const ue=l.set(ne.ExtHostDecorations,e.get(O9)),Le=l.set(ne.ExtHostDocumentsAndEditors,e.get(Ha)),ae=l.set(ne.ExtHostCommands,e.get(cr)),J=l.set(ne.ExtHostTerminalService,e.get(mn)),q=l.set(ne.ExtHostTerminalShellIntegration,e.get(S4)),G=l.set(ne.ExtHostDebugService,e.get(w4)),K=l.set(ne.ExtHostSearch,e.get(A4)),se=l.set(ne.ExtHostTask,e.get(g4)),ve=l.set(ne.ExtHostOutputService,e.get(R9)),Ne=l.set(ne.ExtHostLocalization,e.get(VA)),Me=l.set(ne.ExtHostDocuments,new AZ(l,Le)),mt=l.set(ne.ExtHostDocumentContentProviders,new bZ(l,Le,p)),Vt=l.set(ne.ExtHostDocumentSaveParticipant,new yZ(p,Me,l.getProxy(Y.MainThreadBulkEdits))),tt=l.set(ne.ExtHostNotebook,new xY(l,ae,Le,Me,s,K,p)),Rt=l.set(ne.ExtHostNotebookDocuments,new kY(tt)),Si=l.set(ne.ExtHostNotebookEditors,new jS(p,tt)),ii=l.set(ne.ExtHostNotebookKernels,new zS(l,t,tt,ae,p)),As=l.set(ne.ExtHostNotebookRenderers,new NY(l,tt)),Dn=l.set(ne.ExtHostNotebookDocumentSaveParticipant,new CY(p,tt,l.getProxy(Y.MainThreadBulkEdits))),bi=l.set(ne.ExtHostEditors,new ZY(l,Le)),Xl=l.set(ne.ExtHostTreeViews,new tX(l.getProxy(Y.MainThreadTreeViews),ae,p)),Gr=l.set(ne.ExtHostEditorInsets,new YJ(l.getProxy(Y.MainThreadEditorInsets),bi,t.remote)),hs=l.set(ne.ExtHostDiagnostics,new Q4(l,p,i,Le)),Ze=l.set(ne.ExtHostLanguages,new tY(l,Me,ae.converter,c)),Re=l.set(ne.ExtHostLanguageFeatures,new _Z(l,c,Me,ae,hs,p,v,o)),Pn=l.set(ne.ExtHostCodeMapper,new XJ(l)),Ws=l.set(ne.ExtHostFileSystem,new DZ(l,Re)),Ss=l.set(ne.ExtHostFileSystemEventService,new jZ(l,p,Le)),vr=l.set(ne.ExtHostQuickOpen,RY(l,n,ae)),Ka=l.set(ne.ExtHostSCM,new VS(l,ae,Me,p)),Jd=l.set(ne.ExtHostQuickDiff,new LY(l,c)),Kl=l.set(ne.ExtHostShare,new _Y(l,c)),eu=l.set(ne.ExtHostComments,KJ(l,ae,Me)),ec=l.set(ne.ExtHostLabelService,new HZ(l)),Ni=l.set(ne.ExtHostTheming,new qS(l)),Mo=l.set(ne.ExtHostTimeline,new QY(l,ae)),bt=l.set(ne.ExtHostWebviews,new cZ(l,t.remote,n,p,v)),oi=l.set(ne.ExtHostWebviewPanels,new nX(l,bt,n)),pv=l.set(ne.ExtHostCustomEditors,new pZ(l,Me,h,bt,oi)),gv=l.set(ne.ExtHostWebviewViews,new cX(l,bt)),Bs=l.set(ne.ExtHostTesting,e.get(ud)),tu=l.set(ne.ExtHostUriOpeners,new sX(l)),P=l.set(ne.ExtHostProfileContentHandlers,new MY(l)),L=l.set(ne.ExtHostChatOutputRenderer,new _J(l,bt));l.set(ne.ExtHostInteractive,new zZ(l,tt,Le,ae,p));const R=l.set(ne.ExtHostLanguageModelTools,new eY(l,F)),de=l.set(ne.ExtHostChatSessions,new J4(ae,F,l,p)),we=l.set(ne.ExtHostChatAgents2,new zJ(l,p,ae,Me,Le,F,hs,R)),si=l.set(ne.ExtHostChatContext,new GS(l)),it=l.set(ne.ExtHostAiRelatedInformation,new NJ(l)),Ei=l.set(ne.ExtHostAiEmbeddingVector,new EZ(l)),Ht=l.set(ne.ExtHostAiSettingsSearch,new MJ(l)),ai=l.set(ne.ExtHostStatusBar,new JY(l,ae.converter)),Es=l.set(ne.ExtHostSpeech,new VY(l)),yt=l.set(ne.ExtHostEmbeddings,new SZ(l));l.set(ne.ExtHostMcp,e.get(Xm));const ci=Object.values(ne);l.assertRegistered(ci);const xi=new V4(l,Le),ds=new JJ(l),Ee=new kS(l,p),je=new wZ(l),pt=new qJ(l);return UJ.register(ae),function(x,Ct,tc){function re(w){return(A,$,ge)=>{const Je=w(Ot=>{try{A.call($,Ot)}catch(NL){Qd(new tk(x.identifier,NL,"FAILED to handle event"))}});return ge?.push(Je),Je}}const Ge=function(){let w=!x.isUnderDevelopment;function A(){w||(p.info(`Extension '${x.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),w=!0)}return function $(ge){if(Array.isArray(ge))ge.forEach($);else if(typeof ge=="string")A();else{const Je=ge;typeof Je.scheme>"u"&&A(),typeof Je.exclusive=="boolean"&&T(x,"documentFiltersExclusive")}return ge}}(),gL={getSession(w,A,$){return(typeof $?.forceNewSession=="object"&&$.forceNewSession.learnMore||typeof $?.createIfNone=="object"&&$.createIfNone.learnMore)&&T(x,"authLearnMore"),$?.authorizationServer&&T(x,"authIssuers"),Q.getSession(x,w,A,$)},getAccounts(w){return Q.getAccounts(w)},async hasSession(w,A){return T(x,"authSession"),!!await Q.getSession(x,w,A,{silent:!0})},get onDidChangeSessions(){return re(Q.getExtensionScopedSessionsEvent(x.identifier.value))},registerAuthenticationProvider(w,A,$,ge){return ge?.supportedAuthorizationServers&&T(x,"authIssuers"),Q.registerAuthenticationProvider(w,A,$,ge)}},mL={registerCommand(w,A,$){return ae.registerCommand(!0,w,A,$,void 0,x)},registerTextEditorCommand(w,A,$){return ae.registerCommand(!0,w,(...ge)=>{const Je=bi.getActiveTextEditor();if(!Je){p.warn("Cannot execute "+w+" because there is no active text editor.");return}return Je.edit(Ot=>{A.apply($,[Je,Ot,...ge])}).then(Ot=>{Ot||p.warn("Edits from command "+w+" were not applied.")},Ot=>{p.warn("An error occurred while running command "+w,Ot)})},void 0,void 0,x)},registerDiffInformationCommand:(w,A,$)=>(T(x,"diffCommand"),ae.registerCommand(!0,w,async(...ge)=>{const Je=Le.activeEditor(!0);if(!Je){p.warn("Cannot execute "+w+" because there is no active text editor.");return}const Ot=await bi.getDiffInformation(Je.id);A.apply($,[Ot,...ge])},void 0,void 0,x)),executeCommand(w,...A){return ae.executeCommand(w,...A)},getCommands(w=!1){return ae.getCommands(w)}},G5={get machineId(){return t.telemetryInfo.machineId},get devDeviceId(){return T(x,"devDeviceId"),t.telemetryInfo.devDeviceId??t.telemetryInfo.machineId},get sessionId(){return t.telemetryInfo.sessionId},get language(){return t.environment.appLanguage},get appName(){return t.environment.appName},get appRoot(){return t.environment.appRoot?.fsPath??""},get appHost(){return t.environment.appHost},get uriScheme(){return t.environment.appUriScheme},get clipboard(){return ds.value},get shell(){return J.getDefaultShell(!1)},get onDidChangeShell(){return re(J.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return re(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return T(x,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return T(x,"telemetry"),re(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return RD(t.telemetryInfo.firstSessionDate)},createTelemetryLogger(w,A){return LD.validateSender(w),o.instantiateLogger(x,w,A)},async openExternal(w,A){return b.openUri(w,{allowTunneling:t.remote.isRemote??(t.remote.authority?await g.hasTunnelProvider():!1),allowContributedOpeners:A?.allowContributedOpeners})},async asExternalUri(w){if(w.scheme===t.environment.appUriScheme)return S.createAppUri(w);try{return await b.asExternalUri(w,{allowTunneling:!!t.remote.authority})}catch(A){if(Gv(w,V.http)||Gv(w,V.https))return w;throw A}},get remoteName(){return y0(t.remote.authority)},get remoteAuthority(){return T(x,"resolvers"),t.remote.authority},get uiKind(){return t.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return re(p.onDidChangeLogLevel)},get appQuality(){return T(x,"resolvers"),t.quality},get appCommit(){return T(x,"resolvers"),t.commit},getDataChannel(w){return T(x,"dataChannels"),z.createDataChannel(x,w)}};t.environment.extensionTestsLocationURI||Object.freeze(G5);const vL={createTestController(w,A,$){return Bs.createTestController(x,w,A,$)},createTestObserver(){return T(x,"testObserver"),Bs.createTestObserver()},runTests(w){return T(x,"testObserver"),Bs.runTests(w)},registerTestFollowupProvider(w){return T(x,"testObserver"),Bs.registerTestFollowupProvider(w)},get onDidChangeTestResults(){return T(x,"testObserver"),re(Bs.onResultsChanged)},get testResults(){return T(x,"testObserver"),Bs.results}},Zd=t.remote.isRemote?Ca.Workspace:Ca.UI,wL={getExtension(w,A){et(x,"extensionsAny")||(A=!1);const $=Ct.mine.getExtensionDescription(w);if($)return new ed(r,x.identifier,$,Zd,!1);if(A){const ge=Ct.all.getExtensionDescription(w);if(ge)return new ed(r,x.identifier,ge,Zd,!0)}},get all(){const w=[];for(const A of Ct.mine.getAllExtensionDescriptions())w.push(new ed(r,x.identifier,A,Zd,!1));return w},get allAcrossExtensionHosts(){T(x,"extensionsAny");const w=new Ko(Ct.mine.getAllExtensionDescriptions().map($=>$.identifier)),A=[];for(const $ of Ct.all.getAllExtensionDescriptions()){const ge=!w.has($.identifier);A.push(new ed(r,x.identifier,$,Zd,ge))}return A},get onDidChange(){return et(x,"extensionsAny")?re(Ie.any(Ct.mine.onDidChange,Ct.all.onDidChange)):re(Ct.mine.onDidChange)}},bL={createDiagnosticCollection(w){return hs.createDiagnosticCollection(x.identifier,w)},get onDidChangeDiagnostics(){return re(hs.onDidChangeDiagnostics)},getDiagnostics:w=>hs.getDiagnostics(w),getLanguages(){return Ze.getLanguages()},setTextDocumentLanguage(w,A){return Ze.changeLanguage(w.uri,A)},match(w,A){const $=my.from(w);let ge;return pP($)&&(ge=tt.notebookDocuments.find(Je=>Je.apiNotebook.getCells().find(Ot=>Ot.document===A))?.apiNotebook),fP($,A.uri,A.languageId,!0,ge?.uri,ge?.notebookType)},registerCodeActionsProvider(w,A,$){return Re.registerCodeActionProvider(x,Ge(w),A,$)},registerDocumentPasteEditProvider(w,A,$){return Re.registerDocumentPasteEditProvider(x,Ge(w),A,$)},registerCodeLensProvider(w,A){return Re.registerCodeLensProvider(x,Ge(w),A)},registerDefinitionProvider(w,A){return Re.registerDefinitionProvider(x,Ge(w),A)},registerDeclarationProvider(w,A){return Re.registerDeclarationProvider(x,Ge(w),A)},registerImplementationProvider(w,A){return Re.registerImplementationProvider(x,Ge(w),A)},registerTypeDefinitionProvider(w,A){return Re.registerTypeDefinitionProvider(x,Ge(w),A)},registerHoverProvider(w,A){return Re.registerHoverProvider(x,Ge(w),A,x.identifier)},registerEvaluatableExpressionProvider(w,A){return Re.registerEvaluatableExpressionProvider(x,Ge(w),A,x.identifier)},registerInlineValuesProvider(w,A){return Re.registerInlineValuesProvider(x,Ge(w),A,x.identifier)},registerDocumentHighlightProvider(w,A){return Re.registerDocumentHighlightProvider(x,Ge(w),A)},registerMultiDocumentHighlightProvider(w,A){return Re.registerMultiDocumentHighlightProvider(x,Ge(w),A)},registerLinkedEditingRangeProvider(w,A){return Re.registerLinkedEditingRangeProvider(x,Ge(w),A)},registerReferenceProvider(w,A){return Re.registerReferenceProvider(x,Ge(w),A)},registerRenameProvider(w,A){return Re.registerRenameProvider(x,Ge(w),A)},registerNewSymbolNamesProvider(w,A){return T(x,"newSymbolNamesProvider"),Re.registerNewSymbolNamesProvider(x,Ge(w),A)},registerDocumentSymbolProvider(w,A,$){return Re.registerDocumentSymbolProvider(x,Ge(w),A,$)},registerWorkspaceSymbolProvider(w){return Re.registerWorkspaceSymbolProvider(x,w)},registerDocumentFormattingEditProvider(w,A){return Re.registerDocumentFormattingEditProvider(x,Ge(w),A)},registerDocumentRangeFormattingEditProvider(w,A){return Re.registerDocumentRangeFormattingEditProvider(x,Ge(w),A)},registerOnTypeFormattingEditProvider(w,A,$,...ge){return Re.registerOnTypeFormattingEditProvider(x,Ge(w),A,[$].concat(ge))},registerDocumentSemanticTokensProvider(w,A,$){return Re.registerDocumentSemanticTokensProvider(x,Ge(w),A,$)},registerDocumentRangeSemanticTokensProvider(w,A,$){return Re.registerDocumentRangeSemanticTokensProvider(x,Ge(w),A,$)},registerSignatureHelpProvider(w,A,$,...ge){return typeof $=="object"?Re.registerSignatureHelpProvider(x,Ge(w),A,$):Re.registerSignatureHelpProvider(x,Ge(w),A,typeof $>"u"?[]:[$,...ge])},registerCompletionItemProvider(w,A,...$){return Re.registerCompletionItemProvider(x,Ge(w),A,$)},registerInlineCompletionItemProvider(w,A,$){return A.handleDidShowCompletionItem&&T(x,"inlineCompletionsAdditions"),A.handleDidPartiallyAcceptCompletionItem&&T(x,"inlineCompletionsAdditions"),$&&T(x,"inlineCompletionsAdditions"),Re.registerInlineCompletionsProvider(x,Ge(w),A,$)},get inlineCompletionsUnificationState(){return T(x,"inlineCompletionsAdditions"),Re.inlineCompletionsUnificationState},onDidChangeCompletionsUnificationState(w,A,$){return T(x,"inlineCompletionsAdditions"),re(Re.onDidChangeInlineCompletionsUnificationState)(w,A,$)},registerDocumentLinkProvider(w,A){return Re.registerDocumentLinkProvider(x,Ge(w),A)},registerColorProvider(w,A){return Re.registerColorProvider(x,Ge(w),A)},registerFoldingRangeProvider(w,A){return Re.registerFoldingRangeProvider(x,Ge(w),A)},registerSelectionRangeProvider(w,A){return Re.registerSelectionRangeProvider(x,w,A)},registerCallHierarchyProvider(w,A){return Re.registerCallHierarchyProvider(x,w,A)},registerTypeHierarchyProvider(w,A){return Re.registerTypeHierarchyProvider(x,w,A)},setLanguageConfiguration:(w,A)=>Re.setLanguageConfiguration(x,w,A),getTokenInformationAtPosition(w,A){return T(x,"tokenInformation"),Ze.tokenAtPosition(w,A)},registerInlayHintsProvider(w,A){return Re.registerInlayHintsProvider(x,w,A)},createLanguageStatusItem(w,A){return Ze.createLanguageStatusItem(x,w,A)},registerDocumentDropEditProvider(w,A,$){return Re.registerDocumentOnDropEditProvider(x,w,A,$)}},yL={get activeTextEditor(){return bi.getActiveTextEditor()},get visibleTextEditors(){return bi.getVisibleTextEditors()},get activeTerminal(){return J.activeTerminal},get terminals(){return J.terminals},async showTextDocument(w,A,$){y.isUri(w)&&w.scheme===V.vscodeRemote&&!w.authority&&v.report("workspace.showTextDocument",x,"A URI of 'vscode-remote' scheme requires an authority.");const ge=await(y.isUri(w)?Promise.resolve(J5.openTextDocument(w)):Promise.resolve(w));return bi.showTextDocument(ge,A,$)},createTextEditorDecorationType(w){return bi.createTextEditorDecorationType(x,w)},onDidChangeActiveTextEditor(w,A,$){return re(bi.onDidChangeActiveTextEditor)(w,A,$)},onDidChangeVisibleTextEditors(w,A,$){return re(bi.onDidChangeVisibleTextEditors)(w,A,$)},onDidChangeTextEditorSelection(w,A,$){return re(bi.onDidChangeTextEditorSelection)(w,A,$)},onDidChangeTextEditorOptions(w,A,$){return re(bi.onDidChangeTextEditorOptions)(w,A,$)},onDidChangeTextEditorVisibleRanges(w,A,$){return re(bi.onDidChangeTextEditorVisibleRanges)(w,A,$)},onDidChangeTextEditorViewColumn(w,A,$){return re(bi.onDidChangeTextEditorViewColumn)(w,A,$)},onDidChangeTextEditorDiffInformation(w,A,$){return T(x,"textEditorDiffInformation"),re(bi.onDidChangeTextEditorDiffInformation)(w,A,$)},onDidCloseTerminal(w,A,$){return re(J.onDidCloseTerminal)(w,A,$)},onDidOpenTerminal(w,A,$){return re(J.onDidOpenTerminal)(w,A,$)},onDidChangeActiveTerminal(w,A,$){return re(J.onDidChangeActiveTerminal)(w,A,$)},onDidChangeTerminalDimensions(w,A,$){return T(x,"terminalDimensions"),re(J.onDidChangeTerminalDimensions)(w,A,$)},onDidChangeTerminalState(w,A,$){return re(J.onDidChangeTerminalState)(w,A,$)},onDidWriteTerminalData(w,A,$){return T(x,"terminalDataWriteEvent"),re(J.onDidWriteTerminalData)(w,A,$)},onDidExecuteTerminalCommand(w,A,$){return T(x,"terminalExecuteCommandEvent"),re(J.onDidExecuteTerminalCommand)(w,A,$)},onDidChangeTerminalShellIntegration(w,A,$){return re(q.onDidChangeTerminalShellIntegration)(w,A,$)},onDidStartTerminalShellExecution(w,A,$){return re(q.onDidStartTerminalShellExecution)(w,A,$)},onDidEndTerminalShellExecution(w,A,$){return re(q.onDidEndTerminalShellExecution)(w,A,$)},get state(){return b.getState()},onDidChangeWindowState(w,A,$){return re(b.onDidChangeWindowState)(w,A,$)},showInformationMessage(w,...A){return Ee.showMessage(x,Lt.Info,w,A[0],A.slice(1))},showWarningMessage(w,...A){return Ee.showMessage(x,Lt.Warning,w,A[0],A.slice(1))},showErrorMessage(w,...A){return Ee.showMessage(x,Lt.Error,w,A[0],A.slice(1))},showQuickPick(w,A,$){return vr.showQuickPick(x,w,A,$)},showWorkspaceFolderPick(w){return vr.showWorkspaceFolderPick(w)},showInputBox(w,A){return vr.showInput(w,A)},showOpenDialog(w){return je.showOpenDialog(w)},showSaveDialog(w){return je.showSaveDialog(w)},createStatusBarItem(w,A,$){let ge,Je,Ot;return typeof w=="string"?(ge=w,Je=A,Ot=$):(Je=w,Ot=A),ai.createStatusBarEntry(x,ge,Je,Ot)},setStatusBarMessage(w,A){return ai.setStatusBarMessage(w,A)},withScmProgress(w){return v.report("window.withScmProgress",x,"Use 'withProgress' instead."),O.withProgress(x,{location:fo.SourceControl},(A,$)=>w({report(ge){}}))},withProgress(w,A){return O.withProgress(x,w,A)},createOutputChannel(w,A){return ve.createOutputChannel(w,A,x)},createWebviewPanel(w,A,$,ge){return oi.createWebviewPanel(x,w,A,$,ge)},createWebviewTextEditorInset(w,A,$,ge){return T(x,"editorInsets"),Gr.createWebviewEditorInset(w,A,$,ge,x)},createTerminal(w,A,$){return typeof w=="object"?"pty"in w?J.createExtensionTerminal(w):J.createTerminalFromOptions(w):J.createTerminal(w,A,$)},registerTerminalLinkProvider(w){return J.registerLinkProvider(w)},registerTerminalProfileProvider(w,A){return J.registerProfileProvider(x,w,A)},registerTerminalCompletionProvider(w,...A){return T(x,"terminalCompletionProvider"),J.registerTerminalCompletionProvider(x,w,...A)},registerTerminalQuickFixProvider(w,A){return T(x,"terminalQuickFixProvider"),J.registerTerminalQuickFixProvider(w,x.identifier.value,A)},registerTreeDataProvider(w,A){return Xl.registerTreeDataProvider(w,A,x)},createTreeView(w,A){return Xl.createTreeView(w,A,x)},registerWebviewPanelSerializer:(w,A)=>oi.registerWebviewPanelSerializer(x,w,A),registerCustomEditorProvider:(w,A,$={})=>pv.registerCustomEditorProvider(x,w,A,$),registerFileDecorationProvider(w){return ue.registerFileDecorationProvider(w,x)},registerUriHandler(w){return S.registerUriHandler(x,w)},createQuickPick(){return vr.createQuickPick(x)},createInputBox(){return vr.createInputBox(x)},get activeColorTheme(){return Ni.activeColorTheme},onDidChangeActiveColorTheme(w,A,$){return re(Ni.onDidChangeActiveColorTheme)(w,A,$)},registerWebviewViewProvider(w,A,$){return gv.registerWebviewViewProvider(x,w,A,$?.webviewOptions)},get activeNotebookEditor(){return tt.activeNotebookEditor},onDidChangeActiveNotebookEditor(w,A,$){return re(tt.onDidChangeActiveNotebookEditor)(w,A,$)},get visibleNotebookEditors(){return tt.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return re(tt.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(w,A,$){return re(Si.onDidChangeNotebookEditorSelection)(w,A,$)},onDidChangeNotebookEditorVisibleRanges(w,A,$){return re(Si.onDidChangeNotebookEditorVisibleRanges)(w,A,$)},showNotebookDocument(w,A){return tt.showNotebookDocument(w,A)},registerExternalUriOpener(w,A,$){return T(x,"externalUriOpener"),tu.registerExternalUriOpener(x.identifier,w,A,$)},registerProfileContentHandler(w,A){return T(x,"profileContentHandlers"),P.registerProfileContentHandler(x,w,A)},registerQuickDiffProvider(w,A,$,ge,Je){return T(x,"quickDiffProvider"),Jd.registerQuickDiffProvider(x,Ge(w),A,$,ge,Je)},get tabGroups(){return k.tabGroups},registerShareProvider(w,A){return T(x,"shareProvider"),Kl.registerShareProvider(Ge(w),A)},get nativeHandle(){return T(x,"nativeWindowHandle"),b.nativeHandle},createChatStatusItem:w=>(T(x,"chatStatusItem"),pt.createChatStatusItem(x,w))},J5={get rootPath(){return v.report("workspace.rootPath",x,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),n.getPath()},set rootPath(w){throw new Lo("rootPath")},getWorkspaceFolder(w){return n.getWorkspaceFolder(w)},get workspaceFolders(){return n.getWorkspaceFolders()},get name(){return n.name},set name(w){throw new Lo("name")},get workspaceFile(){return n.workspaceFile},set workspaceFile(w){throw new Lo("workspaceFile")},updateWorkspaceFolders:(w,A,...$)=>n.updateWorkspaceFolders(x,w,A||0,...$),onDidChangeWorkspaceFolders:function(w,A,$){return re(n.onDidChangeWorkspace)(w,A,$)},asRelativePath:(w,A)=>n.getRelativePath(w,A),findFiles:(w,A,$,ge)=>n.findFiles(w,A,$,x.identifier,ge),findFiles2:(w,A,$)=>(T(x,"findFiles2"),n.findFiles2(w,A,x.identifier,$)),findTextInFiles:(w,A,$,ge)=>{T(x,"findTextInFiles");let Je,Ot;return typeof A=="object"?(Je=A,Ot=$):(Je={},Ot=A,ge=$),n.findTextInFiles(w,Je||{},Ot,x.identifier,ge)},findTextInFiles2:(w,A,$)=>(T(x,"findTextInFiles2"),T(x,"textSearchProvider2"),n.findTextInFiles2(w,A,x.identifier,$)),save:w=>n.save(w),saveAs:w=>n.saveAs(w),saveAll:w=>n.saveAll(w),applyEdit(w,A){return xi.applyWorkspaceEdit(w,x,A)},createFileSystemWatcher:(w,A,$,ge)=>{const Je={ignoreCreateEvents:!!A,ignoreChangeEvents:!!$,ignoreDeleteEvents:!!ge};return Ss.createFileSystemWatcher(n,tc,i,x,w,Je)},get textDocuments(){return Me.getAllDocumentData().map(w=>w.document)},set textDocuments(w){throw new Lo("textDocuments")},openTextDocument(w,A){let $;if(A=A??w,typeof w=="string")$=Promise.resolve(y.file(w));else if(y.isUri(w))$=Promise.resolve(w);else if(!A||typeof A=="object")$=Me.createDocumentData(A);else throw new Error("illegal argument - uriOrFileNameOrOptions");return $.then(ge=>(p.trace(`openTextDocument from ${x.identifier}`),ge.scheme===V.vscodeRemote&&!ge.authority&&v.report("workspace.openTextDocument",x,"A URI of 'vscode-remote' scheme requires an authority."),Me.ensureDocumentData(ge,A).then(Je=>Je.document)))},onDidOpenTextDocument:(w,A,$)=>re(Me.onDidAddDocument)(w,A,$),onDidCloseTextDocument:(w,A,$)=>re(Me.onDidRemoveDocument)(w,A,$),onDidChangeTextDocument:(w,A,$)=>et(x,"textDocumentChangeReason")?re(Me.onDidChangeDocumentWithReason)(w,A,$):re(Me.onDidChangeDocument)(w,A,$),onDidSaveTextDocument:(w,A,$)=>re(Me.onDidSaveDocument)(w,A,$),onWillSaveTextDocument:(w,A,$)=>re(Vt.getOnWillSaveTextDocumentEvent(x))(w,A,$),get notebookDocuments(){return tt.notebookDocuments.map(w=>w.apiNotebook)},async openNotebookDocument(w,A){let $;if(y.isUri(w))$=w,await tt.openNotebookDocument(w);else if(typeof w=="string")$=y.revive(await tt.createNotebookDocument({viewType:w,content:A}));else throw new Error("Invalid arguments");return tt.getNotebookDocument($).apiNotebook},onDidSaveNotebookDocument(w,A,$){return re(Rt.onDidSaveNotebookDocument)(w,A,$)},onDidChangeNotebookDocument(w,A,$){return re(Rt.onDidChangeNotebookDocument)(w,A,$)},onWillSaveNotebookDocument(w,A,$){return re(Dn.getOnWillSaveNotebookDocumentEvent(x))(w,A,$)},get onDidOpenNotebookDocument(){return re(tt.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return re(tt.onDidCloseNotebookDocument)},registerNotebookSerializer(w,A,$,ge){return tt.registerNotebookSerializer(x,w,A,$,et(x,"notebookLiveShare")?ge:void 0)},onDidChangeConfiguration:(w,A,$)=>re(tc.onDidChangeConfiguration)(w,A,$),getConfiguration(w,A){return A=arguments.length===1?void 0:A,tc.getConfiguration(w,A,x)},registerTextDocumentContentProvider(w,A){return mt.registerTextDocumentContentProvider(w,A)},registerTaskProvider:(w,A)=>(v.report("window.registerTaskProvider",x,"Use the corresponding function on the 'tasks' namespace instead"),se.registerTaskProvider(x,w,A)),registerFileSystemProvider(w,A,$){return Tv(Ws.registerFileSystemProvider(x,w,A,$),s.addFileSystemProvider(w,A,$))},get fs(){return s.value},registerFileSearchProvider:(w,A)=>(T(x,"fileSearchProvider"),K.registerFileSearchProviderOld(w,A)),registerTextSearchProvider:(w,A)=>(T(x,"textSearchProvider"),K.registerTextSearchProviderOld(w,A)),registerAITextSearchProvider:(w,A)=>(T(x,"aiTextSearchProvider"),T(x,"textSearchProvider2"),K.registerAITextSearchProvider(w,A)),registerFileSearchProvider2:(w,A)=>(T(x,"fileSearchProvider2"),K.registerFileSearchProvider(w,A)),registerTextSearchProvider2:(w,A)=>(T(x,"textSearchProvider2"),K.registerTextSearchProvider(w,A)),registerRemoteAuthorityResolver:(w,A)=>(T(x,"resolvers"),r.registerRemoteAuthorityResolver(w,A)),registerResourceLabelFormatter:w=>(T(x,"resolvers"),ec.$registerResourceLabelFormatter(w)),getRemoteExecServer:w=>(T(x,"resolvers"),r.getRemoteExecServer(w)),onDidCreateFiles:(w,A,$)=>re(Ss.onDidCreateFile)(w,A,$),onDidDeleteFiles:(w,A,$)=>re(Ss.onDidDeleteFile)(w,A,$),onDidRenameFiles:(w,A,$)=>re(Ss.onDidRenameFile)(w,A,$),onWillCreateFiles:(w,A,$)=>re(Ss.getOnWillCreateFileEvent(x))(w,A,$),onWillDeleteFiles:(w,A,$)=>re(Ss.getOnWillDeleteFileEvent(x))(w,A,$),onWillRenameFiles:(w,A,$)=>re(Ss.getOnWillRenameFileEvent(x))(w,A,$),openTunnel:w=>(T(x,"tunnels"),g.openTunnel(x,w).then(A=>{if(!A)throw new Error("cannot open tunnel");return A})),get tunnels(){return T(x,"tunnels"),g.getTunnels()},onDidChangeTunnels:(w,A,$)=>(T(x,"tunnels"),re(g.onDidChangeTunnels)(w,A,$)),registerPortAttributesProvider:(w,A)=>(T(x,"portsAttributes"),g.registerPortsAttributesProvider(w,A)),registerTunnelProvider:(w,A)=>(T(x,"tunnelFactory"),g.registerTunnelProvider(w,A)),registerTimelineProvider:(w,A)=>(T(x,"timeline"),Mo.registerTimelineProvider(w,A,x.identifier,ae.converter)),get isTrusted(){return n.trusted},requestWorkspaceTrust:w=>(T(x,"workspaceTrust"),n.requestWorkspaceTrust(w)),onDidGrantWorkspaceTrust:(w,A,$)=>re(n.onDidGrantWorkspaceTrust)(w,A,$),registerEditSessionIdentityProvider:(w,A)=>(T(x,"editSessionIdentityProvider"),n.registerEditSessionIdentityProvider(w,A)),onWillCreateEditSessionIdentity:(w,A,$)=>(T(x,"editSessionIdentityProvider"),re(n.getOnWillCreateEditSessionIdentityEvent(x))(w,A,$)),registerCanonicalUriProvider:(w,A)=>(T(x,"canonicalUriProvider"),n.registerCanonicalUriProvider(w,A)),getCanonicalUri:(w,A,$)=>(T(x,"canonicalUriProvider"),n.provideCanonicalUri(w,A,$)),decode(w,A){return n.decode(w,A)},encode(w,A){return n.encode(w,A)}},AL={get inputBox(){return v.report("scm.inputBox",x,"Use 'SourceControl.inputBox' instead"),Ka.getLastInputBox(x)},createSourceControl(w,A,$,ge,Je,Ot){return(ge||Je||Ot)&&T(x,"scmProviderOptions"),Ka.createSourceControl(x,w,A,$,ge,Je,Ot)}},SL={createCommentController(w,A){return eu.createCommentController(x,w,A)}},EL={get activeDebugSession(){return G.activeDebugSession},get activeDebugConsole(){return G.activeDebugConsole},get breakpoints(){return G.breakpoints},get activeStackItem(){return G.activeStackItem},registerDebugVisualizationProvider(w,A){return T(x,"debugVisualization"),G.registerDebugVisualizationProvider(x,w,A)},registerDebugVisualizationTreeProvider(w,A){return T(x,"debugVisualization"),G.registerDebugVisualizationTree(x,w,A)},onDidStartDebugSession(w,A,$){return re(G.onDidStartDebugSession)(w,A,$)},onDidTerminateDebugSession(w,A,$){return re(G.onDidTerminateDebugSession)(w,A,$)},onDidChangeActiveDebugSession(w,A,$){return re(G.onDidChangeActiveDebugSession)(w,A,$)},onDidReceiveDebugSessionCustomEvent(w,A,$){return re(G.onDidReceiveDebugSessionCustomEvent)(w,A,$)},onDidChangeBreakpoints(w,A,$){return re(G.onDidChangeBreakpoints)(w,A,$)},onDidChangeActiveStackItem(w,A,$){return re(G.onDidChangeActiveStackItem)(w,A,$)},registerDebugConfigurationProvider(w,A,$){return G.registerDebugConfigurationProvider(w,A,$||l1.Initial)},registerDebugAdapterDescriptorFactory(w,A){return G.registerDebugAdapterDescriptorFactory(x,w,A)},registerDebugAdapterTrackerFactory(w,A){return G.registerDebugAdapterTrackerFactory(w,A)},startDebugging(w,A,$){return!$||typeof $=="object"&&"configuration"in $?G.startDebugging(w,A,{parentSession:$}):G.startDebugging(w,A,$||{})},stopDebugging(w){return G.stopDebugging(w)},addBreakpoints(w){return G.addBreakpoints(w)},removeBreakpoints(w){return G.removeBreakpoints(w)},asDebugSourceUri(w,A){return G.asDebugSourceUri(w,A)}},xL={registerTaskProvider:(w,A)=>se.registerTaskProvider(x,w,A),fetchTasks:w=>se.fetchTasks(w),executeTask:w=>se.executeTask(x,w),get taskExecutions(){return se.taskExecutions},onDidStartTask:(w,A,$)=>{const ge=Je=>{et(x,"taskExecutionTerminal")||Je?.execution?.terminal!==void 0&&(Je.execution.terminal=void 0);const Ot={...Je,execution:Je.execution};return w.call(A,Ot)};return re(se.onDidStartTask)(ge,A,$)},onDidEndTask:(w,A,$)=>re(se.onDidEndTask)(w,A,$),onDidStartTaskProcess:(w,A,$)=>re(se.onDidStartTaskProcess)(w,A,$),onDidEndTaskProcess:(w,A,$)=>re(se.onDidEndTaskProcess)(w,A,$),onDidStartTaskProblemMatchers:(w,A,$)=>(T(x,"taskProblemMatcherStatus"),re(se.onDidStartTaskProblemMatchers)(w,A,$)),onDidEndTaskProblemMatchers:(w,A,$)=>(T(x,"taskProblemMatcherStatus"),re(se.onDidEndTaskProblemMatchers)(w,A,$))},CL={createNotebookController(w,A,$,ge,Je){return ii.createNotebookController(x,w,A,$,ge,et(x,"notebookMessaging")?Je:void 0)},registerNotebookCellStatusBarItemProvider:(w,A)=>tt.registerNotebookCellStatusBarItemProvider(x,w,A),createRendererMessaging(w){return As.createRendererMessaging(x,w)},createNotebookControllerDetectionTask(w){return T(x,"notebookKernelSource"),ii.createNotebookControllerDetectionTask(x,w)},registerKernelSourceActionProvider(w,A){return T(x,"notebookKernelSource"),ii.registerKernelSourceActionProvider(x,w,A)}},kL={t(...w){if(typeof w[0]=="string"){const A=w.shift(),$=!w||typeof w[0]!="object"?w:w[0];return Ne.getMessage(x.identifier.value,{message:A,args:$})}return Ne.getMessage(x.identifier.value,w[0])},get bundle(){return Ne.getBundle(x.identifier.value)},get uri(){return Ne.getBundleUri(x.identifier.value)}},$L={transferActiveChat(w){return T(x,"interactive"),we.transferActiveChat(w)}},IL={getRelatedInformation(w,A){return T(x,"aiRelatedInformation"),it.getRelatedInformation(x,w,A)},registerRelatedInformationProvider(w,A){return T(x,"aiRelatedInformation"),it.registerRelatedInformationProvider(x,w,A)},registerEmbeddingVectorProvider(w,A){return T(x,"aiRelatedInformation"),Ei.registerEmbeddingVectorProvider(x,w,A)},registerSettingsSearchProvider(w){return T(x,"aiSettingsSearch"),Ht.registerSettingsSearchProvider(x,w)}},DL={registerMappedEditsProvider(w,A){return T(x,"mappedEditsProvider"),{dispose(){}}},registerMappedEditsProvider2(w){return T(x,"mappedEditsProvider"),Pn.registerMappedEditsProvider(x,w)},createChatParticipant(w,A){return we.createChatAgent(x,w,A)},createDynamicChatParticipant(w,A,$){return T(x,"chatParticipantPrivate"),we.createDynamicChatAgent(x,w,A,$)},registerChatParticipantDetectionProvider(w){return T(x,"chatParticipantPrivate"),we.registerChatParticipantDetectionProvider(x,w)},registerRelatedFilesProvider(w,A){return T(x,"chatEditing"),we.registerRelatedFilesProvider(x,w,A)},onDidDisposeChatSession:(w,A,$)=>(T(x,"chatParticipantPrivate"),re(we.onDidDisposeChatSession)(w,A,$)),registerChatSessionItemProvider:(w,A)=>(T(x,"chatSessionsProvider"),de.registerChatSessionItemProvider(x,w,A)),registerChatSessionContentProvider(w,A,$,ge){return T(x,"chatSessionsProvider"),de.registerChatSessionContentProvider(x,w,$,A,ge)},registerChatOutputRenderer:(w,A)=>(T(x,"chatOutputRenderer"),L.registerChatOutputRenderer(x,w,A)),registerChatContextProvider(w,A,$){return T(x,"chatContextProvider"),si.registerChatContextProvider(w?Ge(w):void 0,`${x.id}-${A}`,$)},registerCustomAgentsProvider(w){return T(x,"chatParticipantPrivate"),we.registerCustomAgentsProvider(x,w)}},PL={selectChatModels:w=>F.selectLanguageModels(x,w??{}),onDidChangeChatModels:(w,A,$)=>F.onDidChangeProviders(w,A,$),registerLanguageModelChatProvider:(w,A)=>F.registerLanguageModelChatProvider(x,w,A),get isModelProxyAvailable(){return T(x,"languageModelProxy"),F.isModelProxyAvailable},onDidChangeModelProxyAvailability:(w,A,$)=>(T(x,"languageModelProxy"),F.onDidChangeModelProxyAvailability(w,A,$)),getModelProxy:()=>(T(x,"languageModelProxy"),F.getModelProxy(x)),registerLanguageModelProxyProvider:w=>(T(x,"chatParticipantPrivate"),F.registerLanguageModelProxyProvider(x,w)),get embeddingModels(){return T(x,"embeddings"),yt.embeddingsModels},onDidChangeEmbeddingModels:(w,A,$)=>(T(x,"embeddings"),yt.onDidChange(w,A,$)),registerEmbeddingsProvider(w,A){return T(x,"embeddings"),yt.registerEmbeddingsProvider(x,w,A)},async computeEmbeddings(w,A,$){return T(x,"embeddings"),yt.computeEmbeddings(w,A,$)},registerTool(w,A){return R.registerTool(x,w,A)},invokeTool(w,A,$){return R.invokeTool(x,w,A,$)},get tools(){return R.getTools(x)},fileIsIgnored(w,A){return F.fileIsIgnored(x,w,A)},registerIgnoredFileProvider(w){return F.registerIgnoredFileProvider(x,w)},registerMcpServerDefinitionProvider(w,A){return B.registerMcpConfigurationProvider(x,w,A)},onDidChangeChatRequestTools(...w){return T(x,"chatParticipantAdditions"),re(we.onDidChangeChatRequestTools)(...w)}},TL={registerSpeechProvider(w,A){return T(x,"speech"),Es.registerProvider(x.identifier,w,A)}};return{version:t.version,ai:IL,authentication:gL,commands:mL,comments:SL,chat:DL,debug:EL,env:G5,extensions:wL,interactive:$L,l10n:kL,languages:bL,lm:PL,notebooks:CL,scm:AL,speech:TL,tasks:xL,tests:vL,window:yL,workspace:J5,Breakpoint:Qc,TerminalOutputAnchor:Vw,ChatResultFeedbackKind:Ah,ChatVariableLevel:Rb,ChatCompletionItem:EB,ChatReferenceDiagnostic:Gb,CallHierarchyIncomingCall:p7,CallHierarchyItem:Gw,CallHierarchyOutgoingCall:g7,CancellationError:dt,CancellationTokenSource:Qe,CandidatePortSource:v0,CodeAction:th,CodeActionKind:xt,CodeActionTriggerKind:eh,CodeLens:Rp,Color:_c,ColorInformation:Hp,ColorPresentation:Wp,ColorThemeKind:go,CommentMode:mb,CommentState:vb,CommentThreadCollapsibleState:fh,CommentThreadState:ph,CommentThreadApplicability:gh,CommentThreadFocus:mh,CompletionItem:Up,CompletionItemKind:me,CompletionItemTag:sh,CompletionList:Fc,CompletionTriggerKind:Oc,ConfigurationTarget:Jc,CustomExecution:lb,DebugAdapterExecutable:Yc,DebugAdapterInlineImplementation:uh,DebugAdapterNamedPipeServer:lh,DebugAdapterServer:Xc,DebugConfigurationProviderTriggerKind:l1,DebugConsoleMode:Kp,DebugVisualization:mB,DecorationRangeBehavior:ya,Diagnostic:Cp,DiagnosticRelatedInformation:Zu,DiagnosticSeverity:mi,DiagnosticTag:fa,Disposable:Ce,DocumentHighlight:Mp,DocumentHighlightKind:Xu,MultiDocumentHighlight:Lp,DocumentLink:zp,DocumentSymbol:Ku,EndOfLine:sr,EnvironmentVariableMutatorType:Lc,EvaluatableExpression:Jp,InlineValueText:Zp,InlineValueVariableLookup:Qp,InlineValueEvaluatableExpression:Yp,InlineCompletionTriggerKind:hh,InlineCompletionsDisposeReasonKind:ln,EventEmitter:I,ExtensionKind:Ca,ExtensionMode:il,ExternalUriOpenerPriority:Cb,FileChangeType:Kc,FileDecoration:yb,FileDecoration2:yb,FileSystemError:Xt,FileType:is,FilePermission:Xn,FoldingRange:gb,FoldingRangeKind:un,FunctionBreakpoint:xa,InlineCompletionItem:Kw,InlineCompletionList:eb,Hover:Tp,VerboseHover:Np,HoverVerbosityAction:qw,IndentAction:W4,Location:rs,MarkdownString:Hi,OverviewRulerLane:OA,ParameterInformation:Jw,PortAutoForwardAction:$b,Position:Pe,ProcessExecution:qc,ProgressLocation:fo,QuickInputButtonLocation:bb,QuickInputButtons:vh,Range:xe,RelativePattern:Zc,Selection:Dr,SelectionRange:ih,SemanticTokens:el,SemanticTokensBuilder:gB,SemanticTokensEdit:A7,SemanticTokensEdits:Xp,SemanticTokensLegend:wb,ShellExecution:Aa,ShellQuoting:cb,SignatureHelp:Qw,SignatureHelpTriggerKind:Yw,SignatureInformation:Zw,SnippetString:ma,SourceBreakpoint:Ea,StandardTokenType:mo,StatusBarAlignment:uo,SymbolInformation:Yu,SymbolKind:ut,SymbolTag:Qu,Task:Bp,TaskEventKind:ob,TaskGroup:ah,TaskPanelKind:ab,TaskRevealKind:nb,TaskScope:ho,TerminalLink:sB,TerminalQuickFixTerminalCommand:nB,TerminalQuickFixOpener:rB,TerminalLocation:sb,TerminalProfile:oB,TerminalExitReason:tb,TerminalShellExecutionCommandLineConfidence:oh,TerminalCompletionItem:aB,TerminalCompletionItemKind:rb,TerminalCompletionList:cB,TerminalShellType:ib,TextDocumentSaveReason:zc,TextEdit:lo,SnippetTextEdit:zw,TextEditorCursorStyle:Ds,TextEditorChangeKind:Wc,TextEditorLineNumbersStyle:rr,TextEditorRevealType:jp,TextEditorSelectionChangeKind:Hc,SyntaxTokenType:Bc,TextDocumentChangeReason:nh,ThemeColor:ch,ThemeIcon:Ti,TreeItem:_p,TreeItemCheckboxState:Nr,TreeItemCollapsibleState:Sa,TypeHierarchyItem:Ib,UIKind:Qh,Uri:y,ViewColumn:rh,WorkspaceEdit:wa,DocumentPasteTriggerKind:db,DocumentDropEdit:hb,DocumentDropOrPasteEditKind:po,DocumentPasteEdit:hB,InlayHint:Fp,InlayHintLabelPart:Op,InlayHintKind:Xw,RemoteAuthorityResolverError:Mc,ResolvedAuthority:tB,ManagedResolvedAuthority:Pp,SourceControlInputBoxValidationType:Vc,ExtensionRuntime:rg,TimelineItem:Eb,NotebookRange:Ir,NotebookCellKind:pa,NotebookCellExecutionState:Ab,NotebookCellData:kp,NotebookData:l7,NotebookRendererScript:S7,NotebookCellStatusBarAlignment:tg,NotebookEditorRevealType:ig,NotebookCellOutput:Ip,NotebookCellOutputItem:u7,CellErrorStackFrame:vB,NotebookCellStatusBarItem:wB,NotebookControllerAffinity:Sb,NotebookControllerAffinity2:sg,NotebookEdit:$p,NotebookKernelSourceAction:bB,NotebookVariablesRequestKind:bh,PortAttributes:AB,LinkedEditingRanges:yB,TestResultState:xb,TestRunRequest:ng,TestMessage:og,TestMessageStackFrame:SB,TestTag:yh,TestRunProfileKind:sl,TextSearchCompleteMessageType:am,DataTransfer:Gc,DataTransferItem:Vp,TestCoverageCount:ag,FileCoverage:lg,StatementCoverage:x7,BranchCoverage:C7,DeclarationCoverage:k7,WorkspaceTrustState:kb,LanguageStatusSeverity:Rc,QuickPickItemKind:wh,InputBoxValidationSeverity:tl,TabInputText:Db,TabInputTextDiff:ug,TabInputTextMerge:$7,TabInputCustom:Pb,TabInputNotebook:Tb,TabInputNotebookDiff:Nb,TabInputWebview:I7,TabInputTerminal:D7,TabInputInteractiveWindow:P7,TabInputChat:T7,TabInputTextMultiDiff:N7,TelemetryTrustedValue:Rw,LogLevel:X,EditSessionIdentityMatch:B4,InteractiveSessionVoteDirection:Mb,ChatCopyKind:Lb,ChatSessionChangedFile:CB,ChatEditingSessionActionOutcome:Mr,InteractiveEditorResponseFeedbackKind:Fb,DebugStackFrame:b7,DebugThread:y7,RelatedInformationType:Qb,SpeechToTextStatus:Xb,TextToSpeechStatus:Kb,PartialAcceptTriggerKind:ba,InlineCompletionEndOfLifeReasonKind:Uc,InlineCompletionDisplayLocationKind:jc,KeywordRecognitionStatus:ey,ChatImageMimeType:Zb,ChatResponseMarkdownPart:hg,ChatResponseFileTreePart:fg,ChatResponseAnchorPart:Eh,ChatResponseProgressPart:zb,ChatResponseProgressPart2:pg,ChatResponseThinkingProgressPart:rl,ChatResponseReferencePart:ka,ChatResponseReferencePart2:ka,ChatResponseCodeCitationPart:vg,ChatResponseCodeblockUriPart:mg,ChatResponseWarningPart:xh,ChatResponseTextEditPart:Ch,ChatResponseNotebookEditPart:bg,ChatResponseMarkdownWithVulnerabilitiesPart:Sh,ChatResponseCommandButtonPart:gg,ChatResponseConfirmationPart:dg,ChatResponseMovePart:wg,ChatResponseExtensionsPart:Hb,ChatResponseExternalEditPart:jb,ChatResponsePullRequestPart:Wb,ChatPrepareToolInvocationPart:kh,ChatResponseMultiDiffPart:Ub,ChatResponseReferencePartStatusKind:Vb,ChatResponseClearToPreviousToolInvocationReason:qb,ChatRequestTurn:yg,ChatRequestTurn2:yg,ChatResponseTurn:M7,ChatResponseTurn2:xB,ChatToolInvocationPart:Bb,ChatLocation:nr,ChatSessionStatus:_b,ChatRequestEditorData:L7,ChatRequestNotebookData:R7,ChatReferenceBinaryData:O7,ChatRequestEditedFileEventKind:Ob,LanguageModelChatMessageRole:ns,LanguageModelChatMessage:F7,LanguageModelChatMessage2:U7,LanguageModelToolResultPart:nl,LanguageModelToolResultPart2:nl,LanguageModelTextPart:zt,LanguageModelTextPart2:zt,LanguageModelPartAudience:Ag,ToolResultAudience:Ag,LanguageModelToolCallPart:$a,LanguageModelThinkingPart:ol,LanguageModelError:hn,LanguageModelToolResult:Sg,LanguageModelToolResult2:j7,LanguageModelDataPart:vi,LanguageModelDataPart2:vi,LanguageModelToolExtensionSource:z7,LanguageModelToolMCPSource:H7,ExtendedLanguageModelToolResult:kB,LanguageModelChatToolMode:Eg,LanguageModelPromptTsxPart:Lr,NewSymbolName:fB,NewSymbolNameTag:pb,NewSymbolNameTriggerKind:dh,ExcludeSettingOptions:pn,TextSearchContext2:om,TextSearchMatch2:fn,AISearchKeyword:By,TextSearchCompleteMessageTypeNew:am,ChatErrorLevel:Jb,McpHttpServerDefinition:B7,McpHttpServerDefinition2:B7,McpStdioServerDefinition:W7,McpStdioServerDefinition2:W7,McpToolAvailability:xg,SettingsSearchResultKind:Yb}}}var H1,W1=class{constructor(t,i,s,r,n,o,a){this.c=t,this.d=i,this.f=s,this.g=r,this.h=n,this.i=o,this.j=a,this.a=new Map,this.b=[]}async install(){this.k(),Ut("code/extHost/willWaitForConfig");const t=await this.g.getConfigProvider();Ut("code/extHost/didWaitForConfig");const i=await this.h.getExtensionPathIndex();this.register(new uX(this.c,i,this.d,t,this.j)),this.register(this.f.createInstance(JS)),this.i.remote.isRemote&&this.register(this.f.createInstance(ZS,i,this.i.environment.appUriScheme))}register(t){if("nodeModuleName"in t)if(Array.isArray(t.nodeModuleName))for(const i of t.nodeModuleName)this.a.set(i,t);else this.a.set(t.nodeModuleName,t);typeof t.alternativeModuleName=="function"&&this.b.push(i=>t.alternativeModuleName(i))}};W1=__decorate([__param(2,Xo),__param(3,ws),__param(4,vn),__param(5,jt),__param(6,Se)],W1);var JS=class{static{H1=this}static{this.a=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(t){if(t.environment.appRoot&&H1.a.size){const i=Un(this.c(t.environment.appRoot.fsPath)),s="[a-z0-9_.-]",r=`@${s}+\\/${s}+|${s}+`,n="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.b=new RegExp(`^(${i}/${n}\\/)(${r})(.*)$`,"i")}}alternativeModuleName(t){if(!this.b)return;const i=this.b.exec(this.c(t));if(!i)return;const[,s,r,n]=i,o=H1.a.get(r);if(o!==void 0)return console.warn(`${r} as been renamed to ${o}, please update your imports`),s+o+n}c(t){return t.replace(/\\/g,"/")}};JS=H1=__decorate([__param(0,jt)],JS);var uX=class{constructor(e,t,i,s,r){this.c=e,this.d=t,this.e=i,this.f=s,this.g=r,this.nodeModuleName="vscode",this.a=new qn}load(e,t){const i=this.d.findSubstr(t);if(i){let s=this.a.get(i.identifier);return s||(s=this.c(i,this.e,this.f),this.a.set(i.identifier,s)),s}if(!this.b){let s="";this.d.forEach((r,n)=>s+=`	${n} -> ${r.identifier.value}
`),this.g.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${s}`),this.b=this.c(BW,this.e,this.f)}return this.b}},ZS=class{constructor(t,i,s){this.e=t,this.f=i,this.nodeModuleName=["open","opn"],this.d=s.getProxy(Y.MainThreadTelemetry);const r=s.getProxy(Y.MainThreadWindow);this.c=(n,o)=>{const a=y.parse(n);return o?this.g(n,o):a.scheme==="http"||a.scheme==="https"?r.$openUri(a,n,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this.f?r.$openUri(a,n,{}):this.g(n,o)}}load(t,i,s){const r=this.e.findSubstr(i);return r&&(this.a=r.identifier.value,this.h()),this.b=s(t),this.c}g(t,i){return this.i(),this.b(t,i)}h(){this.a&&this.d.$publicLog2("shimming.open",{extension:this.a})}i(){this.a&&this.d.$publicLog2("shimming.open.call.noForward",{extension:this.a})}};ZS=__decorate([__param(2,ke)],ZS);import{LogLevel as qa,createHttpPatch as eN,createProxyResolver as hX,createTlsPatch as dX,createNetPatch as fX,loadSystemCertificates as tN}from"@vscode/proxy-agent";import{createRequire as pX}from"node:module";import{parse as iN}from"url";import{spawn as gX}from"child_process";import{userInfo as mX}from"os";import*as sN from"os";var rN=/^\d+$/,vX=/^Microsoft.PowerShell_.*/,wX=/^Microsoft.PowerShellPreview_.*/,nN;(function(e){e[e.x64=0]="x64",e[e.x86=1]="x86",e[e.ARM=2]="ARM"})(nN||(nN={}));var Dd;switch(process.arch){case"ia32":Dd=1;break;case"arm":case"arm64":Dd=2;break;default:Dd=0;break}var zl;process.env.PROCESSOR_ARCHITEW6432?zl=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?zl=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?zl=1:zl=0;var Pd=class{constructor(e,t,i){this.exePath=e,this.displayName=t,this.a=i}async exists(){return this.a===void 0&&(this.a=await Oi.existsFile(this.exePath)),this.a}};function bX({useAlternateBitness:e=!1}={}){return e?Dd===0?process.env["ProgramFiles(x86)"]||null:zl===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function B1({useAlternateBitness:e=!1,findPreview:t=!1}={}){const i=bX({useAlternateBitness:e});if(!i)return null;const s=_e(i,"PowerShell");if(!await Oi.existsDirectory(s))return null;let r=-1,n=null;for(const c of await nt.readdir(s)){let l=-1;if(t){const h=c.indexOf("-");if(h<0)continue;const f=c.substring(0,h);if(!rN.test(f)||c.substring(h+1)!=="preview")continue;l=parseInt(f,10)}else{if(!rN.test(c))continue;l=parseInt(c,10)}if(l<=r)continue;const u=_e(s,c,"pwsh.exe");await Oi.existsFile(u)&&(n=u,r=l)}if(!n)return null;const o=i.includes("x86")?" (x86)":"",a=t?" Preview":"";return new Pd(n,`PowerShell${a}${o}`,!0)}async function oN({findPreview:e}={}){if(!process.env.LOCALAPPDATA)return null;const t=_e(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await Oi.existsDirectory(t))return null;const{pwshMsixDirRegex:i,pwshMsixName:s}=e?{pwshMsixDirRegex:wX,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:vX,pwshMsixName:"PowerShell (Store)"};for(const r of await nt.readdir(t))if(i.test(r)){const n=_e(t,r,"pwsh.exe");return new Pd(n,s)}return null}function yX(){const e=_e(sN.homedir(),".dotnet","tools","pwsh.exe");return new Pd(e,".NET Core PowerShell Global Tool")}function AX(){const e=_e(sN.homedir(),"scoop","apps"),t=_e(e,"pwsh","current","pwsh.exe");return new Pd(t,"PowerShell (Scoop)")}function SX(){const e=_e(process.env.windir,Dd===1&&zl!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new Pd(e,"Windows PowerShell",!0)}async function*EX(){let e=await B1();e&&(yield e),e=await B1({useAlternateBitness:!0}),e&&(yield e),e=await oN(),e&&(yield e),e=yX(),e&&(yield e),e=await B1({findPreview:!0}),e&&(yield e),e=await oN({findPreview:!0}),e&&(yield e),e=await B1({useAlternateBitness:!0,findPreview:!0}),e&&(yield e),e=await AX(),e&&(yield e),e=SX(),e&&(yield e)}async function*xX(){for await(const e of EX())await e.exists()&&(yield e)}async function CX(){for await(const e of xX())return e;return null}async function kX(e,t){return e===1?ze?IX():M8(t):$X(e,t)}var QS=null;function $X(e,t){if($t&&e===2||Pt&&e===3)return"/bin/bash";if(!QS){let i;if(ze)i="/bin/bash";else{if(i=t.SHELL,!i)try{i=mX().shell}catch{}i||(i="sh"),i==="/bin/false"&&(i="/bin/bash")}QS=i}return QS}var YS=null;async function IX(){return YS||(YS=(await CX()).exePath),YS}import"assert";var Eue=Q5(Y5(),1),xue={o:d(1897,null),e:d(1898,null),t:d(1899,null),m:d(1900,null)},Cue={chat:{type:"subcommand",description:"Pass in a prompt to run in a chat session in the current working directory.",options:{_:{type:"string[]",description:d(1901,null)},mode:{type:"string",cat:"o",alias:"m",args:"mode",description:d(1902,null)},"add-file":{type:"string[]",cat:"o",alias:"a",args:"path",description:d(1903,null)},maximize:{type:"boolean",cat:"o",description:d(1904,null)},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:d(1905,null)},"new-window":{type:"boolean",cat:"o",alias:"n",description:d(1906,null)},profile:{type:"string",cat:"o",args:"profileName",description:d(1907,null)},help:{type:"boolean",alias:"h",description:d(1908,null)}}},"serve-web":{type:"subcommand",description:"Run a server that displays the editor UI in browsers.",options:{"cli-data-dir":{type:"string",args:"dir",description:d(1909,null)},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"}}},tunnel:{type:"subcommand",description:"Make the current machine accessible from vscode.dev or other machines through a secure tunnel.",options:{"cli-data-dir":{type:"string",args:"dir",description:d(1910,null)},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"},user:{type:"subcommand",options:{login:{type:"subcommand",options:{provider:{type:"string"},"access-token":{type:"string"}}}}}}},diff:{type:"boolean",cat:"o",alias:"d",args:["file","file"],description:d(1911,null)},merge:{type:"boolean",cat:"o",alias:"m",args:["path1","path2","base","result"],description:d(1912,null)},add:{type:"boolean",cat:"o",alias:"a",args:"folder",description:d(1913,null)},remove:{type:"boolean",cat:"o",args:"folder",description:d(1914,null)},goto:{type:"boolean",cat:"o",alias:"g",args:"file:line[:character]",description:d(1915,null)},"new-window":{type:"boolean",cat:"o",alias:"n",description:d(1916,null)},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:d(1917,null)},wait:{type:"boolean",cat:"o",alias:"w",description:d(1918,null)},waitMarkerFilePath:{type:"string"},locale:{type:"string",cat:"o",args:"locale",description:d(1919,null)},"user-data-dir":{type:"string",cat:"o",args:"dir",description:d(1920,null)},profile:{type:"string",cat:"o",args:"profileName",description:d(1921,null)},help:{type:"boolean",cat:"o",alias:"h",description:d(1922,null)},"extensions-dir":{type:"string",deprecates:["extensionHomePath"],cat:"e",args:"dir",description:d(1923,null)},"extensions-download-dir":{type:"string"},"builtin-extensions-dir":{type:"string"},"list-extensions":{type:"boolean",cat:"e",description:d(1924,null)},"show-versions":{type:"boolean",cat:"e",description:d(1925,null)},category:{type:"string",allowEmptyValue:!0,cat:"e",description:d(1926,null),args:"category"},"install-extension":{type:"string[]",cat:"e",args:"ext-id | path",description:d(1927,null)},"pre-release":{type:"boolean",cat:"e",description:d(1928,null)},"uninstall-extension":{type:"string[]",cat:"e",args:"ext-id",description:d(1929,null)},"update-extensions":{type:"boolean",cat:"e",description:d(1930,null)},"enable-proposed-api":{type:"string[]",allowEmptyValue:!0,cat:"e",args:"ext-id",description:d(1931,null)},"add-mcp":{type:"string[]",cat:"m",args:"json",description:d(1932,null)},version:{type:"boolean",cat:"t",alias:"v",description:d(1933,null)},verbose:{type:"boolean",cat:"t",global:!0,description:d(1934,null)},log:{type:"string[]",cat:"t",args:"level",global:!0,description:d(1935,null)},status:{type:"boolean",alias:"s",cat:"t",description:d(1936,null)},"prof-startup":{type:"boolean",cat:"t",description:d(1937,null)},"prof-append-timers":{type:"string"},"prof-duration-markers":{type:"string[]"},"prof-duration-markers-file":{type:"string"},"no-cached-data":{type:"boolean"},"prof-startup-prefix":{type:"string"},"prof-v8-extensions":{type:"boolean"},"disable-extensions":{type:"boolean",deprecates:["disableExtensions"],cat:"t",description:d(1938,null)},"disable-extension":{type:"string[]",cat:"t",args:"ext-id",description:d(1939,null)},sync:{type:"string",cat:"t",description:d(1940,null),args:["on | off"]},"inspect-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugPluginHost"],args:"port",cat:"t",description:d(1941,null)},"inspect-brk-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugBrkPluginHost"],args:"port",cat:"t",description:d(1942,null)},"disable-lcd-text":{type:"boolean",cat:"t",description:d(1943,null)},"disable-gpu":{type:"boolean",cat:"t",description:d(1944,null)},"disable-chromium-sandbox":{type:"boolean",cat:"t",description:d(1945,null)},sandbox:{type:"boolean"},"locate-shell-integration-path":{type:"string",cat:"t",args:["shell"],description:d(1946,null)},telemetry:{type:"boolean",cat:"t",description:d(1947,null)},remote:{type:"string",allowEmptyValue:!0},"folder-uri":{type:"string[]",cat:"o",args:"uri"},"file-uri":{type:"string[]",cat:"o",args:"uri"},"locate-extension":{type:"string[]"},extensionDevelopmentPath:{type:"string[]"},extensionDevelopmentKind:{type:"string[]"},extensionTestsPath:{type:"string"},extensionEnvironment:{type:"string"},debugId:{type:"string"},debugRenderer:{type:"boolean"},"inspect-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-brk-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-search":{type:"string",deprecates:["debugSearch"],allowEmptyValue:!0},"inspect-brk-search":{type:"string",deprecates:["debugBrkSearch"],allowEmptyValue:!0},"inspect-sharedprocess":{type:"string",allowEmptyValue:!0},"inspect-brk-sharedprocess":{type:"string",allowEmptyValue:!0},"export-default-configuration":{type:"string"},"export-policy-data":{type:"string",allowEmptyValue:!0},"install-source":{type:"string"},"enable-smoke-test-driver":{type:"boolean"},logExtensionHostCommunication:{type:"boolean"},"skip-release-notes":{type:"boolean"},"skip-welcome":{type:"boolean"},"disable-telemetry":{type:"boolean"},"disable-updates":{type:"boolean"},transient:{type:"boolean",cat:"t",description:d(1948,null)},"use-inmemory-secretstorage":{type:"boolean",deprecates:["disable-keytar"]},"password-store":{type:"string"},"disable-workspace-trust":{type:"boolean"},"disable-crash-reporter":{type:"boolean"},"crash-reporter-directory":{type:"string"},"crash-reporter-id":{type:"string"},"skip-add-to-recently-opened":{type:"boolean"},"open-url":{type:"boolean"},"file-write":{type:"boolean"},"file-chmod":{type:"boolean"},"install-builtin-extension":{type:"string[]"},force:{type:"boolean"},"do-not-sync":{type:"boolean"},"do-not-include-pack-dependencies":{type:"boolean"},trace:{type:"boolean"},"trace-memory-infra":{type:"boolean"},"trace-category-filter":{type:"string"},"trace-options":{type:"string"},"preserve-env":{type:"boolean"},"force-user-env":{type:"boolean"},"force-disable-user-env":{type:"boolean"},"open-devtools":{type:"boolean"},"disable-gpu-sandbox":{type:"boolean"},logsPath:{type:"string"},"__enable-file-policy":{type:"boolean"},editSessionId:{type:"string"},continueOn:{type:"string"},"enable-coi":{type:"boolean"},"unresponsive-sample-interval":{type:"string"},"unresponsive-sample-period":{type:"string"},"enable-rdp-display-tracking":{type:"boolean"},"disable-layout-restore":{type:"boolean"},"disable-experiments":{type:"boolean"},"no-proxy-server":{type:"boolean"},"no-sandbox":{type:"boolean",alias:"sandbox"},"proxy-server":{type:"string"},"proxy-bypass-list":{type:"string"},"proxy-pac-url":{type:"string"},"js-flags":{type:"string"},inspect:{type:"string",allowEmptyValue:!0},"inspect-brk":{type:"string",allowEmptyValue:!0},nolazy:{type:"boolean"},"force-device-scale-factor":{type:"string"},"force-renderer-accessibility":{type:"boolean"},"ignore-certificate-errors":{type:"boolean"},"allow-insecure-localhost":{type:"boolean"},"log-net-log":{type:"string"},vmodule:{type:"string"},_urls:{type:"string[]"},"disable-dev-shm-usage":{type:"boolean"},"profile-temp":{type:"boolean"},"ozone-platform":{type:"string"},"enable-tracing":{type:"string"},"trace-startup-format":{type:"string"},"trace-startup-file":{type:"string"},"trace-startup-duration":{type:"string"},"xdg-portal-required-version":{type:"string"},_:{type:"string[]"}};function aN(e){return e.VSCODE_CLI==="1"}var XS=void 0;async function DX(e,t,i,s){return i["force-disable-user-env"]?(t.trace("resolveShellEnv(): skipped (--force-disable-user-env)"),{}):ze?(t.trace("resolveShellEnv(): skipped (Windows)"),{}):aN(s)&&!i["force-user-env"]?(t.trace("resolveShellEnv(): skipped (VSCODE_CLI is set)"),{}):(aN(s)?t.trace("resolveShellEnv(): running (--force-user-env)"):t.trace("resolveShellEnv(): running (macOS/Linux)"),XS||(XS=Wn.withAsyncBody(async(r,n)=>{const o=new Qe;let a=1e4;const c=e.getValue("application.shellEnvironmentResolutionTimeout");typeof c=="number"&&(a=vj(c,1,120)*1e3);const l=setTimeout(()=>{o.dispose(!0),n(new Error(d(2314,null)))},a);try{r(await PX(t,o.token))}catch(u){!Mi(u)&&!o.token.isCancellationRequested?n(new Error(d(2315,null,Sr(u)))):r({})}finally{clearTimeout(l),o.dispose()}})),XS)}async function PX(e,t){const i=process.env.ELECTRON_RUN_AS_NODE;e.trace("getUnixShellEnvironment#runAsNode",i);const s=process.env.ELECTRON_NO_ATTACH_CONSOLE;e.trace("getUnixShellEnvironment#noAttach",s);const r=Nt().replace(/-/g,"").substr(0,12),n=new RegExp(r+"({.*})"+r),o={...process.env,ELECTRON_RUN_AS_NODE:"1",ELECTRON_NO_ATTACH_CONSOLE:"1",VSCODE_RESOLVING_ENVIRONMENT:"1"};e.trace("getUnixShellEnvironment#env",o);const a=await kX(zo,o);return e.trace("getUnixShellEnvironment#shell",a),new Promise((c,l)=>{if(t.isCancellationRequested)return l(new dt);const u=vt(a);let h,f;const p="";/^(?:pwsh|powershell)(?:-preview)?$/.test(u)?(h=`& '${process.execPath}' ${p} -p '''${r}'' + JSON.stringify(process.env) + ''${r}'''`,f=["-Login","-Command"]):u==="nu"?(h=`^'${process.execPath}' ${p} -p '"${r}" + JSON.stringify(process.env) + "${r}"'`,f=["-i","-l","-c"]):u==="xonsh"?(h=`import os, json; print("${r}", json.dumps(dict(os.environ)), "${r}")`,f=["-i","-l","-c"]):(h=`'${process.execPath}' ${p} -p '"${r}" + JSON.stringify(process.env) + "${r}"'`,u==="tcsh"||u==="csh"?f=["-ic"]:f=["-i","-l","-c"]),e.trace("getUnixShellEnvironment#spawn",JSON.stringify(f),h);const g=gX(a,[...f,h],{detached:!0,stdio:["ignore","pipe","pipe"],env:o});t.onCancellationRequested(()=>(g.kill(),l(new dt))),g.on("error",S=>{e.error("getUnixShellEnvironment#errorChildProcess",Sr(S)),l(S)});const v=[];g.stdout.on("data",S=>v.push(S));const b=[];g.stderr.on("data",S=>b.push(S)),g.on("close",(S,E)=>{const k=Buffer.concat(v).toString("utf8");e.trace("getUnixShellEnvironment#raw",k);const j=Buffer.concat(b).toString("utf8");if(j.trim()&&e.trace("getUnixShellEnvironment#stderr",j),S||E)return l(new Error(d(2316,null,S,E)));const O=n.exec(k),Q=O?O[1]:"{}";try{const F=JSON.parse(Q);i?F.ELECTRON_RUN_AS_NODE=i:delete F.ELECTRON_RUN_AS_NODE,s?F.ELECTRON_NO_ATTACH_CONSOLE=s:delete F.ELECTRON_NO_ATTACH_CONSOLE,delete F.VSCODE_RESOLVING_ENVIRONMENT,delete F.XDG_RUNTIME_DIR,e.trace("getUnixShellEnvironment#result",F),c(F)}catch(F){e.error("getUnixShellEnvironment#errorCaught",Sr(F)),l(F)}})})}import{parse as cN}from"url";function TX(e,t){return e.protocol==="http:"?t.HTTP_PROXY||t.http_proxy||null:e.protocol==="https:"&&(t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy)||null}async function NX(e,t,i={}){const s=cN(e),r=i.proxyUrl||TX(s,t);if(!r)return null;const n=cN(r);if(!/^https?:$/.test(n.protocol||""))return null;const o={host:n.hostname||"",port:(n.port?+n.port:0)||(n.protocol==="https"?443:80),auth:n.auth,rejectUnauthorized:uE(i.strictSSL)?i.strictSSL:!0};if(s.protocol==="http:"){const{default:a}=await import("http-proxy-agent");return new a.HttpProxyAgent(r,o)}else{const{default:a}=await import("https-proxy-agent");return new a.HttpsProxyAgent(r,o)}}import{createGunzip as MX}from"zlib";var lN=class extends aQ{constructor(t,i,s,r){super(r),this.m=t,this.n=i,this.q=s,this.r(),this.D(i.onDidChangeConfiguration(n=>{n.affectsConfiguration("http")&&this.r()}))}r(){this.f=this.s("http.proxy"),this.g=!!this.s("http.proxyStrictSSL"),this.h=this.s("http.proxyAuthorization")}async request(t,i){const{f:s,g:r}=this;let n;try{n=await DX(this.n,this.b,this.q.args,process.env)}catch(c){this.j||(this.j=!0,this.b.error("resolving shell environment failed",eE(c)))}const o={...process.env,...n},a=t.agent?t.agent:await NX(t.url||"",o,{proxyUrl:s,strictSSL:r});return t.agent=a,t.strictSSL=r,this.h&&(t.headers={...t.headers||{},"Proxy-Authorization":this.h}),this.c(t,()=>hN(t,i))}async resolveProxy(t){}async lookupAuthorization(t){}async lookupKerberosAuthorization(t){try{const i=this.s("http.proxyKerberosServicePrincipal");return"Negotiate "+await uN(t,i,this.b,"RequestService#lookupKerberosAuthorization")}catch(i){this.b.debug("RequestService#lookupKerberosAuthorization Kerberos authentication failed",i);return}}async loadCertificates(){return(await import("@vscode/proxy-agent")).loadSystemCertificates({loadSystemCertificatesFromNode:()=>this.s("http.systemCertificatesNode",x1),log:this.b})}s(t,i){if(this.m==="remote")return this.n.getValue(t);const s=this.n.inspect(t);return s.userLocalValue??s.defaultValue??i}};lN=__decorate([__param(1,gi),__param(2,AV),__param(3,Se)],lN);async function uN(e,t,i,s){const r=await import("kerberos"),n=r.default||r,o=new URL(e),a=t||(process.platform==="win32"?`HTTP/${o.hostname}`:`HTTP@${o.hostname}`);return i.debug(`${s} Kerberos authentication lookup`,`proxyURL:${o}`,`spn:${a}`),(await n.initializeClient(a)).step("")}async function LX(e){return(iN(e.url).protocol==="https:"?await import("https"):await import("http")).request}async function hN(e,t){return Wn.withAsyncBody(async(i,s)=>{const r=iN(e.url),n=e.getRawRequest?e.getRawRequest(e):await LX(e),o={hostname:r.hostname,port:r.port?parseInt(r.port):r.protocol==="https:"?443:80,protocol:r.protocol,path:r.path,method:e.type||"GET",headers:e.headers,agent:e.agent,rejectUnauthorized:uE(e.strictSSL)?e.strictSSL:!0};e.user&&e.password&&(o.auth=e.user+":"+e.password),e.disableCache&&(o.cache="no-store");const a=n(o,c=>{const l=Cs(e.followRedirects)?e.followRedirects:3;if(c.statusCode&&c.statusCode>=300&&c.statusCode<400&&l>0&&c.headers.location)hN({...e,url:c.headers.location,followRedirects:l-1},t).then(i,s);else{let u=c;!e.isChromiumNetwork&&c.headers["content-encoding"]==="gzip"&&(u=c.pipe(MX())),i({res:c,stream:TO(u)})}});if(a.on("error",s),e.timeout)if(e.isChromiumNetwork){const c=setTimeout(()=>{a.abort(),s(new Error(`Request timeout after ${e.timeout}ms`))},e.timeout);a.on("response",()=>clearTimeout(c)),a.on("error",()=>clearTimeout(c)),a.on("abort",()=>clearTimeout(c))}else a.setTimeout(e.timeout);e.isChromiumNetwork&&a.removeHeader("Content-Length"),e.data&&typeof e.data=="string"&&a.write(e.data),a.end(),t.onCancellationRequested(()=>{a.abort(),s(new dt)})})}import*as _1 from"@vscode/proxy-agent";var Hl=pX(import.meta.url),dN=Hl("http"),V1=Hl("https"),fN=Hl("tls"),pN=Hl("net"),gN=!1,mN=!1;function RX(e,t,i,s,r,n,o){const a=n.remote.isRemote,c=n.environment.useHostProxy??!a,l=c,u=c,h=()=>!a||t.getConfiguration("http").get("useLocalProxyConfiguration",c),p={resolveProxy:HX(e,r),lookupProxyAuthorization:qX.bind(void 0,e,s,r,t,{},{},n.remote.isRemote,l),getProxyURL:()=>Us(t,a,"http.proxy"),getProxySupport:()=>Us(t,a,"http.proxySupport")||"off",getNoProxyConfig:()=>Us(t,a,"http.noProxy")||[],isAdditionalFetchSupportEnabled:()=>Us(t,a,"http.fetchAdditionalSupport",!0),addCertificatesV1:()=>BX(t,a),addCertificatesV2:()=>_X(t,a),loadSystemCertificatesFromNode:()=>Us(t,a,"http.systemCertificatesNode",x1),log:s,getLogLevel:()=>{const E=s.getLevel();switch(E){case X.Trace:return qa.Trace;case X.Debug:return qa.Debug;case X.Info:return qa.Info;case X.Warning:return qa.Warning;case X.Error:return qa.Error;case X.Off:return qa.Off;default:return k(E)}function k(j){return s.error("Unknown log level",j),qa.Debug}},proxyResolveTelemetry:()=>{},isUseHostProxyEnabled:h,getNetworkInterfaceCheckInterval:()=>Us(t,a,"http.experimental.networkInterfaceCheckInterval",300)*1e3,loadAdditionalCertificates:async()=>{const E=Us(t,a,"http.systemCertificatesNode",x1),k=[];if(a&&k.push(tN({loadSystemCertificatesFromNode:()=>E,log:s})),u)if(!a&&E)k.push(tN({loadSystemCertificatesFromNode:()=>E,log:s}));else{s.trace("ProxyResolver#loadAdditionalCertificates: Loading certificates from main process");const j=e.loadCertificates();j.then(O=>s.trace("ProxyResolver#loadAdditionalCertificates: Loaded certificates from main process",O.length)),k.push(j)}return n.environment.extensionTestsLocationURI&&V1.globalAgent.testCertificates?.length&&(s.trace("ProxyResolver#loadAdditionalCertificates: Loading test certificates"),k.push(Promise.resolve(V1.globalAgent.testCertificates))),(await Promise.all(k)).flat()},env:process.env},{resolveProxyWithRequest:g,resolveProxyURL:v}=hX(p),b=_1.default||_1;b.resolveProxyURL=v,FX(p,t,r,n,v,o);const S=WX(p,g);return VX(i,S)}var OX=["content-length","host","trailer","te","upgrade","cookie2","keep-alive","transfer-encoding","set-cookie"];function FX(e,t,i,s,r,n){if(!globalThis.__vscodeOriginalFetch){const o=globalThis.fetch;globalThis.__vscodeOriginalFetch=o;const a=_1.createFetchPatch(e,o,r);globalThis.__vscodePatchedFetch=a;let c=!1;s.remote.isRemote||(c=t.getConfiguration("http").get("electronFetch",mN),n.add(t.onDidChangeConfiguration(l=>{l.affectsConfiguration("http.electronFetch")&&(c=t.getConfiguration("http").get("electronFetch",mN))}))),globalThis.fetch=async function(u,h){function f(O){return h&&O in h?h[O]:typeof u=="object"&&"cache"in u?u[O]:void 0}const p=typeof u=="string"?u:"cache"in u?u.url:u.toString(),g=p.startsWith("data:");g&&Wl(i,"data");const v=p.startsWith("blob:");v&&Wl(i,"blob");const b=f("redirect")==="manual";b&&Wl(i,"manualRedirect");const S=f("integrity");if(S&&Wl(i,"integrity"),!c||g||v||b||S){const O=await a(u,h);return vN(i,O,p),O}if(h?.headers){const O=new Headers(h.headers);for(const Q of OX)O.delete(Q);h={...h,headers:O}}const E=u instanceof URL?u.toString():u,j=await Hl("electron").net.fetch(E,h);return vN(i,j,p),j}}}function vN(e,t,i){const s=t.url;Object.defineProperty(t,"url",{get(){return Wl(e,"url"),s||i}});const r=t.type;Object.defineProperty(t,"type",{get(){return Wl(e,"typeProperty"),r!=="default"?r:"basic"}})}var wN={url:0,typeProperty:0,data:0,blob:0,integrity:0,manualRedirect:0},q1,UX=!1;function Wl(e,t){UX&&!wN[t]++&&(q1&&clearTimeout(q1),q1=setTimeout(()=>{e.$publicLog2("fetchFeatureUse",wN)},1e4),q1.unref?.())}var hi={count:0,totalDuration:0,minDuration:Number.MAX_SAFE_INTEGER,maxDuration:0,lastSentTime:0},jX=60*60*1e3;function zX(e){if(hi.count>0){const t=hi.totalDuration/hi.count;e.$publicLog2("proxyResolveStats",{count:hi.count,totalDuration:hi.totalDuration,minDuration:hi.minDuration,maxDuration:hi.maxDuration,avgDuration:t}),hi.count=0,hi.totalDuration=0,hi.minDuration=Number.MAX_SAFE_INTEGER,hi.maxDuration=0}hi.lastSentTime=Date.now()}function HX(e,t){return async i=>{const s=performance.now();try{return await e.resolveProxy(i)}finally{const r=performance.now()-s;hi.count++,hi.totalDuration+=r,hi.minDuration=Math.min(hi.minDuration,r),hi.maxDuration=Math.max(hi.maxDuration,r),Date.now()-hi.lastSentTime>=jX&&zX(t)}}}function WX(e,t){function i(s,r){const n=s.default||s;return n.__vscodeOriginal=Object.assign({},n),Object.assign(n,r)}return{http:i(dN,eN(e,dN,t)),https:i(V1,eN(e,V1,t)),net:i(pN,fX(e,pN)),tls:i(fN,dX(e,fN))}}function BX(e,t){return!Us(e,t,"http.experimental.systemCertificatesV2",gN)&&!!Us(e,t,"http.systemCertificates")}function _X(e,t){return!!Us(e,t,"http.experimental.systemCertificatesV2",gN)&&!!Us(e,t,"http.systemCertificates")}var bN=new Map;function VX(e,t){return e.getExtensionPathIndex().then(i=>{const s=Hl("module"),r=s._load;s._load=function(o,a,c){if(o==="net")return t.net;if(o==="tls")return t.tls;if(o!=="http"&&o!=="https"&&o!=="undici")return r.apply(this,arguments);const l=i.findSubstr(y.file(a.filename));let u=bN.get(l);if(u||bN.set(l,u={}),!u[o])if(o==="undici"){const h=r.apply(this,arguments);_1.patchUndici(h),u[o]=h}else{const h=t[o];u[o]={...h}}return u[o]}})}async function qX(e,t,i,s,r,n,o,a,c,l,u){const h=r[c];l&&(r[c]=l),t.trace("ProxyResolver#lookupProxyAuthorization callback",`proxyURL:${c}`,`proxyAuthenticate:${l}`,`proxyAuthenticateCache:${h}`);const f=l||h,p=Array.isArray(f)?f:typeof f=="string"?[f]:[];if(JX(i,p,o),p.some(v=>/^(Negotiate|Kerberos)( |$)/i.test(v))&&!u.kerberosRequested){u.kerberosRequested=!0;try{const v=Us(s,o,"http.proxyKerberosServicePrincipal");return"Negotiate "+await uN(c,v,t,"ProxyResolver#lookupProxyAuthorization")}catch(v){t.debug("ProxyResolver#lookupProxyAuthorization Kerberos authentication failed",v)}if(o&&a){t.debug("ProxyResolver#lookupProxyAuthorization Kerberos authentication lookup on host",`proxyURL:${c}`);const v=await e.lookupKerberosAuthorization(c);if(v)return"Negotiate "+v}}const g=p.find(v=>/^Basic( |$)/i.test(v));if(g)try{const v=n[c];if(v)if(u.basicAuthCacheUsed)t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication deleting cached credentials",`proxyURL:${c}`),delete n[c];else return t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication using cached credentials",`proxyURL:${c}`),u.basicAuthCacheUsed=!0,v;u.basicAuthAttempt=(u.basicAuthAttempt||0)+1;const b=/ realm="([^"]+)"/i.exec(g)?.[1];t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication lookup",`proxyURL:${c}`,`realm:${b}`);const S=new URL(c),E={scheme:"basic",host:S.hostname,port:Number(S.port),realm:b||"",isProxy:!0,attempt:u.basicAuthAttempt},k=await e.lookupAuthorization(E);if(k){t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication received credentials",`proxyURL:${c}`,`realm:${b}`);const j="Basic "+Buffer.from(`${k.username}:${k.password}`).toString("base64");return n[c]=j,j}else t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication received no credentials",`proxyURL:${c}`,`realm:${b}`)}catch(v){t.error("ProxyResolver#lookupProxyAuthorization Basic authentication failed",v)}}var yN=!1,GX=!1;function JX(e,t,i){!GX||yN||!t.length||(yN=!0,e.$publicLog2("proxyAuthenticationRequest",{authenticationType:t.map(s=>s.split(" ")[0]).join(","),extensionHostType:i?"remote":"local"}))}function Us(e,t,i,s){if(t)return e.getConfiguration().get(i)??s;const r=e.getConfiguration().inspect(i);return r?.globalLocalValue??r?.defaultValue??s}import{tmpdir as ZX}from"os";var KS=class extends Z{constructor(t,i){super();const s=t.getProxy(Y.MainThreadDownloadService);i.registerCommand(!1,"_workbench.downloadResource",async r=>{const n=y.file(_e(ZX(),Nt()));return await s.$download(r,n),n})}};KS=__decorate([__param(0,ke),__param(1,cr)],KS);import*as QX from"http";import*as AN from"fs";var YX=class{constructor(e,t,i){this.b=e,this.c=t,this.f=i,this.a=QX.createServer((s,r)=>this.h(s,r)),this.g().catch(s=>(t.error(s),""))}get ipcHandlePath(){return this.f}async g(){try{this.a.listen(this.ipcHandlePath),this.a.on("error",e=>this.c.error(e))}catch{this.c.error("Could not start open from terminal server.")}return this.f}h(e,t){const i=(r,n)=>{t.writeHead(r,{"content-type":"application/json"}),t.end(JSON.stringify(n||null),o=>o&&this.c.error(o))},s=[];e.setEncoding("utf8"),e.on("data",r=>s.push(r)),e.on("end",async()=>{try{const r=JSON.parse(s.join(""));let n;switch(r.type){case"open":n=await this.i(r);break;case"openExternal":n=await this.j(r);break;case"status":n=await this.l(r);break;case"extensionManagement":n=await this.k(r);break;default:i(404,`Unknown message type: ${r.type}`);break}i(200,n)}catch(r){const n=r instanceof Error?r.message:JSON.stringify(r);i(500,n),this.c.error("Error while processing pipe request",r)}})}async i(e){const{fileURIs:t,folderURIs:i,forceNewWindow:s,diffMode:r,mergeMode:n,addMode:o,removeMode:a,forceReuseWindow:c,gotoLineMode:l,waitMarkerFilePath:u,remoteAuthority:h}=e,f=[];if(Array.isArray(i))for(const b of i)try{f.push({folderUri:y.parse(b)})}catch{}if(Array.isArray(t))for(const b of t)try{Cj(b)?f.push({workspaceUri:y.parse(b)}):f.push({fileUri:y.parse(b)})}catch{}const p=u?y.file(u):void 0,v={forceNewWindow:s,diffMode:r,mergeMode:n,addMode:o,removeMode:a,gotoLineMode:l,forceReuseWindow:c,preferNewWindow:!c&&!p&&!o&&!a,waitMarkerFileURI:p,remoteAuthority:h};this.b.executeCommand("_remoteCLI.windowOpen",f,v)}async j(e){for(const t of e.uris){const i=y.parse(t),s=i.scheme==="file"?i:t;await this.b.executeCommand("_remoteCLI.openExternal",s)}}async k(e){const t=s=>s?.map(r=>/\.vsix$/i.test(r)?y.parse(r):r),i={list:e.list,install:t(e.install),uninstall:t(e.uninstall),force:e.force};return await this.b.executeCommand("_remoteCLI.manageExtensions",i)}async l(e){return await this.b.executeCommand("_remoteCLI.getSystemStatus")}dispose(){this.a.close(),this.f&&process.platform!=="win32"&&AN.existsSync(this.f)&&AN.unlinkSync(this.f)}},e5=class extends YX{constructor(t,i){super(t,i,SF())}};e5=__decorate([__param(0,cr),__param(1,Se)],e5);var t5=class{constructor(t,i){this.a=t.getProxy(Y.MainThreadConsole),this.b=i.consoleForward.includeStack,this.c=i.consoleForward.logNative,this.d("info","log"),this.d("log","log"),this.d("warn","warn"),this.d("debug","debug"),this.d("error","error")}d(t,i){const s=this,r=console[t];Object.defineProperty(console,t,{set:()=>{},get:()=>function(){s.e(t,i,r,arguments)}})}e(t,i,s,r){this.a.$logExtensionHostMessage({type:"__$console",severity:i,arguments:KX(r,this.b)}),this.c&&this.f(t,s,r)}};t5=__decorate([__param(0,ke),__param(1,jt)],t5);var XX=1e5;function KX(e,t){const i=[];if(e.length)for(let s=0;s<e.length;s++){let r=e[s];if(typeof r>"u")r="undefined";else if(r instanceof Error){const n=r;n.stack?r=n.stack:r=n.toString()}i.push(r)}if(t){const s=new Error().stack;s&&i.push({__$stack:s.split(`
`).slice(3).join(`
`)})}try{const s=xF(i);return s.length>XX?"Output omitted for a large object that exceeds the limits":s}catch(s){return`Output omitted for an object that cannot be inspected ('${s.toString()}')`}}var eK=1024*1024,i5=class extends t5{constructor(t,i){super(t,i),this.g=!1,this.j("stderr","error"),this.j("stdout","log")}f(t,i,s){const r=t==="error"||t==="warn"?process.stderr:process.stdout;this.g=!0,r.write(`
START_NATIVE_LOG
`),i.apply(console,s),r.write(`
END_NATIVE_LOG
`),this.g=!1}j(t,i){const s=process[t],r=s.write;let n="";Object.defineProperty(s,"write",{set:()=>{},get:()=>(o,a,c)=>{if(!this.g){n+=o.toString(a);const l=n.length>eK?n.length:n.lastIndexOf(`
`);l!==-1&&(console[i](n.slice(0,l)),n=n.slice(l+1))}r.call(s,o,a,c)}})}};i5=__decorate([__param(0,ke),__param(1,jt)],i5);import{promises as Ga}from"fs";async function tK(e,t,i,s,r,n){let o;try{await iK(e,t,i,s,r,n)}catch(a){o=a}finally{o&&r.errorTransformer&&(o=r.errorTransformer(o)),typeof o<"u"&&i.error(o),i.end()}}async function iK(e,t,i,s,r,n){s5(n);const o=await e.open(t,{create:!1});try{s5(n);let a=0,c=0,l=r&&typeof r.length=="number"?r.length:void 0,u=W.alloc(Math.min(r.bufferSize,typeof l=="number"?l:r.bufferSize)),h=r&&typeof r.position=="number"?r.position:0,f=0;do c=await e.read(o,h,u.buffer,f,u.byteLength-f),h+=c,f+=c,a+=c,typeof l=="number"&&(l-=c),f===u.byteLength&&(await i.write(s(u)),u=W.alloc(Math.min(r.bufferSize,typeof l=="number"?l:r.bufferSize)),f=0);while(c>0&&(typeof l!="number"||l>0)&&s5(n)&&sK(a,r));if(f>0){let p=f;typeof l=="number"&&(p=Math.min(f,l)),i.write(s(u.slice(0,p)))}}catch(a){throw Dz(a)}finally{await e.close(o)}}function s5(e){if(e.isCancellationRequested)throw ru();return!0}function sK(e,t){if(typeof t?.limits?.size=="number"&&e>t.limits.size)throw nn(d(2122,null),he.FileTooLarge);return!0}var rK=class extends Z{constructor(e,t){super(),this.a=e,this.b=t,this.c=this.D(new I),this.onDidChangeFile=this.c.event,this.g=this.D(new I),this.onDidWatchError=this.g.event,this.m=[],this.n=this.D(new pu(this.h(this.m.length))),this.y=[],this.z=this.D(new pu(this.h(this.y.length)))}watch(e,t){return t.recursive||this.b?.watcher?.forceUniversal?this.q(e,t):this.C(e,t)}h(e){return e>200?500:0}q(e,t){const i=this.r(e,t),s=iE(this.m,i);return this.s(),te(()=>{s(),this.s()})}r(e,t){const i={path:this.M(e),excludes:t.excludes,includes:t.includes,recursive:t.recursive,filter:t.filter,correlationId:t.correlationId};if(PZ(i)){const s=this.b?.watcher?.recursive?.usePolling;s===!0?i.pollingInterval=this.b?.watcher?.recursive?.pollingInterval??5e3:Array.isArray(s)&&s.includes(i.path)&&(i.pollingInterval=this.b?.watcher?.recursive?.pollingInterval??5e3)}return i}s(){this.n.trigger(()=>this.t(),this.h(this.m.length)).catch(e=>lt(e))}t(){return this.j||(this.j=this.D(this.u(e=>this.c.fire(YP(e)),e=>this.I(e),this.a.getLevel()===X.Trace)),this.D(this.a.onDidChangeLogLevel(()=>{this.j?.setVerboseLogging(this.a.getLevel()===X.Trace)}))),this.j.watch(this.m)}C(e,t){const i={path:this.M(e),excludes:t.excludes,includes:t.includes,recursive:!1,filter:t.filter,correlationId:t.correlationId},s=iE(this.y,i);return this.F(),te(()=>{s(),this.F()})}F(){this.z.trigger(()=>this.G(),this.h(this.y.length)).catch(e=>lt(e))}G(){return this.w||(this.w=this.D(this.H(e=>this.c.fire(YP(e)),e=>this.I(e),this.a.getLevel()===X.Trace)),this.D(this.a.onDidChangeLogLevel(()=>{this.w?.setVerboseLogging(this.a.getLevel()===X.Trace)}))),this.w.watch(this.y)}I(e){e.type==="error"&&this.g.fire(e.message),this.J(e)}J(e){this.a[e.type](e.message)}L(e){return Xr(e.fsPath)}M(e){const t=this.L(e);return O2(t)}};import{fork as nK}from"child_process";function oK(e){const t=e;return t&&typeof t.type=="string"&&typeof t.severity=="string"}function aK(e){const t=[];let i;try{const s=JSON.parse(e.arguments),r=s[s.length-1];r&&r.__$stack&&(s.pop(),i=r.__$stack),t.push(...s)}catch{t.push("Unable to log remote console arguments",e.arguments)}return{args:t,stack:i}}function cK(e){if(!e)return e;const t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function lK(e,t){const{args:i,stack:s}=aK(e),r=typeof i[0]=="string"&&i.length===1;let n=cK(s);n&&(n=`(${n.trim()})`);let o=[];if(typeof i[0]=="string"?n&&r?o=[`%c[${t}] %c${i[0]} %c${n}`,Bl("blue"),Bl(""),Bl("grey")]:o=[`%c[${t}] %c${i[0]}`,Bl("blue"),Bl(""),...i.slice(1)]:o=[`%c[${t}]%`,Bl("blue"),...i],n&&!r&&o.push(n),typeof console[e.severity]!="function")throw new Error("Unknown console method");console[e.severity].apply(console,o)}function Bl(e){return`color: ${e}`}var uK=class{constructor(e,t){this.i=e,this.j=t,this.c=new Set,this.g=new Map,this.h=new I,this.onDidProcessExit=this.h.event;const i=t.timeout||6e4;this.b=new wx(i),this.d=null,this.f=null}getChannel(e){const t=this;return{call(i,s,r){return t.k(e,i,s,r)},listen(i,s){return t.l(e,i,s)}}}k(e,t,i,s=Fe.None){if(!this.b)return Promise.reject(new Error("disposed"));if(s.isCancellationRequested)return Promise.reject(ru());this.b.cancel();const r=this.n(e),n=Kr(c=>r.call(t,i,c)),o=s.onCancellationRequested(()=>n.cancel()),a=te(()=>n.cancel());return this.c.add(a),n.finally(()=>{o.dispose(),this.c.delete(a),this.c.size===0&&this.b&&this.b.trigger(()=>this.o())}),n}l(e,t,i){if(!this.b)return Ie.None;this.b.cancel();let s;const r=new I({onWillAddFirstListener:()=>{s=this.n(e).listen(t,i)(r.fire,r),this.c.add(s)},onDidRemoveLastListener:()=>{this.c.delete(s),s.dispose(),this.c.size===0&&this.b&&this.b.trigger(()=>this.o())}});return r.event}get m(){if(!this.f){const e=this.j.args||[],t=Object.create(null);t.env={...ot(process.env),VSCODE_PARENT_PID:String(process.pid)},this.j.env&&(t.env={...t.env,...this.j.env}),this.j.freshExecArgv&&(t.execArgv=[]),typeof this.j.debug=="number"&&(t.execArgv=["--nolazy","--inspect="+this.j.debug]),typeof this.j.debugBrk=="number"&&(t.execArgv=["--nolazy","--inspect-brk="+this.j.debugBrk]),t.execArgv===void 0&&(t.execArgv=process.execArgv.filter(u=>!/^--inspect(-brk)?=/.test(u)).filter(u=>!u.startsWith("--vscode-"))),yG(t.env),this.d=nK(this.i,e,t);const i=new I,r=Ie.fromNodeEventEmitter(this.d,"message",u=>u)(u=>{if(oK(u)){lK(u,`IPC Library: ${this.j.serverName}`);return}i.fire(W.wrap(Buffer.from(u,"base64")))}),n=this.j.useQueue?AG(this.d):this.d,o=u=>this.d?.connected&&n.send(u.buffer.toString("base64")),a=i.event,c={send:o,onMessage:a};this.f=new Xx(c);const l=()=>this.o();process.once("exit",l),this.d.on("error",u=>console.warn('IPC "'+this.j.serverName+'" errored with '+u)),this.d.on("exit",(u,h)=>{process.removeListener("exit",l),r.dispose(),this.c.forEach(f=>Zi(f)),this.c.clear(),u!==0&&h!=="SIGTERM"&&console.warn('IPC "'+this.j.serverName+'" crashed with exit code '+u+" and signal "+h),this.b?.cancel(),this.o(),this.h.fire({code:u,signal:h})})}return this.f}n(e){let t=this.g.get(e);return t||(t=this.m.getChannel(e),this.g.set(e,t)),t}o(){this.f&&(this.d&&(this.d.kill(),this.d=null),this.f=null,this.g.clear())}dispose(){this.h.dispose(),this.b?.cancel(),this.b=void 0,this.o(),this.c.clear()}},hK=class extends NZ{constructor(e,t,i){super(e,t,i),this.r()}q(e){const t=e.add(new uK(mf.asFileUri("bootstrap-fork").fsPath,{serverName:"File Watcher",args:["--type=fileWatcher"],env:{VSCODE_ESM_ENTRYPOINT:"vs/platform/files/node/watcher/watcherMain",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));return e.add(t.onDidProcessExit(({code:i,signal:s})=>this.s(`terminated by itself with code ${i}, signal: ${s} (ETERM)`))),u0.toService(cF(t.getChannel("watcher")))}};import{watchFile as dK,unwatchFile as fK}from"fs";var pK=class extends Z{constructor(){super(),this.a=this.D(new I),this.onDidChangeFile=this.a.event,this.b=this.D(new I),this.onDidLogMessage=this.b.event,this.c=this.D(new I),this.f=this.c.event,this.g=new Map,this.h=new Map,this.j=this.D(new Fo),this.m=new Set,this.n=this.D(new pu(this.w())),this.q=5007,this.r=new Ri,this.R=!1,this.D(this.f(e=>this.y({id:this.t(e),correlationId:this.s(e)?e.correlationId:void 0,path:e.path})))}s(e){return ZP(e)}t(e){return this.s(e)?e.correlationId:sn(e)}async watch(e){this.r.isSettled||this.r.complete(),this.r=new Ri;try{this.g.clear(),this.h.clear();for(const t of e)this.s(t)?this.g.set(t.correlationId,t):this.h.set(this.t(t),t);for(const[t]of this.j)!this.h.has(t)&&!this.g.has(t)&&(this.j.deleteAndDispose(t),this.m.delete(t));return await this.u(!1)}finally{this.r.complete()}}u(e){const t=[];for(const[i,s]of[...this.h,...this.g])this.j.has(i)||t.push(s);return this.n.trigger(()=>this.N(t),e?this.w():0).catch(i=>lt(i))}w(){return 800}isSuspended(e){const t=this.t(e);return this.m.has(t)?"polling":this.j.has(t)}async y(e){if(this.j.has(e.id))return;const t=new ie;this.j.set(e.id,t),await this.r.p,!t.isDisposed&&(this.C(e,t),this.u(!0))}z(e){this.j.deleteAndDispose(e.id),this.m.delete(e.id),this.u(!1)}C(e,t){this.F(e,t)?(this.P(`reusing an existing recursive watcher to monitor ${e.path}`),this.m.delete(e.id)):(this.G(e,t),this.m.add(e.id))}F(e,t){const i=this.O?.subscribe(e.path,(s,r)=>{t.isDisposed||(s?this.C(e,t):r?.type===1&&this.H(e))});return i?(t.add(i),!0):!1}G(e,t){let i=!1;const s=(r,n)=>{if(t.isDisposed)return;const o=this.I(r),a=this.I(n),c=i;i=o,!o&&(a||c)&&this.H(e)};this.P(`starting fs.watchFile() on ${e.path} (correlationId: ${e.correlationId})`);try{dK(e.path,{persistent:!1,interval:this.q},s)}catch(r){this.Q(`fs.watchFile() failed with error ${r} on path ${e.path} (correlationId: ${e.correlationId})`)}t.add(te(()=>{this.P(`stopping fs.watchFile() on ${e.path} (correlationId: ${e.correlationId})`);try{fK(e.path,s)}catch(r){this.Q(`fs.unwatchFile() failed with error ${r} on path ${e.path} (correlationId: ${e.correlationId})`)}}))}H(e){this.P(`detected ${e.path} exists again, resuming watcher (correlationId: ${e.correlationId})`);const t={resource:y.file(e.path),type:1,cId:e.correlationId};this.a.fire([t]),this.J(t,e),this.z(e)}I(e){return e.ctimeMs===0&&e.ino===0}async stop(){this.j.clearAndDisposeAll(),this.m.clear()}J(e,t){if(this.R){const i=` >> normalized ${e.type===1?"[ADDED]":e.type===2?"[DELETED]":"[CHANGED]"} ${e.resource.fsPath}`;this.L(i,t)}}L(e,t){this.R&&this.P(`${e}${typeof t.correlationId=="number"?` <${t.correlationId}> `:""}`)}M(e){return`${e.path} (excludes: ${e.excludes.length>0?e.excludes:"<none>"}, includes: ${e.includes&&e.includes.length>0?JSON.stringify(e.includes):"<all>"}, filter: ${OZ(e.filter)}, correlationId: ${typeof e.correlationId=="number"?e.correlationId:"<none>"})`}async setVerboseLogging(e){this.R=e}};import{watch as gK,promises as mK}from"fs";var vK=class fv extends Z{static{this.a=100}static{this.b=75}get isReusingRecursiveWatcher(){return this.q}get failed(){return this.r}constructor(t,i,s,r,n,o){super(),this.s=t,this.t=i,this.u=s,this.w=r,this.y=n,this.z=o,this.c=this.D(new Ex({maxWorkChunkSize:100,throttleDelay:200,maxBufferedWork:1e4},c=>this.u(c))),this.f=this.D(new dO(c=>this.M(c),fv.b)),this.m=new Qe,this.n=new Tt(async()=>{let c=this.s.path;try{c=await nt.realpath(this.s.path),this.s.path!==c&&this.Q(`correcting a path to watch that seems to be a symbolic link (original: ${this.s.path}, real: ${c})`)}catch{}return c}),this.q=!1,this.r=!1;const a=!$t;this.g=KP(this.s.path,this.s.excludes,a),this.h=this.s.includes?KP(this.s.path,this.s.includes,a):void 0,this.j=ZP(this.s)?this.s.filter:void 0,this.ready=this.C()}async C(){try{const t=await mK.stat(this.s.path);if(this.m.token.isCancellationRequested)return;this.D(await this.G(t.isDirectory()))}catch(t){t.code!=="ENOENT"?this.O(t):this.Q(`ignoring a path for watching who's stat info failed to resolve: ${this.s.path} (error: ${t})`),this.F()}}F(){this.r=!0,this.w?.()}async G(t){const i=new ie;return this.H(t,i)?(this.Q(`reusing an existing recursive watcher for ${this.s.path}`),this.q=!0):(this.q=!1,await this.I(t,i)),i}H(t,i){if(t)return!1;const s=y.file(this.s.path),r=this.t?.subscribe(this.s.path,async(n,o)=>{i.isDisposed||(n?await SR(this.G(t),i):o&&(typeof o.cId=="number"||typeof this.s.correlationId=="number")&&this.L({resource:s,type:o.type,cId:this.s.correlationId},!0))});return r?(i.add(r),!0):!1}async I(t,i){const s=await this.n.value;if(this.m.token.isCancellationRequested)return;if(Pt&&Vo(s,"/Volumes/",!0)){this.O(`Refusing to watch ${s} for changes using fs.watch() for possibly being a network share where watching is unreliable and unstable.`);return}const r=new Qe(this.m.token);i.add(te(()=>r.dispose(!0)));const n=new ie;i.add(n);try{const o=y.file(this.s.path),a=vt(s),c=gK(s);n.add(te(()=>{c.removeAllListeners(),c.close()})),this.Q(`Started watching: '${s}'`);const l=new Set;if(t)try{for(const h of await nt.readdir(s))l.add(h)}catch(h){this.O(h)}if(r.token.isCancellationRequested)return;const u=new Map;n.add(te(()=>{for(const[,h]of u)h.dispose();u.clear()})),c.on("error",(h,f)=>{r.token.isCancellationRequested||(this.O(`Failed to watch ${s} for changes using fs.watch() (${h}, ${f})`),this.F())}),c.on("change",(h,f)=>{if(r.token.isCancellationRequested)return;this.z&&this.R(`[raw] ["${h}"] ${f}`);let p="";if(f&&(p=f.toString(),Pt&&(p=Ef(p))),!(!p||h!=="change"&&h!=="rename"))if(t)if(h==="rename"){u.get(p)?.dispose();const g=setTimeout(async()=>{if(u.delete(p),df(p,a,!$t)&&!await nt.exists(s)){this.J(o);return}if(r.token.isCancellationRequested)return;const v=await this.N(_e(s,p));if(r.token.isCancellationRequested)return;let b;v?l.has(p)?b=0:(b=1,l.add(p)):(l.delete(p),b=2),this.L({resource:It(o,p),type:b,cId:this.s.correlationId})},fv.a);u.set(p,te(()=>clearTimeout(g)))}else{let g;l.has(p)?g=0:(g=1,l.add(p)),this.L({resource:It(o,p),type:g,cId:this.s.correlationId})}else if(h==="rename"||!df(p,a,!$t)){const g=setTimeout(async()=>{const v=await nt.exists(s);r.token.isCancellationRequested||(v?(this.L({resource:o,type:0,cId:this.s.correlationId},!0),n.add(await this.G(!1))):this.J(o))},fv.a);n.clear(),n.add(te(()=>clearTimeout(g)))}else this.L({resource:o,type:0,cId:this.s.correlationId},!0)})}catch(o){if(r.token.isCancellationRequested)return;this.O(`Failed to watch ${s} for changes using fs.watch() (${o.toString()})`),this.F()}}J(t){this.P("Watcher shutdown because watched path got deleted"),this.L({resource:t,type:2,cId:this.s.correlationId},!0),this.f.flush(),this.F()}L(t,i=!1){this.m.token.isCancellationRequested||(this.z&&this.R(`${t.type===1?"[ADDED]":t.type===2?"[DELETED]":"[CHANGED]"} ${t.resource.fsPath}`),!i&&this.g.some(s=>s(t.resource.fsPath))?this.z&&this.R(` >> ignored (excluded) ${t.resource.fsPath}`):!i&&this.h&&this.h.length>0&&!this.h.some(s=>s(t.resource.fsPath))?this.z&&this.R(` >> ignored (not included) ${t.resource.fsPath}`):this.f.work(t))}M(t){const i=MZ(t),s=[];for(const n of i){if(RZ(n,this.j)){this.z&&this.R(` >> ignored (filtered) ${n.resource.fsPath}`);continue}s.push(n)}if(s.length===0)return;if(this.z)for(const n of s)this.R(` >> normalized ${n.type===1?"[ADDED]":n.type===2?"[DELETED]":"[CHANGED]"} ${n.resource.fsPath}`);this.c.work(s)?this.c.pending>0&&this.Q(`started throttling events due to large amount of file change events at once (pending: ${this.c.pending}, most recent change: ${s[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`):this.P(`started ignoring events due to too many file change events at once (incoming: ${s.length}, most recent change: ${s[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`)}async N(t){if($t)return nt.exists(t);try{const i=vt(t);return(await nt.readdir($i(t))).some(r=>r===i)}catch(i){return this.Q(i),!1}}setVerboseLogging(t){this.z=t}O(t){this.m.token.isCancellationRequested||this.y?.({type:"error",message:`[File Watcher (node.js)] ${t}`})}P(t){this.m.token.isCancellationRequested||this.y?.({type:"warn",message:`[File Watcher (node.js)] ${t}`})}Q(t){!this.m.token.isCancellationRequested&&this.z&&this.y?.({type:"trace",message:`[File Watcher (node.js)] ${t}`})}R(t){!this.m.token.isCancellationRequested&&this.z&&this.Q(`${t}${typeof this.s.correlationId=="number"?` <${this.s.correlationId}> `:""}`)}dispose(){this.m.dispose(!0),super.dispose()}},wK=class extends pK{get watchers(){return this.S.values()}constructor(e){super(),this.O=e,this.onDidError=Ie.None,this.S=new Map,this.U=this.D(new Vs)}async N(e){e=this.cb(e);const t=[],i=new Set(Array.from(this.watchers));for(const s of e){const r=this.S.get(this.Z(s));r&&QI(r.request.excludes,s.excludes)&&QI(r.request.includes,s.includes)?i.delete(r):t.push(s)}t.length&&this.P(`Request to start watching: ${t.map(s=>this.M(s)).join(",")}`),i.size&&this.P(`Request to stop watching: ${Array.from(i).map(s=>this.M(s.request)).join(",")}`),this.U.clear();for(const s of i)this.bb(s);this.Y().work(t)}Y(){return this.U.value=new Ex({maxWorkChunkSize:100,throttleDelay:100,maxBufferedWork:Number.MAX_VALUE},e=>{for(const t of e)this.ab(t)}),this.U.value}Z(e){return typeof e.correlationId=="number"?e.correlationId:this.$(e.path)}$(e){return $t?e:e.toLowerCase()}ab(e){const t=new vK(e,this.O,s=>this.a.fire(s),()=>this.c.fire(e),s=>this.b.fire(s),this.R),i={request:e,instance:t};this.S.set(this.Z(e),i)}async stop(){await super.stop();for(const e of this.watchers)this.bb(e)}bb(e){this.P("stopping file watcher",e),this.S.delete(this.Z(e.request)),e.instance.dispose()}cb(e){const t=new Map;for(const i of e){let s=t.get(i.correlationId);s||(s=new Map,t.set(i.correlationId,s));const r=this.$(i.path);s.has(r)&&this.P(`ignoring a request for watching who's path is already watched: ${this.M(i)}`),s.set(r,i)}return Array.from(t.values()).flatMap(i=>Array.from(i.values()))}async setVerboseLogging(e){super.setVerboseLogging(e);for(const t of this.watchers)t.instance.setVerboseLogging(e)}P(e,t){this.R&&this.b.fire({type:"trace",message:this.fb(e,t)})}Q(e){this.b.fire({type:"warn",message:this.fb(e)})}fb(e,t){return t?`[File Watcher (node.js)] ${e} (${this.M(t.request)})`:`[File Watcher (node.js)] ${e}`}},bK=class extends TZ{constructor(e,t,i){super(e,t,i),this.r()}q(e){return e.add(new wK(void 0))}},yK=class Gd extends rK{constructor(){super(...arguments),this.onDidChangeCapabilities=Ie.None,this.R=new kt(t=>Jv.getComparisonKey(t)),this.Z=new Map,this.$=new Map,this.ab=new Map}static{this.N=!1}get capabilities(){return this.O||(this.O=516126,$t&&(this.O|=1024)),this.O}async stat(t){try{const{stat:i,symbolicLink:s}=await Oi.stat(this.L(t));return{type:this.Q(i,s),ctime:i.birthtime.getTime(),mtime:i.mtime.getTime(),size:i.size,permissions:(i.mode&128)===0?Xn.Locked:void 0}}catch(i){throw this.jb(i)}}async P(t){try{return await this.stat(t)}catch{return}}async realpath(t){const i=this.L(t);return nt.realpath(i)}async readdir(t){try{const i=await nt.readdir(this.L(t),{withFileTypes:!0}),s=[];return await Promise.all(i.map(async r=>{try{let n;r.isSymbolicLink()?n=(await this.stat(It(t,r.name))).type:n=this.Q(r),s.push([r.name,n])}catch(n){this.a.trace(n)}})),s}catch(i){throw this.jb(i)}}Q(t,i){let s;return i?.dangling?s=is.Unknown:t.isFile()?s=is.File:t.isDirectory()?s=is.Directory:s=is.Unknown,i&&(s|=is.SymbolicLink),s}async S(t){const i=this.L(t);this.U(`[Disk FileSystemProvider]: createResourceLock() - request to acquire resource lock (${i})`);let s;for(;s=this.R.get(t);)this.U(`[Disk FileSystemProvider]: createResourceLock() - waiting for resource lock to be released (${i})`),await s.wait();const r=new ps;return this.R.set(t,r),this.U(`[Disk FileSystemProvider]: createResourceLock() - new resource lock created (${i})`),te(()=>{this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock dispose() (${i})`),this.R.get(t)===r&&(this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock removed from resource-lock map (${i})`),this.R.delete(t)),this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock barrier open() (${i})`),r.open()})}async readFile(t,i){let s;try{i?.atomic&&(this.U(`[Disk FileSystemProvider]: atomic read operation started (${this.L(t)})`),s=await this.S(t));const r=this.L(t);return await Ga.readFile(r)}catch(r){throw this.jb(r)}finally{s?.dispose()}}U(t){Gd.N&&this.a.trace(t)}readFileStream(t,i,s){const r=bf(n=>W.concat(n.map(o=>W.wrap(o))).buffer);return tK(this,t,r,n=>n.buffer,{...i,bufferSize:256*1024},s),r}async writeFile(t,i,s){return s?.atomic!==!1&&s?.atomic?.postfix&&await this.W(t)?this.X(t,It(dc(t),`${Li(t)}${s.atomic.postfix}`),i,s):this.Y(t,i,s)}async W(t){try{const i=this.L(t),{symbolicLink:s}=await Oi.stat(i);if(s)return!1}catch{}return!0}async X(t,i,s,r){const n=new ie;try{n.add(await this.S(t)),n.add(await this.S(i)),await this.Y(i,s,{...r,create:!0,overwrite:!0},!0);try{await this.rename(i,t,{overwrite:!0})}catch(o){try{await this.delete(i,{recursive:!1,useTrash:!1,atomic:!1})}catch{}throw o}}finally{n.dispose()}}async Y(t,i,s,r){let n;try{const o=this.L(t);if(!s.create||!s.overwrite){if(await nt.exists(o)){if(!s.overwrite)throw nn(d(2125,null),he.FileExists)}else if(!s.create)throw nn(d(2126,null),he.FileNotFound)}n=await this.open(t,{create:!0,unlock:s.unlock},r),await this.write(n,0,i,0,i.byteLength)}catch(o){throw await this.kb(t,o)}finally{typeof n=="number"&&await this.close(n)}}static{this.bb=!0}static configureFlushOnWrite(t){Gd.bb=t}async open(t,i,s){const r=this.L(t);let n;Cc(i)&&!s&&(n=await this.S(t));let o;try{if(Cc(i)&&i.unlock)try{const{stat:a}=await Oi.stat(r);a.mode&128||await Ga.chmod(r,a.mode|128)}catch(a){a.code!=="ENOENT"&&this.a.trace(a)}if(ze&&Cc(i))try{o=await nt.open(r,"r+"),await nt.ftruncate(o,0)}catch(a){if(a.code!=="ENOENT"&&this.a.trace(a),typeof o=="number"){try{await nt.close(o)}catch(c){this.a.trace(c)}o=void 0}}typeof o!="number"&&(o=await nt.open(r,Cc(i)?"w":"r"))}catch(a){throw n?.dispose(),Cc(i)?await this.kb(t,a):this.jb(a)}if(this.Z.set(o,0),Cc(i)&&this.ab.set(o,t),n){const a=this.$.get(o);this.U(`[Disk FileSystemProvider]: open() - storing lock for handle ${o} (${r})`),this.$.set(o,n),a&&(this.U(`[Disk FileSystemProvider]: open() - disposing a previous lock that was still stored on same handle ${o} (${r})`),a.dispose())}return o}async close(t){const i=this.$.get(t);try{if(this.Z.delete(t),this.ab.delete(t)&&Gd.bb)try{await nt.fdatasync(t)}catch(s){Gd.configureFlushOnWrite(!1),this.a.error(s)}return await nt.close(t)}catch(s){throw this.jb(s)}finally{i&&(this.$.get(t)===i&&(this.U(`[Disk FileSystemProvider]: close() - resource lock removed from handle-lock map ${t}`),this.$.delete(t)),this.U(`[Disk FileSystemProvider]: close() - disposing lock for handle ${t}`),i.dispose())}}async read(t,i,s,r,n){const o=this.cb(t,i);let a=null;try{a=(await nt.read(t,s,r,n,o)).bytesRead}catch(c){throw this.jb(c)}finally{this.db(t,o,a)}return a}cb(t,i){return i===this.Z.get(t)?null:i}db(t,i,s){const r=this.Z.get(t);typeof r=="number"&&(typeof i=="number"||(typeof s=="number"?this.Z.set(t,r+s):this.Z.delete(t)))}async write(t,i,s,r,n){return gO(()=>this.eb(t,i,s,r,n),100,3)}async eb(t,i,s,r,n){const o=this.cb(t,i);let a=null;try{a=(await nt.write(t,s,r,n,o)).bytesWritten}catch(c){throw await this.kb(this.ab.get(t),c)}finally{this.db(t,o,a)}return a}async mkdir(t){try{await Ga.mkdir(this.L(t))}catch(i){throw this.jb(i)}}async delete(t,i){try{const s=this.L(t);if(i.recursive){let r;i?.atomic!==!1&&i.atomic.postfix&&(r=_e($i(s),`${vt(s)}${i.atomic.postfix}`)),await nt.rm(s,Go.MOVE,r)}else try{await Ga.unlink(s)}catch(r){if(r.code==="EPERM"||r.code==="EISDIR"){let n=!1;try{const{stat:o,symbolicLink:a}=await Oi.stat(s);n=o.isDirectory()&&!a}catch{}if(n)await Ga.rmdir(s);else throw r}else throw r}}catch(s){throw this.jb(s)}}async rename(t,i,s){const r=this.L(t),n=this.L(i);if(r!==n)try{await this.fb(t,i,"move",s.overwrite),await nt.rename(r,n)}catch(o){throw(o.code==="EINVAL"||o.code==="EBUSY"||o.code==="ENAMETOOLONG")&&(o=new Error(d(2127,null,vt(r),vt($i(n)),o.toString()))),this.jb(o)}}async copy(t,i,s){const r=this.L(t),n=this.L(i);if(r!==n)try{await this.fb(t,i,"copy",s.overwrite),await nt.copy(r,n,{preserveSymlinks:!0})}catch(o){throw(o.code==="EINVAL"||o.code==="EBUSY"||o.code==="ENAMETOOLONG")&&(o=new Error(d(2128,null,vt(r),vt($i(n)),o.toString()))),this.jb(o)}}async fb(t,i,s,r){const n=this.L(t),o=this.L(i);let a=!1;if(!!(this.capabilities&1024)||(a=df(n,o,!0)),a){if(s==="copy")throw nn(d(2129,null),he.FileExists);if(s==="move")return}const l=await this.P(t);if(!l)throw nn(d(2130,null),he.FileNotFound);const u=await this.P(i);if(u){if(!r)throw nn(d(2131,null),he.FileExists);(l.type&is.File)!==0&&(u.type&is.File)!==0||await this.delete(i,{recursive:!0,useTrash:!1,atomic:!1})}}async cloneFile(t,i){return this.gb(t,i,!1)}async gb(t,i,s){const r=this.L(t),n=this.L(i),o=!!(this.capabilities&1024);if(df(r,n,!o))return;const a=new ie;try{a.add(await this.S(t)),a.add(await this.S(i)),s&&await Ga.mkdir($i(n),{recursive:!0}),await Ga.copyFile(r,n)}catch(c){if(c.code==="ENOENT"&&!s)return this.gb(t,i,!0);throw this.jb(c)}finally{a.dispose()}}u(t,i,s){return new hK(r=>t(r),r=>i(r),s)}H(t,i,s){return new bK(r=>t(r),r=>i(r),s)}jb(t){if(t instanceof Bf)return t;let i=t,s;switch(t.code){case"ENOENT":s=he.FileNotFound;break;case"EISDIR":s=he.FileIsADirectory;break;case"ENOTDIR":s=he.FileNotADirectory;break;case"EEXIST":s=he.FileExists;break;case"EPERM":case"EACCES":s=he.NoPermissions;break;case"ERR_UNC_HOST_NOT_ALLOWED":i=`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`,s=he.Unknown;break;default:s=he.Unknown}return nn(i,s)}async kb(t,i){let s=this.jb(i);if(t&&s.code===he.NoPermissions)try{const{stat:r}=await Oi.stat(this.L(t));r.mode&128||(s=nn(i,he.FileWriteLocked))}catch(r){this.a.trace(r)}return s}},r5=class{constructor(t,i){t.addFileSystemProvider(V.file,new AK(i),{isCaseSensitive:$t})}};r5=__decorate([__param(0,Gh),__param(1,Se)],r5);var AK=class{constructor(e){this.a=new yK(e)}async stat(e){const t=await this.a.stat(e);return{type:t.type,ctime:t.ctime,mtime:t.mtime,size:t.size,permissions:t.permissions===Xn.Readonly?1:void 0}}readDirectory(e){return this.a.readdir(e)}createDirectory(e){return this.a.mkdir(e)}readFile(e){return this.a.readFile(e)}writeFile(e,t,i){return this.a.writeFile(e,t,{...i,unlock:!1,atomic:!1})}delete(e,t){return this.a.delete(e,{...t,useTrash:!1,atomic:!1})}rename(e,t,i){return this.a.rename(e,t,i)}copy(e,t,i){return this.a.copy(e,t,i)}get onDidChangeFile(){throw new Error("Method not implemented.")}watch(e,t){throw new Error("Method not implemented.")}};import SN from"node:module";var EN=SN.createRequire(import.meta.url),SK=class extends W1{k(){const e=this,t=EN("module"),i=t._load;t._load=function(a,c,l){return a=n(a),e.a.has(a)?e.a.get(a).load(a,y.file(Wx(c.filename)),u=>i.apply(this,[u,c,l])):i.apply(this,arguments)};const s=t._resolveLookupPaths;t._resolveLookupPaths=(o,a)=>s.call(this,n(o),a);const r=t._resolveFilename;t._resolveFilename=function(a,c,l,u){return a==="vsda"&&Array.isArray(u?.paths)&&u.paths.length===0&&(u.paths=t._nodeModulePaths(import.meta.dirname)),r.call(this,a,c,l,u)};const n=o=>{for(const a of e.b){const c=a(o);if(c){o=c;break}}return o}}},EK=class Yl extends W1{constructor(){super(...arguments),this.o=new ie}static l(t){return`data:text/javascript;base64,${Buffer.from(t).toString("base64")}`}static{this.m=`
	let lookup;
	export const initialize = async (context) => {
		let requestIds = 0;
		const { port } = context;
		const pendingRequests = new Map();
		port.onmessage = (event) => {
			const { id, url } = event.data;
			pendingRequests.get(id)?.(url);
		};
		lookup = url => {
			// debugger;
			const myId = requestIds++;
			return new Promise((resolve) => {
				pendingRequests.set(myId, resolve);
				port.postMessage({ id: myId, url, });
			});
		};
	};
	export const resolve = async (specifier, context, nextResolve) => {
		if (specifier !== 'vscode' || !context.parentURL) {
			return nextResolve(specifier, context);
		}
		const otherUrl = await lookup(context.parentURL);
		return {
			url: otherUrl,
			shortCircuit: true,
		};
	};`}static{this.n="_VSCODE_IMPORT_VSCODE_API"}dispose(){this.o.dispose()}k(){const t=new hR,i=new Map;Object.defineProperty(globalThis,Yl.n,{enumerable:!1,configurable:!1,writable:!1,value:a=>t.getKey(a)});const{port1:s,port2:r}=new MessageChannel;let n;const o=s;o.onmessage=a=>{n||(n=this.a.get("vscode"),Iv(n));const{id:c,url:l}=a.data,u=y.parse(l),h=n.load("_not_used",u,()=>{throw new Error("CANNOT LOAD MODULE from here.")});let f=t.get(h);f||(f=Nt(),t.set(h,f));let p=i.get(f);if(!p){const g=`const _vscodeInstance = globalThis.${Yl.n}('${f}');

${Object.keys(h).map(v=>`export const ${v} = _vscodeInstance['${v}'];`).join(`
`)}`;p=Yl.l(g),i.set(f,p)}s.postMessage({id:c,url:p})},SN.register(Yl.l(Yl.m),{parentURL:import.meta.url,data:{port:r},transferList:[r]}),this.o.add(te(()=>{s.close(),r.close()}))}},xK=class extends ZA{constructor(){super(...arguments),this.extensionRuntime=rg.Node}async wb(){this.h.createInstance(i5);const e=this.h.invokeFunction(lX);if(this.h.createInstance(KS),this.f.remote.isRemote&&this.f.remote.authority){const i=this.h.createInstance(e5);process.env.VSCODE_IPC_HOOK_CLI=i.ipcHandlePath}this.h.createInstance(r5),await this.h.createInstance(SK,e,{mine:this.J,all:this.L}).install(),await this.B.add(this.h.createInstance(EK,e,{mine:this.J,all:this.L})).install(),Ut("code/extHost/didInitAPI");const t=await this.m.getConfigProvider();await RX(this.j,t,this,this.q,this.y,this.f,this.B),Ut("code/extHost/didInitProxyResolver")}xb(e){return e.main}async Cb(e,t,i,s){if(t.scheme!==V.file)throw new Error(`Cannot load URI: '${t}', must be of file-scheme`);let r=null;i.codeLoadingStart(),this.q.trace(`ExtensionService#loadModule [${s}] -> ${t.toString(!0)}`),this.q.flush();const n=e?.identifier.value;e&&await this.u.initializeLocalizedMessages(e);try{n&&Ut(`code/extHost/willLoadExtensionCode/${n}`),s==="esm"?r=await import(t.toString(!0)):r=EN(t.fsPath)}finally{n&&Ut(`code/extHost/didLoadExtensionCode/${n}`),i.codeLoadingStop()}return r}async yb(e,t,i){return this.Cb(e,t,i,"cjs")}async zb(e,t,i){return this.Cb(e,t,i,"esm")}async $setRemoteEnvironment(e){if(this.f.remote.isRemote)for(const t in e){const i=e[t];i===null?delete process.env[t]:process.env[t]=i}}};import*as Td from"fs";import{exec as xN}from"child_process";var CK=(e,t,i)=>{const s=new Uint8Array(16);for(let o=0;o<16;o++)s[o]=Math.round(Math.random()*256);const r=fc(W.wrap(s));return[`GET ws://localhost${e}?${t}&skipWebSocketFrames=true HTTP/1.1`,"Connection: Upgrade","Upgrade: websocket",`Sec-WebSocket-Key: ${r}`].join(`\r
`)+`\r
\r
`},CN=W.fromString(`\r
\r
`);async function kK(e,t,i,s,r){e.write(W.fromString(CK(t,i,s)));const n=new ie;try{return await new Promise((o,a)=>{let c;n.add(e.onData(l=>{c?c=W.concat([c,l],c.byteLength+l.byteLength):c=l;const u=c.indexOf(CN);if(u===-1)return;o(e),e.pauseData();const h=c.slice(u+CN.byteLength);h.byteLength&&r.onData.fire(h)})),n.add(e.onClose(l=>a(l??new Error("socket closed")))),n.add(e.onEnd(()=>a(new Error("socket ended"))))})}catch(o){throw e.dispose(),o}finally{n.dispose()}}var $K=class extends Z{constructor(e,t){super(),this.g=e,this.a=this.D(new lu),this.onData=(...i)=>(this.a.isPaused&&queueMicrotask(()=>this.a.resume()),this.a.event(...i)),this.b=this.D(new I),this.onDidDispose=this.b.event,this.f=!1,this.D(t.onData),this.D(t.onData.event(i=>this.a.fire(i))),this.onClose=this.D(t.onClose).event,this.onEnd=this.D(t.onEnd).event}pauseData(){this.a.pause()}drain(){return Promise.resolve()}end(){this.f=!0,this.h()}traceSocketEvent(e,t){kf.traceSocketEvent(this,this.g,e,t)}dispose(){this.f||this.h(),this.b.fire(),super.dispose()}},IK="signService",Nd=H(IK);import*as DK from"net";import*as PK from"os";import*as TK from"net";var kN={1:!0,7:!0,9:!0,11:!0,13:!0,15:!0,17:!0,19:!0,20:!0,21:!0,22:!0,23:!0,25:!0,37:!0,42:!0,43:!0,53:!0,69:!0,77:!0,79:!0,87:!0,95:!0,101:!0,102:!0,103:!0,104:!0,109:!0,110:!0,111:!0,113:!0,115:!0,117:!0,119:!0,123:!0,135:!0,137:!0,139:!0,143:!0,161:!0,179:!0,389:!0,427:!0,465:!0,512:!0,513:!0,514:!0,515:!0,526:!0,530:!0,531:!0,532:!0,540:!0,548:!0,554:!0,556:!0,563:!0,587:!0,601:!0,636:!0,989:!0,990:!0,993:!0,995:!0,1719:!0,1720:!0,1723:!0,2049:!0,3659:!0,4045:!0,5060:!0,5061:!0,6e3:!0,6566:!0,6665:!0,6666:!0,6667:!0,6668:!0,6669:!0,6697:!0,10080:!0};function NK(e,t,i,s="127.0.0.1"){let r=!1,n,o=1;const a=TK.createServer({pauseOnConnect:!0});function c(l,u){r||(r=!0,a.removeAllListeners(),a.close(),n&&clearTimeout(n),u(l))}return new Promise(l=>{n=setTimeout(()=>{c(0,l)},i),a.on("listening",()=>{c(e,l)}),a.on("error",u=>{u&&(u.code==="EADDRINUSE"||u.code==="EACCES")&&o<t?(e++,o++,a.listen(e,s)):c(0,l)}),a.on("close",()=>{c(0,l)}),a.listen(e,s)})}var MK=30*1e3,$N;(function(e){e[e.Management=1]="Management",e[e.ExtensionHost=2]="ExtensionHost",e[e.Tunnel=3]="Tunnel"})($N||($N={}));function n5(e){switch(e){case 1:return"Management";case 2:return"ExtensionHost";case 3:return"Tunnel"}}function IN(e){const t=new Qe;return setTimeout(()=>t.cancel(),e),t.token}function LK(e,t){if(e.isCancellationRequested||t.isCancellationRequested)return Fe.Cancelled;const i=new Qe;return e.onCancellationRequested(()=>i.cancel()),t.onCancellationRequested(()=>i.cancel()),i.token}var o5=class{get didTimeout(){return this.c==="timedout"}constructor(e){this.c="pending",this.d=new ie,{promise:this.promise,resolve:this.f,reject:this.g}=mx(),e.isCancellationRequested?this.h():this.d.add(e.onCancellationRequested(()=>this.h()))}registerDisposable(e){this.c==="pending"?this.d.add(e):e.dispose()}h(){this.c==="pending"&&(this.d.dispose(),this.c="timedout",this.g(this.i()))}i(){const e=new Error("Time limit reached");return e.code="ETIMEDOUT",e.syscall="connect",e}resolve(e){this.c==="pending"&&(this.d.dispose(),this.c="resolved",this.f(e))}reject(e){this.c==="pending"&&(this.d.dispose(),this.c="rejected",this.g(e))}};function RK(e,t){const i=new o5(t);return i.registerDisposable(e.onControlMessage(s=>{const r=JSON.parse(s.toString()),n=VK(r);n?i.reject(n):i.resolve(r)})),i.promise}function OK(e,t,i,s,r,n,o,a){const c=new o5(a),l=Qi.create(!1);return e.info(`Creating a socket (${o})...`),Ut(`code/willCreateSocket/${n}`),t.connect(i,s,r,o).then(u=>{c.didTimeout?(Ut(`code/didCreateSocketError/${n}`),e.info(`Creating a socket (${o}) finished after ${l.elapsed()} ms, but this is too late and has timed out already.`),u?.dispose()):(Ut(`code/didCreateSocketOK/${n}`),e.info(`Creating a socket (${o}) was successful after ${l.elapsed()} ms.`),c.resolve(u))},u=>{Ut(`code/didCreateSocketError/${n}`),e.info(`Creating a socket (${o}) returned an error after ${l.elapsed()} ms.`),e.error(u),c.reject(u)}),c.promise}function a5(e,t){const i=new o5(t);return e.then(s=>{i.didTimeout||i.resolve(s)},s=>{i.didTimeout||i.reject(s)}),i.promise}async function FK(e,t,i,s){const r=MN(e,t);e.logService.trace(`${r} 1/6. invoking socketFactory.connect().`);let n;try{n=await OK(e.logService,e.remoteSocketFactoryService,e.connectTo,cx.getServerRootPath(),`reconnectionToken=${e.reconnectionToken}&reconnection=${e.reconnectionProtocol?"true":"false"}`,n5(t),`renderer-${n5(t)}-${e.reconnectionToken}`,s)}catch(u){throw e.logService.error(`${r} socketFactory.connect() failed or timed out. Error:`),e.logService.error(u),u}e.logService.trace(`${r} 2/6. socketFactory.connect() was successful.`);let o,a;e.reconnectionProtocol?(e.reconnectionProtocol.beginAcceptReconnection(n,null),o=e.reconnectionProtocol,a=!1):(o=new d0({socket:n}),a=!0),e.logService.trace(`${r} 3/6. sending AuthRequest control message.`);const c=await a5(e.signService.createNewMessage(Nt()),s),l={type:"auth",auth:e.connectionToken||"00000000000000000000",data:c.data};o.sendControl(W.fromString(JSON.stringify(l)));try{const u=await RK(o,LK(s,IN(1e4)));if(u.type!=="sign"||typeof u.data!="string"){const g=new Error("Unexpected handshake message");throw g.code="VSCODE_CONNECTION_ERROR",g}if(e.logService.trace(`${r} 4/6. received SignRequest control message.`),!await a5(e.signService.validate(c,u.signedData),s)){const g=new Error("Refused to connect to unsupported server");throw g.code="VSCODE_CONNECTION_ERROR",g}const f=await a5(e.signService.sign(u.data),s),p={type:"connectionType",commit:e.commit,signedData:f,desiredConnectionType:t};return i&&(p.args=i),e.logService.trace(`${r} 5/6. sending ConnectionTypeRequest control message.`),o.sendControl(W.fromString(JSON.stringify(p))),{protocol:o,ownsProtocol:a}}catch(u){throw u&&u.code==="ETIMEDOUT"&&(e.logService.error(`${r} the handshake timed out. Error:`),e.logService.error(u)),u&&u.code==="VSCODE_CONNECTION_ERROR"&&(e.logService.error(`${r} received error control message when negotiating connection. Error:`),e.logService.error(u)),a&&NN(o),u}}async function UK(e,t,i){const s=Date.now(),r=MN(e,3),{protocol:n}=await FK(e,3,t,i);return e.logService.trace(`${r} 6/6. handshake finished, connection is up and running after ${ZK(s)}!`),n}async function DN(e,t,i){const{connectTo:s,connectionToken:r}=await e.addressProvider.getAddress();return{commit:e.commit,quality:e.quality,connectTo:s,connectionToken:r,reconnectionToken:t,reconnectionProtocol:i,remoteSocketFactoryService:e.remoteSocketFactoryService,signService:e.signService,logService:e.logService}}async function jK(e,t,i){const s=await DN(e,Nt(),null);return await UK(s,{host:t,port:i},Fe.None)}function zK(e){return Kr(t=>new Promise((i,s)=>{const r=setTimeout(i,e*1e3);t.onCancellationRequested(()=>{clearTimeout(r),i()})}))}var PN;(function(e){e[e.ConnectionLost=0]="ConnectionLost",e[e.ReconnectionWait=1]="ReconnectionWait",e[e.ReconnectionRunning=2]="ReconnectionRunning",e[e.ReconnectionPermanentFailure=3]="ReconnectionPermanentFailure",e[e.ConnectionGain=4]="ConnectionGain"})(PN||(PN={}));var HK=class{constructor(e,t){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.type=0}},WK=class{constructor(e,t,i,s){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.durationSeconds=i,this.c=s,this.type=1}skipWait(){this.c.cancel()}},BK=class{constructor(e,t,i){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.type=2}},TN=class{constructor(e,t,i){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.type=4}},_K=class{constructor(e,t,i,s){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.handled=s,this.type=3}},Hue=class In extends Z{static triggerPermanentFailure(t,i,s){this._permanentFailure=!0,this.f=t,this.g=i,this.h=s,this.j.forEach(r=>r.F(this.f,this.g,this.h))}static debugTriggerReconnection(){this.j.forEach(t=>t.y())}static debugPauseSocketWriting(){this.j.forEach(t=>t.G())}static{this._permanentFailure=!1}static{this.f=0}static{this.g=0}static{this.h=!1}static{this.j=[]}get n(){return this.c||In._permanentFailure}constructor(t,i,s,r,n){super(),this.t=t,this.u=i,this.reconnectionToken=s,this.protocol=r,this.w=n,this.m=this.D(new I),this.onDidStateChange=this.m.event,this.c=!1,this.q=!1,this.r=!1,this.s=108e5,this.m.fire(new TN(this.reconnectionToken,0,0)),this.D(r.onSocketClose(o=>{const a=Md(this.t,this.reconnectionToken,!0);o?o.type===0?(this.u.logService.info(`${a} received socket close event (hadError: ${o.hadError}).`),o.error&&this.u.logService.error(o.error)):(this.u.logService.info(`${a} received socket close event (wasClean: ${o.wasClean}, code: ${o.code}, reason: ${o.reason}).`),o.event&&this.u.logService.error(o.event)):this.u.logService.info(`${a} received socket close event.`),this.y()})),this.D(r.onSocketTimeout(o=>{const a=Md(this.t,this.reconnectionToken,!0);this.u.logService.info(`${a} received socket timeout event (unacknowledgedMsgCount: ${o.unacknowledgedMsgCount}, timeSinceOldestUnacknowledgedMsg: ${o.timeSinceOldestUnacknowledgedMsg}, timeSinceLastReceivedSomeData: ${o.timeSinceLastReceivedSomeData}).`),this.y()})),In.j.push(this),this.D(te(()=>{const o=In.j.indexOf(this);o>=0&&In.j.splice(o,1)})),this.n&&this.F(In.f,In.g,In.h)}updateGraceTime(t){const i=qK(t,108e5),s=Md(this.t,this.reconnectionToken,!1);this.u.logService.trace(`${s} Applying reconnection grace time: ${i}ms (${Math.floor(i/1e3)}s)`),this.s=i}dispose(){super.dispose(),this.r=!0}async y(){if(!this.q)try{this.q=!0,await this.z()}finally{this.q=!1}}async z(){if(this.n||this.r)return;const t=Md(this.t,this.reconnectionToken,!0);this.u.logService.info(`${t} starting reconnecting loop. You can get more information with the trace log level.`),this.m.fire(new HK(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData()));const i=[0,5,5,10,10,10,10,10,30],s=this.s;if(this.u.logService.info(`${t} starting reconnection with grace time: ${s}ms (${Math.floor(s/1e3)}s)`),s<=0){this.u.logService.error(`${t} reconnection grace time is set to 0ms, will not attempt to reconnect.`),this.C(this.protocol.getMillisSinceLastIncomingData(),0,!1);return}const r=Date.now();let n=-1;do{n++;const o=n<i.length?i[n]:i[i.length-1];try{if(o>0){const c=zK(o);this.m.fire(new WK(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),o,c)),this.u.logService.info(`${t} waiting for ${o} seconds before reconnecting...`);try{await c}catch{}}if(this.n){this.u.logService.error(`${t} permanent failure occurred while running the reconnecting loop.`);break}this.m.fire(new BK(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1)),this.u.logService.info(`${t} resolving connection...`);const a=await DN(this.u,this.reconnectionToken,this.protocol);this.u.logService.info(`${t} connecting to ${a.connectTo}...`),await this.H(a,IN(MK)),this.u.logService.info(`${t} reconnected!`),this.m.fire(new TN(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1));break}catch(a){if(a.code==="VSCODE_CONNECTION_ERROR"){this.u.logService.error(`${t} A permanent error occurred in the reconnecting loop! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(Date.now()-r>=s){const c=Math.round(s/1e3);this.u.logService.error(`${t} An error occurred while reconnecting, but it will be treated as a permanent error because the reconnection grace time (${c}s) has expired! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(Ow.isTemporarilyNotAvailable(a)){this.u.logService.info(`${t} A temporarily not available error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if((a.code==="ETIMEDOUT"||a.code==="ENETUNREACH"||a.code==="ECONNREFUSED"||a.code==="ECONNRESET")&&a.syscall==="connect"){this.u.logService.info(`${t} A network error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if(Mi(a)){this.u.logService.info(`${t} A promise cancelation error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if(a instanceof Ow){this.u.logService.error(`${t} A RemoteAuthorityResolverError occurred while trying to reconnect. Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,Ow.isHandled(a));break}this.u.logService.error(`${t} An unknown error occurred while trying to reconnect, since this is an unknown case, it will be treated as a permanent error! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}}while(!this.n&&!this.r)}C(t,i,s){this.w?In.triggerPermanentFailure(t,i,s):this.F(t,i,s)}F(t,i,s){this.m.fire(new _K(this.reconnectionToken,t,i,s)),NN(this.protocol)}G(){this.protocol.pauseSocketWriting()}};function NN(e){try{e.acceptDisconnect();const t=e.getSocket();e.dispose(),t.dispose()}catch(t){lt(t)}}function VK(e){if(e&&e.type==="error"){const t=new Error(`Connection error: ${e.reason}`);return t.code="VSCODE_CONNECTION_ERROR",t}return null}function qK(e,t){return typeof e!="number"||!isFinite(e)||e<0?t:e>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:Math.floor(e)}function GK(e,t){for(;e.length<t;)e+=" ";return e}function JK(e,t){return`[remote-connection][${GK(n5(e),13)}][${t.substr(0,5)}\u2026]`}function Md(e,t,i){return`${JK(e,t)}[${i?"reconnect":"initial"}]`}function MN(e,t){return`${Md(t,e.reconnectionToken,!!e.reconnectionProtocol)}[${e.connectTo}]`}function ZK(e){return`${Date.now()-e} ms`}var c5=H("remoteSocketFactoryService");async function QK(e,t,i,s,r){let n;for(let o=3;o&&(n?.dispose(),n=await new LN(e,t,i,s,r).waitForReady(),!(r&&kN[r]||!kN[n.tunnelLocalPort]));o--);return n}var LN=class extends Z{constructor(e,t,i,s,r){super(),this.m=t,this.n=r,this.privacy=Fr.Private,this.j=new Map,this.a=e,this.b=DK.createServer(),this.c=new ps,this.f=()=>this.c.open(),this.b.on("listening",this.f),this.g=n=>this.q(n),this.b.on("connection",this.g),this.h=()=>{},this.b.on("error",this.h),this.tunnelRemotePort=s,this.tunnelRemoteHost=i}async dispose(){super.dispose(),this.b.removeListener("listening",this.f),this.b.removeListener("connection",this.g),this.b.removeListener("error",this.h),this.b.close(),Array.from(this.j.values()).forEach(t=>{t()})}async waitForReady(){const e=this.n??this.tunnelRemotePort,t=gn(this.m)?"0.0.0.0":"127.0.0.1";let i=await NK(e,2,1e3,t),s=null;return this.b.listen(i,this.m),await this.c.wait(),s=this.b.address(),s||(i=0,this.b.listen(i,this.m),await this.c.wait(),s=this.b.address()),this.tunnelLocalPort=s.port,this.localAddress=`${this.tunnelRemoteHost==="127.0.0.1"?"127.0.0.1":"localhost"}:${s.port}`,this}async q(e){e.pause();const t=ja(this.tunnelRemoteHost)||gn(this.tunnelRemoteHost)?"localhost":this.tunnelRemoteHost,i=await jK(this.a,t,this.tunnelRemotePort),s=i.getSocket(),r=i.readEntireBuffer();i.dispose(),r.byteLength>0&&e.write(r.buffer),e.on("end",()=>{e.localAddress&&this.j.delete(e.localAddress),s.end()}),e.on("close",()=>s.end()),e.on("error",()=>{e.localAddress&&this.j.delete(e.localAddress),s instanceof vu?s.socket.destroy():s.end()}),s instanceof vu?this.s(e,s):this.r(e,s),e.localAddress&&this.j.set(e.localAddress,()=>{e.end(),s.end()})}r(e,t){t.onClose(()=>e.destroy()),t.onEnd(()=>e.end()),t.onData(i=>e.write(i.buffer)),e.on("data",i=>t.write(W.wrap(i))),e.resume()}s(e,t){const i=t.socket;i.on("end",()=>e.end()),i.on("close",()=>e.end()),i.on("error",()=>{e.destroy()}),i.pipe(e),e.pipe(i)}},l5=class extends fA{constructor(t,i,s,r,n){super(i,n),this.H=t,this.I=s,this.J=r}isPortPrivileged(t){return C_(t,this.s,zo,PK.release())}F(t,i,s,r,n,o,a,c){const l=this.C(i,s);if(l)return++l.refcount,l.value;if(E_(t))return this.G(t,i,s,n,o,a,c);{this.q.trace(`ForwardedPorts: (TunnelService) Creating tunnel without provider ${i}:${s} on local port ${n}.`);const u={commit:this.J.commit,quality:this.J.quality,addressProvider:t,remoteSocketFactoryService:this.H,signService:this.I,logService:this.q,ipcLogger:null},h=QK(u,r,i,s,n);return this.q.trace("ForwardedPorts: (TunnelService) Tunnel created without provider."),this.y(i,s,h),h}}};l5=__decorate([__param(0,c5),__param(1,Se),__param(2,Nd),__param(3,sd),__param(4,gi)],l5);var u5=class extends l5{constructor(t,i,s,r,n){super(t,i,s,r,n)}};u5=__decorate([__param(0,c5),__param(1,Se),__param(2,Nd),__param(3,sd),__param(4,gi)],u5);var RN=class extends Z{constructor(t,i,s,r,n){super(),this.b=t,this.c=i,this.f=s,this.g=r,this.h=n,this.a=new Map}async openTunnel(t,i,s,r,n,o,a,c,l){if(this.c.trace(`ForwardedPorts: (SharedTunnelService) openTunnel request for ${s}:${r} on local port ${o}.`),!this.a.has(t)){const u=new u5(this.b,this.c,this.g,this.f,this.h);this.D(u),this.a.set(t,u),u.onTunnelClosed(async()=>{(await u.tunnels).length===0&&(u.dispose(),this.a.delete(t))})}return this.a.get(t).openTunnel(i,s,r,n,o,a,c,l)}};RN=__decorate([__param(0,c5),__param(1,Se),__param(2,sd),__param(3,Nd),__param(4,gi)],RN);var YK=10*1e3,G1="remote.tunnels.toRestore",h5="remote.tunnels.toRestoreExpiration",XK=1e3*60*60*24*14,ON="onTunnel",Vue=new C("forwardedPortsViewEnabled",!1,d(15798,null)),KK=new C("forwardedPortsViewOnlyEnabled",!1,d(15799,null));function FN(e){const t=e.match(/^([a-zA-Z0-9_-]+(?:\.[a-zA-Z0-9_-]+)*:)?([0-9]+)$/);if(t)return{host:t[1]?.substring(0,t[1].length-1)||"localhost",port:Number(t[2])}}var Ld;(function(e){e.Other="Other",e.User="User",e.AutoForwardEnd="AutoForwardEnd"})(Ld||(Ld={}));var xn;(function(e){e[e.User=0]="User",e[e.Auto=1]="Auto",e[e.Extension=2]="Extension"})(xn||(xn={}));var d5={source:xn.User,description:d(15800,null)},que={source:xn.Auto,description:d(15801,null)};function UN(e,t,i){const s=e.get(as(t,i));if(s)return s;if(ja(t))for(const r of Jh){const n=as(r,i);if(e.has(n))return e.get(n)}else if(gn(t))for(const r of ym){const n=as(r,i);if(e.has(n))return e.get(n)}}function Gi(e,t,i){const s=UN(e,t,i);if(s)return s;const r=gn(t)?"localhost":ja(t)?"0.0.0.0":void 0;if(r)return UN(e,r,i)}function as(e,t){return e+":"+t}var Do;(function(e){e.Notify="notify",e.OpenBrowser="openBrowser",e.OpenBrowserOnce="openBrowserOnce",e.OpenPreview="openPreview",e.Silent="silent",e.Ignore="ignore"})(Do||(Do={}));function eee(e){return e&&"host"in e&&typeof e.host=="string"&&"port"in e&&typeof e.port=="number"&&(!("detail"in e)||typeof e.detail=="string")&&(!("pid"in e)||typeof e.pid=="string")}var jN=class mr extends Z{static{this.c="remote.portsAttributes"}static{this.f="remote.otherPortsAttributes"}static{this.g=/^(\d+)\-(\d+)$/}static{this.h=/^([a-z0-9\-]+):(\d{1,5})$/}constructor(t){super(),this.q=t,this.j=[],this.n=new I,this.onDidChangeAttributes=this.n.event,this.D(t.onDidChangeConfiguration(i=>{(i.affectsConfiguration(mr.c)||i.affectsConfiguration(mr.f))&&this.r()})),this.r()}r(){this.j=this.w(),this.n.fire()}getAttributes(t,i,s){let r=this.u(t,i,s,this.j,0);const n={label:void 0,onAutoForward:void 0,elevateIfNeeded:void 0,requireLocalPort:void 0,protocol:void 0};for(;r>=0;){const o=this.j[r];o.key===t?(n.onAutoForward=o.onAutoForward??n.onAutoForward,n.elevateIfNeeded=o.elevateIfNeeded!==void 0?o.elevateIfNeeded:n.elevateIfNeeded,n.label=o.label??n.label,n.requireLocalPort=o.requireLocalPort,n.protocol=o.protocol):(n.onAutoForward=n.onAutoForward??o.onAutoForward,n.elevateIfNeeded=n.elevateIfNeeded!==void 0?n.elevateIfNeeded:o.elevateIfNeeded,n.label=n.label??o.label,n.requireLocalPort=n.requireLocalPort!==void 0?n.requireLocalPort:void 0,n.protocol=n.protocol??o.protocol),r=this.u(t,i,s,this.j,r+1)}return n.onAutoForward!==void 0||n.elevateIfNeeded!==void 0||n.label!==void 0||n.requireLocalPort!==void 0||n.protocol!==void 0?n:this.z()}s(t){return t.start!==void 0&&t.end!==void 0}t(t){return t.host!==void 0&&t.port!==void 0&&Oe(t.host)&&Cs(t.port)}u(t,i,s,r,n){if(n>=r.length)return-1;const o=!ja(i)&&!gn(i),c=r.slice(n).findIndex(l=>Cs(l.key)?o?!1:l.key===t:this.s(l.key)?o?!1:t>=l.key.start&&t<=l.key.end:this.t(l.key)?t===l.key.port&&i===l.key.host:s?l.key.test(s):!1);return c>=0?c+n:-1}w(){const t=this.q.getValue(mr.c);if(!t||!At(t))return[];const i=[];for(const r in t){if(r===void 0)continue;const n=t[r];let o;if(Number(r))o=Number(r);else if(Oe(r))if(mr.g.test(r)){const a=r.match(mr.g);o={start:Number(a[1]),end:Number(a[2])}}else if(mr.h.test(r)){const a=r.match(mr.h);o={host:a[1],port:Number(a[2])}}else{let a;try{a=RegExp(r)}catch{}a&&(o=a)}o&&i.push({key:o,elevateIfNeeded:n.elevateIfNeeded,onAutoForward:n.onAutoForward,label:n.label,requireLocalPort:n.requireLocalPort,protocol:n.protocol})}const s=this.q.getValue(mr.f);return s&&(this.m={elevateIfNeeded:s.elevateIfNeeded,label:s.label,onAutoForward:s.onAutoForward,requireLocalPort:s.requireLocalPort,protocol:s.protocol}),this.y(i)}y(t){function i(s,r){return Cs(s.key)?s.key:r.s(s.key)?s.key.start:r.t(s.key)?s.key.port:Number.MAX_VALUE}return t.sort((s,r)=>i(s,this)-i(r,this))}z(){return this.m}static providedActionToAction(t){switch(t){case Eo.Notify:return Do.Notify;case Eo.OpenBrowser:return Do.OpenBrowser;case Eo.OpenBrowserOnce:return Do.OpenBrowserOnce;case Eo.OpenPreview:return Do.OpenPreview;case Eo.Silent:return Do.Silent;case Eo.Ignore:return Do.Ignore;default:return}}async addAttributes(t,i,s){const n=this.q.inspect(mr.c).userRemoteValue;let o;!n||!At(n)?o={}:o=ot(n),o[`${t}`]||(o[`${t}`]={});for(const a in i)o[`${t}`][a]=i[a];return this.q.updateValue(mr.c,o,s)}},f5=class extends Z{constructor(t,i,s,r,n,o,a,c,l,u){super(),this.H=t,this.I=i,this.J=s,this.L=r,this.M=n,this.N=o,this.O=a,this.P=c,this.Q=l,this.R=u,this.c=new Map,this.g=new I,this.onForwardPort=this.g.event,this.h=new I,this.onClosePort=this.h.event,this.j=new I,this.onPortName=this.j.event,this.n=new I,this.onCandidatesChanged=this.n.event,this.s=new I,this.onEnvironmentTunnelsSet=this.s.event,this.t=!1,this.u=void 0,this.y=!1,this.z=new I,this.C=new Map,this.F=new Map,this.G=[],this.U=!1,this.eb=new Date,this.configPortsAttributes=new jN(s),this.r=this.bb(),this.D(this.configPortsAttributes.onDidChangeAttributes(this.kb,this)),this.forwarded=new Map,this.f=new Map,this.H.tunnels.then(async h=>{const f=await this.getAttributes(h.map(p=>({port:p.tunnelRemotePort,host:p.tunnelRemoteHost})));for(const p of h)if(p.localAddress){const g=as(p.tunnelRemoteHost,p.tunnelRemotePort),v=Gi(this.m??new Map,p.tunnelRemoteHost,p.tunnelRemotePort);this.forwarded.set(g,{remotePort:p.tunnelRemotePort,remoteHost:p.tunnelRemoteHost,localAddress:p.localAddress,protocol:f?.get(p.tunnelRemotePort)?.protocol??Os.Http,localUri:await this.Y(p.localAddress,f?.get(p.tunnelRemotePort)),localPort:p.tunnelLocalPort,name:f?.get(p.tunnelRemotePort)?.label,runningProcess:v?.detail,hasRunningProcess:!!v,pid:v?.pid,privacy:p.privacy,source:d5}),this.f.set(g,p)}}),this.detected=new Map,this.D(this.H.onTunnelOpened(async h=>{const f=as(h.tunnelRemoteHost,h.tunnelRemotePort);if(!Gi(this.forwarded,h.tunnelRemoteHost,h.tunnelRemotePort)&&!Gi(this.detected,h.tunnelRemoteHost,h.tunnelRemotePort)&&!Gi(this.c,h.tunnelRemoteHost,h.tunnelRemotePort)&&h.localAddress){const p=Gi(this.m??new Map,h.tunnelRemoteHost,h.tunnelRemotePort),g=(await this.getAttributes([{port:h.tunnelRemotePort,host:h.tunnelRemoteHost}]))?.get(h.tunnelRemotePort);this.forwarded.set(f,{remoteHost:h.tunnelRemoteHost,remotePort:h.tunnelRemotePort,localAddress:h.localAddress,protocol:g?.protocol??Os.Http,localUri:await this.Y(h.localAddress,g),localPort:h.tunnelLocalPort,name:g?.label,closeable:!0,runningProcess:p?.detail,hasRunningProcess:!!p,pid:p?.pid,privacy:h.privacy,source:d5})}await this.db(),this.W(!0),this.f.set(f,h),this.g.fire(this.forwarded.get(f))})),this.D(this.H.onTunnelClosed(h=>this.X(h,Ld.Other))),this.W(!1)}S(){return this.Q.extensions.find(t=>t.activationEvents?.includes(ON))?(this.R.createKey(KK.key,!0),!0):!1}W(t){if(this.U||(t&&(this.U=!0),this.L.remoteAuthority!==void 0&&!t)||this.S())return;const s=this.D(this.Q.onDidRegisterExtensions(()=>{this.S()&&s.dispose()}))}async X(t,i){const s=as(t.host,t.port);this.forwarded.delete(s)&&(await this.db(),this.h.fire(t))}Y(t,i){if(t.startsWith("http"))return y.parse(t);const s=i?.protocol??"http";return y.parse(`${s}://${t}`)}async Z(t){const i=this.N.getWorkspace(),s=i.configuration?sn(i.configuration.path):i.folders.length>0?sn(i.folders[0].uri.path):void 0;if(s===void 0){this.O.debug("Could not get workspace hash for forwarded ports storage key.");return}return`${t}.${this.L.remoteAuthority}.${s}`}async $(){return this.Z(G1)}async ab(){return this.Z(h5)}async bb(){const t=this.I.get(G1,1);if(t)return this.I.remove(G1,1),await this.db(),t;const i=await this.$();if(i)return this.I.get(i,0)}async restoreForwarded(){if(this.cb(),this.J.getValue("remote.restoreForwardedPorts")){const t=await this.r;if(t&&t!==this.w){const i=JSON.parse(t)??[];this.O.trace(`ForwardedPorts: (TunnelModel) restoring ports ${i.map(s=>s.remotePort).join(", ")}`);for(const s of i){const r=Gi(this.detected,s.remoteHost,s.remotePort);s.source.source!==xn.Extension&&!r||s.source.source===xn.Extension&&r?await this.gb({remote:{host:s.remoteHost,port:s.remotePort},local:s.localPort,name:s.name,elevateIfNeeded:!0,source:s.source}):s.source.source===xn.Extension&&!r&&this.C.set(as(s.remoteHost,s.remotePort),s)}}}if(this.y=!0,this.z.fire(),!this.u){const t=await this.$();this.u=this.D(new ie),this.u.add(this.I.onDidChangeValue(0,void 0,this.u)(async i=>{i.key===t&&(this.r=Promise.resolve(this.I.get(t,0)),await this.restoreForwarded())}))}}cb(){const t=this.I.keys(0,0).filter(i=>i.startsWith(h5));for(const i of t){const s=this.I.getNumber(i,0);if(s&&s<Date.now()){this.r=Promise.resolve(void 0);const r=i.replace(h5,G1);this.I.remove(i,0),this.I.remove(r,0)}}}async db(){if(this.J.getValue("remote.restoreForwardedPorts")){const t=Array.from(this.forwarded.values()),i=t.map(o=>({remoteHost:o.remoteHost,remotePort:o.remotePort,localPort:o.localPort,name:o.name,localAddress:o.localAddress,localUri:o.localUri,protocol:o.protocol,source:o.source}));let s;t.length>0&&(s=JSON.stringify(i));const r=await this.$(),n=await this.ab();!s&&r&&n?(this.I.remove(r,0),this.I.remove(n,0)):s!==this.w&&r&&n&&(this.I.store(r,s,0,0),this.I.store(n,Date.now()+XK,0,0)),this.w=s}}async fb(t,i,s){if(!t.tunnelLocalPort||!s?.requireLocalPort||t.tunnelLocalPort===i)return;const r=new Date;if(this.eb.getTime()+YK>r.getTime())return;this.eb=r;const n=d(15802,null,i,t.tunnelRemotePort,t.tunnelLocalPort);return this.P.info(n)}async forward(t,i){return!this.y&&this.L.remoteAuthority&&await Ie.toPromise(this.z.event),this.gb(t,i)}async gb(t,i){await this.Q.activateByEvent(ON);const s=Gi(this.forwarded,t.remote.host,t.remote.port);i=i??(i!==null?(await this.getAttributes([t.remote]))?.get(t.remote.port):void 0);const r=t.local!==void 0?t.local:t.remote.port;let n;if(s)return this.ib(s,t,i);{const o=this.L.remoteAuthority,a=o?{getAddress:async()=>(await this.M.resolveAuthority(o)).authority}:void 0,c=as(t.remote.host,t.remote.port);this.c.set(c,!0),t=this.hb(c,t);const l=await this.H.openTunnel(a,t.remote.host,t.remote.port,void 0,r,t.elevateIfNeeded?t.elevateIfNeeded:i?.elevateIfNeeded,t.privacy,i?.protocol);if(typeof l=="string")n=l;else if(l&&l.localAddress){const u=Gi(this.m??new Map,t.remote.host,t.remote.port),h=l.protocol?l.protocol===Os.Https?Os.Https:Os.Http:i?.protocol??Os.Http,f={remoteHost:l.tunnelRemoteHost,remotePort:l.tunnelRemotePort,localPort:l.tunnelLocalPort,name:i?.label??t.name,closeable:!0,localAddress:l.localAddress,protocol:h,localUri:await this.Y(l.localAddress,i),runningProcess:u?.detail,hasRunningProcess:!!u,pid:u?.pid,source:t.source??d5,privacy:l.privacy};return this.forwarded.set(c,f),this.f.set(c,l),this.c.delete(c),await this.db(),await this.fb(l,r,i),this.g.fire(f),l}this.c.delete(c)}return n}hb(t,i){const s=this.C.has(t)?this.C:this.F.has(t)?this.F:void 0;if(s){const r=s.get(t);s.delete(t),r&&(i.name=r.name??i.name,i.local=("local"in r?r.local:"localPort"in r?r.localPort:void 0)??i.local,i.privacy=i.privacy)}return i}async ib(t,i,s){const r=s?.label??i.name;let n;(function(a){a[a.None=0]="None",a[a.Fire=1]="Fire",a[a.Reopen=2]="Reopen"})(n||(n={}));let o=n.None;switch(r!==t.name&&(t.name=r,o=n.Fire),(s?.protocol||t.protocol!==Os.Http)&&s?.protocol!==t.protocol&&(i.source=t.source,o=n.Reopen),i.privacy&&t.privacy!==i.privacy&&(o=n.Reopen),o){case n.Fire:{this.g.fire();break}case n.Reopen:await this.close(t.remoteHost,t.remotePort,Ld.User),await this.gb(i,s)}return Gi(this.f,i.remote.host,i.remote.port)}async name(t,i,s){const r=Gi(this.forwarded,t,i),n=as(t,i);if(r){r.name=s,await this.db(),this.j.fire({host:t,port:i});return}else this.detected.has(n)&&(this.detected.get(n).name=s,this.j.fire({host:t,port:i}))}async close(t,i,s){const r=as(t,i),n=this.forwarded.get(r);return s===Ld.AutoForwardEnd&&n&&n.source.source===xn.Auto&&this.F.set(r,{local:n.localPort,name:n.name,privacy:n.privacy}),await this.H.closeTunnel(t,i),this.X({host:t,port:i},s)}address(t,i){const s=as(t,i);return(this.forwarded.get(s)||this.detected.get(s))?.localAddress}get environmentTunnelsSet(){return this.t}addEnvironmentTunnels(t){if(t)for(const i of t){const s=Gi(this.m??new Map,i.remoteAddress.host,i.remoteAddress.port),r=typeof i.localAddress=="string"?i.localAddress:as(i.localAddress.host,i.localAddress.port);this.detected.set(as(i.remoteAddress.host,i.remoteAddress.port),{remoteHost:i.remoteAddress.host,remotePort:i.remoteAddress.port,localAddress:r,protocol:Os.Http,localUri:this.Y(r),closeable:!1,runningProcess:s?.detail,hasRunningProcess:!!s,pid:s?.pid,privacy:Fr.ConstantPrivate,source:{source:xn.Extension,description:d(15803,null)}}),this.H.setEnvironmentTunnel(i.remoteAddress.host,i.remoteAddress.port,r,Fr.ConstantPrivate,Os.Http)}this.t=!0,this.s.fire(),this.g.fire()}setCandidateFilter(t){this.q=t}async setCandidates(t){let i=t;this.q&&(i=await this.q(t));const s=this.jb(i);this.O.trace(`ForwardedPorts: (TunnelModel) removed candidates ${Array.from(s.values()).map(r=>r.port).join(", ")}`),this.n.fire(s)}jb(t){const i=this.m??new Map,s=new Map;return this.m=s,t.forEach(r=>{const n=as(r.host,r.port);s.set(n,{host:r.host,port:r.port,detail:r.detail,pid:r.pid}),i.delete(n);const o=Gi(this.forwarded,r.host,r.port);o&&(o.runningProcess=r.detail,o.hasRunningProcess=!0,o.pid=r.pid)}),i.forEach((r,n)=>{const o=FN(n);if(!o)return;const a=Gi(this.forwarded,o.host,o.port);a&&(a.runningProcess=void 0,a.hasRunningProcess=!1,a.pid=void 0);const c=Gi(this.detected,o.host,o.port);c&&(c.runningProcess=void 0,c.hasRunningProcess=!1,c.pid=void 0)}),i}get candidates(){return this.m?Array.from(this.m.values()):[]}get candidatesOrUndefined(){return this.m?this.candidates:void 0}async kb(){const t=Array.from(this.forwarded.values()),i=await this.getAttributes(t.map(s=>({port:s.remotePort,host:s.remoteHost})),!1);if(i)for(const s of t){const r=i.get(s.remotePort);(r?.protocol||s.protocol!==Os.Http)&&r?.protocol!==s.protocol&&await this.gb({remote:{host:s.remoteHost,port:s.remotePort},local:s.localPort,name:s.name,source:s.source},r),r&&r.label&&r.label!==s.name&&await this.name(s.remoteHost,s.remotePort,r.label)}}async getAttributes(t,i=!0){const s=new Map,r=new Map;t.forEach(l=>{const u=Gi(this.m??new Map,Jh[0],l.port)??l;if(u){s.set(l.port,u);const h=eee(u)?u.pid:void 0;r.has(h)||r.set(h,[]),r.get(h)?.push(l.port)}});const n=new Map;if(t.forEach(l=>{const u=this.configPortsAttributes.getAttributes(l.port,l.host,s.get(l.port)?.detail);u&&n.set(l.port,u)}),this.G.length===0||!i)return n.size>0?n:void 0;const o=await Promise.all(this.G.flatMap(l=>Array.from(r.entries()).map(u=>{const h=u[1],f=s.get(h[0]);return l.providePortAttributes(h,f?.pid,f?.detail,Fe.None)}))),a=new Map;if(o.forEach(l=>l.forEach(u=>{u&&a.set(u.port,u)})),!n&&!a)return;const c=new Map;return t.forEach(l=>{const u=n.get(l.port),h=a.get(l.port);c.set(l.port,{elevateIfNeeded:u?.elevateIfNeeded,label:u?.label,onAutoForward:u?.onAutoForward??jN.providedActionToAction(h?.autoForwardAction),requireLocalPort:u?.requireLocalPort,protocol:u?.protocol})}),c}addAttributesProvider(t){this.G.push(t)}};__decorate([Cf(1e3)],f5.prototype,"db",null),f5=__decorate([__param(0,S_),__param(1,_a),__param(2,gi),__param(3,jA),__param(4,XW),__param(5,$u),__param(6,Se),__param(7,q3),__param(8,K6),__param(9,Gn)],f5);function tee(e){const t=e.trim().split(`
`),i=[];return t.forEach(r=>{const n=/\/proc\/(\d+)\/fd\/\d+ -> socket:\[(\d+)\]/.exec(r);n&&n.length>=3&&i.push({pid:parseInt(n[1],10),socket:parseInt(n[2],10)})}),i.reduce((r,n)=>(r[n.socket]=n,r),{})}function iee(...e){const t=[].concat(...e.map(ree));return[...new Map(t.filter(i=>i.st==="0A").map(i=>{const s=i.local_address.split(":");return{socket:parseInt(i.inode,10),ip:see(s[0]),port:parseInt(s[1],16)}}).map(i=>[i.ip+":"+i.port,i])).values()]}function see(e){let t="";if(e.length===8)for(let i=e.length-2;i>=0;i-=2)t+=parseInt(e.substr(i,2),16),i!==0&&(t+=".");else for(let i=0;i<e.length;i+=8){const s=e.substring(i,i+8);let r="";for(let n=8;n>=2;n-=2)r+=s.substring(n-2,n),(n===6||n===2)&&(r=parseInt(r,16).toString(16),t+=`${r}`,r="",i+n!==e.length-6&&(t+=":"))}return t}function ree(e){const t=e.trim().split(`
`),i=t.shift().trim().split(/\s+/).filter(r=>r!=="rx_queue"&&r!=="tm->when");return t.map(r=>r.trim().split(/\s+/).reduce((n,o,a)=>(n[i[a]||a]=o,n),{}))}function nee(e){return e.length>500?!1:!!e.match(/.*\.vscode-server-[a-zA-Z]+\/bin.*/)||e.indexOf("out/server-main.js")!==-1||e.indexOf("_productName=VSCode")!==-1}function oee(e){const t=e.trim().split(`
`),i=[];return t.forEach(s=>{const r=/^\d+\s+\D+\s+root\s+(\d+)\s+(\d+).+\d+\:\d+\:\d+\s+(.+)$/.exec(s);r&&r.length>=4&&i.push({pid:parseInt(r[1],10),ppid:parseInt(r[2]),cmd:r[3]})}),i}async function aee(e,t,i){const s=i.reduce((n,o)=>(n[o.pid]=o,n),{}),r=[];return e.forEach(({socket:n,ip:o,port:a})=>{const c=t[n]?t[n].pid:void 0,l=c?s[c]?.cmd:void 0;c&&l&&!nee(l)&&r.push({host:o,port:a,detail:l,pid:c})}),r}function cee(e,t,i){const s=new Map,r=oee(t);for(const n of e){const o=i.get(n.port);if(o){s.set(n.port,o);continue}const a=r.find(c=>c.cmd.includes(`${n.port}`));if(a){let c=a,l;do l=r.find(u=>u.ppid===c.pid),l&&(c=l);while(l);s.set(n.port,{host:n.ip,port:n.port,pid:c.pid,detail:c.cmd,ppid:c.ppid})}else s.set(n.port,{host:n.ip,port:n.port,ppid:Number.MAX_VALUE})}return s}var p5=class extends Sm{constructor(t,i,s,r,n){super(t,i,s),this.C=i,this.F=r,this.G=n,this.w=void 0,this.y=new Map,this.z=!1,$t&&i.remote.isRemote&&i.remote.authority&&(this.a.$setRemoteTunnelService(process.pid),this.I())}async $registerCandidateFinder(t){if(t&&this.z)return;this.z=t;let i;this.w&&(i=this.w,await this.a.$onFoundNewCandidates(this.w));const s=new bj;let r=0;for(;this.z;){const n=new Date().getTime(),o=(await this.J()).filter(l=>ja(l.host)||gn(l.host));this.r.trace(`ForwardedPorts: (ExtHostTunnelService) found candidate ports ${o.map(l=>l.port).join(", ")}`);const a=new Date().getTime()-n;this.r.trace(`ForwardedPorts: (ExtHostTunnelService) candidate port scan took ${a} ms.`),r++>3&&s.update(a),(!i||JSON.stringify(i)!==JSON.stringify(o))&&(i=o,await this.a.$onFoundNewCandidates(i));const c=this.H(s.value);this.r.trace(`ForwardedPorts: (ExtHostTunnelService) next candidate port scan in ${c} ms.`),await new Promise(l=>setTimeout(()=>l(),c))}}H(t){return Math.max(t*20,2e3)}async I(){this.w=await this.J(),this.r.trace(`ForwardedPorts: (ExtHostTunnelService) Initial candidates found: ${this.w.map(t=>t.port).join(", ")}`)}async J(){let t="",i="";try{t=await Td.promises.readFile("/proc/net/tcp","utf8"),i=await Td.promises.readFile("/proc/net/tcp6","utf8")}catch{}const s=iee(t,i),r=await new Promise(f=>{xN("ls -l /proc/[0-9]*/fd/[0-9]* | grep socket:",(p,g,v)=>{f(g)})}),n=tee(r),o=await nt.readdir("/proc"),a=[];for(const f of o)try{const p=Number(f),g=It(y.file("/proc"),f);if((await Td.promises.stat(g.fsPath)).isDirectory()&&!isNaN(p)){const b=await Td.promises.readlink(It(g,"cwd").fsPath),S=await Td.promises.readFile(It(g,"cmdline").fsPath,"utf8");a.push({pid:p,cwd:b,cmd:S})}}catch{}const c=[],l=s.filter(f=>{const p=n[f.socket];return p||c.push(f),p}),u=aee(l,n,a);let h;if(this.r.trace(`ForwardedPorts: (ExtHostTunnelService) number of possible root ports ${c.length}`),c.length>0){const f=await new Promise(p=>{xN("ps -F -A -l | grep root",(g,v,b)=>{p(v)})});this.y=cee(c,f,this.y),h=Array.from(this.y.values()),this.r.trace(`ForwardedPorts: (ExtHostTunnelService) heuristic ports ${h.map(p=>p.port).join(", ")}`)}return u.then(f=>h?f.concat(h):f)}async L(){const t=(await this.G.getConfigProvider()).getConfiguration("remote").get("localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}u(t){return async i=>{const s=new LN({commit:this.C.commit,quality:this.C.quality,logService:this.r,ipcLogger:null,remoteSocketFactoryService:{_serviceBrand:void 0,async connect(n,o,a,c){const l=await t.makeConnection();return lee.connect(l,o,a,c)},register(){throw new Error("not implemented")}},addressProvider:{getAddress(){return Promise.resolve({connectTo:new o7(0),connectionToken:t.connectionToken})}},signService:this.F},await this.L(),i.remoteAddress.host||"localhost",i.remoteAddress.port,i.localAddressPort);await s.waitForReady();const r=new I;return{localAddress:FN(s.localAddress)??s.localAddress,remoteAddress:{port:s.tunnelRemotePort,host:s.tunnelRemoteHost},onDidDispose:r.event,dispose:()=>{s.dispose(),r.fire(),r.dispose()}}}}};p5=__decorate([__param(0,ke),__param(1,jt),__param(2,Se),__param(3,Nd),__param(4,ws)],p5);var lee=class fL extends $K{static connect(t,i,s,r){const n=new ie,o={onClose:n.add(new I),onData:n.add(new I),onEnd:n.add(new I)};n.add(t.onDidReceiveMessage(c=>o.onData.fire(W.wrap(c)))),n.add(t.onDidEnd(()=>o.onEnd.fire())),n.add(t.onDidClose(c=>o.onClose.fire({type:0,error:c,hadError:!!c})));const a=new fL(t,r,o);return a.D(n),kK(a,i,s,r,o)}constructor(t,i,s){super(i,s),this.n=t}write(t){this.n.send(t.buffer)}h(){this.n.end()}async drain(){await this.n.drain?.()}};import*as Ja from"fs";var uee=class extends dA{constructor(){super(...arguments),this.i=null}async g(e){const t=await super.g(e);if(t.scheme!==V.file)return t;if(this.b.skipWorkspaceStorageLock)return this.d.info(`Skipping acquiring lock for ${t.fsPath}.`),t;const i=t.fsPath;let s=0;do{let r;s===0?r=i:r=/[/\\]$/.test(i)?`${i.substr(0,i.length-1)}-${s}`:`${i}-${s}`,await hee(r);const n=_e(r,"vscode.lock"),o=await HN(this.d,n,!1);if(o)return this.i=o,process.on("exit",()=>{o.dispose()}),y.file(r);s++}while(s<10);return t}onWillDeactivateAll(){this.i?.setWillRelease(6e3)}};async function hee(e){try{await Ja.promises.stat(e);return}catch{}try{await Ja.promises.mkdir(e,{recursive:!0})}catch{}}var dee=1e3,zN=10*60*1e3,fee=class extends Z{constructor(e,t){super(),this.b=e,this.c=t,this.a=this.D(new Ax),this.a.cancelAndSet(async()=>{const i=await g5(e,t);(!i||i.pid!==process.pid)&&(e.info(`Lock '${t}': The lock was lost unexpectedly.`),this.a.cancel());try{await Ja.promises.utimes(t,new Date,new Date)}catch(s){e.error(s),e.info(`Lock '${t}': Could not update mtime.`)}},dee)}dispose(){super.dispose();try{Ja.unlinkSync(this.c)}catch{}}async setWillRelease(e){this.b.info(`Lock '${this.c}': Marking the lockfile as scheduled to be released in ${e} ms.`);try{const t={pid:process.pid,willReleaseAt:Date.now()+e};await nt.writeFile(this.c,JSON.stringify(t),{flag:"w"})}catch(t){this.b.error(t)}}};async function HN(e,t,i){try{const r={pid:process.pid,willReleaseAt:0};await nt.writeFile(t,JSON.stringify(r),{flag:"wx"})}catch(r){e.error(r)}const s=await g5(e,t);return!s||s.pid!==process.pid?i?(e.info(`Lock '${t}': Could not acquire lock, giving up.`),null):(e.info(`Lock '${t}': Could not acquire lock, checking if the file is stale.`),gee(e,t)):(e.info(`Lock '${t}': Lock acquired.`),new fee(e,t))}async function g5(e,t){let i;try{i=await Ja.promises.readFile(t)}catch(s){return e.error(s),null}try{return JSON.parse(String(i))}catch(s){return e.error(s),null}}async function m5(e,t){let i;try{i=await Ja.promises.stat(t)}catch(s){return e.error(s),0}return i.mtime.getTime()}function pee(e){try{return process.kill(e,0),!0}catch{return!1}}async function gee(e,t){const i=await g5(e,t);if(!i)return e.info(`Lock '${t}': Could not read pid of lock holder.`),Rd(e,t);if(i.willReleaseAt){let a=i.willReleaseAt-Date.now();if(a<5e3){for(a>0?e.info(`Lock '${t}': The lockfile is scheduled to be released in ${a} ms.`):e.info(`Lock '${t}': The lockfile is scheduled to have been released.`);a>0;){if(await ri(Math.min(100,a)),await m5(e,t)===0)return Rd(e,t);a=i.willReleaseAt-Date.now()}return Rd(e,t)}}if(!pee(i.pid))return e.info(`Lock '${t}': The pid ${i.pid} appears to be gone.`),Rd(e,t);const s=await m5(e,t),r=Date.now()-s;if(r<=zN)return e.info(`Lock '${t}': The lock does not look stale, elapsed: ${r} ms, giving up.`),null;e.info(`Lock '${t}': The lock looks stale, waiting for 2s.`),await ri(2e3);const n=await m5(e,t),o=Date.now()-n;return o<=zN?(e.info(`Lock '${t}': The lock does not look stale, elapsed: ${o} ms, giving up.`),null):(e.info(`Lock '${t}': The lock looks stale even after waiting for 2s.`),Rd(e,t))}async function Rd(e,t){e.info(`Lock '${t}': Deleting a stale lock.`);try{await Ja.promises.unlink(t)}catch{}return HN(e,t,!0)}var Cn;(function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.Off=6]="Off"})(Cn||(Cn={}));async function mee(e,t,i,s,r){try{const n=await import("@vscode/spdlog");n.setFlushOn(Cn.Trace);const o=await n.createAsyncRotatingLogger(e,t,i,s);return r?o.clearFormatters():o.setPattern("%Y-%m-%d %H:%M:%S.%e [%l] %v"),o}catch(n){console.error(n)}return null}function WN(e,t,i){switch(t){case X.Trace:e.trace(i);break;case X.Debug:e.debug(i);break;case X.Info:e.info(i);break;case X.Warning:e.warn(i);break;case X.Error:e.error(i);break;case X.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function BN(e,t){switch(t){case X.Trace:e.setLevel(Cn.Trace);break;case X.Debug:e.setLevel(Cn.Debug);break;case X.Info:e.setLevel(Cn.Info);break;case X.Warning:e.setLevel(Cn.Warning);break;case X.Error:e.setLevel(Cn.Error);break;case X.Off:e.setLevel(Cn.Off);break;default:throw new Error(`Invalid log level ${t}`)}}var vee=class extends L0{constructor(e,t,i,s,r){super(),this.n=[],this.setLevel(r),this.q=this.s(e,t,i,s),this.D(this.onDidChangeLogLevel(n=>{this.r&&BN(this.r,n)}))}async s(e,t,i,s){const r=i?6:1,n=30/r*R$.MB,o=await mee(e,t,n,r,s);if(o){this.r=o,BN(this.r,this.getLevel());for(const{level:a,message:c}of this.n)WN(this.r,a,c);this.n=[]}}m(e,t){this.r?WN(this.r,e,t):this.getLevel()<=e&&this.n.push({level:e,message:t})}flush(){this.r?this.u():this.q.then(()=>this.u())}dispose(){this.r?this.w():this.q.then(()=>this.w()),super.dispose()}u(){this.r&&this.r.flush()}w(){this.r&&(this.r.drop(),this.r=void 0)}},wee=class extends Gm{s(e,t,i){return e.scheme===V.file?new vee(i?.name||Nt(),e.fsPath,!i?.donotRotate,!!i?.donotUseFormatters,t):super.s(e,t,i)}registerLogger(e){super.registerLogger(e),this.c.$registerLogger(e)}deregisterLogger(e){super.deregisterLogger(e),this.c.$deregisterLogger(e)}};import{homedir as bee}from"os";var yee=class extends Bm{m(){return bee()}},Aee=class extends Z{constructor(e,t=[]){super(),this.a=new oj([e,...t]),this.D(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.a.onDidChangeLogLevel}setLevel(e){this.a.setLevel(e)}getLevel(){return this.a.getLevel()}trace(e,...t){this.a.trace(e,...t)}debug(e,...t){this.a.debug(e,...t)}info(e,...t){this.a.info(e,...t)}warn(e,...t){this.a.warn(e,...t)}error(e,...t){this.a.error(e,...t)}flush(){this.a.flush()}},v5=class extends Aee{constructor(t,i,s){const r=s.remote.isRemote?"remoteexthost":t?"workerexthost":"exthost",n=s.remote.isRemote?d(3042,null):d(t?3043:3044,null);super(i.createLogger(r,{name:n}))}};v5=__decorate([__param(1,Jn),__param(2,jt)],v5);import{spawn as See}from"child_process";import{readFile as Eee}from"fs/promises";import{homedir as xee}from"os";function Cee(e){const t=new Map,s=e.replace(/\r\n?/g,`
`).split(`
`);for(let o of s){if(o=o.trim(),!o||o.startsWith("#"))continue;const[a,c]=r(o);a&&t.set(a,c)}return t;function r(o){o.startsWith("export ")&&(o=o.substring(7).trim());const a=n(o,h=>h==="="||h===":");if(a===-1)return[null,null];const c=o.substring(0,a).trim();let l=o.substring(a+1).trim();const u=n(l,h=>h==="#");if(u!==-1&&(l=l.substring(0,u).trim()),l.length>=2){const h=l[0],f=l[l.length-1];(h==='"'&&f==='"'||h==="'"&&f==="'"||h==="`"&&f==="`")&&(l=l.substring(1,l.length-1),h==='"'&&(l=l.replace(/\\n/g,`
`).replace(/\\r/g,"\r")))}return[c,l]}function n(o,a){let c=!1,l="";for(let u=0;u<o.length;u++){const h=o[u];if(c)h===l&&o[u-1]!=="\\"&&(c=!1);else if(h==='"'||h==="'"||h==="`")c=!0,l=h;else if(a(h))return u}return-1}}import{Transform as kee}from"stream";var _N=class extends kee{constructor(e){if(super(),typeof e=="number")this.b=e,this.c=1;else{const t=Buffer.isBuffer(e)?e:Buffer.from(e);this.b=t.length===1?t[0]:t,this.c=t.length}}_transform(e,t,i){this.a?this.a=Buffer.concat([this.a,e]):this.a=e;let s=0;for(;s<this.a.length;){const r=typeof this.b=="number"?this.a.indexOf(this.b,s):Dx(this.a,this.b,s);if(r===-1)break;this.push(this.a.slice(s,r+this.c)),s=r+this.c}this.a=s===this.a.length?void 0:this.a.slice(s),i()}_flush(e){this.a&&this.push(this.a),e()}},VN;(function(e){e[e.Running=0]="Running",e[e.StdinEnded=1]="StdinEnded",e[e.KilledPolite=2]="KilledPolite",e[e.KilledForceful=3]="KilledForceful"})(VN||(VN={}));var $ee=class pL{static{this.a=1e4}get stopped(){return this.b!==0}constructor(t,i=pL.a){this.d=t,this.e=i,this.b=0}stop(){if(this.b===0){let t=this.e;try{this.d.stdin.end()}catch{t=1}this.b=1,this.c=new yx(()=>this.f(),t)}else this.c?.dispose(),this.g()}async f(){this.b=2,this.c=new yx(()=>this.g(),this.e),this.d.pid?ze||await P4(this.d.pid,!1).catch(()=>{this.d.kill("SIGTERM")}):this.d.kill("SIGTERM")}async g(){this.b=3,this.d.pid?await P4(this.d.pid,!0).catch(()=>{this.d.kill("SIGKILL")}):this.d.kill()}write(t){this.stopped||this.d.stdin.write(t+`
`)}dispose(){this.c?.dispose()}},Iee=class extends Km{constructor(){super(...arguments),this.w=this.D(new Fo)}r(e,t,i,s){t.type===1?this.z(e,t,i):t.type===2?this.f.set(e,new Dee(e,t,this.b,this.h,s)):super.r(e,t,i,s)}$stopMcp(e){const t=this.w.get(e);t?t.stop():super.$stopMcp(e)}$sendMessage(e,t){const i=this.w.get(e);i?i.write(t):super.$sendMessage(e,t)}async z(e,t,i){const s=a=>this.b.$onDidChangeState(e,{state:3,code:a.hasOwnProperty("code")?String(a.code):void 0,message:typeof a=="string"?a:a.message}),r={...process.env};if(t.envFile)try{for(const[a,c]of Cee(await Eee(t.envFile,"utf-8")))r[a]=c}catch(a){s(`Failed to read envFile '${t.envFile}': ${a.message}`);return}for(const[a,c]of Object.entries(t.env))r[a]=c===null?void 0:String(c);let n;try{const a=xee();let c=t.cwd?Pm(t.cwd,a):i?.fsPath||a;ks(c)||(c=_e(i?i.fsPath:a,c));const{executable:l,args:u,shell:h}=await Tee(Pm(t.command,a),t.args.map(f=>Pm(f,a)),c,r);this.b.$onDidPublishLog(e,X.Debug,`Server command line: ${l} ${u.join(" ")}`),n=See(l,u,{stdio:"pipe",cwd:c,env:r,shell:h})}catch(a){s(a);return}const o=new $ee(n);this.b.$onDidChangeState(e,{state:1}),n.stdout.pipe(new _N(`
`)).on("data",a=>this.b.$onDidReceiveMessage(e,a.toString())),n.stdin.on("error",s),n.stdout.on("error",s),n.stderr.pipe(new _N(`
`)).on("data",a=>this.b.$onDidPublishLog(e,X.Warning,`[server stderr] ${a.toString().trimEnd()}`)),n.on("spawn",()=>this.b.$onDidChangeState(e,{state:2})),n.on("error",a=>{s(a)}),n.on("exit",a=>{this.w.deleteAndDispose(e),a===0||o.stopped?this.b.$onDidChangeState(e,{state:0}):this.b.$onDidChangeState(e,{state:3,message:`Process exited with code ${a}`})}),this.w.set(e,o)}},Dee=class extends k8{constructor(){super(...arguments),this.U=new Tt(()=>import("undici"))}async S(e,t){const{fetch:i,Agent:s}=await this.U.value,r={...t};let n=e;const o=y.parse(e);if(o.scheme==="unix"||o.scheme==="pipe")r.dispatcher=new s({socketPath:o.path}),n=o.with({scheme:"http",authority:"localhost",path:o.fragment}).toString(!0);else return super.S(e,t);const a=await i(n,r);return{status:a.status,statusText:a.statusText,headers:a.headers,body:a.body,url:a.url,json:()=>a.json(),text:()=>a.text()}}},Pee=/\.(bat|cmd)$/i,Tee=async(e,t,i,s)=>{if(process.platform!=="win32")return{executable:e,args:t,shell:!1};const r=await e1(e,i,void 0,s);if(r&&Pee.test(r)){const n=o=>o.includes(" ")?`"${o}"`:o;return{executable:n(r),args:t.map(n),shell:!0}}return{executable:e,args:t,shell:!1}};import{URL as Nee}from"url";import{randomBytes as Mee}from"crypto";import*as Lee from"http";import{URL as Ree}from"url";var Oee=class{constructor(e,t,i){this.e=e,this.f=t,this.g=i,this.c=Mee(16).toString("base64");const s=new Ri;this.b=s.p,this.a=Lee.createServer((r,n)=>{const o=new Ree(r.url,`http://${r.headers.host}`);switch(o.pathname){case"/":{const a=o.searchParams.get("code")??void 0,c=o.searchParams.get("state")??void 0,l=o.searchParams.get("error")??void 0;if(l){n.writeHead(302,{location:`/done?error=${o.searchParams.get("error_description")||l}`}),n.end(),s.error(new Error(l));break}if(!a||!c){n.writeHead(400),n.end();break}if(this.state!==c){n.writeHead(302,{location:`/done?error=${encodeURIComponent("State does not match.")}`}),n.end(),s.error(new Error("State does not match."));break}s.complete({code:a,state:c}),n.writeHead(302,{location:"/done"}),n.end();break}case"/done":this.h(n);break;default:n.writeHead(404),n.end();break}})}get state(){return this.c}get redirectUri(){if(this.d===void 0)throw new Error("Server is not started yet");return`http://127.0.0.1:${this.d}/`}h(e){const t=this.getHtml();e.writeHead(200,{"Content-Type":"text/html","Content-Length":Buffer.byteLength(t,"utf8")}),e.end(t)}start(){const e=new Ri;if(this.a.listening)throw new Error("Server is already started");const t=setTimeout(()=>{e.error(new Error("Timeout waiting for port"))},5e3);return this.a.on("listening",()=>{const i=this.a.address();if(typeof i=="string")this.d=parseInt(i);else if(i instanceof Object)this.d=i.port;else throw new Error("Unable to determine port");clearTimeout(t),e.complete()}),this.a.on("error",i=>{if("code"in i&&i.code==="EADDRINUSE"){this.e.error("Address in use, retrying with a different port..."),this.a.listen(0,"127.0.0.1");return}clearTimeout(t),e.error(new Error(`Error listening to server: ${i}`))}),this.a.on("close",()=>{e.error(new Error("Closed"))}),this.a.listen(GD,"127.0.0.1"),e.p}stop(){const e=new Ri;return this.a.listening?(this.a.close(t=>{t?e.error(t):e.complete()}),setTimeout(()=>{e.isResolved||e.error(new Error("Timeout waiting for server to close"))},5e3),e.p):(e.complete(),e.p)}waitForOAuthResponse(){return this.b}getHtml(){let e="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQABAMAAACNMzawAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAJ1BMVEUAAAD///9Qm8+ozed8tNsWer+Lvd9trNfF3u9Ck8slgsMzi8eZxeM/Qa6mAAAAAXRSTlMAQObYZgAAAAFiS0dEAf8CLd4AAAAHdElNRQfiCwYULRt0g+ZLAAAJRUlEQVR42u3SUY0CQRREUSy0hSZtBA+wfOwv4wAPYwAJSMAfAthkB6YD79HnKqikzmYjSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk6cmKhg4AAASAABAAAkAACAABIAAEgAAQAAJAAAgAAaBvBVAjtV2wfFe1ogcA+0gdFgBoe60IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAjAP/1MkWoAvBvAsUTqBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJAAgAASAABIAAEAACQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7gDlbFwC6AijZagAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQDM2boA0BXAqAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIATARAAAkAAvF7N1hWArgBKthoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfBrAlK0bAF0BjBoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4EQABIAAEwOtN2boB0BVAyVYDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgE8DqNm6AtAVwKgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEwEQAAJAAPzd7xypMwDvBnAskToBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAIAAkAACAABIAAEgAAQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBKBGarsAwK5qRQ8ANGYAACAABIAAEAACQAAIAAEgAASAABAAAkDfCUCSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJC3uDtO80OSql+i8AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTA2VDIwOjQ1OjI3KzAwOjAwEjLurQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wNlQyMDo0NToyNyswMDowMGNvVhEAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAAElFTkSuQmCC')";return this.g==="Visual Studio Code"?e="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtYXNrIGlkPSJtYXNrMCIgbWFzay10eXBlPSJhbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MS41MzQgMjU0LjI1MkMxODUuNTY2IDI1NS44MjMgMTkwLjE2NCAyNTUuNzIyIDE5NC4yMzQgMjUzLjc2NEwyNDYuOTQgMjI4LjQwM0MyNTIuNDc4IDIyNS43MzggMjU2IDIyMC4xMzIgMjU2IDIxMy45ODNWNDIuMDE4MUMyNTYgMzUuODY4OSAyNTIuNDc4IDMwLjI2MzggMjQ2Ljk0IDI3LjU5ODhMMTk0LjIzNCAyLjIzNjgxQzE4OC44OTMgLTAuMzMzMTMyIDE4Mi42NDIgMC4yOTYzNDQgMTc3Ljk1NSAzLjcwNDE4QzE3Ny4yODUgNC4xOTEgMTc2LjY0NyA0LjczNDU0IDE3Ni4wNDkgNS4zMzM1NEw3NS4xNDkgOTcuMzg2MkwzMS4xOTkyIDY0LjAyNDdDMjcuMTA3OSA2MC45MTkxIDIxLjM4NTMgNjEuMTczNSAxNy41ODU1IDY0LjYzTDMuNDg5MzYgNzcuNDUyNUMtMS4xNTg1MyA4MS42ODA1IC0xLjE2Mzg2IDg4Ljk5MjYgMy40Nzc4NSA5My4yMjc0TDQxLjU5MjYgMTI4TDMuNDc3ODUgMTYyLjc3M0MtMS4xNjM4NiAxNjcuMDA4IC0xLjE1ODUzIDE3NC4zMiAzLjQ4OTM2IDE3OC41NDhMMTcuNTg1NSAxOTEuMzdDMjEuMzg1MyAxOTQuODI3IDI3LjEwNzkgMTk1LjA4MSAzMS4xOTkyIDE5MS45NzZMNzUuMTQ5IDE1OC42MTRMMTc2LjA0OSAyNTAuNjY3QzE3Ny42NDUgMjUyLjI2NCAxNzkuNTE5IDI1My40NjcgMTgxLjUzNCAyNTQuMjUyWk0xOTIuMDM5IDY5Ljg4NTNMMTE1LjQ3OSAxMjhMMTkyLjAzOSAxODYuMTE1VjY5Ljg4NTNaIiBmaWxsPSJ3aGl0ZSIvPgo8L21hc2s+CjxnIG1hc2s9InVybCgjbWFzazApIj4KPHBhdGggZD0iTTI0Ni45NCAyNy42MzgzTDE5NC4xOTMgMi4yNDEzOEMxODguMDg4IC0wLjY5ODMwMiAxODAuNzkxIDAuNTQxNzIxIDE3NS45OTkgNS4zMzMzMkwzLjMyMzcxIDE2Mi43NzNDLTEuMzIwODIgMTY3LjAwOCAtMS4zMTU0OCAxNzQuMzIgMy4zMzUyMyAxNzguNTQ4TDE3LjQzOTkgMTkxLjM3QzIxLjI0MjEgMTk0LjgyNyAyNi45NjgyIDE5NS4wODEgMzEuMDYxOSAxOTEuOTc2TDIzOS4wMDMgMzQuMjI2OUMyNDUuOTc5IDI4LjkzNDcgMjU1Ljk5OSAzMy45MTAzIDI1NS45OTkgNDIuNjY2N1Y0Mi4wNTQzQzI1NS45OTkgMzUuOTA3OCAyNTIuNDc4IDMwLjMwNDcgMjQ2Ljk0IDI3LjYzODNaIiBmaWxsPSIjMDA2NUE5Ii8+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2QpIj4KPHBhdGggZD0iTTI0Ni45NCAyMjguMzYyTDE5NC4xOTMgMjUzLjc1OUMxODguMDg4IDI1Ni42OTggMTgwLjc5MSAyNTUuNDU4IDE3NS45OTkgMjUwLjY2N0wzLjMyMzcxIDkzLjIyNzJDLTEuMzIwODIgODguOTkyNSAtMS4zMTU0OCA4MS42ODAyIDMuMzM1MjMgNzcuNDUyM0wxNy40Mzk5IDY0LjYyOThDMjEuMjQyMSA2MS4xNzMzIDI2Ljk2ODIgNjAuOTE4OCAzMS4wNjE5IDY0LjAyNDVMMjM5LjAwMyAyMjEuNzczQzI0NS45NzkgMjI3LjA2NSAyNTUuOTk5IDIyMi4wOSAyNTUuOTk5IDIxMy4zMzNWMjEzLjk0NkMyNTUuOTk5IDIyMC4wOTIgMjUyLjQ3OCAyMjUuNjk1IDI0Ni45NCAyMjguMzYyWiIgZmlsbD0iIzAwN0FDQyIvPgo8L2c+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIxX2QpIj4KPHBhdGggZD0iTTE5NC4xOTYgMjUzLjc2M0MxODguMDg5IDI1Ni43IDE4MC43OTIgMjU1LjQ1OSAxNzYgMjUwLjY2N0MxODEuOTA0IDI1Ni41NzEgMTkyIDI1Mi4zODkgMTkyIDI0NC4wMzlWMTEuOTYwNkMxOTIgMy42MTA1NyAxODEuOTA0IC0wLjU3MTE3NSAxNzYgNS4zMzMyMUMxODAuNzkyIDAuNTQxMTY2IDE4OC4wODkgLTAuNzAwNjA3IDE5NC4xOTYgMi4yMzY0OEwyNDYuOTM0IDI3LjU5ODVDMjUyLjQ3NiAzMC4yNjM1IDI1NiAzNS44Njg2IDI1NiA0Mi4wMTc4VjIxMy45ODNDMjU2IDIyMC4xMzIgMjUyLjQ3NiAyMjUuNzM3IDI0Ni45MzQgMjI4LjQwMkwxOTQuMTk2IDI1My43NjNaIiBmaWxsPSIjMUY5Q0YwIi8+CjwvZz4KPGcgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm92ZXJsYXkiIG9wYWNpdHk9IjAuMjUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MS4zNzggMjU0LjI1MkMxODUuNDEgMjU1LjgyMiAxOTAuMDA4IDI1NS43MjIgMTk0LjA3NyAyNTMuNzY0TDI0Ni43ODMgMjI4LjQwMkMyNTIuMzIyIDIyNS43MzcgMjU1Ljg0NCAyMjAuMTMyIDI1NS44NDQgMjEzLjk4M1Y0Mi4wMTc5QzI1NS44NDQgMzUuODY4NyAyNTIuMzIyIDMwLjI2MzYgMjQ2Ljc4NCAyNy41OTg2TDE5NC4wNzcgMi4yMzY2NUMxODguNzM3IC0wLjMzMzI5OSAxODIuNDg2IDAuMjk2MTc3IDE3Ny43OTggMy43MDQwMUMxNzcuMTI5IDQuMTkwODMgMTc2LjQ5MSA0LjczNDM3IDE3NS44OTIgNS4zMzMzN0w3NC45OTI3IDk3LjM4NkwzMS4wNDI5IDY0LjAyNDVDMjYuOTUxNyA2MC45MTg5IDIxLjIyOSA2MS4xNzM0IDE3LjQyOTIgNjQuNjI5OEwzLjMzMzExIDc3LjQ1MjNDLTEuMzE0NzggODEuNjgwMyAtMS4zMjAxMSA4OC45OTI1IDMuMzIxNiA5My4yMjczTDQxLjQzNjQgMTI4TDMuMzIxNiAxNjIuNzczQy0xLjMyMDExIDE2Ny4wMDggLTEuMzE0NzggMTc0LjMyIDMuMzMzMTEgMTc4LjU0OEwxNy40MjkyIDE5MS4zN0MyMS4yMjkgMTk0LjgyNyAyNi45NTE3IDE5NS4wODEgMzEuMDQyOSAxOTEuOTc2TDc0Ljk5MjcgMTU4LjYxNEwxNzUuODkyIDI1MC42NjdDMTc3LjQ4OCAyNTIuMjY0IDE3OS4zNjMgMjUzLjQ2NyAxODEuMzc4IDI1NC4yNTJaTTE5MS44ODMgNjkuODg1MUwxMTUuMzIzIDEyOEwxOTEuODgzIDE4Ni4xMTVWNjkuODg1MVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcikiLz4KPC9nPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2QiIHg9Ii0yMS40ODk2IiB5PSI0MC41MjI1IiB3aWR0aD0iMjk4LjgyMiIgaGVpZ2h0PSIyMzYuMTQ5IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIi8+CjxmZU9mZnNldC8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEwLjY2NjciLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJvdmVybGF5IiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3ciIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjxmaWx0ZXIgaWQ9ImZpbHRlcjFfZCIgeD0iMTU0LjY2NyIgeT0iLTIwLjY3MzUiIHdpZHRoPSIxMjIuNjY3IiBoZWlnaHQ9IjI5Ny4zNDciIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTAuNjY2NyIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im92ZXJsYXkiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyIiB4MT0iMTI3Ljg0NCIgeTE9IjAuNjU5OTg4IiB4Mj0iMTI3Ljg0NCIgeTI9IjI1NS4zNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSJ3aGl0ZSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K')":this.g==="Visual Studio Code - Insiders"&&(e="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtYXNrIGlkPSJtYXNrMCIgbWFzay10eXBlPSJhbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgo8cGF0aCBkPSJNMTc2LjA0OSAyNTAuNjY5QzE4MC44MzggMjU1LjQ1OSAxODguMTMgMjU2LjcgMTk0LjIzNCAyNTMuNzY0TDI0Ni45NCAyMjguNDE5QzI1Mi40NzggMjI1Ljc1NSAyNTYgMjIwLjE1NCAyNTYgMjE0LjAwOFY0Mi4xNDc5QzI1NiAzNi4wMDI1IDI1Mi40NzggMzAuNDAwOCAyNDYuOTQgMjcuNzM3NEwxOTQuMjM0IDIuMzkwODlDMTg4LjEzIC0wLjU0NDQxNiAxODAuODM4IDAuNjk2NjA3IDE3Ni4wNDkgNS40ODU3MkMxODEuOTUgLTAuNDE1MDYgMTkyLjAzOSAzLjc2NDEzIDE5Mi4wMzkgMTIuMTA5MVYyNDQuMDQ2QzE5Mi4wMzkgMjUyLjM5MSAxODEuOTUgMjU2LjU3IDE3Ni4wNDkgMjUwLjY2OVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xODEuMzc5IDE4MC42NDZMMTE0LjMzIDEyOC42MzNMMTgxLjM3OSA3NS41MTE0VjE3Ljc5NEMxODEuMzc5IDEwLjg0NzcgMTczLjEyOCA3LjIwNjczIDE2Ny45OTYgMTEuODg2Mkw3NC42NTE0IDk3Ljg1MThMMzEuMTk5NCA2NC4xNDM4QzI3LjEwODEgNjEuMDM5IDIxLjM4NTEgNjEuMjk0IDE3LjU4NTMgNjQuNzQ3NkwzLjQ4OTc0IDc3LjU2MjdDLTEuMTU4NDcgODEuNzg5MyAtMS4xNjM2NyA4OS4wOTQ4IDMuNDc2NzIgOTMuMzI5MkwxNjcuOTggMjQ0LjE4NUMxNzMuMTA3IDI0OC44ODcgMTgxLjM3OSAyNDUuMjQ5IDE4MS4zNzkgMjM4LjI5MlYxODAuNjQ2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTM2LjY5MzcgMTM0LjE5NUwzLjQ3NjcyIDE2Mi44MjhDLTEuMTYzNjcgMTY3LjA2MiAtMS4xNTg0NyAxNzQuMzcgMy40ODk3NCAxNzguNTk0TDE3LjU4NTMgMTkxLjQwOUMyMS4zODUxIDE5NC44NjMgMjcuMTA4MSAxOTUuMTE4IDMxLjE5OTQgMTkyLjAxM0w2OS40NDcyIDE2NC4wNTdMMzYuNjkzNyAxMzQuMTk1WiIgZmlsbD0id2hpdGUiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swKSI+CjxwYXRoIGQ9Ik0xNjcuOTk2IDExLjg4NTdDMTczLjEyOCA3LjIwNjI3IDE4MS4zNzkgMTAuODQ3MyAxODEuMzc5IDE3Ljc5MzZWNzUuNTEwOUwxMDQuOTM4IDEzNi4wNzNMNjUuNTc0MiAxMDYuMjExTDE2Ny45OTYgMTEuODg1N1oiIGZpbGw9IiMwMDlBN0MiLz4KPHBhdGggZD0iTTM2LjY5MzcgMTM0LjE5NEwzLjQ3NjcyIDE2Mi44MjdDLTEuMTYzNjcgMTY3LjA2MiAtMS4xNTg0NyAxNzQuMzcgMy40ODk3NCAxNzguNTk0TDE3LjU4NTMgMTkxLjQwOUMyMS4zODUxIDE5NC44NjMgMjcuMTA4MSAxOTUuMTE4IDMxLjE5OTQgMTkyLjAxM0w2OS40NDcyIDE2NC4wNTZMMzYuNjkzNyAxMzQuMTk0WiIgZmlsbD0iIzAwOUE3QyIvPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMF9kKSI+CjxwYXRoIGQ9Ik0xODEuMzc5IDE4MC42NDVMMzEuMTk5NCA2NC4xNDI3QzI3LjEwODEgNjEuMDM3OSAyMS4zODUxIDYxLjI5MjkgMTcuNTg1MyA2NC43NDY1TDMuNDg5NzQgNzcuNTYxNkMtMS4xNTg0NyA4MS43ODgyIC0xLjE2MzY3IDg5LjA5MzcgMy40NzY3MiA5My4zMjgxTDE2Ny45NzIgMjQ0LjE3NkMxNzMuMTAyIDI0OC44ODEgMTgxLjM3OSAyNDUuMjQxIDE4MS4zNzkgMjM4LjI4VjE4MC42NDVaIiBmaWxsPSIjMDBCMjk0Ii8+CjwvZz4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjFfZCkiPgo8cGF0aCBkPSJNMTk0LjIzMyAyNTMuNzY2QzE4OC4xMyAyNTYuNzAxIDE4MC44MzcgMjU1LjQ2IDE3Ni4wNDggMjUwLjY3MUMxODEuOTQ5IDI1Ni41NzEgMTkyLjAzOSAyNTIuMzkyIDE5Mi4wMzkgMjQ0LjA0N1YxMi4xMTAzQzE5Mi4wMzkgMy43NjUzNSAxODEuOTQ5IC0wLjQxMzgzOSAxNzYuMDQ4IDUuNDg2OTRDMTgwLjgzNyAwLjY5NzgyNCAxODguMTI5IC0wLjU0MzE5MSAxOTQuMjMzIDIuMzkyMUwyNDYuOTM5IDI3LjczODZDMjUyLjQ3OCAzMC40MDIgMjU2IDM2LjAwMzcgMjU2IDQyLjE0OTFWMjE0LjAwOUMyNTYgMjIwLjE1NSAyNTIuNDc4IDIyNS43NTcgMjQ2LjkzOSAyMjguNDJMMTk0LjIzMyAyNTMuNzY2WiIgZmlsbD0iIzI0QkZBNSIvPgo8L2c+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iLTIxLjMzMzMiIHk9IjQwLjY0MTMiIHdpZHRoPSIyMjQuMDQ1IiBoZWlnaHQ9IjIyNi45ODgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTAuNjY2NyIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4xNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8ZmlsdGVyIGlkPSJmaWx0ZXIxX2QiIHg9IjE1NC43MTUiIHk9Ii0yMC41MTY5IiB3aWR0aD0iMTIyLjYxOCIgaGVpZ2h0PSIyOTcuMTkxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIi8+CjxmZU9mZnNldC8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEwLjY2NjciLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJvdmVybGF5IiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3ciIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==')"),`<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>GitHub Authentication - Sign In</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		html {
			height: 100%;
		}

		body {
			box-sizing: border-box;
			min-height: 100%;
			margin: 0;
			padding: 15px 30px;
			display: flex;
			flex-direction: column;
			color: white;
			font-family: "Segoe UI","Helvetica Neue","Helvetica",Arial,sans-serif;
			background-color: #2C2C32;
		}

		.branding {
			background-image: ${e};
			background-size: 24px;
			background-repeat: no-repeat;
			background-position: left center;
			padding-left: 36px;
			font-size: 20px;
			letter-spacing: -0.04rem;
			font-weight: 400;
			color: white;
			text-decoration: none;
		}

		.message-container {
			flex-grow: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 0 30px;
		}

		.message {
			font-weight: 300;
			font-size: 1.4rem;
		}

		body.error .message {
			display: none;
		}

		body.error .error-message {
			display: block;
		}

		.error-message {
			display: none;
			font-weight: 300;
			font-size: 1.3rem;
		}

		.error-text {
			color: red;
			font-size: 1rem;
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Light"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.svg#web") format("svg");
			font-weight: 200
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Semilight"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.svg#web") format("svg");
			font-weight: 300
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.svg#web") format("svg");
			font-weight: 400
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Semibold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.svg#web") format("svg");
			font-weight: 600
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Bold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.svg#web") format("svg");
			font-weight: 700
		}
	</style>
</head>

<body>
	<a class="branding" href="https://code.visualstudio.com/">
		${this.g}
	</a>
	<div class="message-container">
		<div class="message">
			Sign-in successful! Returning to ${this.g}...
			<br><br>
			If you're not redirected automatically, <a href="${this.f.toString(!0)}" style="color: #85CEFF;">click here</a> or close this page.
		</div>
		<div class="error-message">
			An error occurred while signing in:
			<div class="error-text"></div>
		</div>
	</div>
	<script>
		const search = window.location.search;
		const error = (/[?&^]error=([^&]+)/.exec(search) || [])[1];
		if (error) {
			document.querySelector('.error-text')
				.textContent = decodeURIComponent(error);
			document.querySelector('body')
				.classList.add('error');
		} else {
			// Redirect to the app URI after a 1-second delay to allow page to load
			setTimeout(function() {
				window.location.href = '${this.f.toString(!0)}';
			}, 1000);
		}
	</script>
</body>
</html>`}},Fee=class extends Dm{constructor(e,t,i,s,r,n,o,a,c,l,u,h,f){super(e,t,i,s,r,n,o,a,c,l,u,h,f),!i.remote.isRemote&&a.authorization_endpoint&&this.g.unshift({label:d(3067,null),handler:(p,g,v)=>this.B(p,g,v)}),a.device_authorization_endpoint&&this.g.push({label:d(3068,null),handler:(p,g,v)=>this.C(p,g,v)})}async B(e,t,i){if(!this.p.authorization_endpoint)throw new Error("Authorization Endpoint required");if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const s=this.v(64),r=await this.w(s),n=this.v(32),o=y.parse(`${this.m.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/redirect?nonce=${n}`);let a;try{a=await this.l.createAppUri(o)}catch(f){throw new Error(`Failed to create external URI: ${f}`)}const c=new Nee(this.p.authorization_endpoint);c.searchParams.append("client_id",this.r),c.searchParams.append("response_type","code"),c.searchParams.append("code_challenge",r),c.searchParams.append("code_challenge_method","S256");const l=e.join(" ");l&&c.searchParams.append("scope",l),this.q?.resource&&c.searchParams.append("resource",this.q.resource);const u=new Oee(this.h,a,this.m.environment.appName);try{await u.start()}catch(f){throw new Error(`Failed to start loopback server: ${f}`)}c.searchParams.set("redirect_uri",u.redirectUri),c.searchParams.set("state",u.state);const h=u.waitForOAuthResponse();this.o.$waitForUriHandler(a);try{if(this.h.info(`Opening authorization URL for scopes: ${l}`),this.h.trace(`Authorization URL: ${c.toString()}`),!await this.k.openUri(c.toString(),{}))throw new dt;t.report({message:d(3069,null)});let p;try{p=(await vf(h,i)).code}catch(v){throw Mi(v)?(this.h.info("Authorization code request was cancelled by the user."),v):(this.h.error(`Failed to receive authorization code: ${v}`),new Error(`Failed to receive authorization code: ${v}`))}return this.h.info(`Authorization code received for scopes: ${l}`),await this.y(p,s,u.redirectUri)}finally{setTimeout(()=>{u.stop()},5e3)}}async C(e,t,i){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");if(!this.p.device_authorization_endpoint)throw new Error("Device authorization endpoint not available in server metadata");const s=this.p.device_authorization_endpoint,r=e.join(" ");this.h.info(`Starting device code flow for scopes: ${r}`);const n=new URLSearchParams;n.append("client_id",this.r),r&&n.append("scope",r),this.q?.resource&&n.append("resource",this.q.resource);let o;try{o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:n.toString()})}catch(h){throw this.h.error(`Failed to request device code: ${h}`),new Error(`Failed to request device code: ${h}`)}if(!o.ok){const h=await o.text();throw new Error(`Device code request failed: ${o.status} ${o.statusText} - ${h}`)}const a=await o.json();if(!Q_(a))throw this.h.error("Invalid device code response received from server"),new Error("Invalid device code response received from server");if(this.h.info(`Device code received: ${a.user_code}`),!await this.o.$showDeviceCodeModal(a.user_code,a.verification_uri))throw new dt;t.report({message:d(3070,null,a.verification_uri,a.user_code)});const l=(a.interval||5)*1e3,u=Date.now()+a.expires_in*1e3;for(;Date.now()<u;){if(i.isCancellationRequested)throw new dt;if(await new Promise(f=>setTimeout(f,l)),i.isCancellationRequested)throw new dt;const h=new URLSearchParams;h.append("grant_type","urn:ietf:params:oauth:grant-type:device_code"),h.append("device_code",a.device_code),h.append("client_id",this.r),this.q?.resource&&h.append("resource",this.q.resource);try{const f=await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:h.toString()});if(f.ok){const p=await f.json();if(!xA(p))throw this.h.error("Invalid token response received from server"),new Error("Invalid token response received from server");return this.h.info(`Device code flow completed successfully for scopes: ${r}`),p}else{let p;try{p=await f.json()}catch(g){throw this.h.error(`Failed to parse error response: ${g}`),new Error(`Token request failed with status ${f.status}: ${f.statusText}`)}if(p.error==="authorization_pending")continue;if(p.error==="slow_down"){await new Promise(g=>setTimeout(g,l));continue}else throw p.error==="expired_token"?new Error("Device code expired. Please try again."):p.error==="access_denied"?new dt:p.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Token request failed: ${p.error_description||p.error||"Unknown error"}`)}}catch(f){throw Mi(f)?f:new Error(`Error polling for token: ${f}`)}}throw new Error("Device code flow timed out. Please try again.")}},Uee=class extends TA{constructor(e,t,i,s,r,n,o){super(e,t,i,s,r,n,o),this.c=Fee}};De(vn,xK,0),De(Jn,wee,1),De(Se,new Er(v5,[!1],!0)),De(Nd,O8,1),De(hA,uee,0),De(Em,new Er(mA,[!1],!0)),De(PA,Uee,0),De(w4,R4,0),De(A4,H4,0),De(g4,T4,0),De(mn,D4,0),De(Am,p5,0),De(Wa,yee,0),De(Xm,Iee,0);import{createRequire as jee}from"node:module";var qN=jee(import.meta.url);if(process.env.VSCODE_DEV){const e=process.listeners("warning");process.removeAllListeners("warning"),process.on("warning",t=>{if(t.code==="ExperimentalWarning"||t.name==="ExperimentalWarning"||t.name==="DeprecationWarning"){console.debug(t);return}e[0](t)})}(function(){for(let t=0;t<process.execArgv.length;t++)process.execArgv[t]==="--inspect-port=0"&&(process.execArgv.splice(t,1),t--)})();var Od=(0,WL.default)(process.argv.slice(2),{boolean:["transformURIs","skipWorkspaceStorageLock","supportGlobalNavigator"],string:["useHostProxy"]});(function(){const e=qN("module"),t=e._load;e._load=function(i){if(i==="natives")throw new Error('Either the extension or an NPM dependency is using the [unsupported "natives" node module](https://go.microsoft.com/fwlink/?linkid=871887).');return t.apply(this,arguments)}})();var J1=process.exit.bind(process),zee=process.on.bind(process);function Hee(e){process.exit=function(t){if(e)J1(t);else{const i=new Error("An extension called process.exit() and this was prevented.");console.warn(i.stack)}},process.crash=function(){const t=new Error("An extension called process.crash() and this was prevented.");console.warn(t.stack)},process.env.ELECTRON_RUN_AS_NODE="1",process.on=function(t,i){if(t==="uncaughtException"){const s=i;i=function(...r){try{return s.apply(void 0,r)}catch{}}}zee(t,i)}}Od.supportGlobalNavigator||Object.defineProperty(globalThis,"navigator",{get:()=>{Qd(new yv("navigator is now a global in nodejs, please see https://aka.ms/vscode-extensions/navigator for additional info on this error."))}});var Wr=function(e){J1()};function Wee(e,t){const i=process.env[e];if(typeof i!="string"||i.trim().length===0)return console.log(`[reconnection-grace-time] Extension host: env var ${e} not set, using default: ${t}ms (${Math.floor(t/1e3)}s)`),t;const s=Number(i);if(!isFinite(s)||s<0)return console.log(`[reconnection-grace-time] Extension host: env var ${e} invalid value '${i}', using default: ${t}ms (${Math.floor(t/1e3)}s)`),t;const r=Math.floor(s),n=r>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r;return console.log(`[reconnection-grace-time] Extension host: read ${e}=${i}ms (${Math.floor(n/1e3)}s)`),n}function Bee(){const e=zV(process.env);if(e.type===3)return new Promise((t,i)=>{const s=r=>{const n=r[0],o=new Qo;n.on("message",a=>o.fire(W.wrap(a.data))),n.on("close",()=>{Wr("renderer closed the MessagePort")}),n.start(),t({onMessage:o.event,send:a=>n.postMessage(a.buffer)})};process.parentPort.on("message",r=>s(r.ports))});if(e.type===2)return new Promise((t,i)=>{let s=null;const r=setTimeout(()=>{Wr("VSCODE_EXTHOST_IPC_SOCKET timeout")},6e4),n=Wee("VSCODE_RECONNECTION_GRACE_TIME",108e5),o=n>0?Math.min(3e5,n):0,a=new Sx(()=>Wr("renderer disconnected for too long (1)"),n),c=new Sx(()=>Wr("renderer disconnected for too long (2)"),o);process.on("message",(u,h)=>{if(u&&u.type==="VSCODE_EXTHOST_IPC_SOCKET"){h.setNoDelay(!0);const f=W.wrap(Buffer.from(u.initialDataChunk,"base64"));let p;if(u.skipWebSocketFrames)p=new vu(h,"extHost-socket");else{const g=W.wrap(Buffer.from(u.inflateBytes,"base64"));p=new mF(new vu(h,"extHost-socket"),u.permessageDeflate,g,!1)}s?(a.cancel(),c.cancel(),s.beginAcceptReconnection(p,f),s.endAcceptReconnection(),s.sendResume()):(clearTimeout(r),s=new d0({socket:p,initialChunk:f}),s.sendResume(),s.onDidDispose(()=>Wr("renderer disconnected")),t(s),s.onSocketClose(()=>{a.schedule()}))}if(u&&u.type==="VSCODE_EXTHOST_IPC_REDUCE_GRACE_TIME"){if(c.isScheduled())return;a.isScheduled()&&c.schedule()}});const l={type:"VSCODE_EXTHOST_IPC_READY"};process.send?.(l)});{const t=e.pipeName;return new Promise((i,s)=>{const r=BL.createConnection(t,()=>{r.removeListener("error",s);const n=new d0({socket:new vu(r,"extHost-renderer")});n.sendResume(),i(n)});r.once("error",s),r.on("close",()=>{Wr("renderer closed the socket")})})}}async function _ee(){const e=await Bee();return new class{constructor(){this.a=new Qo,this.onMessage=this.a.event,this.b=!1,this.d=e.onMessage(t=>{L_(t,2)?(this.b=!0,this.d.dispose(),Wr("received terminate message from renderer")):this.a.fire(t)})}send(t){this.b||e.send(t)}async drain(){if(e.drain)return e.drain()}}}function Vee(e){return new Promise(t=>{const i=e.onMessage(s=>{i.dispose();const r=JSON.parse(s.toString()),n=r.commit,o=yi.commit;if(n&&o&&n!==o&&J1(55),r.parentPid){let a=0;setInterval(function(){try{process.kill(r.parentPid,0),a=0}catch(l){l&&l.code==="EPERM"?(a++,a>=3&&Wr(`parent process ${r.parentPid} does not exist anymore (3 x EPERM): ${l.message} (code: ${l.code}) (errno: ${l.errno})`)):Wr(`parent process ${r.parentPid} does not exist anymore: ${l.message} (code: ${l.code}) (errno: ${l.errno})`)}},1e3);let c;try{c=qN("native-watchdog"),c.start(r.parentPid)}catch(l){lt(l)}}e.send(ND(0)),t({protocol:e,initData:r})});e.send(ND(1))})}async function qee(){const e=[];process.on("unhandledRejection",(a,c)=>{e.push(c),setTimeout(()=>{const l=e.indexOf(c);l>=0&&c.catch(u=>{e.splice(l,1),Mi(u)||(console.warn(`rejected promise not handled within 1 second: ${u}`),u&&u.stack&&console.warn(`stack trace: ${u.stack}`),a&&lt(a))})},1e3)}),process.on("rejectionHandled",a=>{const c=e.indexOf(a);c>=0&&e.splice(c,1)}),process.on("uncaughtException",function(a){qL(a)||lt(a)}),Ut("code/extHost/willConnectToRenderer");const t=await _ee();Ut("code/extHost/didConnectToRenderer");const i=await Vee(t);Ut("code/extHost/didWaitForInitData");const{initData:s}=i;Hee(!!s.environment.extensionTestsLocationURI),s.environment.useHostProxy=Od.useHostProxy!==void 0?Od.useHostProxy!=="false":void 0,s.environment.skipWorkspaceStorageLock=ee(Od.skipWorkspaceStorageLock,!1);const r=new class{constructor(){this.pid=process.pid}exit(c){J1(c)}fsExists(c){return nt.exists(c)}fsRealpath(c){return nt.realpath(c)}};let n=null;s.remote.authority&&Od.transformURIs&&(n=UV(s.remote.authority));const o=new OV(i.protocol,s,r,n);Wr=a=>o.terminate(a)}qee().catch(e=>console.log(e));

//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/2064368b65eca34492249241745ca3b9d4b7bc5d/core/vs/workbench/api/node/extensionHostProcess.js.map
